(function(){function aq(c){function b(h,j,l,f,g,m){for(;g>=0&&m>g;g+=c){var d=f?f[g]:g;l=j(l,h[d],d,h)}return l}return function(h,j,f,g){j=aD(j,g,4);var l=!au(h)&&ar.keys(h),d=(l||h).length,m=c>0?0:d-1;return arguments.length<3&&(f=h[l?l[m]:m],m+=c),b(h,j,f,l,m,d)}}function ak(b){return function(f,g,h){g=ag(g,h);for(var c=Q(f),d=b>0?0:c-1;d>=0&&c>d;d+=b){if(g(f[d],d,f)){return d}}return -1}}function am(d,b,c){return function(j,g,h){var l=0,f=Q(j);if("number"==typeof h){d>0?l=h>=0?h:Math.max(h+f,l):f=h>=0?Math.min(h+1,f):h+f+1}else{if(c&&h&&f){return h=c(j,g),j[h]===g?h:-1}}if(g!==g){return h=b(at.call(j,l,f),ar.isNaN),h>=0?h+l:-1}for(h=d>0?l:f-1;h>=0&&f>h;h+=d){if(j[h]===g){return h}}return -1}}function aA(h,d){var f=Y.length,g=h.constructor,b=ar.isFunction(g)&&g.prototype||aE,c="constructor";for(ar.has(h,c)&&!ar.contains(d,c)&&d.push(c);f--;){c=Y[f],c in h&&h[c]!==b[c]&&!ar.contains(d,c)&&d.push(c)}}var aj=this,aw=aj._,ap=Array.prototype,aE=Object.prototype,aC=Function.prototype,az=ap.push,at=ap.slice,al=aE.toString,ao=aE.hasOwnProperty,ax=Array.isArray,ai=Object.keys,ay=aC.bind,af=Object.create,aB=function(){},ar=function(b){return b instanceof ar?b:this instanceof ar?void (this._wrapped=b):new ar(b)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=ar),exports._=ar):aj._=ar,ar.VERSION="1.8.3";var aD=function(d,b,c){if(b===void 0){return d}switch(null==c?3:c){case 1:return function(e){return d.call(b,e)};case 2:return function(f,g){return d.call(b,f,g)};case 3:return function(g,h,f){return d.call(b,g,h,f)};case 4:return function(h,j,f,g){return d.call(b,h,j,f,g)}}return function(){return d.apply(b,arguments)}},ag=function(d,b,c){return null==d?ar.identity:ar.isFunction(d)?aD(d,b,c):ar.isObject(d)?ar.matcher(d):ar.property(d)};ar.iteratee=function(c,b){return ag(c,b,1/0)};var aF=function(c,b){return function(j){var m=arguments.length;if(2>m||null==j){return j}for(var g=1;m>g;g++){for(var h=arguments[g],n=c(h),d=n.length,p=0;d>p;p++){var l=n[p];b&&j[l]!==void 0||(j[l]=h[l])}}return j}},av=function(c){if(!ar.isObject(c)){return{}}if(af){return af(c)}aB.prototype=c;var b=new aB;return aB.prototype=null,b},ah=function(b){return function(c){return null==c?void 0:c[b]}},ad=Math.pow(2,53)-1,Q=ah("length"),au=function(c){var b=Q(c);return"number"==typeof b&&b>=0&&ad>=b};ar.each=ar.forEach=function(h,d,f){d=aD(d,f);var g,b;if(au(h)){for(g=0,b=h.length;b>g;g++){d(h[g],g,h)}}else{var c=ar.keys(h);for(g=0,b=c.length;b>g;g++){d(h[c[g]],c[g],h)}}return h},ar.map=ar.collect=function(l,f,g){f=ag(f,g);for(var h=!au(l)&&ar.keys(l),c=(h||l).length,d=Array(c),j=0;c>j;j++){var b=h?h[j]:j;d[j]=f(l[b],b,l)}return d},ar.reduce=ar.foldl=ar.inject=aq(1),ar.reduceRight=ar.foldr=aq(-1),ar.find=ar.detect=function(f,b,c){var d;return d=au(f)?ar.findIndex(f,b,c):ar.findKey(f,b,c),d!==void 0&&d!==-1?f[d]:void 0},ar.filter=ar.select=function(f,b,c){var d=[];return b=ag(b,c),ar.each(f,function(h,g,e){b(h,g,e)&&d.push(h)}),d},ar.reject=function(d,b,c){return ar.filter(d,ar.negate(ag(b)),c)},ar.every=ar.all=function(j,d,f){d=ag(d,f);for(var g=!au(j)&&ar.keys(j),b=(g||j).length,c=0;b>c;c++){var h=g?g[c]:c;if(!d(j[h],h,j)){return !1}}return !0},ar.some=ar.any=function(j,d,f){d=ag(d,f);for(var g=!au(j)&&ar.keys(j),b=(g||j).length,c=0;b>c;c++){var h=g?g[c]:c;if(d(j[h],h,j)){return !0}}return !1},ar.contains=ar.includes=ar.include=function(f,b,c,d){return au(f)||(f=ar.values(f)),("number"!=typeof c||d)&&(c=0),ar.indexOf(f,b,c)>=0},ar.invoke=function(f,b){var c=at.call(arguments,2),d=ar.isFunction(b);return ar.map(f,function(g){var e=d?b:g[b];return null==e?e:e.apply(g,c)})},ar.pluck=function(c,b){return ar.map(c,ar.property(b))},ar.where=function(c,b){return ar.filter(c,ar.matcher(b))},ar.findWhere=function(c,b){return ar.find(c,ar.matcher(b))},ar.max=function(f,p,b){var h,m,g=-1/0,d=-1/0;if(null==p&&null!=f){f=au(f)?f:ar.values(f);for(var l=0,j=f.length;j>l;l++){h=f[l],h>g&&(g=h)}}else{p=ag(p,b),ar.each(f,function(o,c,i){m=p(o,c,i),(m>d||m===-1/0&&g===-1/0)&&(g=o,d=m)})}return g},ar.min=function(f,p,b){var h,m,g=1/0,d=1/0;if(null==p&&null!=f){f=au(f)?f:ar.values(f);for(var l=0,j=f.length;j>l;l++){h=f[l],g>h&&(g=h)}}else{p=ag(p,b),ar.each(f,function(o,c,i){m=p(o,c,i),(d>m||1/0===m&&1/0===g)&&(g=o,d=m)})}return g},ar.shuffle=function(h){for(var d,f=au(h)?h:ar.values(h),g=f.length,b=Array(g),c=0;g>c;c++){d=ar.random(0,c),d!==c&&(b[c]=b[d]),b[d]=f[c]}return b},ar.sample=function(d,b,c){return null==b||c?(au(d)||(d=ar.values(d)),d[ar.random(d.length-1)]):ar.shuffle(d).slice(0,Math.max(0,b))},ar.sortBy=function(d,b,c){return b=ag(b,c),ar.pluck(ar.map(d,function(h,f,g){return{value:h,index:f,criteria:b(h,f,g)}}).sort(function(i,f){var g=i.criteria,h=f.criteria;if(g!==h){if(g>h||g===void 0){return 1}if(h>g||h===void 0){return -1}}return i.index-f.index}),"value")};var Z=function(b){return function(d,f,g){var c={};return f=ag(f,g),ar.each(d,function(j,h){var l=f(j,h,d);b(c,j,l)}),c}};ar.groupBy=Z(function(d,b,c){ar.has(d,c)?d[c].push(b):d[c]=[b]}),ar.indexBy=Z(function(d,b,c){d[c]=b}),ar.countBy=Z(function(d,b,c){ar.has(d,c)?d[c]++:d[c]=1}),ar.toArray=function(b){return b?ar.isArray(b)?at.call(b):au(b)?ar.map(b,ar.identity):ar.values(b):[]},ar.size=function(b){return null==b?0:au(b)?b.length:ar.keys(b).length},ar.partition=function(g,c,d){c=ag(c,d);var f=[],b=[];return ar.each(g,function(j,h,e){(c(j,h,e)?f:b).push(j)}),[f,b]},ar.first=ar.head=ar.take=function(d,b,c){return null==d?void 0:null==b||c?d[0]:ar.initial(d,d.length-b)},ar.initial=function(d,b,c){return at.call(d,0,Math.max(0,d.length-(null==b||c?1:b)))},ar.last=function(d,b,c){return null==d?void 0:null==b||c?d[d.length-1]:ar.rest(d,Math.max(0,d.length-b))},ar.rest=ar.tail=ar.drop=function(d,b,c){return at.call(d,null==b||c?1:b)},ar.compact=function(b){return ar.filter(b,ar.identity)};var G=function(g,w,b,p){for(var v=[],j=0,d=p||0,s=Q(g);s>d;d++){var q=g[d];if(au(q)&&(ar.isArray(q)||ar.isArguments(q))){w||(q=G(q,w,b));var m=0,h=q.length;for(v.length+=h;h>m;){v[j++]=q[m++]}}else{b||(v[j++]=q)}}return v};ar.flatten=function(c,b){return G(c,b,!1)},ar.without=function(b){return ar.difference(b,at.call(arguments,1))},ar.uniq=ar.unique=function(g,s,b,l){ar.isBoolean(s)||(l=b,b=s,s=!1),null!=b&&(b=ag(b,l));for(var q=[],h=[],d=0,p=Q(g);p>d;d++){var m=g[d],j=b?b(m,d,g):m;s?(d&&h===j||q.push(m),h=j):b?ar.contains(h,j)||(h.push(j),q.push(m)):ar.contains(q,m)||q.push(m)}return q},ar.union=function(){return ar.uniq(G(arguments,!0,!0))},ar.intersection=function(j){for(var d=[],f=arguments.length,g=0,b=Q(j);b>g;g++){var c=j[g];if(!ar.contains(d,c)){for(var h=1;f>h&&ar.contains(arguments[h],c);h++){}h===f&&d.push(c)}}return d},ar.difference=function(c){var b=G(arguments,!0,!0,1);return ar.filter(c,function(d){return !ar.contains(b,d)})},ar.zip=function(){return ar.unzip(arguments)},ar.unzip=function(f){for(var b=f&&ar.max(f,Q).length||0,c=Array(b),d=0;b>d;d++){c[d]=ar.pluck(f,d)}return c},ar.object=function(g,c){for(var d={},f=0,b=Q(g);b>f;f++){c?d[g[f]]=c[f]:d[g[f][0]]=g[f][1]}return d},ar.findIndex=ak(1),ar.findLastIndex=ak(-1),ar.sortedIndex=function(l,f,g,h){g=ag(g,h,1);for(var c=g(f),d=0,j=Q(l);j>d;){var b=Math.floor((d+j)/2);g(l[b])<c?d=b+1:j=b}return d},ar.indexOf=am(1,ar.findIndex,ar.sortedIndex),ar.lastIndexOf=am(-1,ar.findLastIndex),ar.range=function(h,d,f){null==d&&(d=h||0,h=0),f=f||1;for(var g=Math.max(Math.ceil((d-h)/f),0),b=Array(g),c=0;g>c;c++,h+=f){b[c]=h}return b};var aa=function(j,d,f,g,b){if(!(g instanceof d)){return j.apply(f,b)}var c=av(j.prototype),h=j.apply(c,b);return ar.isObject(h)?h:c};ar.bind=function(f,b){if(ay&&f.bind===ay){return ay.apply(f,at.call(arguments,1))}if(!ar.isFunction(f)){throw new TypeError("Bind must be called on a function")}var c=at.call(arguments,2),d=function(){return aa(f,d,b,this,c.concat(at.call(arguments)))};return d},ar.partial=function(d){var b=at.call(arguments,1),c=function(){for(var h=0,f=b.length,g=Array(f),j=0;f>j;j++){g[j]=b[j]===ar?arguments[h++]:b[j]}for(;h<arguments.length;){g.push(arguments[h++])}return aa(d,c,this,this,g)};return c},ar.bindAll=function(f){var b,c,d=arguments.length;if(1>=d){throw new Error("bindAll must be passed function names")}for(b=1;d>b;b++){c=arguments[b],f[c]=ar.bind(f[c],f)}return f},ar.memoize=function(d,b){var c=function(h){var f=c.cache,g=""+(b?b.apply(this,arguments):h);return ar.has(f,g)||(f[g]=d.apply(this,arguments)),f[g]};return c.cache={},c},ar.delay=function(d,b){var c=at.call(arguments,2);return setTimeout(function(){return d.apply(null,c)},b)},ar.defer=ar.partial(ar.delay,ar,1),ar.throttle=function(f,p,b){var h,m,g,d=null,l=0;b||(b={});var j=function(){l=b.leading===!1?0:ar.now(),d=null,g=f.apply(h,m),d||(h=m=null)};return function(){var e=ar.now();l||b.leading!==!1||(l=e);var c=p-(e-l);return h=this,m=arguments,0>=c||c>p?(d&&(clearTimeout(d),d=null),l=e,g=f.apply(h,m),d||(h=m=null)):d||b.trailing===!1||(d=setTimeout(j,c)),g}},ar.debounce=function(f,p,b){var h,m,g,d,l,j=function(){var c=ar.now()-d;p>c&&c>=0?h=setTimeout(j,p-c):(h=null,b||(l=f.apply(g,m),h||(g=m=null)))};return function(){g=this,m=arguments,d=ar.now();var c=b&&!h;return h||(h=setTimeout(j,p)),c&&(l=f.apply(g,m),g=m=null),l}},ar.wrap=function(c,b){return ar.partial(b,c)},ar.negate=function(b){return function(){return !b.apply(this,arguments)}},ar.compose=function(){var c=arguments,b=c.length-1;return function(){for(var d=b,f=c[b].apply(this,arguments);d--;){f=c[d].call(this,f)}return f}},ar.after=function(c,b){return function(){return --c<1?b.apply(this,arguments):void 0}},ar.before=function(d,b){var c;return function(){return --d>0&&(c=b.apply(this,arguments)),1>=d&&(b=null),c}},ar.once=ar.partial(ar.before,2);var V=!{toString:null}.propertyIsEnumerable("toString"),Y=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];ar.keys=function(d){if(!ar.isObject(d)){return[]}if(ai){return ai(d)}var b=[];for(var c in d){ar.has(d,c)&&b.push(c)}return V&&aA(d,b),b},ar.allKeys=function(d){if(!ar.isObject(d)){return[]}var b=[];for(var c in d){b.push(c)}return V&&aA(d,b),b},ar.values=function(g){for(var c=ar.keys(g),d=c.length,f=Array(d),b=0;d>b;b++){f[b]=g[c[b]]}return f},ar.mapObject=function(l,f,g){f=ag(f,g);for(var h,c=ar.keys(l),d=c.length,j={},b=0;d>b;b++){h=c[b],j[h]=f(l[h],h,l)}return j},ar.pairs=function(g){for(var c=ar.keys(g),d=c.length,f=Array(d),b=0;d>b;b++){f[b]=[c[b],g[c[b]]]}return f},ar.invert=function(g){for(var c={},d=ar.keys(g),f=0,b=d.length;b>f;f++){c[g[d[f]]]=d[f]}return c},ar.functions=ar.methods=function(d){var b=[];for(var c in d){ar.isFunction(d[c])&&b.push(c)}return b.sort()},ar.extend=aF(ar.allKeys),ar.extendOwn=ar.assign=aF(ar.keys),ar.findKey=function(j,d,f){d=ag(d,f);for(var g,b=ar.keys(j),c=0,h=b.length;h>c;c++){if(g=b[c],d(j[g],g,j)){return g}}},ar.pick=function(g,w,b){var p,v,j={},d=g;if(null==d){return j}ar.isFunction(w)?(v=ar.allKeys(d),p=aD(w,b)):(v=G(arguments,!1,!1,1),p=function(f,c,e){return c in e},d=Object(d));for(var s=0,q=v.length;q>s;s++){var m=v[s],h=d[m];p(h,m,d)&&(j[m]=h)}return j},ar.omit=function(f,b,c){if(ar.isFunction(b)){b=ar.negate(b)}else{var d=ar.map(G(arguments,!1,!1,1),String);b=function(g,e){return !ar.contains(d,e)}}return ar.pick(f,b,c)},ar.defaults=aF(ar.allKeys,!0),ar.create=function(d,b){var c=av(d);return b&&ar.extendOwn(c,b),c},ar.clone=function(b){return ar.isObject(b)?ar.isArray(b)?b.slice():ar.extend({},b):b},ar.tap=function(c,b){return b(c),c},ar.isMatch=function(j,d){var f=ar.keys(d),g=f.length;if(null==j){return !g}for(var b=Object(j),c=0;g>c;c++){var h=f[c];if(d[h]!==b[h]||!(h in b)){return !1}}return !0};var U=function(g,w,b,p){if(g===w){return 0!==g||1/g===1/w}if(null==g||null==w){return g===w}g instanceof ar&&(g=g._wrapped),w instanceof ar&&(w=w._wrapped);var v=al.call(g);if(v!==al.call(w)){return !1}switch(v){case"[object RegExp]":case"[object String]":return""+g==""+w;case"[object Number]":return +g!==+g?+w!==+w:0===+g?1/+g===1/w:+g===+w;case"[object Date]":case"[object Boolean]":return +g===+w}var j="[object Array]"===v;if(!j){if("object"!=typeof g||"object"!=typeof w){return !1}var d=g.constructor,s=w.constructor;if(d!==s&&!(ar.isFunction(d)&&d instanceof d&&ar.isFunction(s)&&s instanceof s)&&"constructor" in g&&"constructor" in w){return !1}}b=b||[],p=p||[];for(var q=b.length;q--;){if(b[q]===g){return p[q]===w}}if(b.push(g),p.push(w),j){if(q=g.length,q!==w.length){return !1}for(;q--;){if(!U(g[q],w[q],b,p)){return !1}}}else{var m,h=ar.keys(g);if(q=h.length,ar.keys(w).length!==q){return !1}for(;q--;){if(m=h[q],!ar.has(w,m)||!U(g[m],w[m],b,p)){return !1}}}return b.pop(),p.pop(),!0};ar.isEqual=function(c,b){return U(c,b)},ar.isEmpty=function(b){return null==b?!0:au(b)&&(ar.isArray(b)||ar.isString(b)||ar.isArguments(b))?0===b.length:0===ar.keys(b).length},ar.isElement=function(b){return !(!b||1!==b.nodeType)},ar.isArray=ax||function(b){return"[object Array]"===al.call(b)},ar.isObject=function(c){var b=typeof c;return"function"===b||"object"===b&&!!c},ar.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(b){ar["is"+b]=function(c){return al.call(c)==="[object "+b+"]"}}),ar.isArguments(arguments)||(ar.isArguments=function(b){return ar.has(b,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(ar.isFunction=function(b){return"function"==typeof b||!1}),ar.isFinite=function(b){return isFinite(b)&&!isNaN(parseFloat(b))},ar.isNaN=function(b){return ar.isNumber(b)&&b!==+b},ar.isBoolean=function(b){return b===!0||b===!1||"[object Boolean]"===al.call(b)},ar.isNull=function(b){return null===b},ar.isUndefined=function(b){return b===void 0},ar.has=function(c,b){return null!=c&&ao.call(c,b)},ar.noConflict=function(){return aj._=aw,this},ar.identity=function(b){return b},ar.constant=function(b){return function(){return b}},ar.noop=function(){},ar.property=ah,ar.propertyOf=function(b){return null==b?function(){}:function(c){return b[c]}},ar.matcher=ar.matches=function(b){return b=ar.extendOwn({},b),function(c){return ar.isMatch(c,b)}},ar.times=function(g,c,d){var f=Array(Math.max(0,g));c=aD(c,d,1);for(var b=0;g>b;b++){f[b]=c(b)}return f},ar.random=function(c,b){return null==b&&(b=c,c=0),c+Math.floor(Math.random()*(b-c+1))},ar.now=Date.now||function(){return(new Date).getTime()};var ac={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},C=ar.invert(ac),H=function(g){var c=function(e){return g[e]},d="(?:"+ar.keys(g).join("|")+")",f=RegExp(d),b=RegExp(d,"g");return function(e){return e=null==e?"":""+e,f.test(e)?e.replace(b,c):e}};ar.escape=H(ac),ar.unescape=H(C),ar.result=function(f,b,c){var d=null==f?void 0:f[b];return d===void 0&&(d=c),ar.isFunction(d)?d.call(f):d};var an=0;ar.uniqueId=function(c){var b=++an+"";return c?c+b:b},ar.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var X=/(.)^/,ae={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ab=/\\|'|\r|\n|\u2028|\u2029/g,W=function(b){return"\\"+ae[b]};ar.template=function(g,s,b){!s&&b&&(s=b),s=ar.defaults({},s,ar.templateSettings);var l=RegExp([(s.escape||X).source,(s.interpolate||X).source,(s.evaluate||X).source].join("|")+"|$","g"),q=0,h="__p+='";g.replace(l,function(f,i,n,u,c){return h+=g.slice(q,c).replace(ab,W),q=c+f.length,i?h+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?h+="'+\n((__t=("+n+"))==null?'':__t)+\n'":u&&(h+="';\n"+u+"\n__p+='"),f}),h+="';\n",s.variable||(h="with(obj||{}){\n"+h+"}\n"),h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{var d=new Function(s.variable||"obj","_",h)}catch(p){throw p.source=h,p}var m=function(c){return d.call(this,c,ar)},j=s.variable||"obj";return m.source="function("+j+"){\n"+h+"}",m},ar.chain=function(c){var b=ar(c);return b._chain=!0,b};var J=function(c,b){return c._chain?ar(b).chain():b};ar.mixin=function(b){ar.each(ar.functions(b),function(c){var d=ar[c]=b[c];ar.prototype[c]=function(){var e=[this._wrapped];return az.apply(e,arguments),J(this,d.apply(ar,e))}})},ar.mixin(ar),ar.each(["pop","push","reverse","shift","sort","splice","unshift"],function(c){var b=ap[c];ar.prototype[c]=function(){var d=this._wrapped;return b.apply(d,arguments),"shift"!==c&&"splice"!==c||0!==d.length||delete d[0],J(this,d)}}),ar.each(["concat","join","slice"],function(c){var b=ap[c];ar.prototype[c]=function(){return J(this,b.apply(this._wrapped,arguments))}}),ar.prototype.value=function(){return this._wrapped},ar.prototype.valueOf=ar.prototype.toJSON=ar.prototype.value,ar.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return ar})}).call(this);
/*!
* Bootstrap.js by @fat & @mdo
* Copyright 2012 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/
;!function(b){b(function(){b.support.transition=function(){var c=function(){var f=document.createElement("bootstrap"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},g;for(g in d){if(f.style[g]!==undefined){return d[g]}}}();return c&&{end:c}}()})}(window.jQuery),!function(d){var b='[data-dismiss="alert"]',f=function(e){d(e).on("click",b,this.close)};f.prototype.close=function(g){function h(){e.trigger("closed").remove()}var l=d(this),j=l.attr("data-target"),e;j||(j=l.attr("href"),j=j&&j.replace(/.*(?=#[^\s]*$)/,"")),e=d(j),g&&g.preventDefault(),e.length||(e=l.hasClass("alert")?l:l.parent()),e.trigger(g=d.Event("close"));if(g.isDefaultPrevented()){return}e.removeClass("in"),d.support.transition&&e.hasClass("fade")?e.on(d.support.transition.end,h):h()};var c=d.fn.alert;d.fn.alert=function(e){return this.each(function(){var h=d(this),g=h.data("alert");g||h.data("alert",g=new f(this)),typeof e=="string"&&g[e].call(h)})},d.fn.alert.Constructor=f,d.fn.alert.noConflict=function(){return d.fn.alert=c,this},d(document).on("click.alert.data-api",b,f.prototype.close)}(window.jQuery),!function(c){var b=function(e,f){this.$element=c(e),this.options=c.extend({},c.fn.button.defaults,f)};b.prototype.setState=function(j){var g="disabled",l=this.$element,h=l.data(),f=l.is("input")?"val":"html";j+="Text",h.resetText||l.data("resetText",l[f]()),l[f](h[j]||this.options[j]),setTimeout(function(){j=="loadingText"?l.addClass(g).attr(g,g):l.removeClass(g).removeAttr(g)},0)},b.prototype.toggle=function(){var f=this.$element.closest('[data-toggle="buttons-radio"]');f&&f.find(".active").removeClass("active"),this.$element.toggleClass("active")};var d=c.fn.button;c.fn.button=function(e){return this.each(function(){var h=c(this),f=h.data("button"),g=typeof e=="object"&&e;f||h.data("button",f=new b(this,g)),e=="toggle"?f.toggle():e&&f.setState(e)})},c.fn.button.defaults={loadingText:"loading..."},c.fn.button.Constructor=b,c.fn.button.noConflict=function(){return c.fn.button=d,this},c(document).on("click.button.data-api","[data-toggle^=button]",function(e){var f=c(e.target);f.hasClass("btn")||(f=f.closest(".btn")),f.button("toggle")})}(window.jQuery),!function(c){var b=function(e,f){this.$element=c(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=f,this.options.pause=="hover"&&this.$element.on("mouseenter",c.proxy(this.pause,this)).on("mouseleave",c.proxy(this.cycle,this))};b.prototype={cycle:function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(c.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(e){var g=this.getActiveIndex(),f=this;if(e>this.$items.length-1||e<0){return}return this.sliding?this.$element.one("slid",function(){f.to(e)}):g==e?this.pause().cycle():this.slide(e>g?"next":"prev",c(this.$items[e]))},pause:function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&c.support.transition.end&&(this.$element.trigger(c.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding){return}return this.slide("next")},prev:function(){if(this.sliding){return}return this.slide("prev")},slide:function(q,h){var e=this.$element.find(".item.active"),j=h||e[q](),v=this.interval,g=q=="next"?"left":"right",p=q=="next"?"first":"last",m=this,l;this.sliding=!0,v&&this.pause(),j=j.length?j:this.$element.find(".item")[p](),l=c.Event("slide",{relatedTarget:j[0],direction:g});if(j.hasClass("active")){return}this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var f=c(m.$indicators.children()[m.getActiveIndex()]);f&&f.addClass("active")}));if(c.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(l);if(l.isDefaultPrevented()){return}j.addClass(q),j[0].offsetWidth,e.addClass(g),j.addClass(g),this.$element.one(c.support.transition.end,function(){j.removeClass([q,g].join(" ")).addClass("active"),e.removeClass(["active",g].join(" ")),m.sliding=!1,setTimeout(function(){m.$element.trigger("slid")},0)})}else{this.$element.trigger(l);if(l.isDefaultPrevented()){return}e.removeClass("active"),j.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return v&&this.cycle(),this}};var d=c.fn.carousel;c.fn.carousel=function(e){return this.each(function(){var h=c(this),f=h.data("carousel"),g=c.extend({},c.fn.carousel.defaults,typeof e=="object"&&e),j=typeof e=="string"?e:g.slide;f||h.data("carousel",f=new b(this,g)),typeof e=="number"?f.to(e):j?f[j]():g.interval&&f.pause().cycle()})},c.fn.carousel.defaults={interval:5000,pause:"hover"},c.fn.carousel.Constructor=b,c.fn.carousel.noConflict=function(){return c.fn.carousel=d,this},c(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(f){var l=c(this),h,e=c(l.attr("data-target")||(h=l.attr("href"))&&h.replace(/.*(?=#[^\s]+$)/,"")),g=c.extend({},e.data(),l.data()),j;e.carousel(g),(j=l.attr("data-slide-to"))&&e.data("carousel").pause().to(j).cycle(),f.preventDefault()})}(window.jQuery),!function(c){var b=function(e,f){this.$element=c(e),this.options=c.extend({},c.fn.collapse.defaults,f),this.options.parent&&(this.$parent=c(this.options.parent)),this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var f=this.$element.hasClass("width");return f?"width":"height"},show:function(){var f,h,g,e;if(this.transitioning||this.$element.hasClass("in")){return}f=this.dimension(),h=c.camelCase(["scroll",f].join("-")),g=this.$parent&&this.$parent.find("> .accordion-group > .in");if(g&&g.length){e=g.data("collapse");if(e&&e.transitioning){return}g.collapse("hide"),e||g.data("collapse",null)}this.$element[f](0),this.transition("addClass",c.Event("show"),"shown"),c.support.transition&&this.$element[f](this.$element[0][h])},hide:function(){var e;if(this.transitioning||!this.$element.hasClass("in")){return}e=this.dimension(),this.reset(this.$element[e]()),this.transition("removeClass",c.Event("hide"),"hidden"),this.$element[e](0)},reset:function(g){var f=this.dimension();return this.$element.removeClass("collapse")[f](g||"auto")[0].offsetWidth,this.$element[g!==null?"addClass":"removeClass"]("collapse"),this},transition:function(f,j,h){var e=this,g=function(){j.type=="show"&&e.reset(),e.transitioning=0,e.$element.trigger(h)};this.$element.trigger(j);if(j.isDefaultPrevented()){return}this.transitioning=1,this.$element[f]("in"),c.support.transition&&this.$element.hasClass("collapse")?this.$element.one(c.support.transition.end,g):g()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var d=c.fn.collapse;c.fn.collapse=function(e){return this.each(function(){var h=c(this),f=h.data("collapse"),g=c.extend({},c.fn.collapse.defaults,h.data(),typeof e=="object"&&e);f||h.data("collapse",f=new b(this,g)),typeof e=="string"&&f[e]()})},c.fn.collapse.defaults={toggle:!0},c.fn.collapse.Constructor=b,c.fn.collapse.noConflict=function(){return c.fn.collapse=d,this},c(document).on("click.collapse.data-api","[data-toggle=collapse]",function(f){var j=c(this),h,e=j.attr("data-target")||f.preventDefault()||(h=j.attr("href"))&&h.replace(/.*(?=#[^\s]+$)/,""),g=c(e).data("collapse")?"toggle":j.data();j[c(e).hasClass("in")?"addClass":"removeClass"]("collapsed"),c(e).collapse(g)})}(window.jQuery),!function(g){function f(){g(b).each(function(){c(g(this)).removeClass("open")})}function c(e){var j=e.attr("data-target"),i;j||(j=e.attr("href"),j=j&&/#/.test(j)&&j.replace(/.*(?=#[^\s]*$)/,"")),i=j&&g(j);if(!i||!i.length){i=e.parent()}return i}var b="[data-toggle=dropdown]",h=function(e){var i=g(e).on("click.dropdown.data-api",this.toggle);g("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};h.prototype={constructor:h,toggle:function(e){var l=g(this),i,j;if(l.is(".disabled, :disabled")){return}return i=c(l),j=i.hasClass("open"),f(),j||i.toggleClass("open"),l.focus(),!1},keydown:function(q){var l,j,p,i,e,m;if(!/(38|40|27)/.test(q.keyCode)){return}l=g(this),q.preventDefault(),q.stopPropagation();if(l.is(".disabled, :disabled")){return}i=c(l),e=i.hasClass("open");if(!e||e&&q.keyCode==27){return q.which==27&&i.find(b).focus(),l.click()}j=g("[role=menu] li:not(.divider):visible a",i);if(!j.length){return}m=j.index(j.filter(":focus")),q.keyCode==38&&m>0&&m--,q.keyCode==40&&m<j.length-1&&m++,~m||(m=0),j.eq(m).focus()}};var d=g.fn.dropdown;g.fn.dropdown=function(e){return this.each(function(){var l=g(this),j=l.data("dropdown");j||l.data("dropdown",j=new h(this)),typeof e=="string"&&j[e].call(l)})},g.fn.dropdown.Constructor=h,g.fn.dropdown.noConflict=function(){return g.fn.dropdown=d,this},g(document).on("click.dropdown.data-api",f).on("click.dropdown.data-api",".dropdown form",function(i){i.stopPropagation()}).on("click.dropdown-menu",function(i){i.stopPropagation()}).on("click.dropdown.data-api",b,h.prototype.toggle).on("keydown.dropdown.data-api",b+", [role=menu]",h.prototype.keydown)}(window.jQuery),!function(c){var b=function(e,f){this.options=f,this.$element=c(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",c.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,f=c.Event("show");this.$element.trigger(f);if(this.isShown||f.isDefaultPrevented()){return}this.isShown=!0,this.escape(),this.backdrop(function(){var g=c.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),g&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),g?e.$element.one(c.support.transition.end,function(){e.$element.focus().trigger("shown")}):e.$element.focus().trigger("shown")})},hide:function(e){e&&e.preventDefault();var f=this;e=c.Event("hide"),this.$element.trigger(e);if(!this.isShown||e.isDefaultPrevented()){return}this.isShown=!1,this.escape(),c(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),c.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var e=this;c(document).on("focusin.modal",function(f){e.$element[0]!==f.target&&!e.$element.has(f.target).length&&e.$element.focus()})},escape:function(){var f=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){e.which==27&&f.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var e=this,f=setTimeout(function(){e.$element.off(c.support.transition.end),e.hideModal()},500);this.$element.one(c.support.transition.end,function(){clearTimeout(f),e.hideModal()})},hideModal:function(){var f=this;this.$element.hide(),this.backdrop(function(){f.removeBackdrop(),f.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(f){var h=this,g=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=c.support.transition&&g;this.$backdrop=c('<div class="modal-backdrop '+g+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?c.proxy(this.$element[0].focus,this.$element[0]):c.proxy(this.hide,this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!f){return}e?this.$backdrop.one(c.support.transition.end,f):f()}else{!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),c.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(c.support.transition.end,f):f()):f&&f()}}};var d=c.fn.modal;c.fn.modal=function(e){return this.each(function(){var h=c(this),f=h.data("modal"),g=c.extend({},c.fn.modal.defaults,h.data(),typeof e=="object"&&e);f||h.data("modal",f=new b(this,g)),typeof e=="string"?f[e]():g.show&&f.show()})},c.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},c.fn.modal.Constructor=b,c.fn.modal.noConflict=function(){return c.fn.modal=d,this},c(document).on("click.modal.data-api",'[data-toggle="modal"]',function(f){var j=c(this),h=j.attr("href"),e=c(j.attr("data-target")||h&&h.replace(/.*(?=#[^\s]+$)/,"")),g=e.data("modal")?"toggle":c.extend({remote:!/#/.test(h)&&h},e.data(),j.data());f.preventDefault(),e.modal(g).one("hide",function(){j.focus()})})}(window.jQuery),!function(c){var b=function(g,f){this.init("tooltip",g,f)};b.prototype={constructor:b,init:function(h,p,l){var g,j,m,f,e;this.type=h,this.$element=c(p),this.options=this.getOptions(l),this.enabled=!0,m=this.options.trigger.split(" ");for(e=m.length;e--;){f=m[e],f=="click"?this.$element.on("click."+this.type,this.options.selector,c.proxy(this.toggle,this)):f!="manual"&&(g=f=="hover"?"mouseenter":"focus",j=f=="hover"?"mouseleave":"blur",this.$element.on(g+"."+this.type,this.options.selector,c.proxy(this.enter,this)),this.$element.on(j+"."+this.type,this.options.selector,c.proxy(this.leave,this)))}this.options.selector?this._options=c.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){return e=c.extend({},c.fn[this.type].defaults,this.$element.data(),e),e.delay&&typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),e},enter:function(f){var h=c.fn[this.type].defaults,g={},e;this._options&&c.each(this._options,function(j,i){h[j]!=i&&(g[j]=i)},this),e=c(f.currentTarget)[this.type](g).data(this.type);if(!e.options.delay||!e.options.delay.show){return e.show()}clearTimeout(this.timeout),e.hoverState="in",this.timeout=setTimeout(function(){e.hoverState=="in"&&e.show()},e.options.delay.show)},leave:function(e){var f=c(e.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!f.options.delay||!f.options.delay.hide){return f.hide()}f.hoverState="out",this.timeout=setTimeout(function(){f.hoverState=="out"&&f.hide()},f.options.delay.hide)},show:function(){var g,m,j,f,h,l,e=c.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(e);if(e.isDefaultPrevented()){return}g=this.tip(),this.setContent(),this.options.animation&&g.addClass("fade"),h=typeof this.options.placement=="function"?this.options.placement.call(this,g[0],this.$element[0]):this.options.placement,g.detach().css({top:0,left:0,display:"block"}),this.options.container?g.appendTo(this.options.container):g.insertAfter(this.$element),m=this.getPosition(),j=g[0].offsetWidth,f=g[0].offsetHeight;switch(h){case"bottom":l={top:m.top+m.height,left:m.left+m.width/2-j/2};break;case"top":l={top:m.top-f,left:m.left+m.width/2-j/2};break;case"left":l={top:m.top+m.height/2-f/2,left:m.left-j};break;case"right":l={top:m.top+m.height/2-f/2,left:m.left+m.width}}this.applyPlacement(l,h),this.$element.trigger("shown")}},applyPlacement:function(l,q){var h=this.tip(),f=h[0].offsetWidth,j=h[0].offsetHeight,v,g,p,m;h.offset(l).addClass(q).addClass("in"),v=h[0].offsetWidth,g=h[0].offsetHeight,q=="top"&&g!=j&&(l.top=l.top+j-g,m=!0),q=="bottom"||q=="top"?(p=0,l.left<0&&(p=l.left*-2,l.left=0,h.offset(l),v=h[0].offsetWidth,g=h[0].offsetHeight),this.replaceArrow(p-f+v,v,"left")):this.replaceArrow(g-j,g,"top"),m&&h.offset(l)},replaceArrow:function(g,f,h){this.arrow().css(h,g?50*(1-g/f)+"%":"")},setContent:function(){var g=this.tip(),f=this.getTitle();g.find(".tooltip-inner")[this.options.html?"html":"text"](f),g.removeClass("fade in top bottom left right")},hide:function(){function f(){var i=setTimeout(function(){h.off(c.support.transition.end).detach()},500);h.one(c.support.transition.end,function(){clearTimeout(i),h.detach()})}var e=this,h=this.tip(),g=c.Event("hide");this.$element.trigger(g);if(g.isDefaultPrevented()){return}return h.removeClass("in"),c.support.transition&&this.$tip.hasClass("fade")?f():h.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var f=this.$element;(f.attr("title")||typeof f.attr("data-original-title")!="string")&&f.attr("data-original-title",f.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var e=this.$element[0];return c.extend({},typeof e.getBoundingClientRect=="function"?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},getTitle:function(){var g,f=this.$element,h=this.options;return g=f.attr("data-original-title")||(typeof h.title=="function"?h.title.call(f[0]):h.title),g},tip:function(){return this.$tip=this.$tip||c(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var f=e?c(e.currentTarget)[this.type](this._options).data(this.type):this;f.tip().hasClass("in")?f.hide():f.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var d=c.fn.tooltip;c.fn.tooltip=function(e){return this.each(function(){var h=c(this),f=h.data("tooltip"),g=typeof e=="object"&&e;f||h.data("tooltip",f=new b(this,g)),typeof e=="string"&&f[e]()})},c.fn.tooltip.Constructor=b,c.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},c.fn.tooltip.noConflict=function(){return c.fn.tooltip=d,this}}(window.jQuery),!function(c){var b=function(g,f){this.init("popover",g,f)};b.prototype=c.extend({},c.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var g=this.tip(),f=this.getTitle(),h=this.getContent();g.find(".popover-title")[this.options.html?"html":"text"](f),g.find(".popover-content")[this.options.html?"html":"text"](h),g.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var g,f=this.$element,h=this.options;return g=(typeof h.content=="function"?h.content.call(f[0]):h.content)||f.attr("data-content"),g},tip:function(){return this.$tip||(this.$tip=c(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var d=c.fn.popover;c.fn.popover=function(e){return this.each(function(){var h=c(this),f=h.data("popover"),g=typeof e=="object"&&e;f||h.data("popover",f=new b(this,g)),typeof e=="string"&&f[e]()})},c.fn.popover.Constructor=b,c.fn.popover.defaults=c.extend({},c.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.fn.popover.noConflict=function(){return c.fn.popover=d,this}}(window.jQuery),!function(c){function b(f,j){var h=c.proxy(this.process,this),e=c(f).is("body")?c(window):c(f),g;this.options=c.extend({},c.fn.scrollspy.defaults,j),this.$scrollElement=e.on("scroll.scroll-spy.data-api",h),this.selector=(this.options.target||(g=c(f).attr("href"))&&g.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=c("body"),this.refresh(),this.process()}b.prototype={constructor:b,refresh:function(){var e=this,f;this.offsets=c([]),this.targets=c([]),f=this.$body.find(this.selector).map(function(){var j=c(this),h=j.data("target")||j.attr("href"),g=/^#\w/.test(h)&&c(h);return g&&g.length&&[[g.position().top+(!c.isWindow(e.$scrollElement.get(0))&&e.$scrollElement.scrollTop()),h]]||null}).sort(function(h,g){return h[0]-g[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},process:function(){var l=this.$scrollElement.scrollTop()+this.options.offset,g=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,p=g-this.$scrollElement.height(),j=this.offsets,f=this.targets,h=this.activeTarget,m;if(l>=p){return h!=(m=f.last()[0])&&this.activate(m)}for(m=j.length;m--;){h!=f[m]&&l>=j[m]&&(!j[m+1]||l<=j[m+1])&&this.activate(f[m])}},activate:function(e){var g,f;this.activeTarget=e,c(this.selector).parent(".active").removeClass("active"),f=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',g=c(f).parent("li").addClass("active"),g.parent(".dropdown-menu").length&&(g=g.closest("li.dropdown").addClass("active")),g.trigger("activate")}};var d=c.fn.scrollspy;c.fn.scrollspy=function(e){return this.each(function(){var h=c(this),f=h.data("scrollspy"),g=typeof e=="object"&&e;f||h.data("scrollspy",f=new b(this,g)),typeof e=="string"&&f[e]()})},c.fn.scrollspy.Constructor=b,c.fn.scrollspy.defaults={offset:10},c.fn.scrollspy.noConflict=function(){return c.fn.scrollspy=d,this},c(window).on("load",function(){c('[data-spy="scroll"]').each(function(){var e=c(this);e.scrollspy(e.data())})})}(window.jQuery),!function(c){var b=function(e){this.element=c(e)};b.prototype={constructor:b,show:function(){var f=this.element,l=f.closest("ul:not(.dropdown-menu)"),h=f.attr("data-target"),e,g,j;h||(h=f.attr("href"),h=h&&h.replace(/.*(?=#[^\s]*$)/,""));if(f.parent("li").hasClass("active")){return}e=l.find(".active:last a")[0],j=c.Event("show",{relatedTarget:e}),f.trigger(j);if(j.isDefaultPrevented()){return}g=c(h),this.activate(f.parent("li"),l),this.activate(g,g.parent(),function(){f.trigger({type:"shown",relatedTarget:e})})},activate:function(f,l,h){function j(){e.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),f.addClass("active"),g?(f[0].offsetWidth,f.addClass("in")):f.removeClass("fade"),f.parent(".dropdown-menu")&&f.closest("li.dropdown").addClass("active"),h&&h()}var e=l.find("> .active"),g=h&&c.support.transition&&e.hasClass("fade");g?e.one(c.support.transition.end,j):j(),e.removeClass("in")}};var d=c.fn.tab;c.fn.tab=function(e){return this.each(function(){var g=c(this),f=g.data("tab");f||g.data("tab",f=new b(this)),typeof e=="string"&&f[e]()})},c.fn.tab.Constructor=b,c.fn.tab.noConflict=function(){return c.fn.tab=d,this},c(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),c(this).tab("show")})}(window.jQuery),!function(c){var b=function(e,f){this.$element=c(e),this.options=c.extend({},c.fn.typeahead.defaults,f),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=c(this.options.menu),this.shown=!1,this.listen()};b.prototype={constructor:b,select:function(){var f=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(f)).change(),this.hide()},updater:function(f){return f},show:function(){var e=c.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:e.top+e.height,left:e.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(e){var f;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(f=c.isFunction(this.source)?this.source(this.query,c.proxy(this.process,this)):this.source,f?this.process(f):this)},process:function(e){var f=this;return e=c.grep(e,function(g){return f.matcher(g)}),e=this.sorter(e),e.length?this.render(e.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(f){return ~f.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(j){var g=[],l=[],h=[],f;while(f=j.shift()){f.toLowerCase().indexOf(this.query.toLowerCase())?~f.indexOf(this.query)?l.push(f):h.push(f):g.push(f)}return g.concat(l,h)},highlighter:function(g){var f=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return g.replace(new RegExp("("+f+")","ig"),function(i,h){return"<strong>"+h+"</strong>"})},render:function(e){var f=this;return e=c(e).map(function(g,h){return g=c(f.options.item).attr("data-value",h),g.find("a").html(f.highlighter(h)),g[0]}),e.first().addClass("active"),this.$menu.html(e),this},next:function(e){var g=this.$menu.find(".active").removeClass("active"),f=g.next();f.length||(f=c(this.$menu.find("li")[0])),f.addClass("active")},prev:function(g){var f=this.$menu.find(".active").removeClass("active"),h=f.prev();h.length||(h=this.$menu.find("li").last()),h.addClass("active")},listen:function(){this.$element.on("focus",c.proxy(this.focus,this)).on("blur",c.proxy(this.blur,this)).on("keypress",c.proxy(this.keypress,this)).on("keyup",c.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",c.proxy(this.keydown,this)),this.$menu.on("click",c.proxy(this.click,this)).on("mouseenter","li",c.proxy(this.mouseenter,this)).on("mouseleave","li",c.proxy(this.mouseleave,this))},eventSupported:function(g){var f=g in this.$element;return f||(this.$element.setAttribute(g,"return;"),f=typeof this.$element[g]=="function"),f},move:function(f){if(!this.shown){return}switch(f.keyCode){case 9:case 13:case 27:f.preventDefault();break;case 38:f.preventDefault(),this.prev();break;case 40:f.preventDefault(),this.next()}f.stopPropagation()},keydown:function(e){this.suppressKeyPressRepeat=~c.inArray(e.keyCode,[40,38,9,13,27]),this.move(e)},keypress:function(f){if(this.suppressKeyPressRepeat){return}this.move(f)},keyup:function(f){switch(f.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}f.stopPropagation(),f.preventDefault()},focus:function(f){this.focused=!0},blur:function(f){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(f){f.stopPropagation(),f.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),c(e.currentTarget).addClass("active")},mouseleave:function(f){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var d=c.fn.typeahead;c.fn.typeahead=function(e){return this.each(function(){var h=c(this),f=h.data("typeahead"),g=typeof e=="object"&&e;f||h.data("typeahead",f=new b(this,g)),typeof e=="string"&&f[e]()})},c.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},c.fn.typeahead.Constructor=b,c.fn.typeahead.noConflict=function(){return c.fn.typeahead=d,this},c(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(e){var f=c(this);if(f.data("typeahead")){return}f.typeahead(f.data())})}(window.jQuery),!function(c){var b=function(e,f){this.options=c.extend({},c.fn.affix.defaults,f),this.$window=c(window).on("scroll.affix.data-api",c.proxy(this.checkPosition,this)).on("click.affix.data-api",c.proxy(function(){setTimeout(c.proxy(this.checkPosition,this),1)},this)),this.$element=c(e),this.checkPosition()};b.prototype.checkPosition=function(){if(!this.$element.is(":visible")){return}var h=c(document).height(),p=this.$window.scrollTop(),l=this.$element.offset(),g=this.options.offset,j=g.bottom,m=g.top,f="affix affix-top affix-bottom",e;typeof g!="object"&&(j=m=g),typeof m=="function"&&(m=g.top()),typeof j=="function"&&(j=g.bottom()),e=this.unpin!=null&&p+this.unpin<=l.top?!1:j!=null&&l.top+this.$element.height()>=h-j?"bottom":m!=null&&p<=m?"top":!1;if(this.affixed===e){return}this.affixed=e,this.unpin=e=="bottom"?l.top-p:null,this.$element.removeClass(f).addClass("affix"+(e?"-"+e:""))};var d=c.fn.affix;c.fn.affix=function(e){return this.each(function(){var h=c(this),f=h.data("affix"),g=typeof e=="object"&&e;f||h.data("affix",f=new b(this,g)),typeof e=="string"&&f[e]()})},c.fn.affix.Constructor=b,c.fn.affix.defaults={offset:0},c.fn.affix.noConflict=function(){return c.fn.affix=d,this},c(window).on("load",function(){c('[data-spy="affix"]').each(function(){var e=c(this),f=e.data();f.offset=f.offset||{},f.offsetBottom&&(f.offset.bottom=f.offsetBottom),f.offsetTop&&(f.offset.top=f.offsetTop),e.affix(f)})})}(window.jQuery);(function(f){var g={formatInvalidInputErrorMsg:function(i){return"Invalid input value '"+i+"' passed in"},callingContextNotSliderInstance:"Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"};var e=function(j,r){var i=this.element=f(j).hide();var o=f(j)[0].style.width;var m=false;var n=this.element.parent();if(n.hasClass("slider")===true){m=true;this.picker=n}else{this.picker=f('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div id="tooltip" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><div id="tooltip_min" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><div id="tooltip_max" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element)}this.id=this.element.data("slider-id")||r.id;if(this.id){this.picker[0].id=this.id}if(typeof Modernizr!=="undefined"&&Modernizr.touch){this.touchCapable=true}var q=this.element.data("slider-tooltip")||r.tooltip;this.tooltip=this.picker.find("#tooltip");this.tooltipInner=this.tooltip.find("div.tooltip-inner");this.tooltip_min=this.picker.find("#tooltip_min");this.tooltipInner_min=this.tooltip_min.find("div.tooltip-inner");this.tooltip_max=this.picker.find("#tooltip_max");this.tooltipInner_max=this.tooltip_max.find("div.tooltip-inner");if(m===true){this.picker.removeClass("slider-horizontal");this.picker.removeClass("slider-vertical");this.tooltip.removeClass("hide");this.tooltip_min.removeClass("hide");this.tooltip_max.removeClass("hide")}this.orientation=this.element.data("slider-orientation")||r.orientation;switch(this.orientation){case"vertical":this.picker.addClass("slider-vertical");this.stylePos="top";this.mousePos="pageY";this.sizePos="offsetHeight";this.tooltip.addClass("right")[0].style.left="100%";this.tooltip_min.addClass("right")[0].style.left="100%";this.tooltip_max.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",o);this.orientation="horizontal";this.stylePos="left";this.mousePos="pageX";this.sizePos="offsetWidth";this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px";this.tooltip_min.addClass("top")[0].style.top=-this.tooltip_min.outerHeight()-14+"px";this.tooltip_max.addClass("top")[0].style.top=-this.tooltip_max.outerHeight()-14+"px";break}var p=this;f.each(["min","max","step","value"],function(t,s){if(typeof i.data("slider-"+s)!=="undefined"){p[s]=i.data("slider-"+s)}else{if(typeof r[s]!=="undefined"){p[s]=r[s]}else{if(typeof i.prop(s)!=="undefined"){p[s]=i.prop(s)}else{p[s]=0}}}});if(this.value instanceof Array){if(m&&!this.range){this.value=this.value[0]}else{this.range=true}}else{if(this.range){this.value=[this.value,this.max]}}this.selection=this.element.data("slider-selection")||r.selection;this.selectionEl=this.picker.find(".slider-selection");if(this.selection==="none"){this.selectionEl.addClass("hide")}this.selectionElStyle=this.selectionEl[0].style;this.handle1=this.picker.find(".slider-handle:first");this.handle1Stype=this.handle1[0].style;this.handle2=this.picker.find(".slider-handle:last");this.handle2Stype=this.handle2[0].style;if(m===true){this.handle1.removeClass("round triangle");this.handle2.removeClass("round triangle hide")}var l=this.element.data("slider-handle")||r.handle;switch(l){case"round":this.handle1.addClass("round");this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle");this.handle2.addClass("triangle");break}if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection==="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];this.formater=r.formater;this.tooltip_separator=r.tooltip_separator;this.tooltip_split=r.tooltip_split;this.reversed=this.element.data("slider-reversed")||r.reversed;this.layout();this.layout();this.handle1.on({keydown:f.proxy(this.keydown,this,0)});this.handle2.on({keydown:f.proxy(this.keydown,this,1)});if(this.touchCapable){this.picker.on({touchstart:f.proxy(this.mousedown,this)})}else{this.picker.on({mousedown:f.proxy(this.mousedown,this)})}if(q==="hide"){this.tooltip.addClass("hide");this.tooltip_min.addClass("hide");this.tooltip_max.addClass("hide")}else{if(q==="always"){this.showTooltip();this.alwaysShowTooltip=true}else{this.picker.on({mouseenter:f.proxy(this.showTooltip,this),mouseleave:f.proxy(this.hideTooltip,this)});this.handle1.on({focus:f.proxy(this.showTooltip,this),blur:f.proxy(this.hideTooltip,this)});this.handle2.on({focus:f.proxy(this.showTooltip,this),blur:f.proxy(this.hideTooltip,this)})}}this.enabled=r.enabled&&(this.element.data("slider-enabled")===undefined||this.element.data("slider-enabled")===true);if(this.enabled){this.enable()}else{this.disable()}};e.prototype={constructor:e,over:false,inDrag:false,showTooltip:function(){if(this.tooltip_split===false){this.tooltip.addClass("in")}else{this.tooltip_min.addClass("in");this.tooltip_max.addClass("in")}this.over=true},hideTooltip:function(){if(this.inDrag===false&&this.alwaysShowTooltip!==true){this.tooltip.removeClass("in");this.tooltip_min.removeClass("in");this.tooltip_max.removeClass("in")}this.over=false},layout:function(){var l;if(this.reversed){l=[100-this.percentage[0],this.percentage[1]]}else{l=[this.percentage[0],this.percentage[1]]}this.handle1Stype[this.stylePos]=l[0]+"%";this.handle2Stype[this.stylePos]=l[1]+"%";if(this.orientation==="vertical"){this.selectionElStyle.top=Math.min(l[0],l[1])+"%";this.selectionElStyle.height=Math.abs(l[0]-l[1])+"%"}else{this.selectionElStyle.left=Math.min(l[0],l[1])+"%";this.selectionElStyle.width=Math.abs(l[0]-l[1])+"%";var j=this.tooltip_min[0].getBoundingClientRect();var i=this.tooltip_max[0].getBoundingClientRect();if(j.right>i.left){this.tooltip_max.removeClass("top");this.tooltip_max.addClass("bottom")[0].style.top=18+"px"}else{this.tooltip_max.removeClass("bottom");this.tooltip_max.addClass("top")[0].style.top=-30+"px"}}if(this.range){this.tooltipInner.text(this.formater(this.value[0])+this.tooltip_separator+this.formater(this.value[1]));this.tooltip[0].style[this.stylePos]=this.size*(l[0]+(l[1]-l[0])/2)/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px";this.tooltipInner_min.text(this.formater(this.value[0]));this.tooltipInner_max.text(this.formater(this.value[1]));this.tooltip_min[0].style[this.stylePos]=this.size*((l[0])/100)-(this.orientation==="vertical"?this.tooltip_min.outerHeight()/2:this.tooltip_min.outerWidth()/2)+"px";this.tooltip_max[0].style[this.stylePos]=this.size*((l[1])/100)-(this.orientation==="vertical"?this.tooltip_max.outerHeight()/2:this.tooltip_max.outerWidth()/2)+"px"}else{this.tooltipInner.text(this.formater(this.value[0]));this.tooltip[0].style[this.stylePos]=this.size*l[0]/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}},mousedown:function(j){if(!this.isEnabled()){return false}if(this.touchCapable&&j.type==="touchstart"){j=j.originalEvent}this.triggerFocusOnHandle();this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];var i=this.getPercentage(j);if(this.range){var n=Math.abs(this.percentage[0]-i);var l=Math.abs(this.percentage[1]-i);this.dragged=(n<l)?0:1}else{this.dragged=0}this.percentage[this.dragged]=this.reversed?100-i:i;this.layout();if(this.touchCapable){f(document).on({touchmove:f.proxy(this.mousemove,this),touchend:f.proxy(this.mouseup,this)})}else{f(document).on({mousemove:f.proxy(this.mousemove,this),mouseup:f.proxy(this.mouseup,this)})}this.inDrag=true;var m=this.calculateValue();this.setValue(m);this.element.trigger({type:"slideStart",value:m}).trigger({type:"slide",value:m});return true},triggerFocusOnHandle:function(i){if(i===0){this.handle1.focus()}if(i===1){this.handle2.focus()}},keydown:function(m,l){if(!this.isEnabled()){return false}var j;switch(l.which){case 37:case 40:j=-1;break;case 39:case 38:j=1;break}if(!j){return}var o=j*this.percentage[2];var i=this.percentage[m]+o;if(i>100){i=100}else{if(i<0){i=0}}this.dragged=m;this.adjustPercentageForRangeSliders(i);this.percentage[this.dragged]=i;this.layout();var n=this.calculateValue();this.setValue(n);this.element.trigger({type:"slide",value:n}).trigger({type:"slideStop",value:n}).data("value",n).prop("value",n);return false},mousemove:function(j){if(!this.isEnabled()){return false}if(this.touchCapable&&j.type==="touchmove"){j=j.originalEvent}var i=this.getPercentage(j);this.adjustPercentageForRangeSliders(i);this.percentage[this.dragged]=this.reversed?100-i:i;this.layout();var l=this.calculateValue();this.setValue(l);this.element.trigger({type:"slide",value:l}).data("value",l).prop("value",l);return false},adjustPercentageForRangeSliders:function(i){if(this.range){if(this.dragged===0&&this.percentage[1]<i){this.percentage[0]=this.percentage[1];this.dragged=1}else{if(this.dragged===1&&this.percentage[0]>i){this.percentage[1]=this.percentage[0];this.dragged=0}}}},mouseup:function(){if(!this.isEnabled()){return false}if(this.touchCapable){f(document).off({touchmove:this.mousemove,touchend:this.mouseup})}else{f(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}this.inDrag=false;if(this.over===false){this.hideTooltip()}var i=this.calculateValue();this.layout();this.element.data("value",i).prop("value",i).trigger({type:"slideStop",value:i});return false},calculateValue:function(){var i;if(this.range){i=[this.min,this.max];if(this.percentage[0]!==0){i[0]=(Math.max(this.min,this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step))}if(this.percentage[1]!==100){i[1]=(Math.min(this.max,this.min+Math.round((this.diff*this.percentage[1]/100)/this.step)*this.step))}this.value=i}else{i=(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step);if(i<this.min){i=this.min}else{if(i>this.max){i=this.max}}i=parseFloat(i);this.value=[i,this.value[1]]}return i},getPercentage:function(j){if(this.touchCapable){j=j.touches[0]}var i=(j[this.mousePos]-this.offset[this.stylePos])*100/this.size;i=Math.round(i/this.percentage[2])*this.percentage[2];return Math.max(0,Math.min(100,i))},getValue:function(){if(this.range){return this.value}return this.value[0]},setValue:function(i){this.value=this.validateInputValue(i);if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection==="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.layout();this.element.trigger({type:"slide",value:this.value}).data("value",this.value).prop("value",this.value)},validateInputValue:function(i){if(typeof i==="number"){return i}else{if(i instanceof Array){f.each(i,function(l,j){if(typeof j!=="number"){throw new Error(g.formatInvalidInputErrorMsg(j))}});return i}else{throw new Error(g.formatInvalidInputErrorMsg(i))}}},destroy:function(){this.handle1.off();this.handle2.off();this.element.off().show().insertBefore(this.picker);this.picker.off().remove();f(this.element).removeData("slider")},disable:function(){this.enabled=false;this.handle1.removeAttr("tabindex");this.handle2.removeAttr("tabindex");this.picker.addClass("slider-disabled");this.element.trigger("slideDisabled")},enable:function(){this.enabled=true;this.handle1.attr("tabindex",0);this.handle2.attr("tabindex",0);this.picker.removeClass("slider-disabled");this.element.trigger("slideEnabled")},toggle:function(){if(this.enabled){this.disable()}else{this.enable()}},isEnabled:function(){return this.enabled},setAttribute:function(i,j){this[i]=j}};var c={getValue:e.prototype.getValue,setValue:e.prototype.setValue,setAttribute:e.prototype.setAttribute,destroy:e.prototype.destroy,disable:e.prototype.disable,enable:e.prototype.enable,toggle:e.prototype.toggle,isEnabled:e.prototype.isEnabled};f.fn.slider=function(j){if(typeof j==="string"&&j!=="refresh"){var i=Array.prototype.slice.call(arguments,1);return d.call(this,j,i)}else{return h.call(this,j)}};function d(l,m){if(c[l]){var j=b(this);var i=c[l].apply(j,m);if(typeof i==="undefined"){return f(this)}else{return i}}else{throw new Error("method '"+l+"()' does not exist for slider.")}}function b(j){var i=f(j).data("slider");if(i&&i instanceof e){return i}else{throw new Error(g.callingContextNotSliderInstance)}}function h(i){var j=f(this);j.each(function(){var n=f(this),m=n.data("slider"),l=typeof i==="object"&&i;if(m&&!l){l={};f.each(f.fn.slider.defaults,function(o){l[o]=m[o]})}n.data("slider",(new e(this,f.extend({},f.fn.slider.defaults,l))))});return j}f.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,range:false,selection:"before",tooltip:"show",tooltip_separator:":",tooltip_split:false,handle:"round",reversed:false,enabled:true,formater:function(i){return i}};f.fn.slider.Constructor=e})(window.jQuery);(function(b){if(typeof exports=="object"&&typeof module=="object"){module.exports=b()}else{if(typeof define=="function"&&define.amd){return define([],b)}else{this.CodeMirror=b()}}})(function(){var cq=/gecko\/\d/i.test(navigator.userAgent);var eM=/MSIE \d/.test(navigator.userAgent);var bL=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var dM=eM||bL;var m=dM&&(eM?document.documentMode||6:bL[1]);var c2=/WebKit\//.test(navigator.userAgent);var dP=c2&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var de=/Chrome\//.test(navigator.userAgent);var d4=/Opera\//.test(navigator.userAgent);var aE=/Apple Computer/.test(navigator.vendor);var c9=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var fw=/PhantomJS/.test(navigator.userAgent);var e3=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var ei=e3||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var b9=e3||/Mac/.test(navigator.platform);var aR=/win/i.test(navigator.platform);var a1=d4&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(a1){a1=Number(a1[1])}if(a1&&a1>=15){d4=false;c2=true}var bS=b9&&(dP||d4&&(a1==null||a1<12.11));var f9=cq||(dM&&m>=9);var gc=false,ba=false;function J(gi,gk){if(!(this instanceof J)){return new J(gi,gk)}this.options=gk=gk?aP(gk):{};aP(e5,gk,false);cg(gk);var go=gk.value;if(typeof go=="string"){go=new av(go,gk.mode)}this.doc=go;var gj=new J.inputStyles[gk.inputStyle](this);var gn=this.display=new eK(gi,go,gj);gn.wrapper.CodeMirror=this;ee(this);cQ(this);if(gk.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(gk.autofocus&&!ei){gn.input.focus()}aF(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new gg(),keySeq:null,specialChars:null};var gh=this;if(dM&&m<11){setTimeout(function(){gh.display.input.reset(true)},20)}fS(this);bl();cK(this);this.curOp.forceUpdate=true;ed(this,go);if((gk.autofocus&&!ei)||gh.hasFocus()){setTimeout(cx(cD,this),20)}else{aX(this)}for(var gm in bh){if(bh.hasOwnProperty(gm)){bh[gm](this,gk[gm],ce)}}d7(this);if(gk.finishInit){gk.finishInit(this)}for(var gl=0;gl<bb.length;++gl){bb[gl](this)}ao(this);if(c2&&gk.lineWrapping&&getComputedStyle(gn.lineDiv).textRendering=="optimizelegibility"){gn.lineDiv.style.textRendering="auto"}}function eK(gh,gj,gi){var gk=this;this.input=gi;gk.scrollbarFiller=f2("div",null,"CodeMirror-scrollbar-filler");gk.scrollbarFiller.setAttribute("cm-not-content","true");gk.gutterFiller=f2("div",null,"CodeMirror-gutter-filler");gk.gutterFiller.setAttribute("cm-not-content","true");gk.lineDiv=f2("div",null,"CodeMirror-code");gk.selectionDiv=f2("div",null,null,"position: relative; z-index: 1");gk.cursorDiv=f2("div",null,"CodeMirror-cursors");gk.measure=f2("div",null,"CodeMirror-measure");gk.lineMeasure=f2("div",null,"CodeMirror-measure");gk.lineSpace=f2("div",[gk.measure,gk.lineMeasure,gk.selectionDiv,gk.cursorDiv,gk.lineDiv],null,"position: relative; outline: none");gk.mover=f2("div",[f2("div",[gk.lineSpace],"CodeMirror-lines")],null,"position: relative");gk.sizer=f2("div",[gk.mover],"CodeMirror-sizer");gk.sizerWidth=null;gk.heightForcer=f2("div",null,null,"position: absolute; height: "+dL+"px; width: 1px;");gk.gutters=f2("div",null,"CodeMirror-gutters");gk.lineGutter=null;gk.scroller=f2("div",[gk.sizer,gk.heightForcer,gk.gutters],"CodeMirror-scroll");gk.scroller.setAttribute("tabIndex","-1");gk.wrapper=f2("div",[gk.scrollbarFiller,gk.gutterFiller,gk.scroller],"CodeMirror");if(dM&&m<8){gk.gutters.style.zIndex=-1;gk.scroller.style.paddingRight=0}if(!c2&&!(cq&&ei)){gk.scroller.draggable=true}if(gh){if(gh.appendChild){gh.appendChild(gk.wrapper)}else{gh(gk.wrapper)}}gk.viewFrom=gk.viewTo=gj.first;gk.reportedViewFrom=gk.reportedViewTo=gj.first;gk.view=[];gk.renderedView=null;gk.externalMeasured=null;gk.viewOffset=0;gk.lastWrapHeight=gk.lastWrapWidth=0;gk.updateLineNumbers=null;gk.nativeBarWidth=gk.barHeight=gk.barWidth=0;gk.scrollbarsClipped=false;gk.lineNumWidth=gk.lineNumInnerWidth=gk.lineNumChars=null;gk.alignWidgets=false;gk.cachedCharWidth=gk.cachedTextHeight=gk.cachedPaddingH=null;gk.maxLine=null;gk.maxLineLength=0;gk.maxLineChanged=false;gk.wheelDX=gk.wheelDY=gk.wheelStartX=gk.wheelStartY=null;gk.shift=false;gk.selForContextMenu=null;gk.activeTouch=null;gi.init(gk)}function bt(gh){gh.doc.mode=J.getMode(gh.options,gh.doc.modeOption);en(gh)}function en(gh){gh.doc.iter(function(gi){if(gi.stateAfter){gi.stateAfter=null}if(gi.styles){gi.styles=null}});gh.doc.frontier=gh.doc.first;eh(gh,100);gh.state.modeGen++;if(gh.curOp){aj(gh)}}function eI(gh){if(gh.options.lineWrapping){fC(gh.display.wrapper,"CodeMirror-wrap");gh.display.sizer.style.minWidth="";gh.display.sizerWidth=null}else{g(gh.display.wrapper,"CodeMirror-wrap");h(gh)}Z(gh);aj(gh);am(gh);setTimeout(function(){e0(gh)},100)}function bg(gh){var gj=a0(gh.display),gi=gh.options.lineWrapping;var gk=gi&&Math.max(5,gh.display.scroller.clientWidth/dF(gh.display)-3);return function(gm){if(fy(gh.doc,gm)){return 0}var gl=0;if(gm.widgets){for(var gn=0;gn<gm.widgets.length;gn++){if(gm.widgets[gn].height){gl+=gm.widgets[gn].height}}}if(gi){return gl+(Math.ceil(gm.text.length/gk)||1)*gj}else{return gl+gj}}}function Z(gh){var gj=gh.doc,gi=bg(gh);gj.iter(function(gk){var gl=gi(gk);if(gl!=gk.height){f5(gk,gl)}})}function cQ(gh){gh.display.wrapper.className=gh.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+gh.options.theme.replace(/(^|\s)\s*/g," cm-s-");am(gh)}function dy(gh){ee(gh);aj(gh);setTimeout(function(){eG(gh)},20)}function ee(gh){var gi=gh.display.gutters,gm=gh.options.gutters;d3(gi);for(var gj=0;gj<gm.length;++gj){var gk=gm[gj];var gl=gi.appendChild(f2("div",null,"CodeMirror-gutter "+gk));if(gk=="CodeMirror-linenumbers"){gh.display.lineGutter=gl;gl.style.width=(gh.display.lineNumWidth||1)+"px"}}gi.style.display=gj?"":"none";c6(gh)}function c6(gh){var gi=gh.display.gutters.offsetWidth;gh.display.sizer.style.marginLeft=gi+"px"}function ep(gj){if(gj.height==0){return 0}var gi=gj.text.length,gh,gl=gj;while(gh=eQ(gl)){var gk=gh.find(0,true);gl=gk.from.line;gi+=gk.from.ch-gk.to.ch}gl=gj;while(gh=ey(gl)){var gk=gh.find(0,true);gi-=gl.text.length-gk.from.ch;gl=gk.to.line;gi+=gl.text.length-gk.to.ch}return gi}function h(gh){var gj=gh.display,gi=gh.doc;gj.maxLine=fh(gi,gi.first);gj.maxLineLength=ep(gj.maxLine);gj.maxLineChanged=true;gi.iter(function(gl){var gk=ep(gl);if(gk>gj.maxLineLength){gj.maxLineLength=gk;gj.maxLine=gl}})}function cg(gh){var gi=dj(gh.gutters,"CodeMirror-linenumbers");if(gi==-1&&gh.lineNumbers){gh.gutters=gh.gutters.concat(["CodeMirror-linenumbers"])}else{if(gi>-1&&!gh.lineNumbers){gh.gutters=gh.gutters.slice(0);gh.gutters.splice(gi,1)}}}function dC(gh){var gk=gh.display,gj=gk.gutters.offsetWidth;var gi=Math.round(gh.doc.height+bK(gh.display));return{clientHeight:gk.scroller.clientHeight,viewHeight:gk.wrapper.clientHeight,scrollWidth:gk.scroller.scrollWidth,clientWidth:gk.scroller.clientWidth,viewWidth:gk.wrapper.clientWidth,barLeft:gh.options.fixedGutter?gj:0,docHeight:gi,scrollHeight:gi+cV(gh)+gk.barHeight,nativeBarWidth:gk.nativeBarWidth,gutterWidth:gj}}function dm(gj,gi,gh){this.cm=gh;var gk=this.vert=f2("div",[f2("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var gl=this.horiz=f2("div",[f2("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");gj(gk);gj(gl);bZ(gk,"scroll",function(){if(gk.clientHeight){gi(gk.scrollTop,"vertical")}});bZ(gl,"scroll",function(){if(gl.clientWidth){gi(gl.scrollLeft,"horizontal")}});this.checkedOverlay=false;if(dM&&m<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}}dm.prototype=aP({update:function(gk){var gl=gk.scrollWidth>gk.clientWidth+1;var gj=gk.scrollHeight>gk.clientHeight+1;var gm=gk.nativeBarWidth;if(gj){this.vert.style.display="block";this.vert.style.bottom=gl?gm+"px":"0";var gi=gk.viewHeight-(gl?gm:0);this.vert.firstChild.style.height=Math.max(0,gk.scrollHeight-gk.clientHeight+gi)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(gl){this.horiz.style.display="block";this.horiz.style.right=gj?gm+"px":"0";this.horiz.style.left=gk.barLeft+"px";var gh=gk.viewWidth-gk.barLeft-(gj?gm:0);this.horiz.firstChild.style.width=(gk.scrollWidth-gk.clientWidth+gh)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedOverlay&&gk.clientHeight>0){if(gm==0){this.overlayHack()}this.checkedOverlay=true}return{right:gj?gm:0,bottom:gl?gm:0}},setScrollLeft:function(gh){if(this.horiz.scrollLeft!=gh){this.horiz.scrollLeft=gh}},setScrollTop:function(gh){if(this.vert.scrollTop!=gh){this.vert.scrollTop=gh}},overlayHack:function(){var gh=b9&&!c9?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=gh;var gi=this;var gj=function(gk){if(N(gk)!=gi.vert&&N(gk)!=gi.horiz){c4(gi.cm,ew)(gk)}};bZ(this.vert,"mousedown",gj);bZ(this.horiz,"mousedown",gj)},clear:function(){var gh=this.horiz.parentNode;gh.removeChild(this.horiz);gh.removeChild(this.vert)}},dm.prototype);function e6(){}e6.prototype=aP({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},e6.prototype);J.scrollbarModel={"native":dm,"null":e6};function aF(gh){if(gh.display.scrollbars){gh.display.scrollbars.clear();if(gh.display.scrollbars.addClass){g(gh.display.wrapper,gh.display.scrollbars.addClass)}}gh.display.scrollbars=new J.scrollbarModel[gh.options.scrollbarStyle](function(gi){gh.display.wrapper.insertBefore(gi,gh.display.scrollbarFiller);bZ(gi,"mousedown",function(){if(gh.state.focused){setTimeout(function(){gh.display.input.focus()},0)}});gi.setAttribute("cm-not-content","true")},function(gj,gi){if(gi=="horizontal"){bG(gh,gj)}else{P(gh,gj)}},gh);if(gh.display.scrollbars.addClass){fC(gh.display.wrapper,gh.display.scrollbars.addClass)}}function e0(gj,gl){if(!gl){gl=dC(gj)}var gi=gj.display.barWidth,gh=gj.display.barHeight;aW(gj,gl);for(var gk=0;gk<4&&gi!=gj.display.barWidth||gh!=gj.display.barHeight;gk++){if(gi!=gj.display.barWidth&&gj.options.lineWrapping){bc(gj)}aW(gj,dC(gj));gi=gj.display.barWidth;gh=gj.display.barHeight}}function aW(gh,gi){var gk=gh.display;var gj=gk.scrollbars.update(gi);gk.sizer.style.paddingRight=(gk.barWidth=gj.right)+"px";gk.sizer.style.paddingBottom=(gk.barHeight=gj.bottom)+"px";if(gj.right&&gj.bottom){gk.scrollbarFiller.style.display="block";gk.scrollbarFiller.style.height=gj.bottom+"px";gk.scrollbarFiller.style.width=gj.right+"px"}else{gk.scrollbarFiller.style.display=""}if(gj.bottom&&gh.options.coverGutterNextToScrollbar&&gh.options.fixedGutter){gk.gutterFiller.style.display="block";gk.gutterFiller.style.height=gj.bottom+"px";gk.gutterFiller.style.width=gi.gutterWidth+"px"}else{gk.gutterFiller.style.display=""}}function b8(gk,go,gj){var gl=gj&&gj.top!=null?Math.max(0,gj.top):gk.scroller.scrollTop;gl=Math.floor(gl-fa(gk));var gh=gj&&gj.bottom!=null?gj.bottom:gl+gk.wrapper.clientHeight;var gm=bI(go,gl),gn=bI(go,gh);if(gj&&gj.ensure){var gi=gj.ensure.from.line,gp=gj.ensure.to.line;if(gi<gm){gm=gi;gn=bI(go,bO(fh(go,gi))+gk.wrapper.clientHeight)}else{if(Math.min(gp,go.lastLine())>=gn){gm=bI(go,bO(fh(go,gp))-gk.wrapper.clientHeight);gn=gp}}}return{from:gm,to:Math.max(gn,gm+1)}}function eG(gp){var gn=gp.display,go=gn.view;if(!gn.alignWidgets&&(!gn.gutters.firstChild||!gp.options.fixedGutter)){return}var gl=dZ(gn)-gn.scroller.scrollLeft+gp.doc.scrollLeft;var gh=gn.gutters.offsetWidth,gi=gl+"px";for(var gk=0;gk<go.length;gk++){if(!go[gk].hidden){if(gp.options.fixedGutter&&go[gk].gutter){go[gk].gutter.style.left=gi}var gm=go[gk].alignable;if(gm){for(var gj=0;gj<gm.length;gj++){gm[gj].style.left=gi}}}}if(gp.options.fixedGutter){gn.gutters.style.left=(gl+gh)+"px"}}function d7(gh){if(!gh.options.lineNumbers){return false}var gm=gh.doc,gi=eu(gh.options,gm.first+gm.size-1),gl=gh.display;if(gi.length!=gl.lineNumChars){var gn=gl.measure.appendChild(f2("div",[f2("div",gi)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var gj=gn.firstChild.offsetWidth,gk=gn.offsetWidth-gj;gl.lineGutter.style.width="";gl.lineNumInnerWidth=Math.max(gj,gl.lineGutter.offsetWidth-gk)+1;gl.lineNumWidth=gl.lineNumInnerWidth+gk;gl.lineNumChars=gl.lineNumInnerWidth?gi.length:-1;gl.lineGutter.style.width=gl.lineNumWidth+"px";c6(gh);return true}return false}function eu(gh,gi){return String(gh.lineNumberFormatter(gi+gh.firstLineNumber))}function dZ(gh){return gh.scroller.getBoundingClientRect().left-gh.sizer.getBoundingClientRect().left}function aK(gi,gh,gj){var gk=gi.display;this.viewport=gh;this.visible=b8(gk,gi.doc,gh);this.editorIsHidden=!gk.wrapper.offsetWidth;this.wrapperHeight=gk.wrapper.clientHeight;this.wrapperWidth=gk.wrapper.clientWidth;this.oldDisplayWidth=dn(gi);this.force=gj;this.dims=ff(gi);this.events=[]}aK.prototype.signal=function(gi,gh){if(fk(gi,gh)){this.events.push(arguments)}};aK.prototype.finish=function(){for(var gh=0;gh<this.events.length;gh++){aG.apply(null,this.events[gh])}};function L(gh){var gi=gh.display;if(!gi.scrollbarsClipped&&gi.scroller.offsetWidth){gi.nativeBarWidth=gi.scroller.offsetWidth-gi.scroller.clientWidth;gi.heightForcer.style.height=cV(gh)+"px";gi.sizer.style.marginBottom=-gi.nativeBarWidth+"px";gi.sizer.style.borderRightWidth=cV(gh)+"px";gi.scrollbarsClipped=true}}function D(gq,gk){var gl=gq.display,gp=gq.doc;if(gk.editorIsHidden){ez(gq);return false}if(!gk.force&&gk.visible.from>=gl.viewFrom&&gk.visible.to<=gl.viewTo&&(gl.updateLineNumbers==null||gl.updateLineNumbers>=gl.viewTo)&&gl.renderedView==gl.view&&dd(gq)==0){return false}if(d7(gq)){ez(gq);gk.dims=ff(gq)}var gj=gp.first+gp.size;var gn=Math.max(gk.visible.from-gq.options.viewportMargin,gp.first);var go=Math.min(gj,gk.visible.to+gq.options.viewportMargin);if(gl.viewFrom<gn&&gn-gl.viewFrom<20){gn=Math.max(gp.first,gl.viewFrom)}if(gl.viewTo>go&&gl.viewTo-go<20){go=Math.min(gj,gl.viewTo)}if(ba){gn=aY(gq.doc,gn);go=d5(gq.doc,go)}var gi=gn!=gl.viewFrom||go!=gl.viewTo||gl.lastWrapHeight!=gk.wrapperHeight||gl.lastWrapWidth!=gk.wrapperWidth;cT(gq,gn,go);gl.viewOffset=bO(fh(gq.doc,gl.viewFrom));gq.display.mover.style.top=gl.viewOffset+"px";var gh=dd(gq);if(!gi&&gh==0&&!gk.force&&gl.renderedView==gl.view&&(gl.updateLineNumbers==null||gl.updateLineNumbers>=gl.viewTo)){return false}var gm=dQ();if(gh>4){gl.lineDiv.style.display="none"}co(gq,gl.updateLineNumbers,gk.dims);if(gh>4){gl.lineDiv.style.display=""}gl.renderedView=gl.view;if(gm&&dQ()!=gm&&gm.offsetHeight){gm.focus()}d3(gl.cursorDiv);d3(gl.selectionDiv);gl.gutters.style.height=0;if(gi){gl.lastWrapHeight=gk.wrapperHeight;gl.lastWrapWidth=gk.wrapperWidth;eh(gq,400)}gl.updateLineNumbers=null;return true}function cl(gi,gm){var gk=gm.force,gh=gm.viewport;for(var gl=true;;gl=false){if(gl&&gi.options.lineWrapping&&gm.oldDisplayWidth!=dn(gi)){gk=true}else{gk=false;if(gh&&gh.top!=null){gh={top:Math.min(gi.doc.height+bK(gi.display)-cX(gi),gh.top)}}gm.visible=b8(gi.display,gi.doc,gh);if(gm.visible.from>=gi.display.viewFrom&&gm.visible.to<=gi.display.viewTo){break}}if(!D(gi,gm)){break}bc(gi);var gj=dC(gi);bE(gi);dB(gi,gj);e0(gi,gj)}gm.signal(gi,"update",gi);if(gi.display.viewFrom!=gi.display.reportedViewFrom||gi.display.viewTo!=gi.display.reportedViewTo){gm.signal(gi,"viewportChange",gi,gi.display.viewFrom,gi.display.viewTo);gi.display.reportedViewFrom=gi.display.viewFrom;gi.display.reportedViewTo=gi.display.viewTo}}function dV(gi,gh){var gk=new aK(gi,gh);if(D(gi,gk)){bc(gi);cl(gi,gk);var gj=dC(gi);bE(gi);dB(gi,gj);e0(gi,gj);gk.finish()}}function dB(gh,gi){gh.display.sizer.style.minHeight=gi.docHeight+"px";var gj=gi.docHeight+gh.display.barHeight;gh.display.heightForcer.style.top=gj+"px";gh.display.gutters.style.height=Math.max(gj+cV(gh),gi.clientHeight)+"px"}function bc(go){var gm=go.display;var gi=gm.lineDiv.offsetTop;for(var gj=0;gj<gm.view.length;gj++){var gp=gm.view[gj],gq;if(gp.hidden){continue}if(dM&&m<8){var gl=gp.node.offsetTop+gp.node.offsetHeight;gq=gl-gi;gi=gl}else{var gk=gp.node.getBoundingClientRect();gq=gk.bottom-gk.top}var gn=gp.line.height-gq;if(gq<2){gq=a0(gm)}if(gn>0.001||gn<-0.001){f5(gp.line,gq);cd(gp.line);if(gp.rest){for(var gh=0;gh<gp.rest.length;gh++){cd(gp.rest[gh])}}}}}function cd(gh){if(gh.widgets){for(var gi=0;gi<gh.widgets.length;++gi){gh.widgets[gi].height=gh.widgets[gi].node.offsetHeight}}}function ff(gh){var gm=gh.display,gk={},gj={};var gl=gm.gutters.clientLeft;for(var gn=gm.gutters.firstChild,gi=0;gn;gn=gn.nextSibling,++gi){gk[gh.options.gutters[gi]]=gn.offsetLeft+gn.clientLeft+gl;gj[gh.options.gutters[gi]]=gn.clientWidth}return{fixedPos:dZ(gm),gutterTotalWidth:gm.gutters.offsetWidth,gutterLeft:gk,gutterWidth:gj,wrapperWidth:gm.wrapper.clientWidth}}function co(gs,gj,gr){var go=gs.display,gu=gs.options.lineNumbers;var gh=go.lineDiv,gt=gh.firstChild;function gn(gw){var gv=gw.nextSibling;if(c2&&b9&&gs.display.currentWheelTarget==gw){gw.style.display="none"}else{gw.parentNode.removeChild(gw)}return gv}var gp=go.view,gm=go.viewFrom;for(var gk=0;gk<gp.length;gk++){var gl=gp[gk];if(gl.hidden){}else{if(!gl.node||gl.node.parentNode!=gh){var gi=aH(gs,gl,gm,gr);gh.insertBefore(gi,gt)}else{while(gt!=gl.node){gt=gn(gt)}var gq=gu&&gj!=null&&gj<=gm&&gl.lineNumber;if(gl.changes){if(dj(gl.changes,"gutter")>-1){gq=false}ad(gs,gl,gm,gr)}if(gq){d3(gl.lineNumber);gl.lineNumber.appendChild(document.createTextNode(eu(gs.options,gm)))}gt=gl.node.nextSibling}}gm+=gl.size}while(gt){gt=gn(gt)}}function ad(gh,gj,gl,gm){for(var gi=0;gi<gj.changes.length;gi++){var gk=gj.changes[gi];if(gk=="text"){fn(gh,gj)}else{if(gk=="gutter"){dh(gh,gj,gl,gm)}else{if(gk=="class"){dI(gj)}else{if(gk=="widget"){aq(gh,gj,gm)}}}}}gj.changes=null}function fJ(gh){if(gh.node==gh.text){gh.node=f2("div",null,null,"position: relative");if(gh.text.parentNode){gh.text.parentNode.replaceChild(gh.node,gh.text)}gh.node.appendChild(gh.text);if(dM&&m<8){gh.node.style.zIndex=2}}return gh.node}function ex(gi){var gh=gi.bgClass?gi.bgClass+" "+(gi.line.bgClass||""):gi.line.bgClass;if(gh){gh+=" CodeMirror-linebackground"}if(gi.background){if(gh){gi.background.className=gh}else{gi.background.parentNode.removeChild(gi.background);gi.background=null}}else{if(gh){var gj=fJ(gi);gi.background=gj.insertBefore(f2("div",null,gh),gj.firstChild)}}}function dX(gh,gi){var gj=gh.display.externalMeasured;if(gj&&gj.line==gi.line){gh.display.externalMeasured=null;gi.measure=gj.measure;return gj.built}return eT(gh,gi)}function fn(gh,gk){var gi=gk.text.className;var gj=dX(gh,gk);if(gk.text==gk.node){gk.node=gj.pre}gk.text.parentNode.replaceChild(gj.pre,gk.text);gk.text=gj.pre;if(gj.bgClass!=gk.bgClass||gj.textClass!=gk.textClass){gk.bgClass=gj.bgClass;gk.textClass=gj.textClass;dI(gk)}else{if(gi){gk.text.className=gi}}}function dI(gi){ex(gi);if(gi.line.wrapClass){fJ(gi).className=gi.line.wrapClass}else{if(gi.node!=gi.text){gi.node.className=""}}var gh=gi.textClass?gi.textClass+" "+(gi.line.textClass||""):gi.line.textClass;gi.text.className=gh||""}function dh(gp,gn,gm,go){if(gn.gutter){gn.node.removeChild(gn.gutter);gn.gutter=null}var gk=gn.line.gutterMarkers;if(gp.options.lineNumbers||gk){var gi=fJ(gn);var gl=gn.gutter=f2("div",null,"CodeMirror-gutter-wrapper","left: "+(gp.options.fixedGutter?go.fixedPos:-go.gutterTotalWidth)+"px; width: "+go.gutterTotalWidth+"px");gp.display.input.setUneditable(gl);gi.insertBefore(gl,gn.text);if(gn.line.gutterClass){gl.className+=" "+gn.line.gutterClass}if(gp.options.lineNumbers&&(!gk||!gk["CodeMirror-linenumbers"])){gn.lineNumber=gl.appendChild(f2("div",eu(gp.options,gm),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+go.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+gp.display.lineNumInnerWidth+"px"))}if(gk){for(var gj=0;gj<gp.options.gutters.length;++gj){var gh=gp.options.gutters[gj],gq=gk.hasOwnProperty(gh)&&gk[gh];if(gq){gl.appendChild(f2("div",[gq],"CodeMirror-gutter-elt","left: "+go.gutterLeft[gh]+"px; width: "+go.gutterWidth[gh]+"px"))}}}}}function aq(gh,gi,gl){if(gi.alignable){gi.alignable=null}for(var gk=gi.node.firstChild,gj;gk;gk=gj){var gj=gk.nextSibling;if(gk.className=="CodeMirror-linewidget"){gi.node.removeChild(gk)}}fv(gh,gi,gl)}function aH(gh,gj,gk,gl){var gi=dX(gh,gj);gj.text=gj.node=gi.pre;if(gi.bgClass){gj.bgClass=gi.bgClass}if(gi.textClass){gj.textClass=gi.textClass}dI(gj);dh(gh,gj,gk,gl);fv(gh,gj,gl);return gj.node}function fv(gh,gj,gk){f7(gh,gj.line,gj,gk,true);if(gj.rest){for(var gi=0;gi<gj.rest.length;gi++){f7(gh,gj.rest[gi],gj,gk,false)}}}function f7(gp,gq,gm,go,gk){if(!gq.widgets){return}var gh=fJ(gm);for(var gj=0,gn=gq.widgets;gj<gn.length;++gj){var gl=gn[gj],gi=f2("div",[gl.node],"CodeMirror-linewidget");if(!gl.handleMouseEvents){gi.setAttribute("cm-ignore-events","true")}bH(gl,gi,gm,go);gp.display.input.setUneditable(gi);if(gk&&gl.above){gh.insertBefore(gi,gm.gutter||gm.text)}else{gh.appendChild(gi)}ag(gl,"redraw")}}function bH(gk,gj,gh,gl){if(gk.noHScroll){(gh.alignable||(gh.alignable=[])).push(gj);var gi=gl.wrapperWidth;gj.style.left=gl.fixedPos+"px";if(!gk.coverGutter){gi-=gl.gutterTotalWidth;gj.style.paddingLeft=gl.gutterTotalWidth+"px"}gj.style.width=gi+"px"}if(gk.coverGutter){gj.style.zIndex=5;gj.style.position="relative";if(!gk.noHScroll){gj.style.marginLeft=-gl.gutterTotalWidth+"px"}}}var Y=J.Pos=function(gh,gi){if(!(this instanceof Y)){return new Y(gh,gi)}this.line=gh;this.ch=gi};var ch=J.cmpPos=function(gi,gh){return gi.line-gh.line||gi.ch-gh.ch};function ck(gh){return Y(gh.line,gh.ch)}function bz(gi,gh){return ch(gi,gh)<0?gh:gi}function au(gi,gh){return ch(gi,gh)<0?gi:gh}function t(gh){if(!gh.state.focused){gh.display.input.focus();cD(gh)}}function al(gh){return gh.options.readOnly||gh.doc.cantEdit}var bo=null;function fZ(gw,gm,gj,gi){var gv=gw.doc;gw.display.shift=false;if(!gi){gi=gv.sel}var gq=a3(gm),gh=null;if(gw.state.pasteIncoming&&gi.ranges.length>1){if(bo&&bo.join("\n")==gm){gh=gi.ranges.length%bo.length==0&&bU(bo,a3)}else{if(gq.length==gi.ranges.length){gh=bU(gq,function(gx){return[gx]})}}}for(var gn=gi.ranges.length-1;gn>=0;gn--){var go=gi.ranges[gn];var gu=go.from(),gt=go.to();if(go.empty()){if(gj&&gj>0){gu=Y(gu.line,gu.ch-gj)}else{if(gw.state.overwrite&&!gw.state.pasteIncoming){gt=Y(gt.line,Math.min(fh(gv,gt.line).text.length,gt.ch+fI(gq).length))}}}var gr=gw.curOp.updateInput;var gs={from:gu,to:gt,text:gh?gh[gn%gh.length]:gq,origin:gw.state.pasteIncoming?"paste":gw.state.cutIncoming?"cut":"+input"};bi(gw.doc,gs);ag(gw,"inputRead",gw,gs);if(gm&&!gw.state.pasteIncoming&&gw.options.electricChars&&gw.options.smartIndent&&go.head.ch<100&&(!gn||gi.ranges[gn-1].head.line!=go.head.line)){var gp=gw.getModeAt(go.head);var gk=cZ(gs);if(gp.electricChars){for(var gl=0;gl<gp.electricChars.length;gl++){if(gm.indexOf(gp.electricChars.charAt(gl))>-1){af(gw,gk.line,"smart");break}}}else{if(gp.electricInput){if(gp.electricInput.test(fh(gv,gk.line).text.slice(0,gk.ch))){af(gw,gk.line,"smart")}}}}}fH(gw);gw.curOp.updateInput=gr;gw.curOp.typing=true;gw.state.pasteIncoming=gw.state.cutIncoming=false}function dl(gh){var gm=[],gj=[];for(var gk=0;gk<gh.doc.sel.ranges.length;gk++){var gi=gh.doc.sel.ranges[gk].head.line;var gl={anchor:Y(gi,0),head:Y(gi+1,0)};gj.push(gl);gm.push(gh.getRange(gl.anchor,gl.head))}return{text:gm,ranges:gj}}function fR(gh){gh.setAttribute("autocorrect","off");gh.setAttribute("autocapitalize","off");gh.setAttribute("spellcheck","false")}function aa(gh){this.cm=gh;this.prevInput="";this.pollingFast=false;this.polling=new gg();this.inaccurateSelection=false;this.hasSelection=false}function aZ(){var gh=f2("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");var gi=f2("div",[gh],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(c2){gh.style.width="1000px"}else{gh.setAttribute("wrap","off")}if(e3){gh.style.border="1px solid black"}fR(gh);return gi}aa.prototype=aP({init:function(gj){var gi=this,gh=this.cm;var gm=this.wrapper=aZ();var gk=this.textarea=gm.firstChild;gj.wrapper.insertBefore(gm,gj.wrapper.firstChild);if(e3){gk.style.width="0px"}bZ(gk,"input",function(){if(dM&&m>=9&&gi.hasSelection){gi.hasSelection=null}gi.poll()});bZ(gk,"paste",function(){if(c2&&!gh.state.fakedLastChar&&!(new Date-gh.state.lastMiddleDown<200)){var go=gk.selectionStart,gn=gk.selectionEnd;gk.value+="$";gk.selectionEnd=gn;gk.selectionStart=go;gh.state.fakedLastChar=true}gh.state.pasteIncoming=true;gi.fastPoll()});function gl(go){if(gh.somethingSelected()){bo=gh.getSelections();if(gi.inaccurateSelection){gi.prevInput="";gi.inaccurateSelection=false;gk.value=bo.join("\n");dN(gk)}}else{var gn=dl(gh);bo=gn.text;if(go.type=="cut"){gh.setSelections(gn.ranges,null,ab)}else{gi.prevInput="";gk.value=gn.text.join("\n");dN(gk)}}if(go.type=="cut"){gh.state.cutIncoming=true}}bZ(gk,"cut",gl);bZ(gk,"copy",gl);bZ(gj.scroller,"paste",function(gn){if(bd(gj,gn)){return}gh.state.pasteIncoming=true;gi.focus()});bZ(gj.lineSpace,"selectstart",function(gn){if(!bd(gj,gn)){cI(gn)}})},prepareSelection:function(){var gi=this.cm,gm=gi.display,gl=gi.doc;var gh=fK(gi);if(gi.options.moveInputWithCursor){var gn=dW(gi,gl.sel.primary().head,"div");var gj=gm.wrapper.getBoundingClientRect(),gk=gm.lineDiv.getBoundingClientRect();gh.teTop=Math.max(0,Math.min(gm.wrapper.clientHeight-10,gn.top+gk.top-gj.top));gh.teLeft=Math.max(0,Math.min(gm.wrapper.clientWidth-10,gn.left+gk.left-gj.left))}return gh},showSelection:function(gj){var gh=this.cm,gi=gh.display;bT(gi.cursorDiv,gj.cursors);bT(gi.selectionDiv,gj.selection);if(gj.teTop!=null){this.wrapper.style.top=gj.teTop+"px";this.wrapper.style.left=gj.teLeft+"px"}},reset:function(gl){if(this.contextMenuPending){return}var gi,gk,gh=this.cm,gn=gh.doc;if(gh.somethingSelected()){this.prevInput="";var gj=gn.sel.primary();gi=dc&&(gj.to().line-gj.from().line>100||(gk=gh.getSelection()).length>1000);var gm=gi?"-":gk||gh.getSelection();this.textarea.value=gm;if(gh.state.focused){dN(this.textarea)}if(dM&&m>=9){this.hasSelection=gm}}else{if(!gl){this.prevInput=this.textarea.value="";if(dM&&m>=9){this.hasSelection=null}}}this.inaccurateSelection=gi},getField:function(){return this.textarea},supportsTouch:function(){return false},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!ei||dQ()!=this.textarea)){try{this.textarea.focus()}catch(gh){}}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var gh=this;if(gh.pollingFast){return}gh.polling.set(this.cm.options.pollInterval,function(){gh.poll();if(gh.cm.state.focused){gh.slowPoll()}})},fastPoll:function(){var gi=false,gh=this;gh.pollingFast=true;function gj(){var gk=gh.poll();if(!gk&&!gi){gi=true;gh.polling.set(60,gj)}else{gh.pollingFast=false;gh.slowPoll()}}gh.polling.set(20,gj)},poll:function(){var gh=this.cm,gk=this.textarea,gl=this.prevInput;if(!gh.state.focused||(bu(gk)&&!gl)||al(gh)||gh.options.disableInput||gh.state.keySeq){return false}if(gh.state.pasteIncoming&&gh.state.fakedLastChar){gk.value=gk.value.substring(0,gk.value.length-1);gh.state.fakedLastChar=false}var gm=gk.value;if(gm==gl&&!gh.somethingSelected()){return false}if(dM&&m>=9&&this.hasSelection===gm||b9&&/[\uf700-\uf7ff]/.test(gm)){gh.display.input.reset();return false}if(gh.doc.sel==gh.display.selForContextMenu){if(gm.charCodeAt(0)==8203){if(!gl){gl="\u200b"}}else{if(gl=="\u200b"){gm=gm.slice(1);gl=""}}}var gn=0,gi=Math.min(gl.length,gm.length);while(gn<gi&&gl.charCodeAt(gn)==gm.charCodeAt(gn)){++gn}var gj=this;cO(gh,function(){fZ(gh,gm.slice(gn),gl.length-gn);if(gm.length>1000||gm.indexOf("\n")>-1){gk.value=gj.prevInput=""}else{gj.prevInput=gm}});return true},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}},onKeyPress:function(){if(dM&&m>=9){this.hasSelection=null}this.fastPoll()},onContextMenu:function(gm){var gr=this,gs=gr.cm,go=gs.display,gi=gr.textarea;var gq=cp(gs,gm),gh=go.scroller.scrollTop;if(!gq||d4){return}var gl=gs.options.resetSelectionOnContextMenu;if(gl&&gs.doc.sel.contains(gq)==-1){c4(gs,bW)(gs.doc,eU(gq),ab)}var gn=gi.style.cssText;gr.wrapper.style.position="absolute";gi.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(gm.clientY-5)+"px; left: "+(gm.clientX-5)+"px; z-index: 1000; background: "+(dM?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(c2){var gt=window.scrollY}go.input.focus();if(c2){window.scrollTo(null,gt)}go.input.reset();if(!gs.somethingSelected()){gi.value=gr.prevInput=" "}gr.contextMenuPending=true;go.selForContextMenu=gs.doc.sel;clearTimeout(go.detectingSelectAll);function gk(){if(gi.selectionStart!=null){var gu=gs.somethingSelected();var gv=gi.value="\u200b"+(gu?gi.value:"");gr.prevInput=gu?"":"\u200b";gi.selectionStart=1;gi.selectionEnd=gv.length;go.selForContextMenu=gs.doc.sel}}function gp(){gr.contextMenuPending=false;gr.wrapper.style.position="relative";gi.style.cssText=gn;if(dM&&m<9){go.scrollbars.setScrollTop(go.scroller.scrollTop=gh)}if(gi.selectionStart!=null){if(!dM||(dM&&m<9)){gk()}var gu=0,gv=function(){if(go.selForContextMenu==gs.doc.sel&&gi.selectionStart==0&&gr.prevInput=="\u200b"){c4(gs,eF.selectAll)(gs)}else{if(gu++<10){go.detectingSelectAll=setTimeout(gv,500)}else{go.input.reset()}}};go.detectingSelectAll=setTimeout(gv,200)}}if(dM&&m>=9){gk()}if(f9){et(gm);var gj=function(){ef(window,"mouseup",gj);setTimeout(gp,20)};bZ(window,"mouseup",gj)}else{setTimeout(gp,50)}},setUneditable:fW,needsContentAttribute:false},aa.prototype);function dx(gh){this.cm=gh;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new gg();this.gracePeriod=false}dx.prototype=aP({init:function(gk){var gj=this,gh=gj.cm;var gl=gj.div=gk.lineDiv;gl.contentEditable="true";fR(gl);bZ(gl,"paste",function(gn){var gm=gn.clipboardData&&gn.clipboardData.getData("text/plain");if(gm){gn.preventDefault();gh.replaceSelection(gm,null,"paste")}});bZ(gl,"compositionstart",function(gq){var gp=gq.data;gj.composing={sel:gh.doc.sel,data:gp,startData:gp};if(!gp){return}var gn=gh.doc.sel.primary();var gm=gh.getLine(gn.head.line);var go=gm.indexOf(gp,Math.max(0,gn.head.ch-gp.length));if(go>-1&&go<=gn.head.ch){gj.composing.sel=eU(Y(gn.head.line,go),Y(gn.head.line,go+gp.length))}});bZ(gl,"compositionupdate",function(gm){gj.composing.data=gm.data});bZ(gl,"compositionend",function(gn){var gm=gj.composing;if(!gm){return}if(gn.data!=gm.startData&&!/\u200b/.test(gn.data)){gm.data=gn.data}setTimeout(function(){if(!gm.handled){gj.applyComposition(gm)}if(gj.composing==gm){gj.composing=null}},50)});bZ(gl,"touchstart",function(){gj.forceCompositionEnd()});bZ(gl,"input",function(){if(gj.composing){return}if(!gj.pollContent()){cO(gj.cm,function(){aj(gh)})}});function gi(gp){if(gh.somethingSelected()){bo=gh.getSelections();if(gp.type=="cut"){gh.replaceSelection("",null,"cut")}}else{var gn=dl(gh);bo=gn.text;if(gp.type=="cut"){gh.operation(function(){gh.setSelections(gn.ranges,0,ab);gh.replaceSelection("",null,"cut")})}}if(gp.clipboardData&&!e3){gp.preventDefault();gp.clipboardData.clearData();gp.clipboardData.setData("text/plain",bo.join("\n"))}else{var go=aZ(),gq=go.firstChild;gh.display.lineSpace.insertBefore(go,gh.display.lineSpace.firstChild);gq.value=bo.join("\n");var gm=document.activeElement;dN(gq);setTimeout(function(){gh.display.lineSpace.removeChild(go);gm.focus()},50)}}bZ(gl,"copy",gi);bZ(gl,"cut",gi)},prepareSelection:function(){var gh=fK(this.cm,false);gh.focus=this.cm.state.focused;return gh},showSelection:function(gh){if(!gh||!this.cm.display.view.length){return}if(gh.focus){this.showPrimarySelection()}this.showMultipleSelections(gh)},showPrimarySelection:function(){var gl=window.getSelection(),go=this.cm.doc.sel.primary();var gm=aB(this.cm,gl.anchorNode,gl.anchorOffset);var gq=aB(this.cm,gl.focusNode,gl.focusOffset);if(gm&&!gm.bad&&gq&&!gq.bad&&ch(au(gm,gq),go.from())==0&&ch(bz(gm,gq),go.to())==0){return}var gk=cB(this.cm,go.from());var gp=cB(this.cm,go.to());if(!gk&&!gp){return}var gs=this.cm.display.view;var gn=gl.rangeCount&&gl.getRangeAt(0);if(!gk){gk={node:gs[0].measure.map[2],offset:0}}else{if(!gp){var gj=gs[gs.length-1].measure;var gi=gj.maps?gj.maps[gj.maps.length-1]:gj.map;gp={node:gi[gi.length-1],offset:gi[gi.length-2]-gi[gi.length-3]}}}try{var gh=cn(gk.node,gk.offset,gp.offset,gp.node)}catch(gr){}if(gh){gl.removeAllRanges();gl.addRange(gh);if(gn&&gl.anchorNode==null){gl.addRange(gn)}else{if(cq){this.startGracePeriod()}}}this.rememberSelection()},startGracePeriod:function(){var gh=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){gh.gracePeriod=false;if(gh.selectionChanged()){gh.cm.operation(function(){gh.cm.curOp.selectionChanged=true})}},20)},showMultipleSelections:function(gh){bT(this.cm.display.cursorDiv,gh.cursors);bT(this.cm.display.selectionDiv,gh.selection)},rememberSelection:function(){var gh=window.getSelection();this.lastAnchorNode=gh.anchorNode;this.lastAnchorOffset=gh.anchorOffset;this.lastFocusNode=gh.focusNode;this.lastFocusOffset=gh.focusOffset},selectionInEditor:function(){var gi=window.getSelection();if(!gi.rangeCount){return false}var gh=gi.getRangeAt(0).commonAncestorContainer;return ga(this.div,gh)},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus()}},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return true},receivedFocus:function(){var gh=this;if(this.selectionInEditor()){this.pollSelection()}else{cO(this.cm,function(){gh.cm.curOp.selectionChanged=true})}function gi(){if(gh.cm.state.focused){gh.pollSelection();gh.polling.set(gh.cm.options.pollInterval,gi)}}this.polling.set(this.cm.options.pollInterval,gi)},selectionChanged:function(){var gh=window.getSelection();return gh.anchorNode!=this.lastAnchorNode||gh.anchorOffset!=this.lastAnchorOffset||gh.focusNode!=this.lastFocusNode||gh.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var gk=window.getSelection(),gh=this.cm;this.rememberSelection();var gi=aB(gh,gk.anchorNode,gk.anchorOffset);var gj=aB(gh,gk.focusNode,gk.focusOffset);if(gi&&gj){cO(gh,function(){bW(gh.doc,eU(gi,gj),ab);if(gi.bad||gj.bad){gh.curOp.selectionChanged=true}})}}},pollContent:function(){var gr=this.cm,gB=gr.display,gz=gr.doc.sel.primary();var gA=gz.from(),gl=gz.to();if(gA.line<gB.viewFrom||gl.line>gB.viewTo-1){return false}var go;if(gA.line==gB.viewFrom||(go=dt(gr,gA.line))==0){var gm=bP(gB.view[0].line);var gq=gB.view[0].node}else{var gm=bP(gB.view[go].line);var gq=gB.view[go-1].node.nextSibling}var gy=dt(gr,gl.line);if(gy==gB.view.length-1){var gt=gB.viewTo-1;var gw=gB.view[gy].node}else{var gt=bP(gB.view[gy+1].line)-1;var gw=gB.view[gy+1].node.previousSibling}var gC=a3(f0(gr,gq,gw,gm,gt));var gv=f4(gr.doc,Y(gm,0),Y(gt,fh(gr.doc,gt).text.length));while(gC.length>1&&gv.length>1){if(fI(gC)==fI(gv)){gC.pop();gv.pop();gt--}else{if(gC[0]==gv[0]){gC.shift();gv.shift();gm++}else{break}}}var gx=0,gj=0;var gs=gC[0],gi=gv[0],gh=Math.min(gs.length,gi.length);while(gx<gh&&gs.charCodeAt(gx)==gi.charCodeAt(gx)){++gx}var gp=fI(gC),gD=fI(gv);var gk=Math.min(gp.length-(gC.length==1?gx:0),gD.length-(gv.length==1?gx:0));while(gj<gk&&gp.charCodeAt(gp.length-gj-1)==gD.charCodeAt(gD.length-gj-1)){++gj}gC[gC.length-1]=gp.slice(0,gp.length-gj);gC[0]=gC[0].slice(gx);var gn=Y(gm,gx);var gu=Y(gt,gv.length?fI(gv).length-gj:0);if(gC.length>1||gC[0]||ch(gn,gu)){a4(gr.doc,gC,gn,gu,"+input");return true}},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus()},applyComposition:function(gh){if(gh.data&&gh.data!=gh.startData){c4(this.cm,fZ)(this.cm,gh.data,0,gh.sel)}},setUneditable:function(gh){gh.setAttribute("contenteditable","false")},onKeyPress:function(gh){gh.preventDefault();c4(this.cm,fZ)(this.cm,String.fromCharCode(gh.charCode==null?gh.keyCode:gh.charCode),0)},onContextMenu:fW,resetPosition:fW,needsContentAttribute:true},dx.prototype);function cB(gn,gl){var gm=fd(gn,gl.line);if(!gm||gm.hidden){return null}var gp=fh(gn.doc,gl.line);var gi=cv(gm,gp,gl.line);var gj=b(gp),gk="left";if(gj){var gh=aI(gj,gl.ch);gk=gh%2?"right":"left"}var go=aN(gi.map,gl.ch,"left");go.offset=go.collapse=="right"?go.end:go.start;return go}function ev(gi,gh){if(gh){gi.bad=true}return gi}function aB(gh,gk,gm){var gl;if(gk==gh.display.lineDiv){gl=gh.display.lineDiv.childNodes[gm];if(!gl){return ev(gh.clipPos(Y(gh.display.viewTo-1)),true)}gk=null;gm=0}else{for(gl=gk;;gl=gl.parentNode){if(!gl||gl==gh.display.lineDiv){return null}if(gl.parentNode&&gl.parentNode==gh.display.lineDiv){break}}}for(var gj=0;gj<gh.display.view.length;gj++){var gi=gh.display.view[gj];if(gi.node==gl){return ac(gi,gk,gm)}}}function ac(gp,gl,gn){var gj=gp.text.firstChild,gk=false;if(!gl||!ga(gj,gl)){return ev(Y(bP(gp.line),0),true)}if(gl==gj){gk=true;gl=gj.childNodes[gn];gn=0;if(!gl){var gv=gp.rest?fI(gp.rest):gp.line;return ev(Y(bP(gv),gv.text.length),gk)}}var gm=gl.nodeType==3?gl:null,gt=gl;if(!gm&&gl.childNodes.length==1&&gl.firstChild.nodeType==3){gm=gl.firstChild;if(gn){gn=gm.nodeValue.length}}while(gt.parentNode!=gj){gt=gt.parentNode}var gi=gp.measure,gr=gi.maps;function go(gy,gD,gA){for(var gC=-1;gC<(gr?gr.length:0);gC++){var gx=gC<0?gi.map:gr[gC];for(var gB=0;gB<gx.length;gB+=3){var gz=gx[gB+2];if(gz==gy||gz==gD){var gE=bP(gC<0?gp.line:gp.rest[gC]);var gw=gx[gB]+gA;if(gA<0||gz!=gy){gw=gx[gB+(gA?1:0)]}return Y(gE,gw)}}}}var gu=go(gm,gt,gn);if(gu){return ev(gu,gk)}for(var gh=gt.nextSibling,gq=gm?gm.nodeValue.length-gn:0;gh;gh=gh.nextSibling){gu=go(gh,gh.firstChild,0);if(gu){return ev(Y(gu.line,gu.ch-gq),gk)}else{gq+=gh.textContent.length}}for(var gs=gt.previousSibling,gq=gn;gs;gs=gs.previousSibling){gu=go(gs,gs.firstChild,-1);if(gu){return ev(Y(gu.line,gu.ch+gq),gk)}else{gq+=gh.textContent.length}}}function f0(go,gm,gn,gj,gh){var gp="",gi=false;function gk(gq){return function(gr){return gr.id==gq}}function gl(gu){if(gu.nodeType==1){var gr=gu.getAttribute("cm-text");if(gr!=null){if(gr==""){gr=gu.textContent.replace(/\u200b/g,"")}gp+=gr;return}var gt=gu.getAttribute("cm-marker"),gq;if(gt){var gv=go.findMarks(Y(gj,0),Y(gh+1,0),gk(+gt));if(gv.length&&(gq=gv[0].find())){gp+=f4(go.doc,gq.from,gq.to).join("\n")}return}if(gu.getAttribute("contenteditable")=="false"){return}for(var gs=0;gs<gu.childNodes.length;gs++){gl(gu.childNodes[gs])}if(/^(pre|div|p)$/i.test(gu.nodeName)){gi=true}}else{if(gu.nodeType==3){var gw=gu.nodeValue;if(!gw){return}if(gi){gp+="\n";gi=false}gp+=gw}}}for(;;){gl(gm);if(gm==gn){break}gm=gm.nextSibling}return gp}J.inputStyles={textarea:aa,contenteditable:dx};function f3(gh,gi){this.ranges=gh;this.primIndex=gi}f3.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(gh){if(gh==this){return true}if(gh.primIndex!=this.primIndex||gh.ranges.length!=this.ranges.length){return false}for(var gj=0;gj<this.ranges.length;gj++){var gi=this.ranges[gj],gk=gh.ranges[gj];if(ch(gi.anchor,gk.anchor)!=0||ch(gi.head,gk.head)!=0){return false}}return true},deepCopy:function(){for(var gh=[],gi=0;gi<this.ranges.length;gi++){gh[gi]=new d0(ck(this.ranges[gi].anchor),ck(this.ranges[gi].head))}return new f3(gh,this.primIndex)},somethingSelected:function(){for(var gh=0;gh<this.ranges.length;gh++){if(!this.ranges[gh].empty()){return true}}return false},contains:function(gk,gh){if(!gh){gh=gk}for(var gj=0;gj<this.ranges.length;gj++){var gi=this.ranges[gj];if(ch(gh,gi.from())>=0&&ch(gk,gi.to())<=0){return gj}}return -1}};function d0(gh,gi){this.anchor=gh;this.head=gi}d0.prototype={from:function(){return au(this.anchor,this.head)},to:function(){return bz(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cy(gh,go){var gj=gh[go];gh.sort(function(gr,gq){return ch(gr.from(),gq.from())});go=dj(gh,gj);for(var gl=1;gl<gh.length;gl++){var gp=gh[gl],gi=gh[gl-1];if(ch(gi.to(),gp.from())>=0){var gm=au(gi.from(),gp.from()),gn=bz(gi.to(),gp.to());var gk=gi.empty()?gp.from()==gp.head:gi.from()==gi.head;if(gl<=go){--go}gh.splice(--gl,2,new d0(gk?gn:gm,gk?gm:gn))}}return new f3(gh,go)}function eU(gh,gi){return new f3([new d0(gh,gi||gh)],0)}function c7(gh,gi){return Math.max(gh.first,Math.min(gi,gh.first+gh.size-1))}function fL(gi,gj){if(gj.line<gi.first){return Y(gi.first,0)}var gh=gi.first+gi.size-1;if(gj.line>gh){return Y(gh,fh(gi,gh).text.length)}return fu(gj,fh(gi,gj.line).text.length)}function fu(gj,gi){var gh=gj.ch;if(gh==null||gh>gi){return Y(gj.line,gi)}else{if(gh<0){return Y(gj.line,0)}else{return gj}}}function cb(gi,gh){return gh>=gi.first&&gh<gi.first+gi.size}function d2(gj,gk){for(var gh=[],gi=0;gi<gk.length;gi++){gh[gi]=fL(gj,gk[gi])}return gh}function fx(gm,gi,gl,gh){if(gm.cm&&gm.cm.display.shift||gm.extend){var gk=gi.anchor;if(gh){var gj=ch(gl,gk)<0;if(gj!=(ch(gh,gk)<0)){gk=gl;gl=gh}else{if(gj!=(ch(gl,gh)<0)){gl=gh}}}return new d0(gk,gl)}else{return new d0(gh||gl,gl)}}function fX(gk,gj,gh,gi){bW(gk,new f3([fx(gk,gk.sel.primary(),gj,gh)],0),gi)}function ay(gm,gl,gj){for(var gi=[],gk=0;gk<gm.sel.ranges.length;gk++){gi[gk]=fx(gm,gm.sel.ranges[gk],gl[gk],null)}var gh=cy(gi,gm.sel.primIndex);bW(gm,gh,gj)}function f(gl,gk,gi,gj){var gh=gl.sel.ranges.slice(0);gh[gk]=gi;bW(gl,cy(gh,gl.sel.primIndex),gj)}function H(gk,gi,gj,gh){bW(gk,eU(gi,gj),gh)}function d(gj,gh){var gi={ranges:gh.ranges,update:function(gk){this.ranges=[];for(var gl=0;gl<gk.length;gl++){this.ranges[gl]=new d0(fL(gj,gk[gl].anchor),fL(gj,gk[gl].head))}}};aG(gj,"beforeSelectionChange",gj,gi);if(gj.cm){aG(gj.cm,"beforeSelectionChange",gj.cm,gi)}if(gi.ranges!=gh.ranges){return cy(gi.ranges,gi.ranges.length-1)}else{return gh}}function e9(gl,gk,gi){var gh=gl.history.done,gj=fI(gh);if(gj&&gj.ranges){gh[gh.length-1]=gk;er(gl,gk,gi)}else{bW(gl,gk,gi)}}function bW(gj,gi,gh){er(gj,gi,gh);gb(gj,gj.sel,gj.cm?gj.cm.curOp.id:NaN,gh)}function er(gk,gj,gi){if(fk(gk,"beforeSelectionChange")||gk.cm&&fk(gk.cm,"beforeSelectionChange")){gj=d(gk,gj)}var gh=gi&&gi.bias||(ch(gj.primary().head,gk.sel.primary().head)<0?-1:1);db(gk,p(gk,gj,gh,true));if(!(gi&&gi.scroll===false)&&gk.cm){fH(gk.cm)}}function db(gi,gh){if(gh.equals(gi.sel)){return}gi.sel=gh;if(gi.cm){gi.cm.curOp.updateInput=gi.cm.curOp.selectionChanged=true;X(gi.cm)}ag(gi,"cursorActivity",gi)}function eA(gh){db(gh,p(gh,gh.sel,null,false),ab)}function p(gp,gh,gm,gn){var gj;for(var gk=0;gk<gh.ranges.length;gk++){var gl=gh.ranges[gk];var go=bX(gp,gl.anchor,gm,gn);var gi=bX(gp,gl.head,gm,gn);if(gj||go!=gl.anchor||gi!=gl.head){if(!gj){gj=gh.ranges.slice(0,gk)}gj[gk]=new d0(go,gi)}}return gj?cy(gj,gh.primIndex):gh}function bX(gq,gp,gm,gn){var gr=false,gj=gp;var gk=gm||1;gq.cantEdit=false;search:for(;;){var gs=fh(gq,gj.line);if(gs.markedSpans){for(var gl=0;gl<gs.markedSpans.length;++gl){var gh=gs.markedSpans[gl],gi=gh.marker;if((gh.from==null||(gi.inclusiveLeft?gh.from<=gj.ch:gh.from<gj.ch))&&(gh.to==null||(gi.inclusiveRight?gh.to>=gj.ch:gh.to>gj.ch))){if(gn){aG(gi,"beforeCursorEnter");if(gi.explicitlyCleared){if(!gs.markedSpans){break}else{--gl;continue}}}if(!gi.atomic){continue}var go=gi.find(gk<0?-1:1);if(ch(go,gj)==0){go.ch+=gk;if(go.ch<0){if(go.line>gq.first){go=fL(gq,Y(go.line-1))}else{go=null}}else{if(go.ch>gs.text.length){if(go.line<gq.first+gq.size-1){go=Y(go.line+1,0)}else{go=null}}}if(!go){if(gr){if(!gn){return bX(gq,gp,gm,true)}gq.cantEdit=true;return Y(gq.first,0)}gr=true;go=gp;gk=-gk}}gj=go;continue search}}}return gj}}function bE(gh){gh.display.input.showSelection(gh.display.input.prepareSelection())}function fK(go,gh){var gn=go.doc,gp={};var gm=gp.cursors=document.createDocumentFragment();var gi=gp.selection=document.createDocumentFragment();for(var gk=0;gk<gn.sel.ranges.length;gk++){if(gh===false&&gk==gn.sel.primIndex){continue}var gl=gn.sel.ranges[gk];var gj=gl.empty();if(gj||go.options.showCursorWhenSelecting){C(go,gl,gm)}if(!gj){bF(go,gl,gi)}}return gp}function C(gh,gk,gj){var gm=dW(gh,gk.head,"div",null,null,!gh.options.singleCursorHeightPerLine);var gl=gj.appendChild(f2("div","\u00a0","CodeMirror-cursor"));gl.style.left=gm.left+"px";gl.style.top=gm.top+"px";gl.style.height=Math.max(0,gm.bottom-gm.top)*gh.options.cursorHeight+"px";if(gm.other){var gi=gj.appendChild(f2("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));gi.style.display="";gi.style.left=gm.other.left+"px";gi.style.top=gm.other.top+"px";gi.style.height=(gm.other.bottom-gm.other.top)*0.85+"px"}}function bF(gl,gr,gm){var gu=gl.display,gy=gl.doc;var gh=document.createDocumentFragment();var gq=e7(gl.display),gk=gq.left;var gv=Math.max(gu.sizerWidth,dn(gl)-gu.sizer.offsetLeft)-gq.right;function gs(gC,gB,gA,gz){if(gB<0){gB=0}gB=Math.round(gB);gz=Math.round(gz);gh.appendChild(f2("div",null,"CodeMirror-selected","position: absolute; left: "+gC+"px; top: "+gB+"px; width: "+(gA==null?gv-gC:gA)+"px; height: "+(gz-gB)+"px"))}function gi(gA,gC,gF){var gB=fh(gy,gA);var gD=gB.text.length;var gG,gz;function gE(gI,gH){return cL(gl,Y(gA,gI),"div",gB,gH)}d6(b(gB),gC||0,gF==null?gD:gF,function(gO,gN,gH){var gK=gE(gO,"left"),gL,gM,gJ;if(gO==gN){gL=gK;gM=gJ=gK.left}else{gL=gE(gN-1,"right");if(gH=="rtl"){var gI=gK;gK=gL;gL=gI}gM=gK.left;gJ=gL.right}if(gC==null&&gO==0){gM=gk}if(gL.top-gK.top>3){gs(gM,gK.top,null,gK.bottom);gM=gk;if(gK.bottom<gL.top){gs(gM,gK.bottom,null,gL.top)}}if(gF==null&&gN==gD){gJ=gv}if(!gG||gK.top<gG.top||gK.top==gG.top&&gK.left<gG.left){gG=gK}if(!gz||gL.bottom>gz.bottom||gL.bottom==gz.bottom&&gL.right>gz.right){gz=gL}if(gM<gk+1){gM=gk}gs(gM,gL.top,gJ-gM,gL.bottom)});return{start:gG,end:gz}}var gx=gr.from(),gw=gr.to();if(gx.line==gw.line){gi(gx.line,gx.ch,gw.ch)}else{var gj=fh(gy,gx.line),go=fh(gy,gw.line);var gn=A(gj)==A(go);var gp=gi(gx.line,gx.ch,gn?gj.text.length+1:null).end;var gt=gi(gw.line,gn?0:null,gw.ch).start;if(gn){if(gp.top<gt.top-2){gs(gp.right,gp.top,null,gp.bottom);gs(gk,gt.top,gt.left,gt.bottom)}else{gs(gp.right,gp.top,gt.left-gp.right,gp.bottom)}}if(gp.bottom<gt.top){gs(gk,gp.bottom,null,gt.top)}}gm.appendChild(gh)}function q(gh){if(!gh.state.focused){return}var gj=gh.display;clearInterval(gj.blinker);var gi=true;gj.cursorDiv.style.visibility="";if(gh.options.cursorBlinkRate>0){gj.blinker=setInterval(function(){gj.cursorDiv.style.visibility=(gi=!gi)?"":"hidden"},gh.options.cursorBlinkRate)}else{if(gh.options.cursorBlinkRate<0){gj.cursorDiv.style.visibility="hidden"}}}function eh(gh,gi){if(gh.doc.mode.startState&&gh.doc.frontier<gh.display.viewTo){gh.state.highlight.set(gi,cx(cR,gh))}}function cR(gh){var gl=gh.doc;if(gl.frontier<gl.first){gl.frontier=gl.first}if(gl.frontier>=gh.display.viewTo){return}var gj=+new Date+gh.options.workTime;var gk=b5(gl.mode,dE(gh,gl.frontier));var gi=[];gl.iter(gl.frontier,Math.min(gl.first+gl.size,gh.display.viewTo+500),function(gm){if(gl.frontier>=gh.display.viewFrom){var gp=gm.styles;var gr=fB(gh,gm,gk,true);gm.styles=gr.styles;var go=gm.styleClasses,gq=gr.classes;if(gq){gm.styleClasses=gq}else{if(go){gm.styleClasses=null}}var gs=!gp||gp.length!=gm.styles.length||go!=gq&&(!go||!gq||go.bgClass!=gq.bgClass||go.textClass!=gq.textClass);for(var gn=0;!gs&&gn<gp.length;++gn){gs=gp[gn]!=gm.styles[gn]}if(gs){gi.push(gl.frontier)}gm.stateAfter=b5(gl.mode,gk)}else{dz(gh,gm.text,gk);gm.stateAfter=gl.frontier%5==0?b5(gl.mode,gk):null}++gl.frontier;if(+new Date>gj){eh(gh,gh.options.workDelay);return true}});if(gi.length){cO(gh,function(){for(var gm=0;gm<gi.length;gm++){T(gh,gi[gm],"text")}})}}function cA(gn,gh,gk){var gi,gl,gm=gn.doc;var gj=gk?-1:gh-(gn.doc.mode.innerMode?1000:100);for(var gq=gh;gq>gj;--gq){if(gq<=gm.first){return gm.first}var gp=fh(gm,gq-1);if(gp.stateAfter&&(!gk||gq<=gm.frontier)){return gq}var go=bV(gp.text,null,gn.options.tabSize);if(gl==null||gi>go){gl=gq-1;gi=go}}return gl}function dE(gh,gn,gi){var gl=gh.doc,gk=gh.display;if(!gl.mode.startState){return true}var gm=cA(gh,gn,gi),gj=gm>gl.first&&fh(gl,gm-1).stateAfter;if(!gj){gj=b2(gl.mode)}else{gj=b5(gl.mode,gj)}gl.iter(gm,gn,function(go){dz(gh,go.text,gj);var gp=gm==gn-1||gm%5==0||gm>=gk.viewFrom&&gm<gk.viewTo;go.stateAfter=gp?b5(gl.mode,gj):null;++gm});if(gi){gl.frontier=gm}return gj}function fa(gh){return gh.lineSpace.offsetTop}function bK(gh){return gh.mover.offsetHeight-gh.lineSpace.offsetHeight}function e7(gk){if(gk.cachedPaddingH){return gk.cachedPaddingH}var gj=bT(gk.measure,f2("pre","x"));var gh=window.getComputedStyle?window.getComputedStyle(gj):gj.currentStyle;var gi={left:parseInt(gh.paddingLeft),right:parseInt(gh.paddingRight)};if(!isNaN(gi.left)&&!isNaN(gi.right)){gk.cachedPaddingH=gi}return gi}function cV(gh){return dL-gh.display.nativeBarWidth}function dn(gh){return gh.display.scroller.clientWidth-cV(gh)-gh.display.barWidth}function cX(gh){return gh.display.scroller.clientHeight-cV(gh)-gh.display.barHeight}function cj(go,gk,gn){var gj=go.options.lineWrapping;var gl=gj&&dn(go);if(!gk.measure.heights||gj&&gk.measure.width!=gl){var gm=gk.measure.heights=[];if(gj){gk.measure.width=gl;var gq=gk.text.firstChild.getClientRects();for(var gh=0;gh<gq.length-1;gh++){var gp=gq[gh],gi=gq[gh+1];if(Math.abs(gp.bottom-gi.bottom)>2){gm.push((gp.bottom+gi.top)/2-gn.top)}}}gm.push(gn.bottom-gn.top)}}function cv(gj,gh,gk){if(gj.line==gh){return{map:gj.measure.map,cache:gj.measure.cache}}for(var gi=0;gi<gj.rest.length;gi++){if(gj.rest[gi]==gh){return{map:gj.measure.maps[gi],cache:gj.measure.caches[gi]}}}for(var gi=0;gi<gj.rest.length;gi++){if(bP(gj.rest[gi])>gk){return{map:gj.measure.maps[gi],cache:gj.measure.caches[gi],before:true}}}}function c3(gh,gj){gj=A(gj);var gl=bP(gj);var gi=gh.display.externalMeasured=new bx(gh.doc,gj,gl);gi.lineN=gl;var gk=gi.built=eT(gh,gi);gi.text=gk.pre;bT(gh.display.lineMeasure,gk.pre);return gi}function ej(gh,gi,gk,gj){return E(gh,a7(gh,gi),gk,gj)}function fd(gh,gj){if(gj>=gh.display.viewFrom&&gj<gh.display.viewTo){return gh.display.view[dt(gh,gj)]}var gi=gh.display.externalMeasured;if(gi&&gj>=gi.lineN&&gj<gi.lineN+gi.size){return gi}}function a7(gh,gj){var gk=bP(gj);var gi=fd(gh,gk);if(gi&&!gi.text){gi=null}else{if(gi&&gi.changes){ad(gh,gi,gk,ff(gh))}}if(!gi){gi=c3(gh,gj)}var gl=cv(gi,gj,gk);return{line:gj,view:gi,rect:null,map:gl.map,cache:gl.cache,before:gl.before,hasHeights:false}}function E(gh,gn,gl,gi,gk){if(gn.before){gl=-1}var gj=gl+(gi||""),gm;if(gn.cache.hasOwnProperty(gj)){gm=gn.cache[gj]}else{if(!gn.rect){gn.rect=gn.view.text.getBoundingClientRect()}if(!gn.hasHeights){cj(gh,gn.view,gn.rect);gn.hasHeights=true}gm=l(gh,gn,gl,gi);if(!gm.bogus){gn.cache[gj]=gm}}return{left:gm.left,right:gm.right,top:gk?gm.rtop:gm.top,bottom:gk?gm.rbottom:gm.bottom}}var eD={left:0,right:0,top:0,bottom:0};function aN(gi,gh,go){var gk,gj,gm,gp;for(var gn=0;gn<gi.length;gn+=3){var gl=gi[gn],gq=gi[gn+1];if(gh<gl){gj=0;gm=1;gp="left"}else{if(gh<gq){gj=gh-gl;gm=gj+1}else{if(gn==gi.length-3||gh==gq&&gi[gn+3]>gh){gm=gq-gl;gj=gm-1;if(gh>=gq){gp="right"}}}}if(gj!=null){gk=gi[gn+2];if(gl==gq&&go==(gk.insertLeft?"left":"right")){gp=go}if(go=="left"&&gj==0){while(gn&&gi[gn-2]==gi[gn-3]&&gi[gn-1].insertLeft){gk=gi[(gn-=3)+2];gp="left"}}if(go=="right"&&gj==gq-gl){while(gn<gi.length-3&&gi[gn+3]==gi[gn+4]&&!gi[gn+5].insertLeft){gk=gi[(gn+=3)+2];gp="right"}}break}}return{node:gk,start:gj,end:gm,collapse:gp,coverStart:gl,coverEnd:gq}}function l(go,gy,gr,gm){var gp=aN(gy.map,gr,gm);var gw=gp.node,gl=gp.start,gk=gp.end,gh=gp.collapse;var gi;if(gw.nodeType==3){for(var gx=0;gx<4;gx++){while(gl&&fr(gy.line.text.charAt(gp.coverStart+gl))){--gl}while(gp.coverStart+gk<gp.coverEnd&&fr(gy.line.text.charAt(gp.coverStart+gk))){++gk}if(dM&&m<9&&gl==0&&gk==gp.coverEnd-gp.coverStart){gi=gw.parentNode.getBoundingClientRect()}else{if(dM&&go.options.lineWrapping){var gj=cn(gw,gl,gk).getClientRects();if(gj.length){gi=gj[gm=="right"?gj.length-1:0]}else{gi=eD}}else{gi=cn(gw,gl,gk).getBoundingClientRect()||eD}}if(gi.left||gi.right||gl==0){break}gk=gl;gl=gl-1;gh="right"}if(dM&&m<11){gi=eP(go.display.measure,gi)}}else{if(gl>0){gh=gm="right"}var gj;if(go.options.lineWrapping&&(gj=gw.getClientRects()).length>1){gi=gj[gm=="right"?gj.length-1:0]}else{gi=gw.getBoundingClientRect()}}if(dM&&m<9&&!gl&&(!gi||!gi.left&&!gi.right)){var gn=gw.parentNode.getClientRects()[0];if(gn){gi={left:gn.left,right:gn.left+dF(go.display),top:gn.top,bottom:gn.bottom}}else{gi=eD}}var gu=gi.top-gy.rect.top,gs=gi.bottom-gy.rect.top;var gA=(gu+gs)/2;var gz=gy.view.measure.heights;for(var gx=0;gx<gz.length-1;gx++){if(gA<gz[gx]){break}}var gv=gx?gz[gx-1]:0,gt=gz[gx];var gq={left:(gh=="right"?gi.right:gi.left)-gy.rect.left,right:(gh=="left"?gi.left:gi.right)-gy.rect.left,top:gv,bottom:gt};if(!gi.left&&!gi.right){gq.bogus=true}if(!go.options.singleCursorHeightPerLine){gq.rtop=gu;gq.rbottom=gs}return gq}function eP(gj,gk){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aM(gj)){return gk}var gi=screen.logicalXDPI/screen.deviceXDPI;var gh=screen.logicalYDPI/screen.deviceYDPI;return{left:gk.left*gi,right:gk.right*gi,top:gk.top*gh,bottom:gk.bottom*gh}}function aw(gi){if(gi.measure){gi.measure.cache={};gi.measure.heights=null;if(gi.rest){for(var gh=0;gh<gi.rest.length;gh++){gi.measure.caches[gh]={}}}}}function aQ(gh){gh.display.externalMeasure=null;d3(gh.display.lineMeasure);for(var gi=0;gi<gh.display.view.length;gi++){aw(gh.display.view[gi])}}function am(gh){aQ(gh);gh.display.cachedCharWidth=gh.display.cachedTextHeight=gh.display.cachedPaddingH=null;if(!gh.options.lineWrapping){gh.display.maxLineChanged=true}gh.display.lineNumChars=null}function cw(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cu(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function eS(gn,gk,gm,gi){if(gk.widgets){for(var gj=0;gj<gk.widgets.length;++gj){if(gk.widgets[gj].above){var gp=c0(gk.widgets[gj]);gm.top+=gp;gm.bottom+=gp}}}if(gi=="line"){return gm}if(!gi){gi="local"}var gl=bO(gk);if(gi=="local"){gl+=fa(gn.display)}else{gl-=gn.display.viewOffset}if(gi=="page"||gi=="window"){var gh=gn.display.lineSpace.getBoundingClientRect();gl+=gh.top+(gi=="window"?0:cu());var go=gh.left+(gi=="window"?0:cw());gm.left+=go;gm.right+=go}gm.top+=gl;gm.bottom+=gl;return gm}function ge(gi,gl,gj){if(gj=="div"){return gl}var gn=gl.left,gm=gl.top;if(gj=="page"){gn-=cw();gm-=cu()}else{if(gj=="local"||!gj){var gk=gi.display.sizer.getBoundingClientRect();gn+=gk.left;gm+=gk.top}}var gh=gi.display.lineSpace.getBoundingClientRect();return{left:gn-gh.left,top:gm-gh.top}}function cL(gh,gl,gk,gj,gi){if(!gj){gj=fh(gh.doc,gl.line)}return eS(gh,gj,ej(gh,gj,gl.ch,gi),gk)}function dW(gq,gp,gj,gn,gs,go){gn=gn||fh(gq.doc,gp.line);if(!gs){gs=a7(gq,gn)}function gl(gv,gu){var gt=E(gq,gs,gv,gu?"right":"left",go);if(gu){gt.left=gt.right}else{gt.right=gt.left}return eS(gq,gn,gt,gj)}function gr(gw,gt){var gu=gm[gt],gv=gu.level%2;if(gw==dA(gu)&&gt&&gu.level<gm[gt-1].level){gu=gm[--gt];gw=gd(gu)-(gu.level%2?0:1);gv=true}else{if(gw==gd(gu)&&gt<gm.length-1&&gu.level<gm[gt+1].level){gu=gm[++gt];gw=dA(gu)-gu.level%2;gv=false}}if(gv&&gw==gu.to&&gw>gu.from){return gl(gw-1)}return gl(gw,gv)}var gm=b(gn),gh=gp.ch;if(!gm){return gl(gh)}var gi=aI(gm,gh);var gk=gr(gh,gi);if(e4!=null){gk.other=gr(gh,e4)}return gk}function dJ(gh,gl){var gk=0,gl=fL(gh.doc,gl);if(!gh.options.lineWrapping){gk=dF(gh.display)*gl.ch}var gi=fh(gh.doc,gl.line);var gj=bO(gi)+fa(gh.display);return{left:gk,right:gk,top:gj,bottom:gj+gi.height}}function f1(gh,gi,gj,gl){var gk=Y(gh,gi);gk.xRel=gl;if(gj){gk.outside=true}return gk}function fQ(go,gl,gk){var gn=go.doc;gk+=go.display.viewOffset;if(gk<0){return f1(gn.first,0,true,-1)}var gj=bI(gn,gk),gp=gn.first+gn.size-1;if(gj>gp){return f1(gn.first+gn.size-1,fh(gn,gp).text.length,true,1)}if(gl<0){gl=0}var gi=fh(gn,gj);for(;;){var gq=c1(go,gi,gj,gl,gk);var gm=ey(gi);var gh=gm&&gm.find(0,true);if(gm&&(gq.ch>gh.from.ch||gq.ch==gh.from.ch&&gq.xRel>0)){gj=bP(gi=gh.to.line)}else{return gq}}}function c1(gr,gj,gu,gt,gs){var gq=gs-bO(gj);var gn=false,gA=2*gr.display.wrapper.clientWidth;var gx=a7(gr,gj);function gE(gG){var gH=dW(gr,Y(gu,gG),"line",gj,gx);gn=true;if(gq>gH.bottom){return gH.left-gA}else{if(gq<gH.top){return gH.left+gA}else{gn=false}}return gH.left}var gw=b(gj),gz=gj.text.length;var gB=cG(gj),gk=cU(gj);var gy=gE(gB),gh=gn,gi=gE(gk),gm=gn;if(gt>gi){return f1(gu,gk,gm,1)}for(;;){if(gw?gk==gB||gk==w(gj,gB,1):gk-gB<=1){var gv=gt<gy||gt-gy<=gi-gt?gB:gk;var gD=gt-(gv==gB?gy:gi);while(fr(gj.text.charAt(gv))){++gv}var gp=f1(gu,gv,gv==gB?gh:gm,gD<-1?-1:gD>1?1:0);return gp}var go=Math.ceil(gz/2),gF=gB+go;if(gw){gF=gB;for(var gC=0;gC<go;++gC){gF=w(gj,gF,1)}}var gl=gE(gF);if(gl>gt){gk=gF;gi=gl;if(gm=gn){gi+=1000}gz=go}else{gB=gF;gy=gl;gh=gn;gz-=go}}}var aJ;function a0(gj){if(gj.cachedTextHeight!=null){return gj.cachedTextHeight}if(aJ==null){aJ=f2("pre");for(var gi=0;gi<49;++gi){aJ.appendChild(document.createTextNode("x"));aJ.appendChild(f2("br"))}aJ.appendChild(document.createTextNode("x"))}bT(gj.measure,aJ);var gh=aJ.offsetHeight/50;if(gh>3){gj.cachedTextHeight=gh}d3(gj.measure);return gh||1}function dF(gl){if(gl.cachedCharWidth!=null){return gl.cachedCharWidth}var gh=f2("span","xxxxxxxxxx");var gk=f2("pre",[gh]);bT(gl.measure,gk);var gj=gh.getBoundingClientRect(),gi=(gj.right-gj.left)/10;if(gi>2){gl.cachedCharWidth=gi}return gi||10}var br=null;var ea=0;function cK(gh){gh.curOp={cm:gh,viewChanged:false,startHeight:gh.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++ea};if(br){br.ops.push(gh.curOp)}else{gh.curOp.ownsGroup=br={ops:[gh.curOp],delayedCallbacks:[]}}}function cW(gk){var gj=gk.delayedCallbacks,gi=0;do{for(;gi<gj.length;gi++){gj[gi]()}for(var gh=0;gh<gk.ops.length;gh++){var gl=gk.ops[gh];if(gl.cursorActivityHandlers){while(gl.cursorActivityCalled<gl.cursorActivityHandlers.length){gl.cursorActivityHandlers[gl.cursorActivityCalled++](gl.cm)}}}}while(gi<gj.length)}function ao(gh){var gk=gh.curOp,gj=gk.ownsGroup;if(!gj){return}try{cW(gj)}finally{br=null;for(var gi=0;gi<gj.ops.length;gi++){gj.ops[gi].cm.curOp=null}cM(gj)}}function cM(gj){var gi=gj.ops;for(var gh=0;gh<gi.length;gh++){b7(gi[gh])}for(var gh=0;gh<gi.length;gh++){at(gi[gh])}for(var gh=0;gh<gi.length;gh++){b4(gi[gh])}for(var gh=0;gh<gi.length;gh++){ar(gi[gh])}for(var gh=0;gh<gi.length;gh++){e2(gi[gh])}}function b7(gj){var gh=gj.cm,gi=gh.display;L(gh);if(gj.updateMaxLine){h(gh)}gj.mustUpdate=gj.viewChanged||gj.forceUpdate||gj.scrollTop!=null||gj.scrollToPos&&(gj.scrollToPos.from.line<gi.viewFrom||gj.scrollToPos.to.line>=gi.viewTo)||gi.maxLineChanged&&gh.options.lineWrapping;gj.update=gj.mustUpdate&&new aK(gh,gj.mustUpdate&&{top:gj.scrollTop,ensure:gj.scrollToPos},gj.forceUpdate)}function at(gh){gh.updatedDisplay=gh.mustUpdate&&D(gh.cm,gh.update)}function b4(gj){var gh=gj.cm,gi=gh.display;if(gj.updatedDisplay){bc(gh)}gj.barMeasure=dC(gh);if(gi.maxLineChanged&&!gh.options.lineWrapping){gj.adjustWidthTo=ej(gh,gi.maxLine,gi.maxLine.text.length).left+3;gh.display.sizerWidth=gj.adjustWidthTo;gj.barMeasure.scrollWidth=Math.max(gi.scroller.clientWidth,gi.sizer.offsetLeft+gj.adjustWidthTo+cV(gh)+gh.display.barWidth);gj.maxScrollLeft=Math.max(0,gi.sizer.offsetLeft+gj.adjustWidthTo-dn(gh))}if(gj.updatedDisplay||gj.selectionChanged){gj.preparedSelection=gi.input.prepareSelection()}}function ar(gi){var gh=gi.cm;if(gi.adjustWidthTo!=null){gh.display.sizer.style.minWidth=gi.adjustWidthTo+"px";if(gi.maxScrollLeft<gh.doc.scrollLeft){bG(gh,Math.min(gh.display.scroller.scrollLeft,gi.maxScrollLeft),true)}gh.display.maxLineChanged=false}if(gi.preparedSelection){gh.display.input.showSelection(gi.preparedSelection)}if(gi.updatedDisplay){dB(gh,gi.barMeasure)}if(gi.updatedDisplay||gi.startHeight!=gh.doc.height){e0(gh,gi.barMeasure)}if(gi.selectionChanged){q(gh)}if(gh.state.focused&&gi.updateInput){gh.display.input.reset(gi.typing)}}function e2(go){var gh=go.cm,gm=gh.display,gl=gh.doc;if(go.updatedDisplay){cl(gh,go.update)}if(gm.wheelStartX!=null&&(go.scrollTop!=null||go.scrollLeft!=null||go.scrollToPos)){gm.wheelStartX=gm.wheelStartY=null}if(go.scrollTop!=null&&(gm.scroller.scrollTop!=go.scrollTop||go.forceScroll)){gl.scrollTop=Math.max(0,Math.min(gm.scroller.scrollHeight-gm.scroller.clientHeight,go.scrollTop));gm.scrollbars.setScrollTop(gl.scrollTop);gm.scroller.scrollTop=gl.scrollTop}if(go.scrollLeft!=null&&(gm.scroller.scrollLeft!=go.scrollLeft||go.forceScroll)){gl.scrollLeft=Math.max(0,Math.min(gm.scroller.scrollWidth-dn(gh),go.scrollLeft));gm.scrollbars.setScrollLeft(gl.scrollLeft);gm.scroller.scrollLeft=gl.scrollLeft;eG(gh)}if(go.scrollToPos){var gk=F(gh,fL(gl,go.scrollToPos.from),fL(gl,go.scrollToPos.to),go.scrollToPos.margin);if(go.scrollToPos.isCursor&&gh.state.focused){d8(gh,gk)}}var gj=go.maybeHiddenMarkers,gn=go.maybeUnhiddenMarkers;if(gj){for(var gi=0;gi<gj.length;++gi){if(!gj[gi].lines.length){aG(gj[gi],"hide")}}}if(gn){for(var gi=0;gi<gn.length;++gi){if(gn[gi].lines.length){aG(gn[gi],"unhide")}}}if(gm.wrapper.offsetHeight){gl.scrollTop=gh.display.scroller.scrollTop}if(go.changeObjs){aG(gh,"changes",gh,go.changeObjs)}if(go.update){go.update.finish()}}function cO(gh,gi){if(gh.curOp){return gi()}cK(gh);try{return gi()}finally{ao(gh)}}function c4(gh,gi){return function(){if(gh.curOp){return gi.apply(gh,arguments)}cK(gh);try{return gi.apply(gh,arguments)}finally{ao(gh)}}}function da(gh){return function(){if(this.curOp){return gh.apply(this,arguments)}cK(this);try{return gh.apply(this,arguments)}finally{ao(this)}}}function cF(gh){return function(){var gi=this.cm;if(!gi||gi.curOp){return gh.apply(this,arguments)}cK(gi);try{return gh.apply(this,arguments)}finally{ao(gi)}}}function bx(gj,gh,gi){this.line=gh;this.rest=i(gh);this.size=this.rest?bP(fI(this.rest))-gi+1:1;this.node=this.text=null;this.hidden=fy(gj,gh)}function eX(gh,gn,gm){var gl=[],gj;for(var gk=gn;gk<gm;gk=gj){var gi=new bx(gh.doc,fh(gh.doc,gk),gk);gj=gk+gi.size;gl.push(gi)}return gl}function aj(go,gm,gn,gp){if(gm==null){gm=go.doc.first}if(gn==null){gn=go.doc.first+go.doc.size}if(!gp){gp=0}var gj=go.display;if(gp&&gn<gj.viewTo&&(gj.updateLineNumbers==null||gj.updateLineNumbers>gm)){gj.updateLineNumbers=gm}go.curOp.viewChanged=true;if(gm>=gj.viewTo){if(ba&&aY(go.doc,gm)<gj.viewTo){ez(go)}}else{if(gn<=gj.viewFrom){if(ba&&d5(go.doc,gn+gp)>gj.viewFrom){ez(go)}else{gj.viewFrom+=gp;gj.viewTo+=gp}}else{if(gm<=gj.viewFrom&&gn>=gj.viewTo){ez(go)}else{if(gm<=gj.viewFrom){var gl=dg(go,gn,gn+gp,1);if(gl){gj.view=gj.view.slice(gl.index);gj.viewFrom=gl.lineN;gj.viewTo+=gp}else{ez(go)}}else{if(gn>=gj.viewTo){var gl=dg(go,gm,gm,-1);if(gl){gj.view=gj.view.slice(0,gl.index);gj.viewTo=gl.lineN}else{ez(go)}}else{var gk=dg(go,gm,gm,-1);var gi=dg(go,gn,gn+gp,1);if(gk&&gi){gj.view=gj.view.slice(0,gk.index).concat(eX(go,gk.lineN,gi.lineN)).concat(gj.view.slice(gi.index));gj.viewTo+=gp}else{ez(go)}}}}}}var gh=gj.externalMeasured;if(gh){if(gn<gh.lineN){gh.lineN+=gp}else{if(gm<gh.lineN+gh.size){gj.externalMeasured=null}}}}function T(gi,gj,gm){gi.curOp.viewChanged=true;var gn=gi.display,gl=gi.display.externalMeasured;if(gl&&gj>=gl.lineN&&gj<gl.lineN+gl.size){gn.externalMeasured=null}if(gj<gn.viewFrom||gj>=gn.viewTo){return}var gk=gn.view[dt(gi,gj)];if(gk.node==null){return}var gh=gk.changes||(gk.changes=[]);if(dj(gh,gm)==-1){gh.push(gm)}}function ez(gh){gh.display.viewFrom=gh.display.viewTo=gh.doc.first;gh.display.view=[];gh.display.viewOffset=0}function dt(gh,gk){if(gk>=gh.display.viewTo){return null}gk-=gh.display.viewFrom;if(gk<0){return null}var gi=gh.display.view;for(var gj=0;gj<gi.length;gj++){gk-=gi[gj].size;if(gk<0){return gj}}}function dg(gp,gj,gl,gi){var gm=dt(gp,gj),go,gn=gp.display.view;if(!ba||gl==gp.doc.first+gp.doc.size){return{index:gm,lineN:gl}}for(var gk=0,gh=gp.display.viewFrom;gk<gm;gk++){gh+=gn[gk].size}if(gh!=gj){if(gi>0){if(gm==gn.length-1){return null}go=(gh+gn[gm].size)-gj;gm++}else{go=gh-gj}gj+=go;gl+=go}while(aY(gp.doc,gl)!=gl){if(gm==(gi<0?0:gn.length-1)){return null}gl+=gi*gn[gm-(gi<0?1:0)].size;gm+=gi}return{index:gm,lineN:gl}}function cT(gh,gl,gk){var gj=gh.display,gi=gj.view;if(gi.length==0||gl>=gj.viewTo||gk<=gj.viewFrom){gj.view=eX(gh,gl,gk);gj.viewFrom=gl}else{if(gj.viewFrom>gl){gj.view=eX(gh,gl,gj.viewFrom).concat(gj.view)}else{if(gj.viewFrom<gl){gj.view=gj.view.slice(dt(gh,gl))}}gj.viewFrom=gl;if(gj.viewTo<gk){gj.view=gj.view.concat(eX(gh,gj.viewTo,gk))}else{if(gj.viewTo>gk){gj.view=gj.view.slice(0,dt(gh,gk))}}}gj.viewTo=gk}function dd(gh){var gi=gh.display.view,gl=0;for(var gk=0;gk<gi.length;gk++){var gj=gi[gk];if(!gj.hidden&&(!gj.node||gj.changes)){++gl}}return gl}function fS(go){var gl=go.display;bZ(gl.scroller,"mousedown",c4(go,ew));if(dM&&m<11){bZ(gl.scroller,"dblclick",c4(go,function(gr){if(aT(go,gr)){return}var gs=cp(go,gr);if(!gs||n(go,gr)||bd(go.display,gr)){return}cI(gr);var gq=go.findWordAt(gs);fX(go.doc,gq.anchor,gq.head)}))}else{bZ(gl.scroller,"dblclick",function(gq){aT(go,gq)||cI(gq)})}if(!f9){bZ(gl.scroller,"contextmenu",function(gq){aA(go,gq)})}var gp,gi={end:0};function gk(){if(gl.activeTouch){gp=setTimeout(function(){gl.activeTouch=null},1000);gi=gl.activeTouch;gi.end=+new Date}}function gj(gq){if(gq.touches.length!=1){return false}var gr=gq.touches[0];return gr.radiusX<=1&&gr.radiusY<=1}function gh(gt,gq){if(gq.left==null){return true}var gs=gq.left-gt.left,gr=gq.top-gt.top;return gs*gs+gr*gr>20*20}bZ(gl.scroller,"touchstart",function(gr){if(!gj(gr)){clearTimeout(gp);var gq=+new Date;gl.activeTouch={start:gq,moved:false,prev:gq-gi.end<=300?gi:null};if(gr.touches.length==1){gl.activeTouch.left=gr.touches[0].pageX;gl.activeTouch.top=gr.touches[0].pageY}}});bZ(gl.scroller,"touchmove",function(){if(gl.activeTouch){gl.activeTouch.moved=true}});bZ(gl.scroller,"touchend",function(gr){var gt=gl.activeTouch;if(gt&&!bd(gl,gr)&&gt.left!=null&&!gt.moved&&new Date-gt.start<300){var gs=go.coordsChar(gl.activeTouch,"page"),gq;if(!gt.prev||gh(gt,gt.prev)){gq=new d0(gs,gs)}else{if(!gt.prev.prev||gh(gt,gt.prev.prev)){gq=go.findWordAt(gs)}else{gq=new d0(Y(gs.line,0),fL(go.doc,Y(gs.line+1,0)))}}go.setSelection(gq.anchor,gq.head);go.focus();cI(gr)}gk()});bZ(gl.scroller,"touchcancel",gk);bZ(gl.scroller,"scroll",function(){if(gl.scroller.clientHeight){P(go,gl.scroller.scrollTop);bG(go,gl.scroller.scrollLeft,true);aG(go,"scroll",go)}});bZ(gl.scroller,"mousewheel",function(gq){c(go,gq)});bZ(gl.scroller,"DOMMouseScroll",function(gq){c(go,gq)});bZ(gl.wrapper,"scroll",function(){gl.wrapper.scrollTop=gl.wrapper.scrollLeft=0});function gn(gq){if(!aT(go,gq)){et(gq)}}if(go.options.dragDrop){bZ(gl.scroller,"dragstart",function(gq){S(go,gq)});bZ(gl.scroller,"dragenter",gn);bZ(gl.scroller,"dragover",gn);bZ(gl.scroller,"drop",c4(go,bm))}var gm=gl.input.getField();bZ(gm,"keyup",function(gq){bk.call(go,gq)});bZ(gm,"keydown",c4(go,r));bZ(gm,"keypress",c4(go,cz));bZ(gm,"focus",cx(cD,go));bZ(gm,"blur",cx(aX,go))}function aV(gh){var gi=gh.display;if(gi.lastWrapHeight==gi.wrapper.clientHeight&&gi.lastWrapWidth==gi.wrapper.clientWidth){return}gi.cachedCharWidth=gi.cachedTextHeight=gi.cachedPaddingH=null;gi.scrollbarsClipped=false;gh.setSize()}function bd(gi,gh){for(var gj=N(gh);gj!=gi.wrapper;gj=gj.parentNode){if(!gj||(gj.nodeType==1&&gj.getAttribute("cm-ignore-events")=="true")||(gj.parentNode==gi.sizer&&gj!=gi.mover)){return true}}}function cp(gq,gl,gi,gj){var gm=gq.display;if(!gi&&N(gl).getAttribute("cm-not-content")=="true"){return null}var gp,gn,gh=gm.lineSpace.getBoundingClientRect();try{gp=gl.clientX-gh.left;gn=gl.clientY-gh.top}catch(gl){return null}var go=fQ(gq,gp,gn),gr;if(gj&&go.xRel==1&&(gr=fh(gq.doc,go.line).text).length==go.ch){var gk=bV(gr,gr.length,gq.options.tabSize)-gr.length;go=Y(go.line,Math.max(0,Math.round((gp-e7(gq.display).left)/dF(gq.display))-gk))}return go}function ew(gj){var gh=this,gi=gh.display;if(gi.activeTouch&&gi.input.supportsTouch()||aT(gh,gj)){return}gi.shift=gj.shiftKey;if(bd(gi,gj)){if(!c2){gi.scroller.draggable=false;setTimeout(function(){gi.scroller.draggable=true},100)}return}if(n(gh,gj)){return}var gk=cp(gh,gj);window.focus();switch(fP(gj)){case 1:if(gk){az(gh,gj,gk)}else{if(N(gj)==gi.scroller){cI(gj)}}break;case 2:if(c2){gh.state.lastMiddleDown=+new Date}if(gk){fX(gh.doc,gk)}setTimeout(function(){gi.input.focus()},20);cI(gj);break;case 3:if(f9){aA(gh,gj)}else{an(gh)}break}}var dq,df;function az(gi,gn,go){if(dM){setTimeout(cx(t,gi),0)}else{t(gi)}var gj=+new Date,gl;if(df&&df.time>gj-400&&ch(df.pos,go)==0){gl="triple"}else{if(dq&&dq.time>gj-400&&ch(dq.pos,go)==0){gl="double";df={time:gj,pos:go}}else{gl="single";dq={time:gj,pos:go}}}var gm=gi.doc.sel,gh=b9?gn.metaKey:gn.ctrlKey,gk;if(gi.options.dragDrop&&eN&&!al(gi)&&gl=="single"&&(gk=gm.contains(go))>-1&&!gm.ranges[gk].empty()){a6(gi,gn,go,gh)}else{o(gi,gn,go,gl,gh)}}function a6(gj,gl,gm,gi){var gk=gj.display;var gh=c4(gj,function(gn){if(c2){gk.scroller.draggable=false}gj.state.draggingText=false;ef(document,"mouseup",gh);ef(gk.scroller,"drop",gh);if(Math.abs(gl.clientX-gn.clientX)+Math.abs(gl.clientY-gn.clientY)<10){cI(gn);if(!gi){fX(gj.doc,gm)}if(c2||dM&&m==9){setTimeout(function(){document.body.focus();gk.input.focus()},20)}else{gk.input.focus()}}});if(c2){gk.scroller.draggable=true}gj.state.draggingText=gh;if(gk.scroller.dragDrop){gk.scroller.dragDrop()}bZ(document,"mouseup",gh);bZ(gk.scroller,"drop",gh)}function o(gl,gz,gk,gi,gn){var gw=gl.display,gB=gl.doc;cI(gz);var gj,gA,gm=gB.sel,gh=gm.ranges;if(gn&&!gz.shiftKey){gA=gB.sel.contains(gk);if(gA>-1){gj=gh[gA]}else{gj=new d0(gk,gk)}}else{gj=gB.sel.primary();gA=gB.sel.primIndex}if(gz.altKey){gi="rect";if(!gn){gj=new d0(gk,gk)}gk=cp(gl,gz,true,true);gA=-1}else{if(gi=="double"){var gx=gl.findWordAt(gk);if(gl.display.shift||gB.extend){gj=fx(gB,gj,gx.anchor,gx.head)}else{gj=gx}}else{if(gi=="triple"){var gq=new d0(Y(gk.line,0),fL(gB,Y(gk.line+1,0)));if(gl.display.shift||gB.extend){gj=fx(gB,gj,gq.anchor,gq.head)}else{gj=gq}}else{gj=fx(gB,gj,gk)}}}if(!gn){gA=0;bW(gB,new f3([gj],0),O);gm=gB.sel}else{if(gA==-1){gA=gh.length;bW(gB,cy(gh.concat([gj]),gA),{scroll:false,origin:"*mouse"})}else{if(gh.length>1&&gh[gA].empty()&&gi=="single"&&!gz.shiftKey){bW(gB,cy(gh.slice(0,gA).concat(gh.slice(gA+1)),0));gm=gB.sel}else{f(gB,gA,gj,O)}}}var gv=gk;function gu(gM){if(ch(gv,gM)==0){return}gv=gM;if(gi=="rect"){var gD=[],gJ=gl.options.tabSize;var gC=bV(fh(gB,gk.line).text,gk.ch,gJ);var gP=bV(fh(gB,gM.line).text,gM.ch,gJ);var gE=Math.min(gC,gP),gN=Math.max(gC,gP);for(var gQ=Math.min(gk.line,gM.line),gG=Math.min(gl.lastLine(),Math.max(gk.line,gM.line));gQ<=gG;gQ++){var gO=fh(gB,gQ).text,gF=es(gO,gE,gJ);if(gE==gN){gD.push(new d0(Y(gQ,gF),Y(gQ,gF)))}else{if(gO.length>gF){gD.push(new d0(Y(gQ,gF),Y(gQ,es(gO,gN,gJ))))}}}if(!gD.length){gD.push(new d0(gk,gk))}bW(gB,cy(gm.ranges.slice(0,gA).concat(gD),gA),{origin:"*mouse",scroll:false});gl.scrollIntoView(gM)}else{var gK=gj;var gH=gK.anchor,gL=gM;if(gi!="single"){if(gi=="double"){var gI=gl.findWordAt(gM)}else{var gI=new d0(Y(gM.line,0),fL(gB,Y(gM.line+1,0)))}if(ch(gI.anchor,gH)>0){gL=gI.head;gH=au(gK.from(),gI.anchor)}else{gL=gI.anchor;gH=bz(gK.to(),gI.head)}}var gD=gm.ranges.slice(0);gD[gA]=new d0(fL(gB,gH),gL);bW(gB,cy(gD,gA),O)}}var gs=gw.wrapper.getBoundingClientRect();var go=0;function gy(gE){var gC=++go;var gG=cp(gl,gE,true,gi=="rect");if(!gG){return}if(ch(gG,gv)!=0){t(gl);gu(gG);var gF=b8(gw,gB);if(gG.line>=gF.to||gG.line<gF.from){setTimeout(c4(gl,function(){if(go==gC){gy(gE)}}),150)}}else{var gD=gE.clientY<gs.top?-20:gE.clientY>gs.bottom?20:0;if(gD){setTimeout(c4(gl,function(){if(go!=gC){return}gw.scroller.scrollTop+=gD;gy(gE)}),50)}}}function gr(gC){go=Infinity;cI(gC);gw.input.focus();ef(document,"mousemove",gt);ef(document,"mouseup",gp);gB.history.lastSelOrigin=null}var gt=c4(gl,function(gC){if(!fP(gC)){gr(gC)}else{gy(gC)}});var gp=c4(gl,gr);bZ(document,"mousemove",gt);bZ(document,"mouseup",gp)}function gf(gs,go,gq,gr,gk){try{var gi=go.clientX,gh=go.clientY}catch(go){return false}if(gi>=Math.floor(gs.display.gutters.getBoundingClientRect().right)){return false}if(gr){cI(go)}var gp=gs.display;var gn=gp.lineDiv.getBoundingClientRect();if(gh>gn.bottom||!fk(gs,gq)){return bN(go)}gh-=gn.top-gp.viewOffset;for(var gl=0;gl<gs.options.gutters.length;++gl){var gm=gp.gutters.childNodes[gl];if(gm&&gm.getBoundingClientRect().right>=gi){var gt=bI(gs.doc,gh);var gj=gs.options.gutters[gl];gk(gs,gq,gs,gt,gj,go);return bN(go)}}}function n(gh,gi){return gf(gh,gi,"gutterClick",true,ag)}var ai=0;function bm(gn){var gp=this;if(aT(gp,gn)||bd(gp.display,gn)){return}cI(gn);if(dM){ai=+new Date}var go=cp(gp,gn,true),gh=gn.dataTransfer.files;if(!go||al(gp)){return}if(gh&&gh.length&&window.FileReader&&window.File){var gj=gh.length,gq=Array(gj),gi=0;var gl=function(gt,gs){var gr=new FileReader;gr.onload=c4(gp,function(){gq[gs]=gr.result;if(++gi==gj){go=fL(gp.doc,go);var gu={from:go,to:go,text:a3(gq.join("\n")),origin:"paste"};bi(gp.doc,gu);e9(gp.doc,eU(go,cZ(gu)))}});gr.readAsText(gt)};for(var gm=0;gm<gj;++gm){gl(gh[gm],gm)}}else{if(gp.state.draggingText&&gp.doc.sel.contains(go)>-1){gp.state.draggingText(gn);setTimeout(function(){gp.display.input.focus()},20);return}try{var gq=gn.dataTransfer.getData("Text");if(gq){if(gp.state.draggingText&&!(b9?gn.metaKey:gn.ctrlKey)){var gk=gp.listSelections()}er(gp.doc,eU(go,go));if(gk){for(var gm=0;gm<gk.length;++gm){a4(gp.doc,"",gk[gm].anchor,gk[gm].head,"drag")}}gp.replaceSelection(gq,"around","paste");gp.display.input.focus()}}catch(gn){}}}function S(gh,gj){if(dM&&(!gh.state.draggingText||+new Date-ai<100)){et(gj);return}if(aT(gh,gj)||bd(gh.display,gj)){return}gj.dataTransfer.setData("Text",gh.getSelection());if(gj.dataTransfer.setDragImage&&!aE){var gi=f2("img",null,null,"position: fixed; left: 0; top: 0;");gi.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(d4){gi.width=gi.height=1;gh.display.wrapper.appendChild(gi);gi._top=gi.offsetTop}gj.dataTransfer.setDragImage(gi,0,0);if(d4){gi.parentNode.removeChild(gi)}}}function P(gh,gi){if(Math.abs(gh.doc.scrollTop-gi)<2){return}gh.doc.scrollTop=gi;if(!cq){dV(gh,{top:gi})}if(gh.display.scroller.scrollTop!=gi){gh.display.scroller.scrollTop=gi}gh.display.scrollbars.setScrollTop(gi);if(cq){dV(gh)}eh(gh,100)}function bG(gh,gj,gi){if(gi?gj==gh.doc.scrollLeft:Math.abs(gh.doc.scrollLeft-gj)<2){return}gj=Math.min(gj,gh.display.scroller.scrollWidth-gh.display.scroller.clientWidth);gh.doc.scrollLeft=gj;eG(gh);if(gh.display.scroller.scrollLeft!=gj){gh.display.scroller.scrollLeft=gj}gh.display.scrollbars.setScrollLeft(gj)}var fo=0,ci=null;if(dM){ci=-0.53}else{if(cq){ci=15}else{if(de){ci=-0.7}else{if(aE){ci=-1/3}}}}var cS=function(gj){var gi=gj.wheelDeltaX,gh=gj.wheelDeltaY;if(gi==null&&gj.detail&&gj.axis==gj.HORIZONTAL_AXIS){gi=gj.detail}if(gh==null&&gj.detail&&gj.axis==gj.VERTICAL_AXIS){gh=gj.detail}else{if(gh==null){gh=gj.wheelDelta}}return{x:gi,y:gh}};J.wheelEventPixels=function(gh){var gi=cS(gh);gi.x*=ci;gi.y*=ci;return gi};function c(gp,gj){var gq=cS(gj),gt=gq.x,gs=gq.y;var gl=gp.display,go=gl.scroller;if(!(gt&&go.scrollWidth>go.clientWidth||gs&&go.scrollHeight>go.clientHeight)){return}if(gs&&b9&&c2){outer:for(var gr=gj.target,gn=gl.view;gr!=go;gr=gr.parentNode){for(var gi=0;gi<gn.length;gi++){if(gn[gi].node==gr){gp.display.currentWheelTarget=gr;break outer}}}}if(gt&&!cq&&!d4&&ci!=null){if(gs){P(gp,Math.max(0,Math.min(go.scrollTop+gs*ci,go.scrollHeight-go.clientHeight)))}bG(gp,Math.max(0,Math.min(go.scrollLeft+gt*ci,go.scrollWidth-go.clientWidth)));cI(gj);gl.wheelStartX=null;return}if(gs&&ci!=null){var gh=gs*ci;var gm=gp.doc.scrollTop,gk=gm+gl.wrapper.clientHeight;if(gh<0){gm=Math.max(0,gm+gh-50)}else{gk=Math.min(gp.doc.height,gk+gh+50)}dV(gp,{top:gm,bottom:gk})}if(fo<20){if(gl.wheelStartX==null){gl.wheelStartX=go.scrollLeft;gl.wheelStartY=go.scrollTop;gl.wheelDX=gt;gl.wheelDY=gs;setTimeout(function(){if(gl.wheelStartX==null){return}var gu=go.scrollLeft-gl.wheelStartX;var gw=go.scrollTop-gl.wheelStartY;var gv=(gw&&gl.wheelDY&&gw/gl.wheelDY)||(gu&&gl.wheelDX&&gu/gl.wheelDX);gl.wheelStartX=gl.wheelStartY=null;if(!gv){return}ci=(ci*fo+gv)/(fo+1);++fo},200)}else{gl.wheelDX+=gt;gl.wheelDY+=gs}}}function fT(gi,gl,gh){if(typeof gl=="string"){gl=eF[gl];if(!gl){return false}}gi.display.input.ensurePolled();var gk=gi.display.shift,gj=false;try{if(al(gi)){gi.state.suppressEdits=true}if(gh){gi.display.shift=false}gj=gl(gi)!=cc}finally{gi.display.shift=gk;gi.state.suppressEdits=false}return gj}function ec(gi,gj,gl){for(var gk=0;gk<gi.state.keyMaps.length;gk++){var gh=j(gj,gi.state.keyMaps[gk],gl,gi);if(gh){return gh}}return(gi.options.extraKeys&&j(gj,gi.options.extraKeys,gl,gi))||j(gj,gi.options.keyMap,gl,gi)}var dO=new gg;function bf(gi,gk,gm,gl){var gj=gi.state.keySeq;if(gj){if(eE(gk)){return"handled"}dO.set(50,function(){if(gi.state.keySeq==gj){gi.state.keySeq=null;gi.display.input.reset()}});gk=gj+" "+gk}var gh=ec(gi,gk,gl);if(gh=="multi"){gi.state.keySeq=gk}if(gh=="handled"){ag(gi,"keyHandled",gi,gk,gm)}if(gh=="handled"||gh=="multi"){cI(gm);q(gi)}if(gj&&!gh&&/\'$/.test(gk)){cI(gm);return true}return !!gh}function fl(gh,gj){var gi=ft(gj,true);if(!gi){return false}if(gj.shiftKey&&!gh.state.keySeq){return bf(gh,"Shift-"+gi,gj,function(gk){return fT(gh,gk,true)})||bf(gh,gi,gj,function(gk){if(typeof gk=="string"?/^go[A-Z]/.test(gk):gk.motion){return fT(gh,gk)}})}else{return bf(gh,gi,gj,function(gk){return fT(gh,gk)})}}function el(gh,gj,gi){return bf(gh,"'"+gi+"'",gj,function(gk){return fT(gh,gk,true)})}var dp=null;function r(gk){var gh=this;t(gh);if(aT(gh,gk)){return}if(dM&&m<11&&gk.keyCode==27){gk.returnValue=false}var gi=gk.keyCode;gh.display.shift=gi==16||gk.shiftKey;var gj=fl(gh,gk);if(d4){dp=gj?gi:null;if(!gj&&gi==88&&!dc&&(b9?gk.metaKey:gk.ctrlKey)){gh.replaceSelection("",null,"cut")}}if(gi==18&&!/\bCodeMirror-crosshair\b/.test(gh.display.lineDiv.className)){ax(gh)}}function ax(gi){var gj=gi.display.lineDiv;fC(gj,"CodeMirror-crosshair");function gh(gk){if(gk.keyCode==18||!gk.altKey){g(gj,"CodeMirror-crosshair");ef(document,"keyup",gh);ef(document,"mouseover",gh)}}bZ(document,"keyup",gh);bZ(document,"mouseover",gh)}function bk(gh){if(gh.keyCode==16){this.doc.sel.shift=false}aT(this,gh)}function cz(gl){var gh=this;if(bd(gh.display,gl)||aT(gh,gl)||gl.ctrlKey&&!gl.altKey||b9&&gl.metaKey){return}var gk=gl.keyCode,gi=gl.charCode;if(d4&&gk==dp){dp=null;cI(gl);return}if((d4&&(!gl.which||gl.which<10))&&fl(gh,gl)){return}var gj=String.fromCharCode(gi==null?gk:gi);if(el(gh,gl,gj)){return}gh.display.input.onKeyPress(gl)}function an(gh){gh.state.delayingBlurEvent=true;setTimeout(function(){if(gh.state.delayingBlurEvent){gh.state.delayingBlurEvent=false;aX(gh)}},100)}function cD(gh){if(gh.state.delayingBlurEvent){gh.state.delayingBlurEvent=false}if(gh.options.readOnly=="nocursor"){return}if(!gh.state.focused){aG(gh,"focus",gh);gh.state.focused=true;fC(gh.display.wrapper,"CodeMirror-focused");if(!gh.curOp&&gh.display.selForContextMenu!=gh.doc.sel){gh.display.input.reset();if(c2){setTimeout(function(){gh.display.input.reset(true)},20)}}gh.display.input.receivedFocus()}q(gh)}function aX(gh){if(gh.state.delayingBlurEvent){return}if(gh.state.focused){aG(gh,"blur",gh);gh.state.focused=false;g(gh.display.wrapper,"CodeMirror-focused")}clearInterval(gh.display.blinker);setTimeout(function(){if(!gh.state.focused){gh.display.shift=false}},150)}function aA(gh,gi){if(bd(gh.display,gi)||di(gh,gi)){return}gh.display.input.onContextMenu(gi)}function di(gh,gi){if(!fk(gh,"gutterContextMenu")){return false}return gf(gh,gi,"gutterContextMenu",false,aG)}var cZ=J.changeEnd=function(gh){if(!gh.text){return gh.to}return Y(gh.from.line+gh.text.length-1,fI(gh.text).length+(gh.text.length==1?gh.from.ch:0))};function b1(gk,gj){if(ch(gk,gj.from)<0){return gk}if(ch(gk,gj.to)<=0){return cZ(gj)}var gh=gk.line+gj.text.length-(gj.to.line-gj.from.line)-1,gi=gk.ch;if(gk.line==gj.to.line){gi+=cZ(gj).ch-gj.to.ch}return Y(gh,gi)}function fm(gk,gl){var gi=[];for(var gj=0;gj<gk.sel.ranges.length;gj++){var gh=gk.sel.ranges[gj];gi.push(new d0(b1(gh.anchor,gl),b1(gh.head,gl)))}return cy(gi,gk.sel.primIndex)}function bw(gj,gi,gh){if(gj.line==gi.line){return Y(gh.line,gj.ch-gi.ch+gh.ch)}else{return Y(gh.line+(gj.line-gi.line),gj.ch)}}function ah(gr,go,gi){var gj=[];var gh=Y(gr.first,0),gs=gh;for(var gl=0;gl<go.length;gl++){var gn=go[gl];var gq=bw(gn.from,gh,gs);var gp=bw(cZ(gn),gh,gs);gh=gn.to;gs=gp;if(gi=="around"){var gm=gr.sel.ranges[gl],gk=ch(gm.head,gm.anchor)<0;gj[gl]=new d0(gk?gp:gq,gk?gq:gp)}else{gj[gl]=new d0(gq,gq)}}return new f3(gj,gr.sel.primIndex)}function dT(gi,gk,gj){var gh={canceled:false,from:gk.from,to:gk.to,text:gk.text,origin:gk.origin,cancel:function(){this.canceled=true}};if(gj){gh.update=function(go,gn,gm,gl){if(go){this.from=fL(gi,go)}if(gn){this.to=fL(gi,gn)}if(gm){this.text=gm}if(gl!==undefined){this.origin=gl}}}aG(gi,"beforeChange",gi,gh);if(gi.cm){aG(gi.cm,"beforeChange",gi.cm,gh)}if(gh.canceled){return null}return{from:gh.from,to:gh.to,text:gh.text,origin:gh.origin}}function bi(gk,gl,gj){if(gk.cm){if(!gk.cm.curOp){return c4(gk.cm,bi)(gk,gl,gj)}if(gk.cm.state.suppressEdits){return}}if(fk(gk,"beforeChange")||gk.cm&&fk(gk.cm,"beforeChange")){gl=dT(gk,gl,true);if(!gl){return}}var gi=gc&&!gj&&cJ(gk,gl.from,gl.to);if(gi){for(var gh=gi.length-1;gh>=0;--gh){M(gk,{from:gi[gh].from,to:gi[gh].to,text:gh?[""]:gl.text})}}else{M(gk,gl)}}function M(gj,gk){if(gk.text.length==1&&gk.text[0]==""&&ch(gk.from,gk.to)==0){return}var gi=fm(gj,gk);fO(gj,gk,gi,gj.cm?gj.cm.curOp.id:NaN);eg(gj,gk,gi,em(gj,gk));var gh=[];d9(gj,function(gm,gl){if(!gl&&dj(gh,gm.history)==-1){dG(gm.history,gk);gh.push(gm.history)}eg(gm,gk,null,em(gm,gk))})}function ca(gs,gq,gu){if(gs.cm&&gs.cm.state.suppressEdits){return}var gp=gs.history,gj,gl=gs.sel;var gh=gq=="undo"?gp.done:gp.undone,gt=gq=="undo"?gp.undone:gp.done;for(var gm=0;gm<gh.length;gm++){gj=gh[gm];if(gu?gj.ranges&&!gj.equals(gs.sel):!gj.ranges){break}}if(gm==gh.length){return}gp.lastOrigin=gp.lastSelOrigin=null;for(;;){gj=gh.pop();if(gj.ranges){cP(gj,gt);if(gu&&!gj.equals(gs.sel)){bW(gs,gj,{clearRedo:false});return}gl=gj}else{break}}var go=[];cP(gl,gt);gt.push({changes:go,generation:gp.generation});gp.generation=gj.generation||++gp.maxGeneration;var gk=fk(gs,"beforeChange")||gs.cm&&fk(gs.cm,"beforeChange");for(var gm=gj.changes.length-1;gm>=0;--gm){var gr=gj.changes[gm];gr.origin=gq;if(gk&&!dT(gs,gr,false)){gh.length=0;return}go.push(dw(gs,gr));var gi=gm?fm(gs,gr):fI(gh);eg(gs,gr,gi,eb(gs,gr));if(!gm&&gs.cm){gs.cm.scrollIntoView({from:gr.from,to:cZ(gr)})}var gn=[];d9(gs,function(gw,gv){if(!gv&&dj(gn,gw.history)==-1){dG(gw.history,gr);gn.push(gw.history)}eg(gw,gr,null,eb(gw,gr))})}}function fp(gi,gk){if(gk==0){return}gi.first+=gk;gi.sel=new f3(bU(gi.sel.ranges,function(gl){return new d0(Y(gl.anchor.line+gk,gl.anchor.ch),Y(gl.head.line+gk,gl.head.ch))}),gi.sel.primIndex);if(gi.cm){aj(gi.cm,gi.first,gi.first-gk,gk);for(var gj=gi.cm.display,gh=gj.viewFrom;gh<gj.viewTo;gh++){T(gi.cm,gh,"gutter")}}}function eg(gl,gm,gk,gi){if(gl.cm&&!gl.cm.curOp){return c4(gl.cm,eg)(gl,gm,gk,gi)}if(gm.to.line<gl.first){fp(gl,gm.text.length-1-(gm.to.line-gm.from.line));return}if(gm.from.line>gl.lastLine()){return}if(gm.from.line<gl.first){var gh=gm.text.length-1-(gl.first-gm.from.line);fp(gl,gh);gm={from:Y(gl.first,0),to:Y(gm.to.line+gh,gm.to.ch),text:[fI(gm.text)],origin:gm.origin}}var gj=gl.lastLine();if(gm.to.line>gj){gm={from:gm.from,to:Y(gj,fh(gl,gj).text.length),text:[gm.text[0]],origin:gm.origin}}gm.removed=f4(gl,gm.from,gm.to);if(!gk){gk=fm(gl,gm)}if(gl.cm){aL(gl.cm,gm,gi)}else{fA(gl,gm,gi)}er(gl,gk,ab)}function aL(gs,go,gm){var gr=gs.doc,gn=gs.display,gp=go.from,gq=go.to;var gh=false,gl=gp.line;if(!gs.options.lineWrapping){gl=bP(A(fh(gr,gp.line)));gr.iter(gl,gq.line+1,function(gu){if(gu==gn.maxLine){gh=true;return true}})}if(gr.sel.contains(go.from,go.to)>-1){X(gs)}fA(gr,go,gm,bg(gs));if(!gs.options.lineWrapping){gr.iter(gl,gp.line+go.text.length,function(gv){var gu=ep(gv);if(gu>gn.maxLineLength){gn.maxLine=gv;gn.maxLineLength=gu;gn.maxLineChanged=true;gh=false}});if(gh){gs.curOp.updateMaxLine=true}}gr.frontier=Math.min(gr.frontier,gp.line);eh(gs,400);var gt=go.text.length-(gq.line-gp.line)-1;if(go.full){aj(gs)}else{if(gp.line==gq.line&&go.text.length==1&&!dU(gs.doc,go)){T(gs,gp.line,"text")}else{aj(gs,gp.line,gq.line+1,gt)}}var gj=fk(gs,"changes"),gk=fk(gs,"change");if(gk||gj){var gi={from:gp,to:gq,text:go.text,removed:go.removed,origin:go.origin};if(gk){ag(gs,"change",gs,gi)}if(gj){(gs.curOp.changeObjs||(gs.curOp.changeObjs=[])).push(gi)}}gs.display.selForContextMenu=null}function a4(gk,gj,gm,gl,gh){if(!gl){gl=gm}if(ch(gl,gm)<0){var gi=gl;gl=gm;gm=gi}if(typeof gj=="string"){gj=a3(gj)}bi(gk,{from:gm,to:gl,text:gj,origin:gh})}function d8(gi,gl){if(aT(gi,"scrollCursorIntoView")){return}var gm=gi.display,gj=gm.sizer.getBoundingClientRect(),gh=null;if(gl.top+gj.top<0){gh=true}else{if(gl.bottom+gj.top>(window.innerHeight||document.documentElement.clientHeight)){gh=false}}if(gh!=null&&!fw){var gk=f2("div","\u200b",null,"position: absolute; top: "+(gl.top-gm.viewOffset-fa(gi.display))+"px; height: "+(gl.bottom-gl.top+cV(gi)+gm.barHeight)+"px; left: "+gl.left+"px; width: 2px;");gi.display.lineSpace.appendChild(gk);gk.scrollIntoView(gh);gi.display.lineSpace.removeChild(gk)}}function F(gr,gp,gl,gk){if(gk==null){gk=0}for(var gm=0;gm<5;gm++){var gn=false,gq=dW(gr,gp);var gh=!gl||gl==gp?gq:dW(gr,gl);var gj=I(gr,Math.min(gq.left,gh.left),Math.min(gq.top,gh.top)-gk,Math.max(gq.left,gh.left),Math.max(gq.bottom,gh.bottom)+gk);var go=gr.doc.scrollTop,gi=gr.doc.scrollLeft;if(gj.scrollTop!=null){P(gr,gj.scrollTop);if(Math.abs(gr.doc.scrollTop-go)>1){gn=true}}if(gj.scrollLeft!=null){bG(gr,gj.scrollLeft);if(Math.abs(gr.doc.scrollLeft-gi)>1){gn=true}}if(!gn){break}}return gq}function G(gh,gj,gl,gi,gk){var gm=I(gh,gj,gl,gi,gk);if(gm.scrollTop!=null){P(gh,gm.scrollTop)}if(gm.scrollLeft!=null){bG(gh,gm.scrollLeft)}}function I(gt,gk,gs,gi,gr){var gp=gt.display,gn=a0(gt.display);if(gs<0){gs=0}var gl=gt.curOp&&gt.curOp.scrollTop!=null?gt.curOp.scrollTop:gp.scroller.scrollTop;var gv=cX(gt),gx={};if(gr-gs>gv){gr=gs+gv}var gj=gt.doc.height+bK(gp);var gh=gs<gn,go=gr>gj-gn;if(gs<gl){gx.scrollTop=gh?0:gs}else{if(gr>gl+gv){var gq=Math.min(gs,(go?gj:gr)-gv);if(gq!=gl){gx.scrollTop=gq}}}var gw=gt.curOp&&gt.curOp.scrollLeft!=null?gt.curOp.scrollLeft:gp.scroller.scrollLeft;var gu=dn(gt)-(gt.options.fixedGutter?gp.gutters.offsetWidth:0);var gm=gi-gk>gu;if(gm){gi=gk+gu}if(gk<10){gx.scrollLeft=0}else{if(gk<gw){gx.scrollLeft=Math.max(0,gk-(gm?0:10))}else{if(gi>gu+gw-3){gx.scrollLeft=gi+(gm?0:10)-gu}}}return gx}function cN(gh,gj,gi){if(gj!=null||gi!=null){fE(gh)}if(gj!=null){gh.curOp.scrollLeft=(gh.curOp.scrollLeft==null?gh.doc.scrollLeft:gh.curOp.scrollLeft)+gj}if(gi!=null){gh.curOp.scrollTop=(gh.curOp.scrollTop==null?gh.doc.scrollTop:gh.curOp.scrollTop)+gi}}function fH(gh){fE(gh);var gi=gh.getCursor(),gk=gi,gj=gi;if(!gh.options.lineWrapping){gk=gi.ch?Y(gi.line,gi.ch-1):gi;gj=Y(gi.line,gi.ch+1)}gh.curOp.scrollToPos={from:gk,to:gj,margin:gh.options.cursorScrollMargin,isCursor:true}}function fE(gh){var gj=gh.curOp.scrollToPos;if(gj){gh.curOp.scrollToPos=null;var gl=dJ(gh,gj.from),gk=dJ(gh,gj.to);var gi=I(gh,Math.min(gl.left,gk.left),Math.min(gl.top,gk.top)-gj.margin,Math.max(gl.right,gk.right),Math.max(gl.bottom,gk.bottom)+gj.margin);gh.scrollTo(gi.scrollLeft,gi.scrollTop)}}function af(gu,gk,gt,gj){var gs=gu.doc,gi;if(gt==null){gt="add"}if(gt=="smart"){if(!gs.mode.indent){gt="prev"}else{gi=dE(gu,gk)}}var go=gu.options.tabSize;var gv=fh(gs,gk),gn=bV(gv.text,null,go);if(gv.stateAfter){gv.stateAfter=null}var gh=gv.text.match(/^\s*/)[0],gq;if(!gj&&!/\S/.test(gv.text)){gq=0;gt="not"}else{if(gt=="smart"){gq=gs.mode.indent(gi,gv.text.slice(gh.length),gv.text);if(gq==cc||gq>150){if(!gj){return}gt="prev"}}}if(gt=="prev"){if(gk>gs.first){gq=bV(fh(gs,gk-1).text,null,go)}else{gq=0}}else{if(gt=="add"){gq=gn+gu.options.indentUnit}else{if(gt=="subtract"){gq=gn-gu.options.indentUnit}else{if(typeof gt=="number"){gq=gn+gt}}}}gq=Math.max(0,gq);var gr="",gp=0;if(gu.options.indentWithTabs){for(var gl=Math.floor(gq/go);gl;--gl){gp+=go;gr+="\t"}}if(gp<gq){gr+=cr(gq-gp)}if(gr!=gh){a4(gs,gr,Y(gk,0),Y(gk,gh.length),"+input")}else{for(var gl=0;gl<gs.sel.ranges.length;gl++){var gm=gs.sel.ranges[gl];if(gm.head.line==gk&&gm.head.ch<gh.length){var gp=Y(gk,gh.length);f(gs,gl,new d0(gp,gp));break}}}gv.stateAfter=null}function eB(gk,gj,gh,gm){var gl=gj,gi=gj;if(typeof gj=="number"){gi=fh(gk,c7(gk,gj))}else{gl=bP(gj)}if(gl==null){return null}if(gm(gi,gl)&&gk.cm){T(gk.cm,gl,gh)}return gi}function eZ(gh,gn){var gi=gh.doc.sel.ranges,gl=[];for(var gk=0;gk<gi.length;gk++){var gj=gn(gi[gk]);while(gl.length&&ch(gj.from,fI(gl).to)<=0){var gm=gl.pop();if(ch(gm.from,gj.from)<0){gj.from=gm.from;break}}gl.push(gj)}cO(gh,function(){for(var go=gl.length-1;go>=0;go--){a4(gh.doc,"",gl[go].from,gl[go].to,"+delete")}fH(gh)})}function by(gz,gl,gt,gs,gn){var gq=gl.line,gr=gl.ch,gy=gt;var gi=fh(gz,gq);var gw=true;function gx(){var gA=gq+gt;if(gA<gz.first||gA>=gz.first+gz.size){return(gw=false)}gq=gA;return gi=fh(gz,gA)}function gv(gB){var gA=(gn?w:ak)(gi,gr,gt,true);if(gA==null){if(!gB&&gx()){if(gn){gr=(gt<0?cU:cG)(gi)}else{gr=gt<0?gi.text.length:0}}else{return(gw=false)}}else{gr=gA}return true}if(gs=="char"){gv()}else{if(gs=="column"){gv(true)}else{if(gs=="word"||gs=="group"){var gu=null,go=gs=="group";var gh=gz.cm&&gz.cm.getHelper(gl,"wordChars");for(var gm=true;;gm=false){if(gt<0&&!gv(!gm)){break}var gj=gi.text.charAt(gr)||"\n";var gk=cC(gj,gh)?"w":go&&gj=="\n"?"n":!go||/\s/.test(gj)?null:"p";if(go&&!gm&&!gk){gk="s"}if(gu&&gu!=gk){if(gt<0){gt=1;gv()}break}if(gk){gu=gk}if(gt>0&&!gv(!gm)){break}}}}}var gp=bX(gz,Y(gq,gr),gy,true);if(!gw){gp.hitSide=true}return gp}function bs(gp,gk,gh,go){var gn=gp.doc,gm=gk.left,gl;if(go=="page"){var gj=Math.min(gp.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);gl=gk.top+gh*(gj-(gh<0?1.5:0.5)*a0(gp.display))}else{if(go=="line"){gl=gh>0?gk.bottom+3:gk.top-3}}for(;;){var gi=fQ(gp,gm,gl);if(!gi.outside){break}if(gh<0?gl<=0:gl>=gn.height){gi.hitSide=true;break}gl+=gh*5}return gi}J.prototype={constructor:J,focus:function(){window.focus();this.display.input.focus()},setOption:function(gj,gk){var gi=this.options,gh=gi[gj];if(gi[gj]==gk&&gj!="mode"){return}gi[gj]=gk;if(bh.hasOwnProperty(gj)){c4(this,bh[gj])(this,gk,gh)}},getOption:function(gh){return this.options[gh]},getDoc:function(){return this.doc},addKeyMap:function(gi,gh){this.state.keyMaps[gh?"push":"unshift"](fY(gi))},removeKeyMap:function(gi){var gj=this.state.keyMaps;for(var gh=0;gh<gj.length;++gh){if(gj[gh]==gi||gj[gh].name==gi){gj.splice(gh,1);return true}}},addOverlay:da(function(gh,gi){var gj=gh.token?gh:J.getMode(this.options,gh);if(gj.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:gj,modeSpec:gh,opaque:gi&&gi.opaque});this.state.modeGen++;aj(this)}),removeOverlay:da(function(gh){var gj=this.state.overlays;for(var gi=0;gi<gj.length;++gi){var gk=gj[gi].modeSpec;if(gk==gh||typeof gh=="string"&&gk.name==gh){gj.splice(gi,1);this.state.modeGen++;aj(this);return}}}),indentLine:da(function(gj,gh,gi){if(typeof gh!="string"&&typeof gh!="number"){if(gh==null){gh=this.options.smartIndent?"smart":"prev"}else{gh=gh?"add":"subtract"}}if(cb(this.doc,gj)){af(this,gj,gh,gi)}}),indentSelection:da(function(gq){var gh=this.doc.sel.ranges,gk=-1;for(var gm=0;gm<gh.length;gm++){var gn=gh[gm];if(!gn.empty()){var go=gn.from(),gp=gn.to();var gi=Math.max(gk,go.line);gk=Math.min(this.lastLine(),gp.line-(gp.ch?0:1))+1;for(var gl=gi;gl<gk;++gl){af(this,gl,gq)}var gj=this.doc.sel.ranges;if(go.ch==0&&gh.length==gj.length&&gj[gm].from().ch>0){f(this.doc,gm,new d0(go,gj[gm].to()),ab)}}else{if(gn.head.line>gk){af(this,gn.head.line,gq,true);gk=gn.head.line;if(gm==this.doc.sel.primIndex){fH(this)}}}}}),getTokenAt:function(gi,gh){return cs(this,gi,gh)},getLineTokens:function(gi,gh){return cs(this,Y(gi),gh,true)},getTokenTypeAt:function(go){go=fL(this.doc,go);var gk=c8(this,fh(this.doc,go.line));var gm=0,gn=(gk.length-1)/2,gj=go.ch;var gi;if(gj==0){gi=gk[2]}else{for(;;){var gh=(gm+gn)>>1;if((gh?gk[gh*2-1]:0)>=gj){gn=gh}else{if(gk[gh*2+1]<gj){gm=gh+1}else{gi=gk[gh*2+2];break}}}}var gl=gi?gi.indexOf("cm-overlay "):-1;return gl<0?gi:gl==0?null:gi.slice(0,gl-1)},getModeAt:function(gi){var gh=this.doc.mode;if(!gh.innerMode){return gh}return J.innerMode(gh,this.getTokenAt(gi).state).mode},getHelper:function(gi,gh){return this.getHelpers(gi,gh)[0]},getHelpers:function(go,gj){var gk=[];if(!fq.hasOwnProperty(gj)){return gk}var gh=fq[gj],gn=this.getModeAt(go);if(typeof gn[gj]=="string"){if(gh[gn[gj]]){gk.push(gh[gn[gj]])}}else{if(gn[gj]){for(var gi=0;gi<gn[gj].length;gi++){var gm=gh[gn[gj][gi]];if(gm){gk.push(gm)}}}else{if(gn.helperType&&gh[gn.helperType]){gk.push(gh[gn.helperType])}else{if(gh[gn.name]){gk.push(gh[gn.name])}}}}for(var gi=0;gi<gh._global.length;gi++){var gl=gh._global[gi];if(gl.pred(gn,this)&&dj(gk,gl.val)==-1){gk.push(gl.val)}}return gk},getStateAfter:function(gi,gh){var gj=this.doc;gi=c7(gj,gi==null?gj.first+gj.size-1:gi);return dE(this,gi+1,gh)},cursorCoords:function(gk,gi){var gj,gh=this.doc.sel.primary();if(gk==null){gj=gh.head}else{if(typeof gk=="object"){gj=fL(this.doc,gk)}else{gj=gk?gh.from():gh.to()}}return dW(this,gj,gi||"page")},charCoords:function(gi,gh){return cL(this,fL(this.doc,gi),gh||"page")},coordsChar:function(gh,gi){gh=ge(this,gh,gi||"page");return fQ(this,gh.left,gh.top)},lineAtHeight:function(gh,gi){gh=ge(this,{top:gh,left:0},gi||"page").top;return bI(this.doc,gh+this.display.viewOffset)},heightAtLine:function(gi,gl){var gh=false,gk=this.doc.first+this.doc.size-1;if(gi<this.doc.first){gi=this.doc.first}else{if(gi>gk){gi=gk;gh=true}}var gj=fh(this.doc,gi);return eS(this,gj,{top:0,left:0},gl||"page").top+(gh?this.doc.height-bO(gj):0)},defaultTextHeight:function(){return a0(this.display)},defaultCharWidth:function(){return dF(this.display)},setGutterMarker:da(function(gh,gi,gj){return eB(this.doc,gh,"gutter",function(gk){var gl=gk.gutterMarkers||(gk.gutterMarkers={});gl[gi]=gj;if(!gj&&eW(gl)){gk.gutterMarkers=null}return true})}),clearGutter:da(function(gj){var gh=this,gk=gh.doc,gi=gk.first;gk.iter(function(gl){if(gl.gutterMarkers&&gl.gutterMarkers[gj]){gl.gutterMarkers[gj]=null;T(gh,gi,"gutter");if(eW(gl.gutterMarkers)){gl.gutterMarkers=null}}++gi})}),lineInfo:function(gh){if(typeof gh=="number"){if(!cb(this.doc,gh)){return null}var gi=gh;gh=fh(this.doc,gh);if(!gh){return null}}else{var gi=bP(gh);if(gi==null){return null}}return{line:gi,handle:gh,text:gh.text,gutterMarkers:gh.gutterMarkers,textClass:gh.textClass,bgClass:gh.bgClass,wrapClass:gh.wrapClass,widgets:gh.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(gm,gj,go,gk,gq){var gl=this.display;gm=dW(this,fL(this.doc,gm));var gn=gm.bottom,gi=gm.left;gj.style.position="absolute";gj.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(gj);gl.sizer.appendChild(gj);if(gk=="over"){gn=gm.top}else{if(gk=="above"||gk=="near"){var gh=Math.max(gl.wrapper.clientHeight,this.doc.height),gp=Math.max(gl.sizer.clientWidth,gl.lineSpace.clientWidth);if((gk=="above"||gm.bottom+gj.offsetHeight>gh)&&gm.top>gj.offsetHeight){gn=gm.top-gj.offsetHeight}else{if(gm.bottom+gj.offsetHeight<=gh){gn=gm.bottom}}if(gi+gj.offsetWidth>gp){gi=gp-gj.offsetWidth}}}gj.style.top=gn+"px";gj.style.left=gj.style.right="";if(gq=="right"){gi=gl.sizer.clientWidth-gj.offsetWidth;gj.style.right="0px"}else{if(gq=="left"){gi=0}else{if(gq=="middle"){gi=(gl.sizer.clientWidth-gj.offsetWidth)/2}}gj.style.left=gi+"px"}if(go){G(this,gi,gn,gi+gj.offsetWidth,gn+gj.offsetHeight)}},triggerOnKeyDown:da(r),triggerOnKeyPress:da(cz),triggerOnKeyUp:bk,execCommand:function(gh){if(eF.hasOwnProperty(gh)){return eF[gh](this)}},findPosH:function(gn,gk,gl,gi){var gh=1;if(gk<0){gh=-1;gk=-gk}for(var gj=0,gm=fL(this.doc,gn);gj<gk;++gj){gm=by(this.doc,gm,gh,gl,gi);if(gm.hitSide){break}}return gm},moveH:da(function(gi,gj){var gh=this;gh.extendSelectionsBy(function(gk){if(gh.display.shift||gh.doc.extend||gk.empty()){return by(gh.doc,gk.head,gi,gj,gh.options.rtlMoveVisually)}else{return gi<0?gk.from():gk.to()}},cY)}),deleteH:da(function(gh,gi){var gj=this.doc.sel,gk=this.doc;if(gj.somethingSelected()){gk.replaceSelection("",null,"+delete")}else{eZ(this,function(gm){var gl=by(gk,gm.head,gh,gi,false);return gh<0?{from:gl,to:gm.head}:{from:gm.head,to:gl}})}}),findPosV:function(gm,gj,gn,gp){var gh=1,gl=gp;if(gj<0){gh=-1;gj=-gj}for(var gi=0,go=fL(this.doc,gm);gi<gj;++gi){var gk=dW(this,go,"div");if(gl==null){gl=gk.left}else{gk.left=gl}go=bs(this,gk,gh,gn);if(go.hitSide){break}}return go},moveV:da(function(gi,gk){var gh=this,gm=this.doc,gl=[];var gn=!gh.display.shift&&!gm.extend&&gm.sel.somethingSelected();gm.extendSelectionsBy(function(go){if(gn){return gi<0?go.from():go.to()}var gq=dW(gh,go.head,"div");if(go.goalColumn!=null){gq.left=go.goalColumn}gl.push(gq.left);var gp=bs(gh,gq,gi,gk);if(gk=="page"&&go==gm.sel.primary()){cN(gh,null,cL(gh,gp,"div").top-gq.top)}return gp},cY);if(gl.length){for(var gj=0;gj<gm.sel.ranges.length;gj++){gm.sel.ranges[gj].goalColumn=gl[gj]}}}),findWordAt:function(go){var gm=this.doc,gk=fh(gm,go.line).text;var gn=go.ch,gj=go.ch;if(gk){var gl=this.getHelper(go,"wordChars");if((go.xRel<0||gj==gk.length)&&gn){--gn}else{++gj}var gi=gk.charAt(gn);var gh=cC(gi,gl)?function(gp){return cC(gp,gl)}:/\s/.test(gi)?function(gp){return/\s/.test(gp)}:function(gp){return !/\s/.test(gp)&&!cC(gp)};while(gn>0&&gh(gk.charAt(gn-1))){--gn}while(gj<gk.length&&gh(gk.charAt(gj))){++gj}}return new d0(Y(go.line,gn),Y(go.line,gj))},toggleOverwrite:function(gh){if(gh!=null&&gh==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fC(this.display.cursorDiv,"CodeMirror-overwrite")}else{g(this.display.cursorDiv,"CodeMirror-overwrite")}aG(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==dQ()},scrollTo:da(function(gh,gi){if(gh!=null||gi!=null){fE(this)}if(gh!=null){this.curOp.scrollLeft=gh}if(gi!=null){this.curOp.scrollTop=gi}}),getScrollInfo:function(){var gh=this.display.scroller;return{left:gh.scrollLeft,top:gh.scrollTop,height:gh.scrollHeight-cV(this)-this.display.barHeight,width:gh.scrollWidth-cV(this)-this.display.barWidth,clientHeight:cX(this),clientWidth:dn(this)}},scrollIntoView:da(function(gi,gj){if(gi==null){gi={from:this.doc.sel.primary().head,to:null};if(gj==null){gj=this.options.cursorScrollMargin}}else{if(typeof gi=="number"){gi={from:Y(gi,0),to:null}}else{if(gi.from==null){gi={from:gi,to:null}}}}if(!gi.to){gi.to=gi.from}gi.margin=gj||0;if(gi.from.line!=null){fE(this);this.curOp.scrollToPos=gi}else{var gh=I(this,Math.min(gi.from.left,gi.to.left),Math.min(gi.from.top,gi.to.top)-gi.margin,Math.max(gi.from.right,gi.to.right),Math.max(gi.from.bottom,gi.to.bottom)+gi.margin);this.scrollTo(gh.scrollLeft,gh.scrollTop)}}),setSize:da(function(gk,gi){var gh=this;function gj(gm){return typeof gm=="number"||/^\d+$/.test(String(gm))?gm+"px":gm}if(gk!=null){gh.display.wrapper.style.width=gj(gk)}if(gi!=null){gh.display.wrapper.style.height=gj(gi)}if(gh.options.lineWrapping){aQ(this)}var gl=gh.display.viewFrom;gh.doc.iter(gl,gh.display.viewTo,function(gm){if(gm.widgets){for(var gn=0;gn<gm.widgets.length;gn++){if(gm.widgets[gn].noHScroll){T(gh,gl,"widget");break}}}++gl});gh.curOp.forceUpdate=true;aG(gh,"refresh",this)}),operation:function(gh){return cO(this,gh)},refresh:da(function(){var gh=this.display.cachedTextHeight;aj(this);this.curOp.forceUpdate=true;am(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);c6(this);if(gh==null||Math.abs(gh-a0(this.display))>0.5){Z(this)}aG(this,"refresh",this)}),swapDoc:da(function(gi){var gh=this.doc;gh.cm=null;ed(this,gi);am(this);this.display.input.reset();this.scrollTo(gi.scrollLeft,gi.scrollTop);this.curOp.forceScroll=true;ag(this,"swapDoc",this,gh);return gh}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bA(J);var e5=J.defaults={};var bh=J.optionHandlers={};function u(gh,gk,gj,gi){J.defaults[gh]=gk;if(gj){bh[gh]=gi?function(gl,gn,gm){if(gm!=ce){gj(gl,gn,gm)}}:gj}}var ce=J.Init={toString:function(){return"CodeMirror.Init"}};u("value","",function(gh,gi){gh.setValue(gi)},true);u("mode",null,function(gh,gi){gh.doc.modeOption=gi;bt(gh)},true);u("indentUnit",2,bt,true);u("indentWithTabs",false);u("smartIndent",true);u("tabSize",4,function(gh){en(gh);am(gh);aj(gh)},true);u("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(gh,gj,gi){gh.state.specialChars=new RegExp(gj.source+(gj.test("\t")?"":"|\t"),"g");if(gi!=J.Init){gh.refresh()}});u("specialCharPlaceholder",fe,function(gh){gh.refresh()},true);u("electricChars",true);u("inputStyle",ei?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);u("rtlMoveVisually",!aR);u("wholeLineUpdateBefore",true);u("theme","default",function(gh){cQ(gh);dy(gh)},true);u("keyMap","default",function(gh,gl,gi){var gj=fY(gl);var gk=gi!=J.Init&&fY(gi);if(gk&&gk.detach){gk.detach(gh,gj)}if(gj.attach){gj.attach(gh,gk||null)}});u("extraKeys",null);u("lineWrapping",false,eI,true);u("gutters",[],function(gh){cg(gh.options);dy(gh)},true);u("fixedGutter",true,function(gh,gi){gh.display.gutters.style.left=gi?dZ(gh.display)+"px":"0";gh.refresh()},true);u("coverGutterNextToScrollbar",false,function(gh){e0(gh)},true);u("scrollbarStyle","native",function(gh){aF(gh);e0(gh);gh.display.scrollbars.setScrollTop(gh.doc.scrollTop);gh.display.scrollbars.setScrollLeft(gh.doc.scrollLeft)},true);u("lineNumbers",false,function(gh){cg(gh.options);dy(gh)},true);u("firstLineNumber",1,dy,true);u("lineNumberFormatter",function(gh){return gh},dy,true);u("showCursorWhenSelecting",false,bE,true);u("resetSelectionOnContextMenu",true);u("readOnly",false,function(gh,gi){if(gi=="nocursor"){aX(gh);gh.display.input.blur();gh.display.disabled=true}else{gh.display.disabled=false;if(!gi){gh.display.input.reset()}}});u("disableInput",false,function(gh,gi){if(!gi){gh.display.input.reset()}},true);u("dragDrop",true);u("cursorBlinkRate",530);u("cursorScrollMargin",0);u("cursorHeight",1,bE,true);u("singleCursorHeightPerLine",true,bE,true);u("workTime",100);u("workDelay",100);u("flattenSpans",true,en,true);u("addModeClass",false,en,true);u("pollInterval",100);u("undoDepth",200,function(gh,gi){gh.doc.history.undoDepth=gi});u("historyEventDelay",1250);u("viewportMargin",10,function(gh){gh.refresh()},true);u("maxHighlightLength",10000,en,true);u("moveInputWithCursor",true,function(gh,gi){if(!gi){gh.display.input.resetPosition()}});u("tabindex",null,function(gh,gi){gh.display.input.getField().tabIndex=gi||""});u("autofocus",null);var du=J.modes={},aU=J.mimeModes={};J.defineMode=function(gh,gi){if(!J.defaults.mode&&gh!="null"){J.defaults.mode=gh}if(arguments.length>2){gi.dependencies=Array.prototype.slice.call(arguments,2)}du[gh]=gi};J.defineMIME=function(gi,gh){aU[gi]=gh};J.resolveMode=function(gh){if(typeof gh=="string"&&aU.hasOwnProperty(gh)){gh=aU[gh]}else{if(gh&&typeof gh.name=="string"&&aU.hasOwnProperty(gh.name)){var gi=aU[gh.name];if(typeof gi=="string"){gi={name:gi}}gh=cm(gi,gh);gh.name=gi.name}else{if(typeof gh=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(gh)){return J.resolveMode("application/xml")}}}if(typeof gh=="string"){return{name:gh}}else{return gh||{name:"null"}}};J.getMode=function(gi,gh){var gh=J.resolveMode(gh);var gk=du[gh.name];if(!gk){return J.getMode(gi,"text/plain")}var gl=gk(gi,gh);if(dr.hasOwnProperty(gh.name)){var gj=dr[gh.name];for(var gm in gj){if(!gj.hasOwnProperty(gm)){continue}if(gl.hasOwnProperty(gm)){gl["_"+gm]=gl[gm]}gl[gm]=gj[gm]}}gl.name=gh.name;if(gh.helperType){gl.helperType=gh.helperType}if(gh.modeProps){for(var gm in gh.modeProps){gl[gm]=gh.modeProps[gm]}}return gl};J.defineMode("null",function(){return{token:function(gh){gh.skipToEnd()}}});J.defineMIME("text/plain","null");var dr=J.modeExtensions={};J.extendMode=function(gj,gi){var gh=dr.hasOwnProperty(gj)?dr[gj]:(dr[gj]={});aP(gi,gh)};J.defineExtension=function(gh,gi){J.prototype[gh]=gi};J.defineDocExtension=function(gh,gi){av.prototype[gh]=gi};J.defineOption=u;var bb=[];J.defineInitHook=function(gh){bb.push(gh)};var fq=J.helpers={};J.registerHelper=function(gi,gh,gj){if(!fq.hasOwnProperty(gi)){fq[gi]=J[gi]={_global:[]}}fq[gi][gh]=gj};J.registerGlobalHelper=function(gj,gi,gh,gk){J.registerHelper(gj,gi,gk);fq[gj]._global.push({pred:gh,val:gk})};var b5=J.copyState=function(gk,gh){if(gh===true){return gh}if(gk.copyState){return gk.copyState(gh)}var gj={};for(var gl in gh){var gi=gh[gl];if(gi instanceof Array){gi=gi.concat([])}gj[gl]=gi}return gj};var b2=J.startState=function(gj,gi,gh){return gj.startState?gj.startState(gi,gh):true};J.innerMode=function(gj,gh){while(gj.innerMode){var gi=gj.innerMode(gh);if(!gi||gi.mode==gj){break}gh=gi.state;gj=gi.mode}return gi||{mode:gj,state:gh}};var eF=J.commands={selectAll:function(gh){gh.setSelection(Y(gh.firstLine(),0),Y(gh.lastLine()),ab)},singleSelection:function(gh){gh.setSelection(gh.getCursor("anchor"),gh.getCursor("head"),ab)},killLine:function(gh){eZ(gh,function(gj){if(gj.empty()){var gi=fh(gh.doc,gj.head.line).text.length;if(gj.head.ch==gi&&gj.head.line<gh.lastLine()){return{from:gj.head,to:Y(gj.head.line+1,0)}}else{return{from:gj.head,to:Y(gj.head.line,gi)}}}else{return{from:gj.from(),to:gj.to()}}})},deleteLine:function(gh){eZ(gh,function(gi){return{from:Y(gi.from().line,0),to:fL(gh.doc,Y(gi.to().line+1,0))}})},delLineLeft:function(gh){eZ(gh,function(gi){return{from:Y(gi.from().line,0),to:gi.from()}})},delWrappedLineLeft:function(gh){eZ(gh,function(gi){var gk=gh.charCoords(gi.head,"div").top+5;var gj=gh.coordsChar({left:0,top:gk},"div");return{from:gj,to:gi.from()}})},delWrappedLineRight:function(gh){eZ(gh,function(gi){var gk=gh.charCoords(gi.head,"div").top+5;var gj=gh.coordsChar({left:gh.display.lineDiv.offsetWidth+100,top:gk},"div");return{from:gi.from(),to:gj}})},undo:function(gh){gh.undo()},redo:function(gh){gh.redo()},undoSelection:function(gh){gh.undoSelection()},redoSelection:function(gh){gh.redoSelection()},goDocStart:function(gh){gh.extendSelection(Y(gh.firstLine(),0))},goDocEnd:function(gh){gh.extendSelection(Y(gh.lastLine()))},goLineStart:function(gh){gh.extendSelectionsBy(function(gi){return bv(gh,gi.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(gh){gh.extendSelectionsBy(function(gi){return dK(gh,gi.head)},{origin:"+move",bias:1})},goLineEnd:function(gh){gh.extendSelectionsBy(function(gi){return dR(gh,gi.head.line)},{origin:"+move",bias:-1})},goLineRight:function(gh){gh.extendSelectionsBy(function(gi){var gj=gh.charCoords(gi.head,"div").top+5;return gh.coordsChar({left:gh.display.lineDiv.offsetWidth+100,top:gj},"div")},cY)},goLineLeft:function(gh){gh.extendSelectionsBy(function(gi){var gj=gh.charCoords(gi.head,"div").top+5;return gh.coordsChar({left:0,top:gj},"div")},cY)},goLineLeftSmart:function(gh){gh.extendSelectionsBy(function(gi){var gj=gh.charCoords(gi.head,"div").top+5;var gk=gh.coordsChar({left:0,top:gj},"div");if(gk.ch<gh.getLine(gk.line).search(/\S/)){return dK(gh,gi.head)}return gk},cY)},goLineUp:function(gh){gh.moveV(-1,"line")},goLineDown:function(gh){gh.moveV(1,"line")},goPageUp:function(gh){gh.moveV(-1,"page")},goPageDown:function(gh){gh.moveV(1,"page")},goCharLeft:function(gh){gh.moveH(-1,"char")},goCharRight:function(gh){gh.moveH(1,"char")},goColumnLeft:function(gh){gh.moveH(-1,"column")},goColumnRight:function(gh){gh.moveH(1,"column")},goWordLeft:function(gh){gh.moveH(-1,"word")},goGroupRight:function(gh){gh.moveH(1,"group")},goGroupLeft:function(gh){gh.moveH(-1,"group")},goWordRight:function(gh){gh.moveH(1,"word")},delCharBefore:function(gh){gh.deleteH(-1,"char")},delCharAfter:function(gh){gh.deleteH(1,"char")},delWordBefore:function(gh){gh.deleteH(-1,"word")},delWordAfter:function(gh){gh.deleteH(1,"word")},delGroupBefore:function(gh){gh.deleteH(-1,"group")},delGroupAfter:function(gh){gh.deleteH(1,"group")},indentAuto:function(gh){gh.indentSelection("smart")},indentMore:function(gh){gh.indentSelection("add")},indentLess:function(gh){gh.indentSelection("subtract")},insertTab:function(gh){gh.replaceSelection("\t")},insertSoftTab:function(gh){var gj=[],gi=gh.listSelections(),gm=gh.options.tabSize;for(var gl=0;gl<gi.length;gl++){var gn=gi[gl].from();var gk=bV(gh.getLine(gn.line),gn.ch,gm);gj.push(new Array(gm-gk%gm+1).join(" "))}gh.replaceSelections(gj)},defaultTab:function(gh){if(gh.somethingSelected()){gh.indentSelection("add")}else{gh.execCommand("insertTab")}},transposeChars:function(gh){cO(gh,function(){var gk=gh.listSelections(),gj=[];for(var gl=0;gl<gk.length;gl++){var gn=gk[gl].head,gi=fh(gh.doc,gn.line).text;if(gi){if(gn.ch==gi.length){gn=new Y(gn.line,gn.ch-1)}if(gn.ch>0){gn=new Y(gn.line,gn.ch+1);gh.replaceRange(gi.charAt(gn.ch-1)+gi.charAt(gn.ch-2),Y(gn.line,gn.ch-2),gn,"+transpose")}else{if(gn.line>gh.doc.first){var gm=fh(gh.doc,gn.line-1).text;if(gm){gh.replaceRange(gi.charAt(0)+"\n"+gm.charAt(gm.length-1),Y(gn.line-1,gm.length-1),Y(gn.line,1),"+transpose")}}}}gj.push(new d0(gn,gn))}gh.setSelections(gj)})},newlineAndIndent:function(gh){cO(gh,function(){var gi=gh.listSelections().length;for(var gk=0;gk<gi;gk++){var gj=gh.listSelections()[gk];gh.replaceRange("\n",gj.anchor,gj.head,"+input");gh.indentLine(gj.from().line+1,null,true);fH(gh)}})},toggleOverwrite:function(gh){gh.toggleOverwrite()}};var fc=J.keyMap={};fc.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};fc.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};fc.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};fc.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};fc["default"]=b9?fc.macDefault:fc.pcDefault;function dv(gi){var go=gi.split(/-(?!$)/),gi=go[go.length-1];var gn,gm,gh,gl;for(var gk=0;gk<go.length-1;gk++){var gj=go[gk];if(/^(cmd|meta|m)$/i.test(gj)){gl=true}else{if(/^a(lt)?$/i.test(gj)){gn=true}else{if(/^(c|ctrl|control)$/i.test(gj)){gm=true}else{if(/^s(hift)$/i.test(gj)){gh=true}else{throw new Error("Unrecognized modifier name: "+gj)}}}}}if(gn){gi="Alt-"+gi}if(gm){gi="Ctrl-"+gi}if(gl){gi="Cmd-"+gi}if(gh){gi="Shift-"+gi}return gi}J.normalizeKeyMap=function(go){var gi={};for(var gn in go){if(go.hasOwnProperty(gn)){var gp=go[gn];if(/^(name|fallthrough|(de|at)tach)$/.test(gn)){continue}if(gp=="..."){delete go[gn];continue}var gq=bU(gn.split(" "),dv);for(var gm=0;gm<gq.length;gm++){var gk,gj;if(gm==gq.length-1){gj=gn;gk=gp}else{gj=gq.slice(0,gm+1).join(" ");gk="..."}var gl=gi[gj];if(!gl){gi[gj]=gk}else{if(gl!=gk){throw new Error("Inconsistent bindings for "+gj)}}}delete go[gn]}}for(var gh in gi){go[gh]=gi[gh]}return go};var j=J.lookupKey=function(gk,gn,gm,gj){gn=fY(gn);var gl=gn.call?gn.call(gk,gj):gn[gk];if(gl===false){return"nothing"}if(gl==="..."){return"multi"}if(gl!=null&&gm(gl)){return"handled"}if(gn.fallthrough){if(Object.prototype.toString.call(gn.fallthrough)!="[object Array]"){return j(gk,gn.fallthrough,gm,gj)}for(var gi=0;gi<gn.fallthrough.length;gi++){var gh=j(gk,gn.fallthrough[gi],gm,gj);if(gh){return gh}}}};var eE=J.isModifierKey=function(gi){var gh=typeof gi=="string"?gi:fi[gi.keyCode];return gh=="Ctrl"||gh=="Alt"||gh=="Shift"||gh=="Mod"};var ft=J.keyName=function(gi,gk){if(d4&&gi.keyCode==34&&gi["char"]){return false}var gj=fi[gi.keyCode],gh=gj;if(gh==null||gi.altGraphKey){return false}if(gi.altKey&&gj!="Alt"){gh="Alt-"+gh}if((bS?gi.metaKey:gi.ctrlKey)&&gj!="Ctrl"){gh="Ctrl-"+gh}if((bS?gi.ctrlKey:gi.metaKey)&&gj!="Cmd"){gh="Cmd-"+gh}if(!gk&&gi.shiftKey&&gj!="Shift"){gh="Shift-"+gh}return gh};function fY(gh){return typeof gh=="string"?fc[gh]:gh}J.fromTextArea=function(go,gp){gp=gp?aP(gp):{};gp.value=go.value;if(!gp.tabindex&&go.tabIndex){gp.tabindex=go.tabIndex}if(!gp.placeholder&&go.placeholder){gp.placeholder=go.placeholder}if(gp.autofocus==null){var gh=dQ();gp.autofocus=gh==go||go.getAttribute("autofocus")!=null&&gh==document.body}function gl(){go.value=gn.getValue()}if(go.form){bZ(go.form,"submit",gl);if(!gp.leaveSubmitMethodAlone){var gi=go.form,gm=gi.submit;try{var gk=gi.submit=function(){gl();gi.submit=gm;gi.submit();gi.submit=gk}}catch(gj){}}}gp.finishInit=function(gq){gq.save=gl;gq.getTextArea=function(){return go};gq.toTextArea=function(){gq.toTextArea=isNaN;gl();go.parentNode.removeChild(gq.getWrapperElement());go.style.display="";if(go.form){ef(go.form,"submit",gl);if(typeof go.form.submit=="function"){go.form.submit=gm}}}};go.style.display="none";var gn=J(function(gq){go.parentNode.insertBefore(gq,go.nextSibling)},gp);return gn};var eV=J.StringStream=function(gh,gi){this.pos=this.start=0;this.string=gh;this.tabSize=gi||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};eV.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(gh){var gj=this.string.charAt(this.pos);if(typeof gh=="string"){var gi=gj==gh}else{var gi=gj&&(gh.test?gh.test(gj):gh(gj))}if(gi){++this.pos;return gj}},eatWhile:function(gh){var gi=this.pos;while(this.eat(gh)){}return this.pos>gi},eatSpace:function(){var gh=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>gh},skipToEnd:function(){this.pos=this.string.length},skipTo:function(gh){var gi=this.string.indexOf(gh,this.pos);if(gi>-1){this.pos=gi;return true}},backUp:function(gh){this.pos-=gh},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bV(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bV(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bV(this.string,null,this.tabSize)-(this.lineStart?bV(this.string,this.lineStart,this.tabSize):0)},match:function(gl,gi,gh){if(typeof gl=="string"){var gm=function(gn){return gh?gn.toLowerCase():gn};var gk=this.string.substr(this.pos,gl.length);if(gm(gk)==gm(gl)){if(gi!==false){this.pos+=gl.length}return true}}else{var gj=this.string.slice(this.pos).match(gl);if(gj&&gj.index>0){return null}if(gj&&gi!==false){this.pos+=gj[0].length}return gj}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(gi,gh){this.lineStart+=gi;try{return gh()}finally{this.lineStart-=gi}}};var a8=0;var R=J.TextMarker=function(gi,gh){this.lines=[];this.type=gh;this.doc=gi;this.id=++a8};bA(R);R.prototype.clear=function(){if(this.explicitlyCleared){return}var go=this.doc.cm,gi=go&&!go.curOp;if(gi){cK(go)}if(fk(this,"clear")){var gp=this.find();if(gp){ag(this,"clear",gp.from,gp.to)}}var gj=null,gm=null;for(var gk=0;gk<this.lines.length;++gk){var gq=this.lines[gk];var gn=fb(gq.markedSpans,this);if(go&&!this.collapsed){T(go,bP(gq),"text")}else{if(go){if(gn.to!=null){gm=bP(gq)}if(gn.from!=null){gj=bP(gq)}}}gq.markedSpans=eJ(gq.markedSpans,gn);if(gn.from==null&&this.collapsed&&!fy(this.doc,gq)&&go){f5(gq,a0(go.display))}}if(go&&this.collapsed&&!go.options.lineWrapping){for(var gk=0;gk<this.lines.length;++gk){var gh=A(this.lines[gk]),gl=ep(gh);if(gl>go.display.maxLineLength){go.display.maxLine=gh;go.display.maxLineLength=gl;go.display.maxLineChanged=true}}}if(gj!=null&&go&&this.collapsed){aj(go,gj,gm+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(go){eA(go.doc)}}if(go){ag(go,"markerCleared",go,this)}if(gi){ao(go)}if(this.parent){this.parent.clear()}};R.prototype.find=function(gk,gi){if(gk==null&&this.type=="bookmark"){gk=1}var gn,gm;for(var gj=0;gj<this.lines.length;++gj){var gh=this.lines[gj];var gl=fb(gh.markedSpans,this);if(gl.from!=null){gn=Y(gi?gh:bP(gh),gl.from);if(gk==-1){return gn}}if(gl.to!=null){gm=Y(gi?gh:bP(gh),gl.to);if(gk==1){return gm}}}return gn&&{from:gn,to:gm}};R.prototype.changed=function(){var gj=this.find(-1,true),gi=this,gh=this.doc.cm;if(!gj||!gh){return}cO(gh,function(){var gl=gj.line,gm=bP(gj.line);var gk=fd(gh,gm);if(gk){aw(gk);gh.curOp.selectionChanged=gh.curOp.forceUpdate=true}gh.curOp.updateMaxLine=true;if(!fy(gi.doc,gl)&&gi.height!=null){var go=gi.height;gi.height=null;var gn=c0(gi)-go;if(gn){f5(gl,gl.height+gn)}}})};R.prototype.attachLine=function(gh){if(!this.lines.length&&this.doc.cm){var gi=this.doc.cm.curOp;if(!gi.maybeHiddenMarkers||dj(gi.maybeHiddenMarkers,this)==-1){(gi.maybeUnhiddenMarkers||(gi.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(gh)};R.prototype.detachLine=function(gh){this.lines.splice(dj(this.lines,gh),1);if(!this.lines.length&&this.doc.cm){var gi=this.doc.cm.curOp;(gi.maybeHiddenMarkers||(gi.maybeHiddenMarkers=[])).push(this)}};var a8=0;function eH(gp,gn,go,gr,gl){if(gr&&gr.shared){return Q(gp,gn,go,gr,gl)}if(gp.cm&&!gp.cm.curOp){return c4(gp.cm,eH)(gp,gn,go,gr,gl)}var gk=new R(gp,gl),gq=ch(gn,go);if(gr){aP(gr,gk,false)}if(gq>0||gq==0&&gk.clearWhenEmpty!==false){return gk}if(gk.replacedWith){gk.collapsed=true;gk.widgetNode=f2("span",[gk.replacedWith],"CodeMirror-widget");if(!gr.handleMouseEvents){gk.widgetNode.setAttribute("cm-ignore-events","true")}if(gr.insertLeft){gk.widgetNode.insertLeft=true}}if(gk.collapsed){if(B(gp,gn.line,gn,go,gk)||gn.line!=go.line&&B(gp,go.line,gn,go,gk)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}ba=true}if(gk.addToHistory){fO(gp,{from:gn,to:go,origin:"markText"},gp.sel,NaN)}var gi=gn.line,gm=gp.cm,gh;gp.iter(gi,go.line+1,function(gs){if(gm&&gk.collapsed&&!gm.options.lineWrapping&&A(gs)==gm.display.maxLine){gh=true}if(gk.collapsed&&gi!=gn.line){f5(gs,0)}cf(gs,new ek(gk,gi==gn.line?gn.ch:null,gi==go.line?go.ch:null));++gi});if(gk.collapsed){gp.iter(gn.line,go.line+1,function(gs){if(fy(gp,gs)){f5(gs,0)}})}if(gk.clearOnEnter){bZ(gk,"beforeCursorEnter",function(){gk.clear()})}if(gk.readOnly){gc=true;if(gp.history.done.length||gp.history.undone.length){gp.clearHistory()}}if(gk.collapsed){gk.id=++a8;gk.atomic=true}if(gm){if(gh){gm.curOp.updateMaxLine=true}if(gk.collapsed){aj(gm,gn.line,go.line+1)}else{if(gk.className||gk.title||gk.startStyle||gk.endStyle||gk.css){for(var gj=gn.line;gj<=go.line;gj++){T(gm,gj,"text")}}}if(gk.atomic){eA(gm.doc)}ag(gm,"markerAdded",gm,gk)}return gk}var z=J.SharedTextMarker=function(gj,gi){this.markers=gj;this.primary=gi;for(var gh=0;gh<gj.length;++gh){gj[gh].parent=this}};bA(z);z.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var gh=0;gh<this.markers.length;++gh){this.markers[gh].clear()}ag(this,"clear")};z.prototype.find=function(gi,gh){return this.primary.find(gi,gh)};function Q(gl,go,gn,gh,gj){gh=aP(gh);gh.shared=false;var gm=[eH(gl,go,gn,gh,gj)],gi=gm[0];var gk=gh.widgetNode;d9(gl,function(gq){if(gk){gh.widgetNode=gk.cloneNode(true)}gm.push(eH(gq,fL(gq,go),fL(gq,gn),gh,gj));for(var gp=0;gp<gq.linked.length;++gp){if(gq.linked[gp].isParent){return}}gi=fI(gm)});return new z(gm,gi)}function eR(gh){return gh.findMarks(Y(gh.first,0),gh.clipPos(Y(gh.lastLine())),function(gi){return gi.parent})}function dH(gm,gn){for(var gk=0;gk<gn.length;gk++){var gi=gn[gk],go=gi.find();var gh=gm.clipPos(go.from),gl=gm.clipPos(go.to);if(ch(gh,gl)){var gj=eH(gm,gh,gl,gi.primary,gi.primary.type);gi.markers.push(gj);gj.parent=gi}}}function eq(gk){for(var gj=0;gj<gk.length;gj++){var gh=gk[gj],gm=[gh.primary.doc];d9(gh.primary.doc,function(gn){gm.push(gn)});for(var gi=0;gi<gh.markers.length;gi++){var gl=gh.markers[gi];if(dj(gm,gl.doc)==-1){gl.parent=null;gh.markers.splice(gi--,1)}}}}function ek(gh,gj,gi){this.marker=gh;this.from=gj;this.to=gi}function fb(gj,gh){if(gj){for(var gi=0;gi<gj.length;++gi){var gk=gj[gi];if(gk.marker==gh){return gk}}}}function eJ(gi,gj){for(var gk,gh=0;gh<gi.length;++gh){if(gi[gh]!=gj){(gk||(gk=[])).push(gi[gh])}}return gk}function cf(gh,gi){gh.markedSpans=gh.markedSpans?gh.markedSpans.concat([gi]):[gi];gi.marker.attachLine(gh)}function aS(gi,gj,gn){if(gi){for(var gl=0,go;gl<gi.length;++gl){var gp=gi[gl],gm=gp.marker;var gh=gp.from==null||(gm.inclusiveLeft?gp.from<=gj:gp.from<gj);if(gh||gp.from==gj&&gm.type=="bookmark"&&(!gn||!gp.marker.insertLeft)){var gk=gp.to==null||(gm.inclusiveRight?gp.to>=gj:gp.to>gj);(go||(go=[])).push(new ek(gm,gp.from,gk?null:gp.to))}}}return go}function aD(gi,gk,gn){if(gi){for(var gl=0,go;gl<gi.length;++gl){var gp=gi[gl],gm=gp.marker;var gj=gp.to==null||(gm.inclusiveRight?gp.to>=gk:gp.to>gk);if(gj||gp.from==gk&&gm.type=="bookmark"&&(!gn||gp.marker.insertLeft)){var gh=gp.from==null||(gm.inclusiveLeft?gp.from<=gk:gp.from<gk);(go||(go=[])).push(new ek(gm,gh?null:gp.from-gk,gp.to==null?null:gp.to-gk))}}}return go}function em(gt,gq){if(gq.full){return null}var gp=cb(gt,gq.from.line)&&fh(gt,gq.from.line).markedSpans;var gw=cb(gt,gq.to.line)&&fh(gt,gq.to.line).markedSpans;if(!gp&&!gw){return null}var gi=gq.from.ch,gl=gq.to.ch,go=ch(gq.from,gq.to)==0;var gn=aS(gp,gi,go);var gv=aD(gw,gl,go);var gu=gq.text.length==1,gj=fI(gq.text).length+(gu?gi:0);if(gn){for(var gk=0;gk<gn.length;++gk){var gs=gn[gk];if(gs.to==null){var gx=fb(gv,gs.marker);if(!gx){gs.to=gi}else{if(gu){gs.to=gx.to==null?null:gx.to+gj}}}}}if(gv){for(var gk=0;gk<gv.length;++gk){var gs=gv[gk];if(gs.to!=null){gs.to+=gj}if(gs.from==null){var gx=fb(gn,gs.marker);if(!gx){gs.from=gj;if(gu){(gn||(gn=[])).push(gs)}}}else{gs.from+=gj;if(gu){(gn||(gn=[])).push(gs)}}}}if(gn){gn=s(gn)}if(gv&&gv!=gn){gv=s(gv)}var gm=[gn];if(!gu){var gr=gq.text.length-2,gh;if(gr>0&&gn){for(var gk=0;gk<gn.length;++gk){if(gn[gk].to==null){(gh||(gh=[])).push(new ek(gn[gk].marker,null,null))}}}for(var gk=0;gk<gr;++gk){gm.push(gh)}gm.push(gv)}return gm}function s(gi){for(var gh=0;gh<gi.length;++gh){var gj=gi[gh];if(gj.from!=null&&gj.from==gj.to&&gj.marker.clearWhenEmpty!==false){gi.splice(gh--,1)}}if(!gi.length){return null}return gi}function eb(gp,gn){var gh=b6(gp,gn);var gq=em(gp,gn);if(!gh){return gq}if(!gq){return gh}for(var gk=0;gk<gh.length;++gk){var gl=gh[gk],gm=gq[gk];if(gl&&gm){spans:for(var gj=0;gj<gm.length;++gj){var go=gm[gj];for(var gi=0;gi<gl.length;++gi){if(gl[gi].marker==go.marker){continue spans}}gl.push(go)}}else{if(gm){gh[gk]=gm}}}return gh}function cJ(gt,gr,gs){var gl=null;gt.iter(gr.line,gs.line+1,function(gu){if(gu.markedSpans){for(var gv=0;gv<gu.markedSpans.length;++gv){var gw=gu.markedSpans[gv].marker;if(gw.readOnly&&(!gl||dj(gl,gw)==-1)){(gl||(gl=[])).push(gw)}}}});if(!gl){return null}var gm=[{from:gr,to:gs}];for(var gn=0;gn<gl.length;++gn){var go=gl[gn],gj=go.find(0);for(var gk=0;gk<gm.length;++gk){var gi=gm[gk];if(ch(gi.to,gj.from)<0||ch(gi.from,gj.to)>0){continue}var gq=[gk,1],gh=ch(gi.from,gj.from),gp=ch(gi.to,gj.to);if(gh<0||!go.inclusiveLeft&&!gh){gq.push({from:gi.from,to:gj.from})}if(gp>0||!go.inclusiveRight&&!gp){gq.push({from:gj.to,to:gi.to})}gm.splice.apply(gm,gq);gk+=gq.length-1}}return gm}function f8(gh){var gj=gh.markedSpans;if(!gj){return}for(var gi=0;gi<gj.length;++gi){gj[gi].marker.detachLine(gh)}gh.markedSpans=null}function c5(gh,gj){if(!gj){return}for(var gi=0;gi<gj.length;++gi){gj[gi].marker.attachLine(gh)}gh.markedSpans=gj}function x(gh){return gh.inclusiveLeft?-1:0}function bY(gh){return gh.inclusiveRight?1:0}function dS(gk,gi){var gm=gk.lines.length-gi.lines.length;if(gm!=0){return gm}var gj=gk.find(),gn=gi.find();var gh=ch(gj.from,gn.from)||x(gk)-x(gi);if(gh){return -gh}var gl=ch(gj.to,gn.to)||bY(gk)-bY(gi);if(gl){return gl}return gi.id-gk.id}function a9(gi,gm){var gh=ba&&gi.markedSpans,gl;if(gh){for(var gk,gj=0;gj<gh.length;++gj){gk=gh[gj];if(gk.marker.collapsed&&(gm?gk.from:gk.to)==null&&(!gl||dS(gl,gk.marker)<0)){gl=gk.marker}}}return gl}function eQ(gh){return a9(gh,true)}function ey(gh){return a9(gh,false)}function B(gp,gj,gn,go,gl){var gs=fh(gp,gj);var gh=ba&&gs.markedSpans;if(gh){for(var gk=0;gk<gh.length;++gk){var gi=gh[gk];if(!gi.marker.collapsed){continue}var gr=gi.marker.find(0);var gq=ch(gr.from,gn)||x(gi.marker)-x(gl);var gm=ch(gr.to,go)||bY(gi.marker)-bY(gl);if(gq>=0&&gm<=0||gq<=0&&gm>=0){continue}if(gq<=0&&(ch(gr.to,gn)>0||(gi.marker.inclusiveRight&&gl.inclusiveLeft))||gq>=0&&(ch(gr.from,go)<0||(gi.marker.inclusiveLeft&&gl.inclusiveRight))){return true}}}}function A(gi){var gh;while(gh=eQ(gi)){gi=gh.find(-1,true).line}return gi}function i(gj){var gh,gi;while(gh=ey(gj)){gj=gh.find(1,true).line;(gi||(gi=[])).push(gj)}return gi}function aY(gk,gi){var gh=fh(gk,gi),gj=A(gh);if(gh==gj){return gi}return bP(gj)}function d5(gk,gj){if(gj>gk.lastLine()){return gj}var gi=fh(gk,gj),gh;if(!fy(gk,gi)){return gj}while(gh=ey(gi)){gi=gh.find(1,true).line}return bP(gi)+1}function fy(gl,gi){var gh=ba&&gi.markedSpans;if(gh){for(var gk,gj=0;gj<gh.length;++gj){gk=gh[gj];if(!gk.marker.collapsed){continue}if(gk.from==null){return true}if(gk.marker.widgetNode){continue}if(gk.from==0&&gk.marker.inclusiveLeft&&V(gl,gi,gk)){return true}}}}function V(gm,gi,gk){if(gk.to==null){var gh=gk.marker.find(1,true);return V(gm,gh.line,fb(gh.line.markedSpans,gk.marker))}if(gk.marker.inclusiveRight&&gk.to==gi.text.length){return true}for(var gl,gj=0;gj<gi.markedSpans.length;++gj){gl=gi.markedSpans[gj];if(gl.marker.collapsed&&!gl.marker.widgetNode&&gl.from==gk.to&&(gl.to==null||gl.to!=gk.from)&&(gl.marker.inclusiveLeft||gk.marker.inclusiveRight)&&V(gm,gi,gl)){return true}}}var dD=J.LineWidget=function(gk,gj,gh){if(gh){for(var gi in gh){if(gh.hasOwnProperty(gi)){this[gi]=gh[gi]}}}this.doc=gk;this.node=gj};bA(dD);function d1(gh,gi,gj){if(bO(gi)<((gh.curOp&&gh.curOp.scrollTop)||gh.doc.scrollTop)){cN(gh,null,gj)}}dD.prototype.clear=function(){var gi=this.doc.cm,gk=this.line.widgets,gj=this.line,gm=bP(gj);if(gm==null||!gk){return}for(var gl=0;gl<gk.length;++gl){if(gk[gl]==this){gk.splice(gl--,1)}}if(!gk.length){gj.widgets=null}var gh=c0(this);f5(gj,Math.max(0,gj.height-gh));if(gi){cO(gi,function(){d1(gi,gj,-gh);T(gi,gm,"widget")})}};dD.prototype.changed=function(){var gi=this.height,gh=this.doc.cm,gj=this.line;this.height=null;var gk=c0(this)-gi;if(!gk){return}f5(gj,gj.height+gk);if(gh){cO(gh,function(){gh.curOp.forceUpdate=true;d1(gh,gj,gk)})}};function c0(gj){if(gj.height!=null){return gj.height}var gh=gj.doc.cm;if(!gh){return 0}if(!ga(document.body,gj.node)){var gi="position: relative;";if(gj.coverGutter){gi+="margin-left: -"+gh.display.gutters.offsetWidth+"px;"}if(gj.noHScroll){gi+="width: "+gh.display.wrapper.clientWidth+"px;"}bT(gh.display.measure,f2("div",[gj.node],null,gi))}return gj.height=gj.node.offsetHeight}function bJ(gm,gl,gj,gi){var gk=new dD(gm,gj,gi);var gh=gm.cm;if(gh&&gk.noHScroll){gh.display.alignWidgets=true}eB(gm,gl,"widget",function(go){var gp=go.widgets||(go.widgets=[]);if(gk.insertAt==null){gp.push(gk)}else{gp.splice(Math.min(gp.length-1,Math.max(0,gk.insertAt)),0,gk)}gk.line=go;if(gh&&!fy(gm,go)){var gn=bO(go)<gm.scrollTop;f5(go,go.height+c0(gk));if(gn){cN(gh,null,gk.height)}gh.curOp.forceUpdate=true}return true});return gk}var f6=J.Line=function(gj,gi,gh){this.text=gj;c5(this,gi);this.height=gh?gh(this):1};bA(f6);f6.prototype.lineNo=function(){return bP(this)};function eo(gi,gl,gj,gh){gi.text=gl;if(gi.stateAfter){gi.stateAfter=null}if(gi.styles){gi.styles=null}if(gi.order!=null){gi.order=null}f8(gi);c5(gi,gj);var gk=gh?gh(gi):1;if(gk!=gi.height){f5(gi,gk)}}function bD(gh){gh.parent=null;f8(gh)}function dk(gj,gi){if(gj){for(;;){var gh=gj.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!gh){break}gj=gj.slice(0,gh.index)+gj.slice(gh.index+gh[0].length);var gk=gh[1]?"bgClass":"textClass";if(gi[gk]==null){gi[gk]=gh[2]}else{if(!(new RegExp("(?:^|s)"+gh[2]+"(?:$|s)")).test(gi[gk])){gi[gk]+=" "+gh[2]}}}}return gj}function fs(gj,gi){if(gj.blankLine){return gj.blankLine(gi)}if(!gj.innerMode){return}var gh=J.innerMode(gj,gi);if(gh.mode.blankLine){return gh.mode.blankLine(gh.state)}}function eC(gm,gl,gk,gh){for(var gi=0;gi<10;gi++){if(gh){gh[0]=J.innerMode(gm,gk).mode}var gj=gm.token(gl,gk);if(gl.pos>gl.start){return gj}}throw new Error("Mode "+gm.name+" failed to advance stream.")}function cs(gq,go,gl,gk){function gh(gt){return{start:gr.start,end:gr.pos,string:gr.current(),type:gj||null,state:gt?b5(gp.mode,gi):gi}}var gp=gq.doc,gm=gp.mode,gj;go=fL(gp,go);var gs=fh(gp,go.line),gi=dE(gq,go.line,gl);var gr=new eV(gs.text,gq.options.tabSize),gn;if(gk){gn=[]}while((gk||gr.pos<go.ch)&&!gr.eol()){gr.start=gr.pos;gj=eC(gm,gr,gi);if(gk){gn.push(gh(true))}}return gk?gn:gh()}function y(gr,gt,gm,gi,gn,gk,gl){var gj=gm.flattenSpans;if(gj==null){gj=gr.options.flattenSpans}var gp=0,go=null;var gs=new eV(gt,gr.options.tabSize),gh;var gv=gr.options.addModeClass&&[null];if(gt==""){dk(fs(gm,gi),gk)}while(!gs.eol()){if(gs.pos>gr.options.maxHighlightLength){gj=false;if(gl){dz(gr,gt,gi,gs.pos)}gs.pos=gt.length;gh=null}else{gh=dk(eC(gm,gs,gi,gv),gk)}if(gv){var gu=gv[0].name;if(gu){gh="m-"+(gh?gu+" "+gh:gu)}}if(!gj||go!=gh){while(gp<gs.start){gp=Math.min(gs.start,gp+50000);gn(gp,go)}go=gh}gs.start=gs.pos}while(gp<gs.pos){var gq=Math.min(gs.pos,gp+50000);gn(gq,go);gp=gq}}function fB(go,gq,gh,gl){var gp=[go.state.modeGen],gk={};y(go,gq.text,go.doc.mode,gh,function(gr,gs){gp.push(gr,gs)},gk,gl);for(var gi=0;gi<go.state.overlays.length;++gi){var gm=go.state.overlays[gi],gn=1,gj=0;y(go,gq.text,gm.mode,true,function(gr,gt){var gv=gn;while(gj<gr){var gs=gp[gn];if(gs>gr){gp.splice(gn,1,gr,gp[gn+1],gs)}gn+=2;gj=Math.min(gr,gs)}if(!gt){return}if(gm.opaque){gp.splice(gv,gn-gv,gr,"cm-overlay "+gt);gn=gv+2}else{for(;gv<gn;gv+=2){var gu=gp[gv+1];gp[gv+1]=(gu?gu+" ":"")+"cm-overlay "+gt}}},gk)}return{styles:gp,classes:gk.bgClass||gk.textClass?gk:null}}function c8(gi,gj,gk){if(!gj.styles||gj.styles[0]!=gi.state.modeGen){var gh=fB(gi,gj,gj.stateAfter=dE(gi,bP(gj)));gj.styles=gh.styles;if(gh.classes){gj.styleClasses=gh.classes}else{if(gj.styleClasses){gj.styleClasses=null}}if(gk===gi.doc.frontier){gi.doc.frontier++}}return gj.styles}function dz(gh,gm,gj,gi){var gl=gh.doc.mode;var gk=new eV(gm,gh.options.tabSize);gk.start=gk.pos=gi||0;if(gm==""){fs(gl,gj)}while(!gk.eol()&&gk.pos<=gh.options.maxHighlightLength){eC(gl,gk,gj);gk.start=gk.pos}}var dY={},b3={};function eY(gj,gi){if(!gj||/^\s*$/.test(gj)){return null}var gh=gi.addModeClass?b3:dY;return gh[gj]||(gh[gj]=gj.replace(/\S+/g,"cm-$&"))}function eT(gi,gm){var gn=f2("span",null,null,c2?"padding-right: .1px":null);var gk={pre:f2("pre",[gn]),content:gn,col:0,pos:0,cm:gi,splitSpaces:(dM||c2)&&gi.getOption("lineWrapping")};gm.measure={};for(var gl=0;gl<=(gm.rest?gm.rest.length:0);gl++){var gj=gl?gm.rest[gl-1]:gm.line,gh;gk.pos=0;gk.addToken=v;if(bQ(gi.display.measure)&&(gh=b(gj))){gk.addToken=W(gk.addToken,gh)}gk.map=[];var go=gm!=gi.display.externalMeasured&&bP(gj);bq(gj,gk,c8(gi,gj,go));if(gj.styleClasses){if(gj.styleClasses.bgClass){gk.bgClass=fU(gj.styleClasses.bgClass,gk.bgClass||"")}if(gj.styleClasses.textClass){gk.textClass=fU(gj.styleClasses.textClass,gk.textClass||"")}}if(gk.map.length==0){gk.map.push(0,0,gk.content.appendChild(bp(gi.display.measure)))}if(gl==0){gm.measure.map=gk.map;gm.measure.cache={}}else{(gm.measure.maps||(gm.measure.maps=[])).push(gk.map);(gm.measure.caches||(gm.measure.caches=[])).push({})}}if(c2&&/\bcm-tab\b/.test(gk.content.lastChild.className)){gk.content.className="cm-tab-wrap-hack"}aG(gi,"renderLine",gi,gm.line,gk.pre);if(gk.pre.className){gk.textClass=fU(gk.pre.className,gk.textClass||"")}return gk}function fe(gi){var gh=f2("span","\u2022","cm-invalidchar");gh.title="\\u"+gi.charCodeAt(0).toString(16);gh.setAttribute("aria-label",gh.title);return gh}function v(gs,gn,gx,gu,gq,gz,gm){if(!gn){return}var gw=gs.splitSpaces?gn.replace(/ {3,}/g,cH):gn;var gh=gs.cm.state.specialChars,gi=false;if(!gh.test(gn)){gs.col+=gn.length;var gv=document.createTextNode(gw);gs.map.push(gs.pos,gs.pos+gn.length,gv);if(dM&&m<9){gi=true}gs.pos+=gn.length}else{var gv=document.createDocumentFragment(),gk=0;while(true){gh.lastIndex=gk;var gt=gh.exec(gn);var gy=gt?gt.index-gk:gn.length-gk;if(gy){var gp=document.createTextNode(gw.slice(gk,gk+gy));if(dM&&m<9){gv.appendChild(f2("span",[gp]))}else{gv.appendChild(gp)}gs.map.push(gs.pos,gs.pos+gy,gp);gs.col+=gy;gs.pos+=gy}if(!gt){break}gk+=gy+1;if(gt[0]=="\t"){var gr=gs.cm.options.tabSize,go=gr-gs.col%gr;var gp=gv.appendChild(f2("span",cr(go),"cm-tab"));gp.setAttribute("role","presentation");gp.setAttribute("cm-text","\t");gs.col+=go}else{var gp=gs.cm.options.specialCharPlaceholder(gt[0]);gp.setAttribute("cm-text",gt[0]);if(dM&&m<9){gv.appendChild(f2("span",[gp]))}else{gv.appendChild(gp)}gs.col+=1}gs.map.push(gs.pos,gs.pos+1,gp);gs.pos++}}if(gx||gu||gq||gi||gm){var gj=gx||"";if(gu){gj+=gu}if(gq){gj+=gq}var gl=f2("span",[gv],gj,gm);if(gz){gl.title=gz}return gs.content.appendChild(gl)}gs.content.appendChild(gv)}function cH(gh){var gi=" ";for(var gj=0;gj<gh.length-2;++gj){gi+=gj%2?" ":"\u00a0"}gi+=" ";return gi}function W(gi,gh){return function(gq,gs,gj,gn,gt,gr,gp){gj=gj?gj+" cm-force-border":"cm-force-border";var gk=gq.pos,gm=gk+gs.length;for(;;){for(var go=0;go<gh.length;go++){var gl=gh[go];if(gl.to>gk&&gl.from<=gk){break}}if(gl.to>=gm){return gi(gq,gs,gj,gn,gt,gr,gp)}gi(gq,gs.slice(0,gl.to-gk),gj,gn,null,gr,gp);gn=null;gs=gs.slice(gl.to-gk);gk=gl.to}}}function ae(gi,gk,gh,gj){var gl=!gj&&gh.widgetNode;if(gl){gi.map.push(gi.pos,gi.pos+gk,gl)}if(!gj&&gi.cm.display.input.needsContentAttribute){if(!gl){gl=gi.content.appendChild(document.createElement("span"))}gl.setAttribute("cm-marker",gh.id)}if(gl){gi.cm.display.input.setUneditable(gl);gi.content.appendChild(gl)}gi.pos+=gk}function bq(gq,gx,gp){var gm=gq.markedSpans,go=gq.text,gv=0;if(!gm){for(var gA=1;gA<gp.length;gA+=2){gx.addToken(gx,go.slice(gv,gv=gp[gA]),eY(gp[gA+1],gx.cm.options))}return}var gB=go.length,gl=0,gA=1,gt="",gC,gr;var gE=0,gh,gD,gu,gF,gj;for(;;){if(gE==gl){gh=gD=gu=gF=gr="";gj=null;gE=Infinity;var gn=[];for(var gy=0;gy<gm.length;++gy){var gz=gm[gy],gw=gz.marker;if(gz.from<=gl&&(gz.to==null||gz.to>gl)){if(gz.to!=null&&gE>gz.to){gE=gz.to;gD=""}if(gw.className){gh+=" "+gw.className}if(gw.css){gr=gw.css}if(gw.startStyle&&gz.from==gl){gu+=" "+gw.startStyle}if(gw.endStyle&&gz.to==gE){gD+=" "+gw.endStyle}if(gw.title&&!gF){gF=gw.title}if(gw.collapsed&&(!gj||dS(gj.marker,gw)<0)){gj=gz}}else{if(gz.from>gl&&gE>gz.from){gE=gz.from}}if(gw.type=="bookmark"&&gz.from==gl&&gw.widgetNode){gn.push(gw)}}if(gj&&(gj.from||0)==gl){ae(gx,(gj.to==null?gB+1:gj.to)-gl,gj.marker,gj.from==null);if(gj.to==null){return}}if(!gj&&gn.length){for(var gy=0;gy<gn.length;++gy){ae(gx,0,gn[gy])}}}if(gl>=gB){break}var gs=Math.min(gB,gE);while(true){if(gt){var gi=gl+gt.length;if(!gj){var gk=gi>gs?gt.slice(0,gs-gl):gt;gx.addToken(gx,gk,gC?gC+gh:gh,gu,gl+gk.length==gE?gD:"",gF,gr)}if(gi>=gs){gt=gt.slice(gs-gl);gl=gs;break}gl=gi;gu=""}gt=go.slice(gv,gv=gp[gA++]);gC=eY(gp[gA++],gx.cm.options)}}}function dU(gh,gi){return gi.from.ch==0&&gi.to.ch==0&&fI(gi.text)==""&&(!gh.cm||gh.cm.options.wholeLineUpdateBefore)}function fA(gu,gp,gi,gl){function gv(gx){return gi?gi[gx]:null}function gj(gx,gz,gy){eo(gx,gz,gy,gl);ag(gx,"change",gx,gp)}function gh(gA,gy){for(var gz=gA,gx=[];gz<gy;++gz){gx.push(new f6(gw[gz],gv(gz),gl))}return gx}var gt=gp.from,gs=gp.to,gw=gp.text;var gq=fh(gu,gt.line),gr=fh(gu,gs.line);var go=fI(gw),gk=gv(gw.length-1),gn=gs.line-gt.line;if(gp.full){gu.insert(0,gh(0,gw.length));gu.remove(gw.length,gu.size-gw.length)}else{if(dU(gu,gp)){var gm=gh(0,gw.length-1);gj(gr,gr.text,gk);if(gn){gu.remove(gt.line,gn)}if(gm.length){gu.insert(gt.line,gm)}}else{if(gq==gr){if(gw.length==1){gj(gq,gq.text.slice(0,gt.ch)+go+gq.text.slice(gs.ch),gk)}else{var gm=gh(1,gw.length-1);gm.push(new f6(go+gq.text.slice(gs.ch),gk,gl));gj(gq,gq.text.slice(0,gt.ch)+gw[0],gv(0));gu.insert(gt.line+1,gm)}}else{if(gw.length==1){gj(gq,gq.text.slice(0,gt.ch)+gw[0]+gr.text.slice(gs.ch),gv(0));gu.remove(gt.line+1,gn)}else{gj(gq,gq.text.slice(0,gt.ch)+gw[0],gv(0));gj(gr,go+gr.text.slice(gs.ch),gk);var gm=gh(1,gw.length-1);if(gn>1){gu.remove(gt.line+1,gn-1)}gu.insert(gt.line+1,gm)}}}}ag(gu,"change",gu,gp)}function e1(gi){this.lines=gi;this.parent=null;for(var gj=0,gh=0;gj<gi.length;++gj){gi[gj].parent=this;gh+=gi[gj].height}this.height=gh}e1.prototype={chunkSize:function(){return this.lines.length},removeInner:function(gh,gl){for(var gj=gh,gk=gh+gl;gj<gk;++gj){var gi=this.lines[gj];this.height-=gi.height;bD(gi);ag(gi,"delete")}this.lines.splice(gh,gl)},collapse:function(gh){gh.push.apply(gh,this.lines)},insertInner:function(gi,gj,gh){this.height+=gh;this.lines=this.lines.slice(0,gi).concat(gj).concat(this.lines.slice(gi));for(var gk=0;gk<gj.length;++gk){gj[gk].parent=this}},iterN:function(gh,gk,gj){for(var gi=gh+gk;gh<gi;++gh){if(gj(this.lines[gh])){return true}}}};function fz(gk){this.children=gk;var gj=0,gh=0;for(var gi=0;gi<gk.length;++gi){var gl=gk[gi];gj+=gl.chunkSize();gh+=gl.height;gl.parent=this}this.size=gj;this.height=gh;this.parent=null}fz.prototype={chunkSize:function(){return this.size},removeInner:function(gh,go){this.size-=go;for(var gj=0;gj<this.children.length;++gj){var gn=this.children[gj],gl=gn.chunkSize();if(gh<gl){var gk=Math.min(go,gl-gh),gm=gn.height;gn.removeInner(gh,gk);this.height-=gm-gn.height;if(gl==gk){this.children.splice(gj--,1);gn.parent=null}if((go-=gk)==0){break}gh=0}else{gh-=gl}}if(this.size-go<25&&(this.children.length>1||!(this.children[0] instanceof e1))){var gi=[];this.collapse(gi);this.children=[new e1(gi)];this.children[0].parent=this}},collapse:function(gh){for(var gi=0;gi<this.children.length;++gi){this.children[gi].collapse(gh)}},insertInner:function(gi,gj,gh){this.size+=gj.length;this.height+=gh;for(var gm=0;gm<this.children.length;++gm){var go=this.children[gm],gn=go.chunkSize();if(gi<=gn){go.insertInner(gi,gj,gh);if(go.lines&&go.lines.length>50){while(go.lines.length>50){var gl=go.lines.splice(go.lines.length-25,25);var gk=new e1(gl);go.height-=gk.height;this.children.splice(gm+1,0,gk);gk.parent=this}this.maybeSpill()}break}gi-=gn}},maybeSpill:function(){if(this.children.length<=10){return}var gk=this;do{var gi=gk.children.splice(gk.children.length-5,5);var gj=new fz(gi);if(!gk.parent){var gl=new fz(gk.children);gl.parent=gk;gk.children=[gl,gj];gk=gl}else{gk.size-=gj.size;gk.height-=gj.height;var gh=dj(gk.parent.children,gk);gk.parent.children.splice(gh+1,0,gj)}gj.parent=gk.parent}while(gk.children.length>10);gk.parent.maybeSpill()},iterN:function(gh,gn,gm){for(var gi=0;gi<this.children.length;++gi){var gl=this.children[gi],gk=gl.chunkSize();if(gh<gk){var gj=Math.min(gn,gk-gh);if(gl.iterN(gh,gj,gm)){return true}if((gn-=gj)==0){break}gh=0}else{gh-=gk}}}};var ct=0;var av=J.Doc=function(gj,gi,gh){if(!(this instanceof av)){return new av(gj,gi,gh)}if(gh==null){gh=0}fz.call(this,[new e1([new f6("",null)])]);this.first=gh;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=gh;var gk=Y(gh,0);this.sel=eU(gk);this.history=new fV(null);this.id=++ct;this.modeOption=gi;if(typeof gj=="string"){gj=a3(gj)}fA(this,{from:gk,to:gk,text:gj});bW(this,eU(gk),ab)};av.prototype=cm(fz.prototype,{constructor:av,iter:function(gj,gi,gh){if(gh){this.iterN(gj-this.first,gi-gj,gh)}else{this.iterN(this.first,this.first+this.size,gj)}},insert:function(gi,gj){var gh=0;for(var gk=0;gk<gj.length;++gk){gh+=gj[gk].height}this.insertInner(gi-this.first,gj,gh)},remove:function(gh,gi){this.removeInner(gh-this.first,gi)},getValue:function(gi){var gh=a5(this,this.first,this.first+this.size);if(gi===false){return gh}return gh.join(gi||"\n")},setValue:cF(function(gi){var gj=Y(this.first,0),gh=this.first+this.size-1;bi(this,{from:gj,to:Y(gh,fh(this,gh).text.length),text:a3(gi),origin:"setValue",full:true},true);bW(this,eU(gj))}),replaceRange:function(gi,gk,gj,gh){gk=fL(this,gk);gj=gj?fL(this,gj):gk;a4(this,gi,gk,gj,gh)},getRange:function(gk,gj,gi){var gh=f4(this,fL(this,gk),fL(this,gj));if(gi===false){return gh}return gh.join(gi||"\n")},getLine:function(gi){var gh=this.getLineHandle(gi);return gh&&gh.text},getLineHandle:function(gh){if(cb(this,gh)){return fh(this,gh)}},getLineNumber:function(gh){return bP(gh)},getLineHandleVisualStart:function(gh){if(typeof gh=="number"){gh=fh(this,gh)}return A(gh)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(gh){return fL(this,gh)},getCursor:function(gj){var gh=this.sel.primary(),gi;if(gj==null||gj=="head"){gi=gh.head}else{if(gj=="anchor"){gi=gh.anchor}else{if(gj=="end"||gj=="to"||gj===false){gi=gh.to()}else{gi=gh.from()}}}return gi},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cF(function(gh,gj,gi){H(this,fL(this,typeof gh=="number"?Y(gh,gj||0):gh),null,gi)}),setSelection:cF(function(gi,gj,gh){H(this,fL(this,gi),fL(this,gj||gi),gh)}),extendSelection:cF(function(gj,gh,gi){fX(this,fL(this,gj),gh&&fL(this,gh),gi)}),extendSelections:cF(function(gi,gh){ay(this,d2(this,gi,gh))}),extendSelectionsBy:cF(function(gi,gh){ay(this,bU(this.sel.ranges,gi),gh)}),setSelections:cF(function(gh,gl,gj){if(!gh.length){return}for(var gk=0,gi=[];gk<gh.length;gk++){gi[gk]=new d0(fL(this,gh[gk].anchor),fL(this,gh[gk].head))}if(gl==null){gl=Math.min(gh.length-1,this.sel.primIndex)}bW(this,cy(gi,gl),gj)}),addSelection:cF(function(gj,gk,gi){var gh=this.sel.ranges.slice(0);gh.push(new d0(fL(this,gj),fL(this,gk||gj)));bW(this,cy(gh,gh.length-1),gi)}),getSelection:function(gl){var gi=this.sel.ranges,gh;for(var gj=0;gj<gi.length;gj++){var gk=f4(this,gi[gj].from(),gi[gj].to());gh=gh?gh.concat(gk):gk}if(gl===false){return gh}else{return gh.join(gl||"\n")}},getSelections:function(gl){var gk=[],gh=this.sel.ranges;for(var gi=0;gi<gh.length;gi++){var gj=f4(this,gh[gi].from(),gh[gi].to());if(gl!==false){gj=gj.join(gl||"\n")}gk[gi]=gj}return gk},replaceSelection:function(gj,gl,gh){var gk=[];for(var gi=0;gi<this.sel.ranges.length;gi++){gk[gi]=gj}this.replaceSelections(gk,gl,gh||"+input")},replaceSelections:cF(function(gm,go,gj){var gl=[],gn=this.sel;for(var gk=0;gk<gn.ranges.length;gk++){var gi=gn.ranges[gk];gl[gk]={from:gi.from(),to:gi.to(),text:a3(gm[gk]),origin:gj}}var gh=go&&go!="end"&&ah(this,gl,go);for(var gk=gl.length-1;gk>=0;gk--){bi(this,gl[gk])}if(gh){e9(this,gh)}else{if(this.cm){fH(this.cm)}}}),undo:cF(function(){ca(this,"undo")}),redo:cF(function(){ca(this,"redo")}),undoSelection:cF(function(){ca(this,"undo",true)}),redoSelection:cF(function(){ca(this,"redo",true)}),setExtending:function(gh){this.extend=gh},getExtending:function(){return this.extend},historySize:function(){var gk=this.history,gh=0,gj=0;for(var gi=0;gi<gk.done.length;gi++){if(!gk.done[gi].ranges){++gh}}for(var gi=0;gi<gk.undone.length;gi++){if(!gk.undone[gi].ranges){++gj}}return{undo:gh,redo:gj}},clearHistory:function(){this.history=new fV(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(gh){if(gh){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gh){return this.history.generation==(gh||this.cleanGeneration)},getHistory:function(){return{done:bR(this.history.done),undone:bR(this.history.undone)}},setHistory:function(gi){var gh=this.history=new fV(this.history.maxGeneration);gh.done=bR(gi.done.slice(0),null,true);gh.undone=bR(gi.undone.slice(0),null,true)},addLineClass:cF(function(gj,gi,gh){return eB(this,gj,gi=="gutter"?"gutter":"class",function(gk){var gl=gi=="text"?"textClass":gi=="background"?"bgClass":gi=="gutter"?"gutterClass":"wrapClass";if(!gk[gl]){gk[gl]=gh}else{if(U(gh).test(gk[gl])){return false}else{gk[gl]+=" "+gh}}return true})}),removeLineClass:cF(function(gj,gi,gh){return eB(this,gj,gi=="gutter"?"gutter":"class",function(gl){var go=gi=="text"?"textClass":gi=="background"?"bgClass":gi=="gutter"?"gutterClass":"wrapClass";var gn=gl[go];if(!gn){return false}else{if(gh==null){gl[go]=null}else{var gm=gn.match(U(gh));if(!gm){return false}var gk=gm.index+gm[0].length;gl[go]=gn.slice(0,gm.index)+(!gm.index||gk==gn.length?"":" ")+gn.slice(gk)||null}}return true})}),addLineWidget:cF(function(gj,gi,gh){return bJ(this,gj,gi,gh)}),removeLineWidget:function(gh){gh.clear()},markText:function(gj,gi,gh){return eH(this,fL(this,gj),fL(this,gi),gh,"range")},setBookmark:function(gj,gh){var gi={replacedWith:gh&&(gh.nodeType==null?gh.widget:gh),insertLeft:gh&&gh.insertLeft,clearWhenEmpty:false,shared:gh&&gh.shared,handleMouseEvents:gh&&gh.handleMouseEvents};gj=fL(this,gj);return eH(this,gj,gj,gi,"bookmark")},findMarksAt:function(gl){gl=fL(this,gl);var gk=[],gi=fh(this,gl.line).markedSpans;if(gi){for(var gh=0;gh<gi.length;++gh){var gj=gi[gh];if((gj.from==null||gj.from<=gl.ch)&&(gj.to==null||gj.to>=gl.ch)){gk.push(gj.marker.parent||gj.marker)}}}return gk},findMarks:function(gl,gk,gh){gl=fL(this,gl);gk=fL(this,gk);var gi=[],gj=gl.line;this.iter(gl.line,gk.line+1,function(gm){var go=gm.markedSpans;if(go){for(var gn=0;gn<go.length;gn++){var gp=go[gn];if(!(gj==gl.line&&gl.ch>gp.to||gp.from==null&&gj!=gl.line||gj==gk.line&&gp.from>gk.ch)&&(!gh||gh(gp.marker))){gi.push(gp.marker.parent||gp.marker)}}}++gj});return gi},getAllMarks:function(){var gh=[];this.iter(function(gj){var gi=gj.markedSpans;if(gi){for(var gk=0;gk<gi.length;++gk){if(gi[gk].from!=null){gh.push(gi[gk].marker)}}}});return gh},posFromIndex:function(gi){var gh,gj=this.first;this.iter(function(gk){var gl=gk.text.length+1;if(gl>gi){gh=gi;return true}gi-=gl;++gj});return fL(this,Y(gj,gh))},indexFromPos:function(gi){gi=fL(this,gi);var gh=gi.ch;if(gi.line<this.first||gi.ch<0){return 0}this.iter(this.first,gi.line,function(gj){gh+=gj.text.length+1});return gh},copy:function(gh){var gi=new av(a5(this,this.first,this.first+this.size),this.modeOption,this.first);gi.scrollTop=this.scrollTop;gi.scrollLeft=this.scrollLeft;gi.sel=this.sel;gi.extend=false;if(gh){gi.history.undoDepth=this.history.undoDepth;gi.setHistory(this.getHistory())}return gi},linkedDoc:function(gh){if(!gh){gh={}}var gk=this.first,gj=this.first+this.size;if(gh.from!=null&&gh.from>gk){gk=gh.from}if(gh.to!=null&&gh.to<gj){gj=gh.to}var gi=new av(a5(this,gk,gj),gh.mode||this.modeOption,gk);if(gh.sharedHist){gi.history=this.history}(this.linked||(this.linked=[])).push({doc:gi,sharedHist:gh.sharedHist});gi.linked=[{doc:this,isParent:true,sharedHist:gh.sharedHist}];dH(gi,eR(this));return gi},unlinkDoc:function(gi){if(gi instanceof J){gi=gi.doc}if(this.linked){for(var gj=0;gj<this.linked.length;++gj){var gk=this.linked[gj];if(gk.doc!=gi){continue}this.linked.splice(gj,1);gi.unlinkDoc(this);eq(eR(this));break}}if(gi.history==this.history){var gh=[gi.id];d9(gi,function(gl){gh.push(gl.id)},true);gi.history=new fV(null);gi.history.done=bR(this.history.done,gh);gi.history.undone=bR(this.history.undone,gh)}},iterLinkedDocs:function(gh){d9(this,gh)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});av.prototype.eachLine=av.prototype.iter;var e="iter insert remove copy getEditor".split(" ");for(var bM in av.prototype){if(av.prototype.hasOwnProperty(bM)&&dj(e,bM)<0){J.prototype[bM]=(function(gh){return function(){return gh.apply(this.doc,arguments)}})(av.prototype[bM])}}bA(av);function d9(gk,gj,gi){function gh(gq,go,gm){if(gq.linked){for(var gn=0;gn<gq.linked.length;++gn){var gl=gq.linked[gn];if(gl.doc==go){continue}var gp=gm&&gl.sharedHist;if(gi&&!gp){continue}gj(gl.doc,gp);gh(gl.doc,gq,gp)}}}gh(gk,null,true)}function ed(gh,gi){if(gi.cm){throw new Error("This document is already in use.")}gh.doc=gi;gi.cm=gh;Z(gh);bt(gh);if(!gh.options.lineWrapping){h(gh)}gh.options.mode=gi.modeOption;aj(gh)}function fh(gk,gm){gm-=gk.first;if(gm<0||gm>=gk.size){throw new Error("There is no line "+(gm+gk.first)+" in the document.")}for(var gh=gk;!gh.lines;){for(var gi=0;;++gi){var gl=gh.children[gi],gj=gl.chunkSize();if(gm<gj){gh=gl;break}gm-=gj}}return gh.lines[gm]}function f4(gj,gl,gh){var gi=[],gk=gl.line;gj.iter(gl.line,gh.line+1,function(gm){var gn=gm.text;if(gk==gh.line){gn=gn.slice(0,gh.ch)}if(gk==gl.line){gn=gn.slice(gl.ch)}gi.push(gn);++gk});return gi}function a5(gi,gk,gj){var gh=[];gi.iter(gk,gj,function(gl){gh.push(gl.text)});return gh}function f5(gi,gh){var gj=gh-gi.height;if(gj){for(var gk=gi;gk;gk=gk.parent){gk.height+=gj}}}function bP(gh){if(gh.parent==null){return null}var gl=gh.parent,gk=dj(gl.lines,gh);for(var gi=gl.parent;gi;gl=gi,gi=gi.parent){for(var gj=0;;++gj){if(gi.children[gj]==gl){break}gk+=gi.children[gj].chunkSize()}}return gk+gl.first}function bI(gj,gm){var go=gj.first;outer:do{for(var gk=0;gk<gj.children.length;++gk){var gn=gj.children[gk],gl=gn.height;if(gm<gl){gj=gn;continue outer}gm-=gl;go+=gn.chunkSize()}return go}while(!gj.lines);for(var gk=0;gk<gj.lines.length;++gk){var gi=gj.lines[gk],gh=gi.height;if(gm<gh){break}gm-=gh}return go+gk}function bO(gj){gj=A(gj);var gl=0,gi=gj.parent;for(var gk=0;gk<gi.lines.length;++gk){var gh=gi.lines[gk];if(gh==gj){break}else{gl+=gh.height}}for(var gm=gi.parent;gm;gi=gm,gm=gi.parent){for(var gk=0;gk<gm.children.length;++gk){var gn=gm.children[gk];if(gn==gi){break}else{gl+=gn.height}}}return gl}function b(gi){var gh=gi.order;if(gh==null){gh=gi.order=bj(gi.text)}return gh}function fV(gh){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=gh||1}function dw(gh,gj){var gi={from:ck(gj.from),to:cZ(gj),text:f4(gh,gj.from,gj.to)};b0(gh,gi,gj.from.line,gj.to.line+1);d9(gh,function(gk){b0(gk,gi,gj.from.line,gj.to.line+1)},true);return gi}function fD(gi){while(gi.length){var gh=fI(gi);if(gh.ranges){gi.pop()}else{break}}}function eO(gi,gh){if(gh){fD(gi.done);return fI(gi.done)}else{if(gi.done.length&&!fI(gi.done).ranges){return fI(gi.done)}else{if(gi.done.length>1&&!gi.done[gi.done.length-2].ranges){gi.done.pop();return fI(gi.done)}}}}function fO(gn,gl,gh,gk){var gj=gn.history;gj.undone.length=0;var gi=+new Date,go;if((gj.lastOp==gk||gj.lastOrigin==gl.origin&&gl.origin&&((gl.origin.charAt(0)=="+"&&gn.cm&&gj.lastModTime>gi-gn.cm.options.historyEventDelay)||gl.origin.charAt(0)=="*"))&&(go=eO(gj,gj.lastOp==gk))){var gp=fI(go.changes);if(ch(gl.from,gl.to)==0&&ch(gl.from,gp.to)==0){gp.to=cZ(gl)}else{go.changes.push(dw(gn,gl))}}else{var gm=fI(gj.done);if(!gm||!gm.ranges){cP(gn.sel,gj.done)}go={changes:[dw(gn,gl)],generation:gj.generation};gj.done.push(go);while(gj.done.length>gj.undoDepth){gj.done.shift();if(!gj.done[0].ranges){gj.done.shift()}}}gj.done.push(gh);gj.generation=++gj.maxGeneration;gj.lastModTime=gj.lastSelTime=gi;gj.lastOp=gj.lastSelOp=gk;gj.lastOrigin=gj.lastSelOrigin=gl.origin;if(!gp){aG(gn,"historyAdded")}}function bC(gl,gh,gj,gk){var gi=gh.charAt(0);return gi=="*"||gi=="+"&&gj.ranges.length==gk.ranges.length&&gj.somethingSelected()==gk.somethingSelected()&&new Date-gl.history.lastSelTime<=(gl.cm?gl.cm.options.historyEventDelay:500)}function gb(gm,gk,gh,gj){var gl=gm.history,gi=gj&&gj.origin;if(gh==gl.lastSelOp||(gi&&gl.lastSelOrigin==gi&&(gl.lastModTime==gl.lastSelTime&&gl.lastOrigin==gi||bC(gm,gi,fI(gl.done),gk)))){gl.done[gl.done.length-1]=gk}else{cP(gk,gl.done)}gl.lastSelTime=+new Date;gl.lastSelOrigin=gi;gl.lastSelOp=gh;if(gj&&gj.clearRedo!==false){fD(gl.undone)}}function cP(gi,gh){var gj=fI(gh);if(!(gj&&gj.ranges&&gj.equals(gi))){gh.push(gi)}}function b0(gi,gm,gl,gk){var gh=gm["spans_"+gi.id],gj=0;gi.iter(Math.max(gi.first,gl),Math.min(gi.first+gi.size,gk),function(gn){if(gn.markedSpans){(gh||(gh=gm["spans_"+gi.id]={}))[gj]=gn.markedSpans}++gj})}function bn(gj){if(!gj){return null}for(var gi=0,gh;gi<gj.length;++gi){if(gj[gi].marker.explicitlyCleared){if(!gh){gh=gj.slice(0,gi)}}else{if(gh){gh.push(gj[gi])}}}return !gh?gj:gh.length?gh:null}function b6(gk,gl){var gj=gl["spans_"+gk.id];if(!gj){return null}for(var gi=0,gh=[];gi<gl.text.length;++gi){gh.push(bn(gj[gi]))}return gh}function bR(gs,gk,gr){for(var gn=0,gi=[];gn<gs.length;++gn){var gj=gs[gn];if(gj.ranges){gi.push(gr?f3.prototype.deepCopy.call(gj):gj);continue}var gp=gj.changes,gq=[];gi.push({changes:gq});for(var gm=0;gm<gp.length;++gm){var go=gp[gm],gl;gq.push({from:go.from,to:go.to,text:go.text});if(gk){for(var gh in go){if(gl=gh.match(/^spans_(\d+)$/)){if(dj(gk,Number(gl[1]))>-1){fI(gq)[gh]=go[gh];delete go[gh]}}}}}}return gi}function K(gk,gj,gi,gh){if(gi<gk.line){gk.line+=gh}else{if(gj<gk.line){gk.line=gj;gk.ch=0}}}function fj(gk,gm,gn,go){for(var gj=0;gj<gk.length;++gj){var gh=gk[gj],gl=true;if(gh.ranges){if(!gh.copied){gh=gk[gj]=gh.deepCopy();gh.copied=true}for(var gi=0;gi<gh.ranges.length;gi++){K(gh.ranges[gi].anchor,gm,gn,go);K(gh.ranges[gi].head,gm,gn,go)}continue}for(var gi=0;gi<gh.changes.length;++gi){var gp=gh.changes[gi];if(gn<gp.from.line){gp.from=Y(gp.from.line+go,gp.from.ch);gp.to=Y(gp.to.line+go,gp.to.ch)}else{if(gm<=gp.to.line){gl=false;break}}}if(!gl){gk.splice(0,gj+1);gj=0}}}function dG(gi,gl){var gk=gl.from.line,gj=gl.to.line,gh=gl.text.length-(gj-gk)-1;fj(gi.done,gk,gj,gh);fj(gi.undone,gk,gj,gh)}var cI=J.e_preventDefault=function(gh){if(gh.preventDefault){gh.preventDefault()}else{gh.returnValue=false}};var ds=J.e_stopPropagation=function(gh){if(gh.stopPropagation){gh.stopPropagation()}else{gh.cancelBubble=true}};function bN(gh){return gh.defaultPrevented!=null?gh.defaultPrevented:gh.returnValue==false}var et=J.e_stop=function(gh){cI(gh);ds(gh)};function N(gh){return gh.target||gh.srcElement}function fP(gi){var gh=gi.which;if(gh==null){if(gi.button&1){gh=1}else{if(gi.button&2){gh=3}else{if(gi.button&4){gh=2}}}}if(b9&&gi.ctrlKey&&gh==1){gh=3}return gh}var bZ=J.on=function(gk,gi,gj){if(gk.addEventListener){gk.addEventListener(gi,gj,false)}else{if(gk.attachEvent){gk.attachEvent("on"+gi,gj)}else{var gl=gk._handlers||(gk._handlers={});var gh=gl[gi]||(gl[gi]=[]);gh.push(gj)}}};var ef=J.off=function(gl,gj,gk){if(gl.removeEventListener){gl.removeEventListener(gj,gk,false)}else{if(gl.detachEvent){gl.detachEvent("on"+gj,gk)}else{var gh=gl._handlers&&gl._handlers[gj];if(!gh){return}for(var gi=0;gi<gh.length;++gi){if(gh[gi]==gk){gh.splice(gi,1);break}}}}};var aG=J.signal=function(gl,gk){var gh=gl._handlers&&gl._handlers[gk];if(!gh){return}var gi=Array.prototype.slice.call(arguments,2);for(var gj=0;gj<gh.length;++gj){gh[gj].apply(null,gi)}};var bB=null;function ag(gn,gl){var gh=gn._handlers&&gn._handlers[gl];if(!gh){return}var gj=Array.prototype.slice.call(arguments,2),gm;if(br){gm=br.delayedCallbacks}else{if(bB){gm=bB}else{gm=bB=[];setTimeout(aO,0)}}function gi(go){return function(){go.apply(null,gj)}}for(var gk=0;gk<gh.length;++gk){gm.push(gi(gh[gk]))}}function aO(){var gh=bB;bB=null;for(var gi=0;gi<gh.length;++gi){gh[gi]()}}function aT(gh,gj,gi){if(typeof gj=="string"){gj={type:gj,preventDefault:function(){this.defaultPrevented=true}}}aG(gh,gi||gj.type,gh,gj);return bN(gj)||gj.codemirrorIgnore}function X(gi){var gh=gi._handlers&&gi._handlers.cursorActivity;if(!gh){return}var gk=gi.curOp.cursorActivityHandlers||(gi.curOp.cursorActivityHandlers=[]);for(var gj=0;gj<gh.length;++gj){if(dj(gk,gh[gj])==-1){gk.push(gh[gj])}}}function fk(gj,gi){var gh=gj._handlers&&gj._handlers[gi];return gh&&gh.length>0}function bA(gh){gh.prototype.on=function(gi,gj){bZ(this,gi,gj)};gh.prototype.off=function(gi,gj){ef(this,gi,gj)}}var dL=30;var cc=J.Pass={toString:function(){return"CodeMirror.Pass"}};var ab={scroll:false},O={origin:"*mouse"},cY={origin:"+move"};function gg(){this.id=null}gg.prototype.set=function(gh,gi){clearTimeout(this.id);this.id=setTimeout(gi,gh)};var bV=J.countColumn=function(gk,gi,gm,gn,gj){if(gi==null){gi=gk.search(/[^\s\u00a0]/);if(gi==-1){gi=gk.length}}for(var gl=gn||0,go=gj||0;;){var gh=gk.indexOf("\t",gl);if(gh<0||gh>=gi){return go+(gi-gl)}go+=gh-gl;go+=gm-(go%gm);gl=gh+1}};function es(gl,gk,gm){for(var gn=0,gj=0;;){var gi=gl.indexOf("\t",gn);if(gi==-1){gi=gl.length}var gh=gi-gn;if(gi==gl.length||gj+gh>=gk){return gn+Math.min(gh,gk-gj)}gj+=gi-gn;gj+=gm-(gj%gm);gn=gi+1;if(gj>=gk){return gn}}}var a2=[""];function cr(gh){while(a2.length<=gh){a2.push(fI(a2)+" ")}return a2[gh]}function fI(gh){return gh[gh.length-1]}var dN=function(gh){gh.select()};if(e3){dN=function(gh){gh.selectionStart=0;gh.selectionEnd=gh.value.length}}else{if(dM){dN=function(gi){try{gi.select()}catch(gh){}}}}function dj(gj,gh){for(var gi=0;gi<gj.length;++gi){if(gj[gi]==gh){return gi}}return -1}function bU(gk,gj){var gh=[];for(var gi=0;gi<gk.length;gi++){gh[gi]=gj(gk[gi],gi)}return gh}function fW(){}function cm(gj,gh){var gi;if(Object.create){gi=Object.create(gj)}else{fW.prototype=gj;gi=new fW()}if(gh){aP(gh,gi)}return gi}function aP(gj,gi,gh){if(!gi){gi={}}for(var gk in gj){if(gj.hasOwnProperty(gk)&&(gh!==false||!gi.hasOwnProperty(gk))){gi[gk]=gj[gk]}}return gi}function cx(gi){var gh=Array.prototype.slice.call(arguments,1);return function(){return gi.apply(null,gh)}}var be=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fF=J.isWordChar=function(gh){return/\w/.test(gh)||gh>"\x80"&&(gh.toUpperCase()!=gh.toLowerCase()||be.test(gh))};function cC(gh,gi){if(!gi){return fF(gh)}if(gi.source.indexOf("\\w")>-1&&fF(gh)){return true}return gi.test(gh)}function eW(gh){for(var gi in gh){if(gh.hasOwnProperty(gi)&&gh[gi]){return false}}return true}var eL=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function fr(gh){return gh.charCodeAt(0)>=768&&eL.test(gh)}function f2(gh,gl,gk,gj){var gm=document.createElement(gh);if(gk){gm.className=gk}if(gj){gm.style.cssText=gj}if(typeof gl=="string"){gm.appendChild(document.createTextNode(gl))}else{if(gl){for(var gi=0;gi<gl.length;++gi){gm.appendChild(gl[gi])}}}return gm}var cn;if(document.createRange){cn=function(gk,gl,gi,gh){var gj=document.createRange();gj.setEnd(gh||gk,gi);gj.setStart(gk,gl);return gj}}else{cn=function(gj,gl,gh){var gi=document.body.createTextRange();try{gi.moveToElementText(gj.parentNode)}catch(gk){return gi}gi.collapse(true);gi.moveEnd("character",gh);gi.moveStart("character",gl);return gi}}function d3(gi){for(var gh=gi.childNodes.length;gh>0;--gh){gi.removeChild(gi.firstChild)}return gi}function bT(gh,gi){return d3(gh).appendChild(gi)}var ga=J.contains=function(gh,gi){if(gi.nodeType==3){gi=gi.parentNode}if(gh.contains){return gh.contains(gi)}do{if(gi.nodeType==11){gi=gi.host}if(gi==gh){return true}}while(gi=gi.parentNode)};function dQ(){return document.activeElement}if(dM&&m<11){dQ=function(){try{return document.activeElement}catch(gh){return document.body}}}function U(gh){return new RegExp("(^|\\s)"+gh+"(?:$|\\s)\\s*")}var g=J.rmClass=function(gj,gh){var gk=gj.className;var gi=U(gh).exec(gk);if(gi){var gl=gk.slice(gi.index+gi[0].length);gj.className=gk.slice(0,gi.index)+(gl?gi[1]+gl:"")}};var fC=J.addClass=function(gi,gh){var gj=gi.className;if(!U(gh).test(gj)){gi.className+=(gj?" ":"")+gh}};function fU(gj,gh){var gi=gj.split(" ");for(var gk=0;gk<gi.length;gk++){if(gi[gk]&&!U(gi[gk]).test(gh)){gh+=" "+gi[gk]}}return gh}function aC(gk){if(!document.body.getElementsByClassName){return}var gj=document.body.getElementsByClassName("CodeMirror");for(var gi=0;gi<gj.length;gi++){var gh=gj[gi].CodeMirror;if(gh){gk(gh)}}}var cE=false;function bl(){if(cE){return}fG();cE=true}function fG(){var gh;bZ(window,"resize",function(){if(gh==null){gh=setTimeout(function(){gh=null;aC(aV)},100)}});bZ(window,"blur",function(){aC(aX)})}var eN=function(){if(dM&&m<9){return false}var gh=f2("div");return"draggable" in gh||"dragDrop" in gh}();var fN;function bp(gh){if(fN==null){var gj=f2("span","\u200b");bT(gh,f2("span",[gj,document.createTextNode("x")]));if(gh.firstChild.offsetHeight!=0){fN=gj.offsetWidth<=1&&gj.offsetHeight>2&&!(dM&&m<8)}}var gi=fN?f2("span","\u200b"):f2("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");gi.setAttribute("cm-text","");return gi}var fM;function bQ(gk){if(fM!=null){return fM}var gh=bT(gk,document.createTextNode("A\u062eA"));var gj=cn(gh,0,1).getBoundingClientRect();if(!gj||gj.left==gj.right){return false}var gi=cn(gh,1,2).getBoundingClientRect();return fM=(gi.right-gj.right<3)}var a3=J.splitLines="\n\nb".split(/\n/).length!=3?function(gm){var gn=0,gh=[],gl=gm.length;while(gn<=gl){var gk=gm.indexOf("\n",gn);if(gk==-1){gk=gm.length}var gj=gm.slice(gn,gm.charAt(gk-1)=="\r"?gk-1:gk);var gi=gj.indexOf("\r");if(gi!=-1){gh.push(gj.slice(0,gi));gn+=gi+1}else{gh.push(gj);gn=gk+1}}return gh}:function(gh){return gh.split(/\r\n?|\n/)};var bu=window.getSelection?function(gi){try{return gi.selectionStart!=gi.selectionEnd}catch(gh){return false}}:function(gj){try{var gh=gj.ownerDocument.selection.createRange()}catch(gi){}if(!gh||gh.parentElement()!=gj){return false}return gh.compareEndPoints("StartToEnd",gh)!=0};var dc=(function(){var gh=f2("div");if("oncopy" in gh){return true}gh.setAttribute("oncopy","return;");return typeof gh.oncopy=="function"})();var e8=null;function aM(gi){if(e8!=null){return e8}var gj=bT(gi,f2("span","x"));var gk=gj.getBoundingClientRect();var gh=cn(gj,0,1).getBoundingClientRect();return e8=Math.abs(gk.left-gh.left)>1}var fi={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};J.keyNames=fi;(function(){for(var gh=0;gh<10;gh++){fi[gh+48]=fi[gh+96]=String(gh)}for(var gh=65;gh<=90;gh++){fi[gh]=String.fromCharCode(gh)}for(var gh=1;gh<=12;gh++){fi[gh+111]=fi[gh+63235]="F"+gh}})();function d6(gh,gn,gm,gl){if(!gh){return gl(gn,gm,"ltr")}var gk=false;for(var gj=0;gj<gh.length;++gj){var gi=gh[gj];if(gi.from<gm&&gi.to>gn||gn==gm&&gi.to==gn){gl(Math.max(gi.from,gn),Math.min(gi.to,gm),gi.level==1?"rtl":"ltr");gk=true}}if(!gk){gl(gn,gm,"ltr")}}function dA(gh){return gh.level%2?gh.to:gh.from}function gd(gh){return gh.level%2?gh.from:gh.to}function cG(gi){var gh=b(gi);return gh?dA(gh[0]):0}function cU(gi){var gh=b(gi);if(!gh){return gi.text.length}return gd(fI(gh))}function bv(gi,gl){var gj=fh(gi.doc,gl);var gm=A(gj);if(gm!=gj){gl=bP(gm)}var gh=b(gm);var gk=!gh?0:gh[0].level%2?cU(gm):cG(gm);return Y(gl,gk)}function dR(gj,gm){var gi,gk=fh(gj.doc,gm);while(gi=ey(gk)){gk=gi.find(1,true).line;gm=null}var gh=b(gk);var gl=!gh?gk.text.length:gh[0].level%2?cG(gk):cU(gk);return Y(gm==null?bP(gk):gm,gl)}function dK(gi,gn){var gm=bv(gi,gn.line);var gj=fh(gi.doc,gm.line);var gh=b(gj);if(!gh||gh[0].level==0){var gl=Math.max(0,gj.text.search(/\S/));var gk=gn.line==gm.line&&gn.ch<=gl&&gn.ch;return Y(gm.line,gk?0:gl)}return gm}function ap(gi,gj,gh){var gk=gi[0].level;if(gj==gk){return true}if(gh==gk){return false}return gj<gh}var e4;function aI(gh,gl){e4=null;for(var gi=0,gj;gi<gh.length;++gi){var gk=gh[gi];if(gk.from<gl&&gk.to>gl){return gi}if((gk.from==gl||gk.to==gl)){if(gj==null){gj=gi}else{if(ap(gh,gk.level,gh[gj].level)){if(gk.from!=gk.to){e4=gj}return gi}else{if(gk.from!=gk.to){e4=gi}return gj}}}}return gj}function fg(gh,gk,gi,gj){if(!gj){return gk+gi}do{gk+=gi}while(gk>0&&fr(gh.text.charAt(gk)));return gk}function w(gh,go,gj,gk){var gl=b(gh);if(!gl){return ak(gh,go,gj,gk)}var gn=aI(gl,go),gi=gl[gn];var gm=fg(gh,go,gi.level%2?-gj:gj,gk);for(;;){if(gm>gi.from&&gm<gi.to){return gm}if(gm==gi.from||gm==gi.to){if(aI(gl,gm)==gn){return gm}gi=gl[gn+=gj];return(gj>0)==gi.level%2?gi.to:gi.from}else{gi=gl[gn+=gj];if(!gi){return null}if((gj>0)==gi.level%2){gm=fg(gh,gi.to,-1,gk)}else{gm=fg(gh,gi.from,1,gk)}}}}function ak(gh,gl,gi,gj){var gk=gl+gi;if(gj){while(gk>0&&fr(gh.text.charAt(gk))){gk+=gi}}return gk<0||gk>gh.text.length?null:gk}var bj=(function(){var gn="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var gl="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function gk(gr){if(gr<=247){return gn.charAt(gr)}else{if(1424<=gr&&gr<=1524){return"R"}else{if(1536<=gr&&gr<=1773){return gl.charAt(gr-1536)}else{if(1774<=gr&&gr<=2220){return"r"}else{if(8192<=gr&&gr<=8203){return"w"}else{if(gr==8204){return"b"}else{return"L"}}}}}}}var gh=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var gq=/[stwN]/,gj=/[LRr]/,gi=/[Lb1n]/,gm=/[1n]/;var gp="L";function go(gt,gs,gr){this.level=gt;this.from=gs;this.to=gr}return function(gB){if(!gh.test(gB)){return false}var gH=gB.length,gx=[];for(var gG=0,gt;gG<gH;++gG){gx.push(gt=gk(gB.charCodeAt(gG)))}for(var gG=0,gA=gp;gG<gH;++gG){var gt=gx[gG];if(gt=="m"){gx[gG]=gA}else{gA=gt}}for(var gG=0,gr=gp;gG<gH;++gG){var gt=gx[gG];if(gt=="1"&&gr=="r"){gx[gG]="n"}else{if(gj.test(gt)){gr=gt;if(gt=="r"){gx[gG]="R"}}}}for(var gG=1,gA=gx[0];gG<gH-1;++gG){var gt=gx[gG];if(gt=="+"&&gA=="1"&&gx[gG+1]=="1"){gx[gG]="1"}else{if(gt==","&&gA==gx[gG+1]&&(gA=="1"||gA=="n")){gx[gG]=gA}}gA=gt}for(var gG=0;gG<gH;++gG){var gt=gx[gG];if(gt==","){gx[gG]="N"}else{if(gt=="%"){for(var gu=gG+1;gu<gH&&gx[gu]=="%";++gu){}var gI=(gG&&gx[gG-1]=="!")||(gu<gH&&gx[gu]=="1")?"1":"N";for(var gE=gG;gE<gu;++gE){gx[gE]=gI}gG=gu-1}}}for(var gG=0,gr=gp;gG<gH;++gG){var gt=gx[gG];if(gr=="L"&&gt=="1"){gx[gG]="L"}else{if(gj.test(gt)){gr=gt}}}for(var gG=0;gG<gH;++gG){if(gq.test(gx[gG])){for(var gu=gG+1;gu<gH&&gq.test(gx[gu]);++gu){}var gy=(gG?gx[gG-1]:gp)=="L";var gs=(gu<gH?gx[gu]:gp)=="L";var gI=gy||gs?"L":"R";for(var gE=gG;gE<gu;++gE){gx[gE]=gI}gG=gu-1}}var gF=[],gC;for(var gG=0;gG<gH;){if(gi.test(gx[gG])){var gv=gG;for(++gG;gG<gH&&gi.test(gx[gG]);++gG){}gF.push(new go(0,gv,gG))}else{var gw=gG,gz=gF.length;for(++gG;gG<gH&&gx[gG]!="L";++gG){}for(var gE=gw;gE<gG;){if(gm.test(gx[gE])){if(gw<gE){gF.splice(gz,0,new go(1,gw,gE))}var gD=gE;for(++gE;gE<gG&&gm.test(gx[gE]);++gE){}gF.splice(gz,0,new go(2,gD,gE));gw=gE}else{++gE}}if(gw<gG){gF.splice(gz,0,new go(1,gw,gG))}}}if(gF[0].level==1&&(gC=gB.match(/^\s+/))){gF[0].from=gC[0].length;gF.unshift(new go(0,0,gC[0].length))}if(fI(gF).level==1&&(gC=gB.match(/\s+$/))){fI(gF).to-=gC[0].length;gF.push(new go(0,gH-gC[0].length,gH))}if(gF[0].level!=fI(gF).level){gF.push(new go(gF[0].level,gH,gH))}return gF}})();J.version="5.1.0";return J});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){var c={};var f=/[^\s\u00a0]/;var d=b.Pos;function e(h){var g=h.search(f);return g==-1?0:g}b.commands.toggleComment=function(g){var l=Infinity,h=g.listSelections(),m=null;for(var j=h.length-1;j>=0;j--){var o=h[j].from(),n=h[j].to();if(o.line>=l){continue}if(n.line>=l){n=d(l,0)}l=o.line;if(m==null){if(g.uncomment(o,n)){m="un"}else{g.lineComment(o,n);m="line"}}else{if(m=="un"){g.uncomment(o,n)}else{g.lineComment(o,n)}}}};b.defineExtension("lineComment",function(m,n,q){if(!q){q=c}var o=this,i=o.getModeAt(m);var p=q.lineComment||i.lineComment;if(!p){if(q.blockCommentStart||i.blockCommentStart){q.fullLines=true;o.blockComment(m,n,q)}return}var l=o.getLine(m.line);if(l==null){return}var h=Math.min(n.ch!=0||n.line==m.line?n.line+1:n.line,o.lastLine()+1);var g=q.padding==null?" ":q.padding;var j=q.commentBlankLines||m.line==n.line;o.operation(function(){if(q.indent){var t=l.slice(0,e(l));for(var s=m.line;s<h;++s){var r=o.getLine(s),u=t.length;if(!j&&!f.test(r)){continue}if(r.slice(0,u)!=t){u=e(r)}o.replaceRange(t+p+g,d(s,0),d(s,u))}}else{for(var s=m.line;s<h;++s){if(j||f.test(o.getLine(s))){o.replaceRange(p+g,d(s,0))}}}})});b.defineExtension("blockComment",function(l,m,p){if(!p){p=c}var o=this,i=o.getModeAt(l);var j=p.blockCommentStart||i.blockCommentStart;var n=p.blockCommentEnd||i.blockCommentEnd;if(!j||!n){if((p.lineComment||i.lineComment)&&p.fullLines!=false){o.lineComment(l,m,p)}return}var h=Math.min(m.line,o.lastLine());if(h!=l.line&&m.ch==0&&f.test(o.getLine(h))){--h}var g=p.padding==null?" ":p.padding;if(l.line>h){return}o.operation(function(){if(p.fullLines!=false){var s=f.test(o.getLine(h));o.replaceRange(g+n,d(h));o.replaceRange(j+g,d(l.line,0));var q=p.blockCommentLead||i.blockCommentLead;if(q!=null){for(var r=l.line+1;r<=h;++r){if(r!=h||s){o.replaceRange(q+g,d(r,0))}}}}else{o.replaceRange(n,m);o.replaceRange(j,l)}})});b.defineExtension("uncomment",function(B,l,m){if(!m){m=c}var y=this,v=y.getModeAt(B);var n=Math.min(l.ch!=0||l.line==B.line?l.line:l.line-1,y.lastLine()),o=Math.min(B.line,n);var x=m.lineComment||v.lineComment,j=[];var E=m.padding==null?" ":m.padding,q;lineComment:{if(!x){break lineComment}for(var C=o;C<=n;++C){var r=y.getLine(C);var s=r.indexOf(x);if(s>-1&&!/comment/.test(y.getTokenTypeAt(d(C,s+1)))){s=-1}if(s==-1&&(C!=n||C==o)&&f.test(r)){break lineComment}if(s>-1&&f.test(r.slice(0,s))){break lineComment}j.push(r)}y.operation(function(){for(var I=o;I<=n;++I){var G=j[I-o];var J=G.indexOf(x),H=J+x.length;if(J<0){continue}if(G.slice(H,H+E.length)==E){H+=E.length}q=true;y.replaceRange("",d(I,J),d(I,H))}});if(q){return true}}var t=m.blockCommentStart||v.blockCommentStart;var g=m.blockCommentEnd||v.blockCommentEnd;if(!t||!g){return false}var D=m.blockCommentLead||v.blockCommentLead;var A=y.getLine(o),p=n==o?A:y.getLine(n);var u=A.indexOf(t),w=p.lastIndexOf(g);if(w==-1&&o!=n){p=y.getLine(--n);w=p.lastIndexOf(g)}if(u==-1||w==-1||!/comment/.test(y.getTokenTypeAt(d(o,u+1)))||!/comment/.test(y.getTokenTypeAt(d(n,w+1)))){return false}var z=A.lastIndexOf(t,B.ch);var F=z==-1?-1:A.slice(0,B.ch).indexOf(g,z+t.length);if(z!=-1&&F!=-1&&F+g.length!=B.ch){return false}F=p.indexOf(g,l.ch);var h=p.slice(l.ch).lastIndexOf(t,F-l.ch);z=(F==-1||h==-1)?-1:l.ch+h;if(F!=-1&&z!=-1&&z!=l.ch){return false}y.operation(function(){y.replaceRange("",d(n,w-(E&&p.slice(w-E.length,w)==E?E.length:0)),d(n,w+g.length));var J=u+t.length;if(E&&A.slice(J,J+E.length)==E){J+=E.length}y.replaceRange("",d(o,u),d(o,J));if(D){for(var I=o+1;I<=n;++I){var H=y.getLine(I),K=H.indexOf(D);if(K==-1||f.test(H.slice(0,K))){continue}var G=K+D.length;if(E&&H.slice(G,G+E.length)==E){G+=E.length}y.replaceRange("",d(I,K),d(I,G))}}});return true})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(f){var e=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var j=f.Pos;var b={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function g(s,o,r,m){var u=s.getLineHandle(o.line),q=o.ch-1;var p=(q>=0&&b[u.text.charAt(q)])||b[u.text.charAt(++q)];if(!p){return null}var n=p.charAt(1)==">"?1:-1;if(r&&(n>0)!=(q==o.ch)){return null}var l=s.getTokenTypeAt(j(o.line,q+1));var t=h(s,j(o.line,q+(n>0?1:0)),n,l||null,m);if(t==null){return null}return{from:j(o.line,q),to:t&&t.pos,match:t&&t.ch==p.charAt(0),forward:n>0}}function h(y,t,p,m,o){var n=(o&&o.maxScanLineLength)||10000;var v=(o&&o.maxScanLines)||1000;var x=[];var z=o&&o.bracketRegex?o.bracketRegex:/[(){}[\]]/;var s=p>0?Math.min(t.line+v,y.lastLine()+1):Math.max(y.firstLine()-1,t.line-v);for(var q=t.line;q!=s;q+=p){var A=y.getLine(q);if(!A){continue}var w=p>0?0:A.length-1,r=p>0?A.length:-1;if(A.length>n){continue}if(q==t.line){w=t.ch-(p<0?1:0)}for(;w!=r;w+=p){var l=A.charAt(w);if(z.test(l)&&(m===undefined||y.getTokenTypeAt(j(q,w+1))==m)){var u=b[l];if((u.charAt(1)==">")==(p>0)){x.push(l)}else{if(!x.length){return{pos:j(q,w),ch:l}}else{x.pop()}}}}}return q-p==(p>0?y.lastLine():y.firstLine())?false:null}function c(u,p,o){var m=u.state.matchBrackets.maxHighlightLineLength||1000;var t=[],n=u.listSelections();for(var q=0;q<n.length;q++){var s=n[q].empty()&&g(u,n[q].head,false,o);if(s&&u.getLine(s.from.line).length<=m){var l=s.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";t.push(u.markText(s.from,j(s.from.line,s.from.ch+1),{className:l}));if(s.to&&u.getLine(s.to.line).length<=m){t.push(u.markText(s.to,j(s.to.line,s.to.ch+1),{className:l}))}}}if(t.length){if(e&&u.state.focused){u.focus()}var r=function(){u.operation(function(){for(var v=0;v<t.length;v++){t[v].clear()}})};if(p){setTimeout(r,800)}else{return r}}}var d=null;function i(l){l.operation(function(){if(d){d();d=null}d=c(l,false,l.state.matchBrackets)})}f.defineOption("matchBrackets",false,function(l,n,m){if(m&&m!=f.Init){l.off("cursorActivity",i)}if(n){l.state.matchBrackets=typeof n=="object"?n:{};l.on("cursorActivity",i)}});f.defineExtension("matchBrackets",function(){c(this,true)});f.defineExtension("findMatchingBracket",function(n,l,m){return g(this,n,l,m)});f.defineExtension("scanForBracket",function(o,m,n,l){return h(this,o,m,n,l)})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"),"cjs")}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],function(c){b(c,"amd")})}else{b(CodeMirror,"plain")}}})(function(b,d){if(!b.modeURL){b.modeURL="../mode/%N/%N.js"}var f={};function e(g,i){var h=i;return function(){if(--h==0){g()}}}function c(n,g){var m=b.modes[n].dependencies;if(!m){return g()}var l=[];for(var j=0;j<m.length;++j){if(!b.modes.hasOwnProperty(m[j])){l.push(m[j])}}if(!l.length){return g()}var h=e(g,l.length);for(var j=0;j<l.length;++j){b.requireMode(l[j],h)}}b.requireMode=function(m,g){if(typeof m!="string"){m=m.name}if(b.modes.hasOwnProperty(m)){return c(m,g)}if(f.hasOwnProperty(m)){return f[m].push(g)}var i=b.modeURL.replace(/%N/g,m);if(d=="plain"){var h=document.createElement("script");h.src=i;var j=document.getElementsByTagName("script")[0];var l=f[m]=[g];b.on(h,"load",function(){c(m,function(){for(var n=0;n<l.length;++n){l[n]()}})});j.parentNode.insertBefore(h,j)}else{if(d=="cjs"){require(i);g()}else{if(d=="amd"){requirejs([i],g)}}}};b.autoLoadMode=function(g,h){if(!b.modes.hasOwnProperty(h)){b.requireMode(h,function(){g.setOption("mode",g.getOption("mode"))})}}});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(e){var h="CodeMirror-hint";var g="CodeMirror-hint-active";e.showHint=function(n,o,p){if(!o){return n.showHint(p)}if(p&&p.async){o.async=true}var q={hint:o};if(p){for(var r in p){q[r]=p[r]}}return n.showHint(q)};var l=0;function f(o,n,p,q){if(o.async){var r=++l;o(n,function(s){if(l==r){q(s)}},p)}else{q(o(n,p))}}e.defineExtension("showHint",function(p){if(this.listSelections().length>1||this.somethingSelected()){return}if(this.state.completionActive){this.state.completionActive.close()}var o=this.state.completionActive=new b(this,p);var n=o.options.hint;if(!n){return}e.signal(this,"startCompletion",this);return f(n,this,o.options,function(q){o.showHints(q)})});function b(n,o){this.cm=n;this.options=this.buildOptions(o);this.widget=this.onClose=null}b.prototype={close:function(){if(!this.active()){return}this.cm.state.completionActive=null;if(this.widget){this.widget.close()}if(this.onClose){this.onClose()}e.signal(this.cm,"endCompletion",this.cm)},active:function(){return this.cm.state.completionActive==this},pick:function(p,o){var n=p.list[o];if(n.hint){n.hint(this.cm,p,n)}else{this.cm.replaceRange(m(n),n.from||p.from,n.to||p.to,"complete")}e.signal(p,"pick",n);this.close()},showHints:function(n){if(!n||!n.list.length||!this.active()){return this.close()}if(this.options.completeSingle&&n.list.length==1){this.pick(n,0)}else{this.showWidget(n)}},showWidget:function(s){this.widget=new j(this,s);e.signal(s,"shown");var z=0,p=this,o;var A=this.options.closeCharacters;var w=this.cm.getCursor(),t=this.cm.getLine(w.line).length;var x=window.requestAnimationFrame||function(B){return setTimeout(B,1000/60)};var u=window.cancelAnimationFrame||clearTimeout;function r(){if(o){return}o=true;p.close();p.cm.off("cursorActivity",n);if(s){e.signal(s,"close")}}function q(){if(o){return}e.signal(s,"update");f(p.options.hint,p.cm,p.options,y)}function y(B){s=B;if(o){return}if(!s||!s.list.length){return r()}if(p.widget){p.widget.close()}p.widget=new j(p,s)}function v(){if(z){u(z);z=0}}function n(){v();var C=p.cm.getCursor(),B=p.cm.getLine(C.line);if(C.line!=w.line||B.length-C.ch!=t-w.ch||C.ch<w.ch||p.cm.somethingSelected()||(C.ch&&A.test(B.charAt(C.ch-1)))){p.close()}else{z=x(q);if(p.widget){p.widget.close()}}}this.cm.on("cursorActivity",n);this.onClose=r},buildOptions:function(o){var p=this.cm.options.hintOptions;var n={};for(var q in c){n[q]=c[q]}if(p){for(var q in p){if(p[q]!==undefined){n[q]=p[q]}}}if(o){for(var q in o){if(o[q]!==undefined){n[q]=o[q]}}}return n}};function m(n){if(typeof n=="string"){return n}else{return n.text}}function d(r,u){var o={Up:function(){u.moveFocus(-1)},Down:function(){u.moveFocus(1)},PageUp:function(){u.moveFocus(-u.menuSize()+1,true)},PageDown:function(){u.moveFocus(u.menuSize()-1,true)},Home:function(){u.setFocus(0)},End:function(){u.setFocus(u.length-1)},Enter:u.pick,Tab:u.pick,Esc:u.close};var t=r.options.customKeys;var q=t?{}:o;function p(v,x){var w;if(typeof x!="string"){w=function(y){return x(y,u)}}else{if(o.hasOwnProperty(x)){w=o[x]}else{w=x}}q[v]=w}if(t){for(var s in t){if(t.hasOwnProperty(s)){p(s,t[s])}}}var n=r.options.extraKeys;if(n){for(var s in n){if(n.hasOwnProperty(s)){p(s,n[s])}}}return q}function i(o,n){while(n&&n!=o){if(n.nodeName.toUpperCase()==="LI"&&n.parentNode==o){return n}n=n.parentNode}}function j(A,K){this.completion=A;this.data=K;var r=this,w=A.cm;var H=this.hints=document.createElement("ul");H.className="CodeMirror-hints";this.selectedHint=K.selectedHint||0;var v=K.list;for(var J=0;J<v.length;++J){var q=H.appendChild(document.createElement("li")),p=v[J];var o=h+(J!=this.selectedHint?"":" "+g);if(p.className!=null){o=p.className+" "+o}q.className=o;if(p.render){p.render(q,K,p)}else{q.appendChild(document.createTextNode(p.displayText||m(p)))}q.hintId=J}var u=w.cursorCoords(A.options.alignWithWord?K.from:null);var s=u.left,E=u.bottom,C=true;H.style.left=s+"px";H.style.top=E+"px";var x=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth);var I=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(A.options.container||document.body).appendChild(H);var y=H.getBoundingClientRect(),z=y.bottom-I;if(z>0){var F=y.bottom-y.top,n=u.top-(u.bottom-y.top);if(n-F>0){H.style.top=(E=u.top-F)+"px";C=false}else{if(F>I){H.style.height=(I-5)+"px";H.style.top=(E=u.bottom-y.top)+"px";var t=w.getCursor();if(K.from.ch!=t.ch){u=w.cursorCoords(t);H.style.left=(s=u.left)+"px";y=H.getBoundingClientRect()}}}}var B=y.right-x;if(B>0){if(y.right-y.left>x){H.style.width=(x-5)+"px";B-=(y.right-y.left)-x}H.style.left=(s=u.left-B)+"px"}w.addKeyMap(this.keyMap=d(A,{moveFocus:function(M,L){r.changeActive(r.selectedHint+M,L)},setFocus:function(L){r.changeActive(L)},menuSize:function(){return r.screenAmount()},length:v.length,close:function(){A.close()},pick:function(){r.pick()},data:K}));if(A.options.closeOnUnfocus){var G;w.on("blur",this.onBlur=function(){G=setTimeout(function(){A.close()},100)});w.on("focus",this.onFocus=function(){clearTimeout(G)})}var D=w.getScrollInfo();w.on("scroll",this.onScroll=function(){var O=w.getScrollInfo(),N=w.getWrapperElement().getBoundingClientRect();var M=E+D.top-O.top;var L=M-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(!C){L+=H.offsetHeight}if(L<=N.top||L>=N.bottom){return A.close()}H.style.top=M+"px";H.style.left=(s+D.left-O.left)+"px"});e.on(H,"dblclick",function(M){var L=i(H,M.target||M.srcElement);if(L&&L.hintId!=null){r.changeActive(L.hintId);r.pick()}});e.on(H,"click",function(M){var L=i(H,M.target||M.srcElement);if(L&&L.hintId!=null){r.changeActive(L.hintId);if(A.options.completeOnSingleClick){r.pick()}}});e.on(H,"mousedown",function(){setTimeout(function(){w.focus()},20)});e.signal(K,"select",v[0],H.firstChild);return true}j.prototype={close:function(){if(this.completion.widget!=this){return}this.completion.widget=null;this.hints.parentNode.removeChild(this.hints);this.completion.cm.removeKeyMap(this.keyMap);var n=this.completion.cm;if(this.completion.options.closeOnUnfocus){n.off("blur",this.onBlur);n.off("focus",this.onFocus)}n.off("scroll",this.onScroll)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(n,p){if(n>=this.data.list.length){n=p?this.data.list.length-1:0}else{if(n<0){n=p?0:this.data.list.length-1}}if(this.selectedHint==n){return}var o=this.hints.childNodes[this.selectedHint];o.className=o.className.replace(" "+g,"");o=this.hints.childNodes[this.selectedHint=n];o.className+=" "+g;if(o.offsetTop<this.hints.scrollTop){this.hints.scrollTop=o.offsetTop-3}else{if(o.offsetTop+o.offsetHeight>this.hints.scrollTop+this.hints.clientHeight){this.hints.scrollTop=o.offsetTop+o.offsetHeight-this.hints.clientHeight+3}}e.signal(this.data,"select",this.data.list[this.selectedHint],o)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}};e.registerHelper("hint","auto",function(n,o){var q=n.getHelpers(n.getCursor(),"hint"),s;if(q.length){for(var p=0;p<q.length;p++){var r=q[p](n,o);if(r&&r.list.length){return r}}}else{if(s=n.getHelper(n.getCursor(),"hintWords")){if(s){return e.hint.fromList(n,{words:s})}}else{if(e.hint.anyword){return e.hint.anyword(n,o)}}}});e.registerHelper("hint","fromList",function(n,o){var t=n.getCursor(),q=n.getTokenAt(t);var r=[];for(var p=0;p<o.words.length;p++){var s=o.words[p];if(s.slice(0,q.string.length)==q.string){r.push(s)}}if(r.length){return{list:r,from:e.Pos(t.line,q.start),to:e.Pos(t.line,q.end)}}});e.commands.autocomplete=e.showHint;var c={hint:e.hint.auto,completeSingle:true,alignWithWord:true,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:true,completeOnSingleClick:false,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(c){c.defineMode("clike",function(C,o){var w=C.indentUnit,u=o.statementIndentUnit||w,x=o.dontAlignCalls,q=o.keywords||{},D=o.builtin||{},y=o.blockKeywords||{},m=o.atoms||{},l=o.hooks||{},t=o.multiLineStrings,r=o.indentStatements!==false;var s=/[+\-*&%=<>!?|\/]/;var A;function E(J,H){var G=J.next();if(l[G]){var F=l[G](J,H);if(F!==false){return F}}if(G=='"'||G=="'"){H.tokenize=p(G);return H.tokenize(J,H)}if(/[\[\]{}\(\),;\:\.]/.test(G)){A=G;return null}if(/\d/.test(G)){J.eatWhile(/[\w\.]/);return"number"}if(G=="/"){if(J.eat("*")){H.tokenize=v;return v(J,H)}if(J.eat("/")){J.skipToEnd();return"comment"}}if(s.test(G)){J.eatWhile(s);return"operator"}J.eatWhile(/[\w\$_\xa1-\uffff]/);var I=J.current();if(q.propertyIsEnumerable(I)){if(y.propertyIsEnumerable(I)){A="newstatement"}return"keyword"}if(D.propertyIsEnumerable(I)){if(y.propertyIsEnumerable(I)){A="newstatement"}return"builtin"}if(m.propertyIsEnumerable(I)){return"atom"}return"variable"}function p(F){return function(K,I){var J=false,H,G=false;while((H=K.next())!=null){if(H==F&&!J){G=true;break}J=!J&&H=="\\"}if(G||!(J||t)){I.tokenize=null}return"string"}}function v(I,H){var F=false,G;while(G=I.next()){if(G=="/"&&F){H.tokenize=null;break}F=(G=="*")}return"comment"}function z(J,G,F,I,H){this.indented=J;this.column=G;this.type=F;this.align=I;this.prev=H}function n(I,G,H){var F=I.indented;if(I.context&&I.context.type=="statement"){F=I.context.indented}return I.context=new z(F,G,H,null,I.context)}function B(G){var F=G.context.type;if(F==")"||F=="]"||F=="}"){G.indented=G.context.indented}return G.context=G.context.prev}return{startState:function(F){return{tokenize:null,context:new z((F||0)-w,0,"top",false),indented:0,startOfLine:true}},token:function(I,H){var F=H.context;if(I.sol()){if(F.align==null){F.align=false}H.indented=I.indentation();H.startOfLine=true}if(I.eatSpace()){return null}A=null;var G=(H.tokenize||E)(I,H);if(G=="comment"||G=="meta"){return G}if(F.align==null){F.align=true}if((A==";"||A==":"||A==",")&&F.type=="statement"){B(H)}else{if(A=="{"){n(H,I.column(),"}")}else{if(A=="["){n(H,I.column(),"]")}else{if(A=="("){n(H,I.column(),")")}else{if(A=="}"){while(F.type=="statement"){F=B(H)}if(F.type=="}"){F=B(H)}while(F.type=="statement"){F=B(H)}}else{if(A==F.type){B(H)}else{if(r&&(((F.type=="}"||F.type=="top")&&A!=";")||(F.type=="statement"&&A=="newstatement"))){n(H,I.column(),"statement")}}}}}}}H.startOfLine=false;return G},indent:function(J,G){if(J.tokenize!=E&&J.tokenize!=null){return c.Pass}var F=J.context,I=G&&G.charAt(0);if(F.type=="statement"&&I=="}"){F=F.prev}var H=I==F.type;if(F.type=="statement"){return F.indented+(I=="{"?0:u)}else{if(F.align&&(!x||F.type!=")")){return F.column+(H?0:1)}else{if(F.type==")"&&!H){return F.indented+u}else{return F.indented+(H?0:w)}}}},electricChars:"{}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",fold:"brace"}});function g(o){var m={},n=o.split(" ");for(var l=0;l<n.length;++l){m[n[l]]=true}return m}var j="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";function d(m,l){if(!l.startOfLine){return false}for(;;){if(m.skipTo("\\")){m.next();if(m.eol()){l.tokenize=d;break}}else{m.skipToEnd();l.tokenize=null;break}}return"meta"}function i(n,m){n.backUp(1);if(n.match(/(R|u8R|uR|UR|LR)/)){var l=n.match(/"([^\s\\()]{0,16})\(/);if(!l){return false}m.cpp11RawStringDelim=l[1];m.tokenize=f;return f(n,m)}if(n.match(/(u8|u|U|L)/)){if(n.match(/["']/,false)){return"string"}return false}n.next();return false}function h(n,m){var l;while((l=n.next())!=null){if(l=='"'&&!n.eat('"')){m.tokenize=null;break}}return"string"}function f(o,m){var n=m.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&");var l=o.match(new RegExp(".*?\\)"+n+'"'));if(l){m.tokenize=null}else{o.skipToEnd()}return"string"}function b(l,p){if(typeof l=="string"){l=[l]}var o=[];function n(q){if(q){for(var r in q){if(q.hasOwnProperty(r)){o.push(r)}}}}n(p.keywords);n(p.builtin);n(p.atoms);if(o.length){p.helperType=l[0];c.registerHelper("hintWords",l[0],o)}for(var m=0;m<l.length;++m){c.defineMIME(l[m],p)}}b(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:g(j),blockKeywords:g("case do else for if switch while struct"),atoms:g("null"),hooks:{"#":d},modeProps:{fold:["brace","include"]}});b(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:g(j+" asm dynamic_cast namespace reinterpret_cast try bool explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected wchar_t alignas alignof constexpr decltype nullptr noexcept thread_local final static_assert override"),blockKeywords:g("catch class do else finally for if struct switch try while"),atoms:g("true false null"),hooks:{"#":d,u:i,U:i,L:i,R:i},modeProps:{fold:["brace","include"]}});b("text/x-java",{name:"clike",keywords:g("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:g("catch class do else finally for if switch try while"),atoms:g("true false null"),hooks:{"@":function(l){l.eatWhile(/[\w\$_]/);return"meta"}},modeProps:{fold:["brace","import"]}});b("text/x-csharp",{name:"clike",keywords:g("abstract as base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:g("catch class do else finally for foreach if struct switch try while"),builtin:g("Boolean Byte Char DateTime DateTimeOffset Decimal Double Guid Int16 Int32 Int64 Object SByte Single String TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),atoms:g("true false null"),hooks:{"@":function(m,l){if(m.eat('"')){l.tokenize=h;return h(m,l)}m.eatWhile(/[\w\$_]/);return"meta"}}});function e(n,l){var m=false;while(!n.eol()){if(!m&&n.match('"""')){l.tokenize=null;break}m=n.next()=="\\"&&!m}return"string"}b("text/x-scala",{name:"clike",keywords:g("abstract case catch class def do else extends false final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try trye type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector :: #:: Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:true,blockKeywords:g("catch class do else finally for forSome if match switch try while"),atoms:g("true false null"),indentStatements:false,hooks:{"@":function(l){l.eatWhile(/[\w\$_]/);return"meta"},'"':function(m,l){if(!m.match('""')){return false}l.tokenize=e;return l.tokenize(m,l)},"'":function(l){l.eatWhile(/[\w\$_\xa1-\uffff]/);return"atom"}},modeProps:{closeBrackets:{triples:'"'}}});b(["x-shader/x-vertex","x-shader/x-fragment"],{name:"clike",keywords:g("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),blockKeywords:g("for while do if else struct"),builtin:g("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:g("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),hooks:{"#":d},modeProps:{fold:["brace","include"]}});b("text/x-nesc",{name:"clike",keywords:g(j+"as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),blockKeywords:g("case do else for if switch while struct"),atoms:g("null"),hooks:{"#":d},modeProps:{fold:["brace","include"]}});b("text/x-objectivec",{name:"clike",keywords:g(j+"inline restrict _Bool _Complex _Imaginery BOOL Class bycopy byref id IMP in inout nil oneway out Protocol SEL self super atomic nonatomic retain copy readwrite readonly"),atoms:g("YES NO NULL NILL ON OFF"),hooks:{"@":function(l){l.eatWhile(/[\w\$]/);return"keyword"},"#":d},modeProps:{fold:"brace"}})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("clojure",function(c){var s="builtin",v="comment",o="string",e="string-2",j="atom",r="number",m="bracket",n="keyword",z="variable";var t=c.indentUnit||2;var g=c.indentUnit||2;function y(D){var B={},C=D.split(" ");for(var A=0;A<C.length;++A){B[C[A]]=true}return B}var d=y("true false nil");var l=y("defn defn- def def- defonce defmulti defmethod defmacro defstruct deftype defprotocol defrecord defproject deftest slice defalias defhinted defmacro- defn-memo defnk defnk defonce- defunbound defunbound- defvar defvar- let letfn do case cond condp for loop recur when when-not when-let when-first if if-let if-not . .. -> ->> doto and or dosync doseq dotimes dorun doall load import unimport ns in-ns refer try catch finally throw with-open with-local-vars binding gen-class gen-and-load-class gen-and-save-class handler-case handle");var h=y("* *' *1 *2 *3 *agent* *allow-unresolved-vars* *assert* *clojure-version* *command-line-args* *compile-files* *compile-path* *compiler-options* *data-readers* *e *err* *file* *flush-on-newline* *fn-loader* *in* *math-context* *ns* *out* *print-dup* *print-length* *print-level* *print-meta* *print-readably* *read-eval* *source-path* *unchecked-math* *use-context-classloader* *verbose-defrecords* *warn-on-reflection* + +' - -' -> ->> ->ArrayChunk ->Vec ->VecNode ->VecSeq -cache-protocol-fn -reset-methods .. / < <= = == > >= EMPTY-NODE accessor aclone add-classpath add-watch agent agent-error agent-errors aget alength alias all-ns alter alter-meta! alter-var-root amap ancestors and apply areduce array-map aset aset-boolean aset-byte aset-char aset-double aset-float aset-int aset-long aset-short assert assoc assoc! assoc-in associative? atom await await-for await1 bases bean bigdec bigint biginteger binding bit-and bit-and-not bit-clear bit-flip bit-not bit-or bit-set bit-shift-left bit-shift-right bit-test bit-xor boolean boolean-array booleans bound-fn bound-fn* bound? butlast byte byte-array bytes case cast char char-array char-escape-string char-name-string char? chars chunk chunk-append chunk-buffer chunk-cons chunk-first chunk-next chunk-rest chunked-seq? class class? clear-agent-errors clojure-version coll? comment commute comp comparator compare compare-and-set! compile complement concat cond condp conj conj! cons constantly construct-proxy contains? count counted? create-ns create-struct cycle dec dec' decimal? declare default-data-readers definline definterface defmacro defmethod defmulti defn defn- defonce defprotocol defrecord defstruct deftype delay delay? deliver denominator deref derive descendants destructure disj disj! dissoc dissoc! distinct distinct? doall dorun doseq dosync dotimes doto double double-array doubles drop drop-last drop-while empty empty? ensure enumeration-seq error-handler error-mode eval even? every-pred every? ex-data ex-info extend extend-protocol extend-type extenders extends? false? ffirst file-seq filter filterv find find-keyword find-ns find-protocol-impl find-protocol-method find-var first flatten float float-array float? floats flush fn fn? fnext fnil for force format frequencies future future-call future-cancel future-cancelled? future-done? future? gen-class gen-interface gensym get get-in get-method get-proxy-class get-thread-bindings get-validator group-by hash hash-combine hash-map hash-set identical? identity if-let if-not ifn? import in-ns inc inc' init-proxy instance? int int-array integer? interleave intern interpose into into-array ints io! isa? iterate iterator-seq juxt keep keep-indexed key keys keyword keyword? last lazy-cat lazy-seq let letfn line-seq list list* list? load load-file load-reader load-string loaded-libs locking long long-array longs loop macroexpand macroexpand-1 make-array make-hierarchy map map-indexed map? mapcat mapv max max-key memfn memoize merge merge-with meta method-sig methods min min-key mod munge name namespace namespace-munge neg? newline next nfirst nil? nnext not not-any? not-empty not-every? not= ns ns-aliases ns-imports ns-interns ns-map ns-name ns-publics ns-refers ns-resolve ns-unalias ns-unmap nth nthnext nthrest num number? numerator object-array odd? or parents partial partition partition-all partition-by pcalls peek persistent! pmap pop pop! pop-thread-bindings pos? pr pr-str prefer-method prefers primitives-classnames print print-ctor print-dup print-method print-simple print-str printf println println-str prn prn-str promise proxy proxy-call-with-super proxy-mappings proxy-name proxy-super push-thread-bindings pvalues quot rand rand-int rand-nth range ratio? rational? rationalize re-find re-groups re-matcher re-matches re-pattern re-seq read read-line read-string realized? reduce reduce-kv reductions ref ref-history-count ref-max-history ref-min-history ref-set refer refer-clojure reify release-pending-sends rem remove remove-all-methods remove-method remove-ns remove-watch repeat repeatedly replace replicate require reset! reset-meta! resolve rest restart-agent resultset-seq reverse reversible? rseq rsubseq satisfies? second select-keys send send-off seq seq? seque sequence sequential? set set-error-handler! set-error-mode! set-validator! set? short short-array shorts shuffle shutdown-agents slurp some some-fn sort sort-by sorted-map sorted-map-by sorted-set sorted-set-by sorted? special-symbol? spit split-at split-with str string? struct struct-map subs subseq subvec supers swap! symbol symbol? sync take take-last take-nth take-while test the-ns thread-bound? time to-array to-array-2d trampoline transient tree-seq true? type unchecked-add unchecked-add-int unchecked-byte unchecked-char unchecked-dec unchecked-dec-int unchecked-divide-int unchecked-double unchecked-float unchecked-inc unchecked-inc-int unchecked-int unchecked-long unchecked-multiply unchecked-multiply-int unchecked-negate unchecked-negate-int unchecked-remainder-int unchecked-short unchecked-subtract unchecked-subtract-int underive unquote unquote-splicing update-in update-proxy use val vals var-get var-set var? vary-meta vec vector vector-of vector? when when-first when-let when-not while with-bindings with-bindings* with-in-str with-loading-context with-local-vars with-meta with-open with-out-str with-precision with-redefs with-redefs-fn xml-seq zero? zipmap *default-data-reader-fn* as-> cond-> cond->> reduced reduced? send-via set-agent-send-executor! set-agent-send-off-executor! some-> some->>");var u=y("ns fn def defn defmethod bound-fn if if-not case condp when while when-not when-first do future comment doto locking proxy with-open with-precision reify deftype defrecord defprotocol extend extend-protocol extend-type try catch let letfn binding loop for doseq dotimes when-let if-let defstruct struct-map assoc testing deftest handler-case handle dotrace deftrace");var i={digit:/\d/,digit_or_colon:/[\d:]/,hex:/[0-9a-f]/i,sign:/[+-]/,exponent:/e/i,keyword_char:/[^\s\(\[\;\)\]]/,symbol:/[\w*+!\-\._?:<>\/\xa1-\uffff]/};function f(A,B,C){this.indent=A;this.type=B;this.prev=C}function w(C,A,B){C.indentStack=new f(A,B,C.indentStack)}function q(A){A.indentStack=A.indentStack.prev}function p(A,B){if(A==="0"&&B.eat(/x/i)){B.eatWhile(i.hex);return true}if((A=="+"||A=="-")&&(i.digit.test(B.peek()))){B.eat(i.sign);A=B.next()}if(i.digit.test(A)){B.eat(A);B.eatWhile(i.digit);if("."==B.peek()){B.eat(".");B.eatWhile(i.digit)}if(B.eat(i.exponent)){B.eat(i.sign);B.eatWhile(i.digit)}return true}return false}function x(B){var A=B.next();if(A&&A.match(/[a-z]/)&&B.match(/[a-z]+/,true)){return}if(A==="u"){B.match(/[0-9a-z]{4}/i,true)}}return{startState:function(){return{indentStack:null,indentation:0,mode:false}},token:function(I,C){if(C.indentStack==null&&I.sol()){C.indentation=I.indentation()}if(I.eatSpace()){return null}var G=null;switch(C.mode){case"string":var E,B=false;while((E=I.next())!=null){if(E=='"'&&!B){C.mode=false;break}B=!B&&E=="\\"}G=o;break;default:var A=I.next();if(A=='"'){C.mode="string";G=o}else{if(A=="\\"){x(I);G=e}else{if(A=="'"&&!(i.digit_or_colon.test(I.peek()))){G=j}else{if(A==";"){I.skipToEnd();G=v}else{if(p(A,I)){G=r}else{if(A=="("||A=="["||A=="{"){var H="",F=I.column(),D;if(A=="("){while((D=I.eat(i.keyword_char))!=null){H+=D}}if(H.length>0&&(u.propertyIsEnumerable(H)||/^(?:def|with)/.test(H))){w(C,F+t,A)}else{I.eatSpace();if(I.eol()||I.peek()==";"){w(C,F+g,A)}else{w(C,F+I.current().length,A)}}I.backUp(I.current().length-1);G=m}else{if(A==")"||A=="]"||A=="}"){G=m;if(C.indentStack!=null&&C.indentStack.type==(A==")"?"(":(A=="]"?"[":"{"))){q(C)}}else{if(A==":"){I.eatWhile(i.symbol);return j}else{I.eatWhile(i.symbol);if(l&&l.propertyIsEnumerable(I.current())){G=n}else{if(h&&h.propertyIsEnumerable(I.current())){G=s}else{if(d&&d.propertyIsEnumerable(I.current())){G=j}else{G=z}}}}}}}}}}}}return G},indent:function(A){if(A.indentStack==null){return A.indentation}return A.indentStack.indent},closeBrackets:{pairs:'()[]{}""'},lineComment:";;"}});b.defineMIME("text/x-clojure","clojure")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("coffeescript",function(n,w){var c="error";function r(A){return new RegExp("^(("+A.join(")|(")+"))\\b")}var t=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var h=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var i=/^[_A-Za-z$][_A-Za-z$0-9]*/;var l=/^(@|this\.)[_A-Za-z$][_A-Za-z$0-9]*/;var e=r(["and","or","not","is","isnt","in","instanceof","typeof"]);var d=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var u=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var m=r(d.concat(u));d=r(d);var o=/^('{3}|\"{3}|['\"])/;var j=/^(\/{3}|\/)/;var p=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var y=r(p);function z(G,F){if(G.sol()){if(F.scope.align===null){F.scope.align=false}var B=F.scope.offset;if(G.eatSpace()){var D=G.indentation();if(D>B&&F.scope.type=="coffee"){return"indent"}else{if(D<B){return"dedent"}}return null}else{if(B>0){f(G,F)}}}if(G.eatSpace()){return null}var E=G.peek();if(G.match("####")){G.skipToEnd();return"comment"}if(G.match("###")){F.tokenize=s;return F.tokenize(G,F)}if(E==="#"){G.skipToEnd();return"comment"}if(G.match(/^-?[0-9\.]/,false)){var C=false;if(G.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){C=true}if(G.match(/^-?\d+\.\d*/)){C=true}if(G.match(/^-?\.\d+/)){C=true}if(C){if(G.peek()=="."){G.backUp(1)}return"number"}var A=false;if(G.match(/^-?0x[0-9a-f]+/i)){A=true}if(G.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){A=true}if(G.match(/^-?0(?![\dx])/i)){A=true}if(A){return"number"}}if(G.match(o)){F.tokenize=v(G.current(),false,"string");return F.tokenize(G,F)}if(G.match(j)){if(G.current()!="/"||G.match(/^.*\//,false)){F.tokenize=v(G.current(),true,"string-2");return F.tokenize(G,F)}else{G.backUp(1)}}if(G.match(t)||G.match(e)){return"operator"}if(G.match(h)){return"punctuation"}if(G.match(y)){return"atom"}if(G.match(m)){return"keyword"}if(G.match(i)){return"variable"}if(G.match(l)){return"property"}G.next();return c}function v(A,B,C){return function(E,D){while(!E.eol()){E.eatWhile(/[^'"\/\\]/);if(E.eat("\\")){E.next();if(B&&E.eol()){return C}}else{if(E.match(A)){D.tokenize=z;return C}else{E.eat(/['"\/]/)}}}if(B){if(w.singleLineStringErrors){C=c}else{D.tokenize=z}}return C}}function s(B,A){while(!B.eol()){B.eatWhile(/[^#]/);if(B.match("###")){A.tokenize=z;break}B.eatWhile("#")}return"comment"}function q(F,D,C){C=C||"coffee";var E=0,G=false,A=null;for(var B=D.scope;B;B=B.prev){if(B.type==="coffee"||B.type=="}"){E=B.offset+n.indentUnit;break}}if(C!=="coffee"){G=null;A=F.column()+F.current().length}else{if(D.scope.align){D.scope.align=false}}D.scope={offset:E,type:C,prev:D.scope,align:G,alignOffset:A}}function f(E,D){if(!D.scope.prev){return}if(D.scope.type==="coffee"){var B=E.indentation();var A=false;for(var C=D.scope;C;C=C.prev){if(B===C.offset){A=true;break}}if(!A){return true}while(D.scope.prev&&D.scope.offset!==B){D.scope=D.scope.prev}return false}else{D.scope=D.scope.prev;return false}}function x(E,C){var B=C.tokenize(E,C);var D=E.current();if(D==="."){B=C.tokenize(E,C);D=E.current();if(/^\.[\w$]+$/.test(D)){return"variable"}else{return c}}if(D==="return"){C.dedent=true}if(((D==="->"||D==="=>")&&!C.lambda&&!E.peek())||B==="indent"){q(E,C)}var A="[({".indexOf(D);if(A!==-1){q(E,C,"])}".slice(A,A+1))}if(d.exec(D)){q(E,C)}if(D=="then"){f(E,C)}if(B==="dedent"){if(f(E,C)){return c}}A="])}".indexOf(D);if(A!==-1){while(C.scope.type=="coffee"&&C.scope.prev){C.scope=C.scope.prev}if(C.scope.type==D){C.scope=C.scope.prev}}if(C.dedent&&E.eol()){if(C.scope.type=="coffee"&&C.scope.prev){C.scope=C.scope.prev}C.dedent=false}return B}var g={startState:function(A){return{tokenize:z,scope:{offset:A||0,type:"coffee",prev:null,align:false},lastToken:null,lambda:false,dedent:0}},token:function(D,C){var B=C.scope.align===null&&C.scope;if(B&&D.sol()){B.align=false}var A=x(D,C);if(B&&A&&A!="comment"){B.align=true}C.lastToken={style:A,content:D.current()};if(D.eol()&&D.lambda){C.lambda=false}return A},indent:function(B,D){if(B.tokenize!=z){return 0}var A=B.scope;var E=D&&"])}".indexOf(D.charAt(0))>-1;if(E){while(A.type=="coffee"&&A.prev){A=A.prev}}var C=E&&A.type===D.charAt(0);if(A.align){return A.alignOffset-(C?1:0)}else{return(C?A.prev:A).offset}},lineComment:"#",fold:"indent"};return g});b.defineMIME("text/x-coffeescript","coffeescript")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMIME("text/x-erlang","erlang");b.defineMode("erlang",function(w){var c=["-type","-spec","-export_type","-opaque"];var M=["after","begin","catch","case","cond","end","fun","if","let","of","query","receive","try","when"];var R=/[\->,;]/;var o=["->",";",","];var C=["and","andalso","band","bnot","bor","bsl","bsr","bxor","div","not","or","orelse","rem","xor"];var h=/[\+\-\*\/<>=\|:!]/;var z=["=","+","-","*","/",">",">=","<","=<","=:=","==","=/=","/=","||","<-","!"];var B=/[<\(\[\{]/;var y=["<<","(","[","{"];var F=/[>\)\]\}]/;var G=["}","]",")",">>"];var t=["is_atom","is_binary","is_bitstring","is_boolean","is_float","is_function","is_integer","is_list","is_number","is_pid","is_port","is_record","is_reference","is_tuple","atom","binary","bitstring","boolean","function","integer","list","number","pid","port","record","reference","tuple"];var n=["abs","adler32","adler32_combine","alive","apply","atom_to_binary","atom_to_list","binary_to_atom","binary_to_existing_atom","binary_to_list","binary_to_term","bit_size","bitstring_to_list","byte_size","check_process_code","contact_binary","crc32","crc32_combine","date","decode_packet","delete_module","disconnect_node","element","erase","exit","float","float_to_list","garbage_collect","get","get_keys","group_leader","halt","hd","integer_to_list","internal_bif","iolist_size","iolist_to_binary","is_alive","is_atom","is_binary","is_bitstring","is_boolean","is_float","is_function","is_integer","is_list","is_number","is_pid","is_port","is_process_alive","is_record","is_reference","is_tuple","length","link","list_to_atom","list_to_binary","list_to_bitstring","list_to_existing_atom","list_to_float","list_to_integer","list_to_pid","list_to_tuple","load_module","make_ref","module_loaded","monitor_node","node","node_link","node_unlink","nodes","notalive","now","open_port","pid_to_list","port_close","port_command","port_connect","port_control","pre_loaded","process_flag","process_info","processes","purge_module","put","register","registered","round","self","setelement","size","spawn","spawn_link","spawn_monitor","spawn_opt","split_binary","statistics","term_to_binary","time","throw","tl","trunc","tuple_size","tuple_to_list","unlink","unregister","whereis"];var L=/[\w@----]/;var r=/[0-7]{1,3}|[bdefnrstv\\"']|\^[a-zA-Z]|x[0-9a-zA-Z]{2}|x{[0-9a-zA-Z]+}/;function l(W,V){if(V.in_string){V.in_string=(!D(W));return q(V,W,"string")}if(V.in_atom){V.in_atom=(!u(W));return q(V,W,"atom")}if(W.eatSpace()){return q(V,W,"whitespace")}if(!j(V)&&W.match(/-\s*[a-z--][\w----]*/)){if(H(W.current(),c)){return q(V,W,"type")}else{return q(V,W,"attribute")}}var U=W.next();if(U=="%"){W.skipToEnd();return q(V,W,"comment")}if(U==":"){return q(V,W,"colon")}if(U=="?"){W.eatSpace();W.eatWhile(L);return q(V,W,"macro")}if(U=="#"){W.eatSpace();W.eatWhile(L);return q(V,W,"record")}if(U=="$"){if(W.next()=="\\"&&!W.match(r)){return q(V,W,"error")}return q(V,W,"number")}if(U=="."){return q(V,W,"dot")}if(U=="'"){if(!(V.in_atom=(!u(W)))){if(W.match(/\s*\/\s*[0-9]/,false)){W.match(/\s*\/\s*[0-9]/,true);return q(V,W,"fun")}if(W.match(/\s*\(/,false)||W.match(/\s*:/,false)){return q(V,W,"function")}}return q(V,W,"atom")}if(U=='"'){V.in_string=(!D(W));return q(V,W,"string")}if(/[A-Z_--]/.test(U)){W.eatWhile(L);return q(V,W,"variable")}if(/[a-z_--]/.test(U)){W.eatWhile(L);if(W.match(/\s*\/\s*[0-9]/,false)){W.match(/\s*\/\s*[0-9]/,true);return q(V,W,"fun")}var d=W.current();if(H(d,M)){return q(V,W,"keyword")}else{if(H(d,C)){return q(V,W,"operator")}else{if(W.match(/\s*\(/,false)){if(H(d,n)&&((j(V).token!=":")||(j(V,2).token=="erlang"))){return q(V,W,"builtin")}else{if(H(d,t)){return q(V,W,"guard")}else{return q(V,W,"function")}}}else{if(H(d,C)){return q(V,W,"operator")}else{if(Q(W)==":"){if(d=="erlang"){return q(V,W,"builtin")}else{return q(V,W,"function")}}else{if(H(d,["true","false"])){return q(V,W,"boolean")}else{if(H(d,["true","false"])){return q(V,W,"boolean")}else{return q(V,W,"atom")}}}}}}}}var S=/[0-9]/;var T=/[0-9a-zA-Z]/;if(S.test(U)){W.eatWhile(S);if(W.eat("#")){if(!W.eatWhile(T)){W.backUp(1)}}else{if(W.eat(".")){if(!W.eatWhile(S)){W.backUp(1)}else{if(W.eat(/[eE]/)){if(W.eat(/[-+]/)){if(!W.eatWhile(S)){W.backUp(2)}}else{if(!W.eatWhile(S)){W.backUp(1)}}}}}}return q(V,W,"number")}if(A(W,B,y)){return q(V,W,"open_paren")}if(A(W,F,G)){return q(V,W,"close_paren")}if(I(W,R,o)){return q(V,W,"separator")}if(I(W,h,z)){return q(V,W,"operator")}return q(V,W,null)}function A(T,d,S){if(T.current().length==1&&d.test(T.current())){T.backUp(1);while(d.test(T.peek())){T.next();if(H(T.current(),S)){return true}}T.backUp(T.current().length-1)}return false}function I(T,d,S){if(T.current().length==1&&d.test(T.current())){while(d.test(T.peek())){T.next()}while(0<T.current().length){if(H(T.current(),S)){return true}else{T.backUp(1)}}T.next()}return false}function D(d){return p(d,'"',"\\")}function u(d){return p(d,"'","\\")}function p(U,S,d){while(!U.eol()){var T=U.next();if(T==S){return true}else{if(T==d){U.next()}}}return false}function Q(S){var d=S.match(/([\n\s]+|%[^\n]*\n)*(.)/,false);return d?d.pop():""}function H(d,S){return(-1<S.indexOf(d))}function q(S,T,d){O(S,x(d,T));switch(d){case"atom":return"atom";case"attribute":return"attribute";case"boolean":return"atom";case"builtin":return"builtin";case"close_paren":return null;case"colon":return null;case"comment":return"comment";case"dot":return null;case"error":return"error";case"fun":return"meta";case"function":return"tag";case"guard":return"property";case"keyword":return"keyword";case"macro":return"variable-2";case"number":return"number";case"open_paren":return null;case"operator":return"operator";case"record":return"bracket";case"separator":return null;case"string":return"string";case"type":return"def";case"variable":return"variable";default:return null}}function i(d,S,U,T){return{token:d,column:S,indent:U,type:T}}function x(d,S){return i(S.current(),S.column(),S.indentation(),d)}function v(d){return i(d,0,0,d)}function j(S,U){var d=S.tokenStack.length;var T=(U?U:1);if(d<T){return false}else{return S.tokenStack[d-T]}}function O(S,d){if(!(d.type=="comment"||d.type=="whitespace")){S.tokenStack=s(S.tokenStack,d);S.tokenStack=K(S.tokenStack)}}function s(S,d){var T=S.length-1;if(0<T&&S[T].type==="record"&&d.type==="dot"){S.pop()}else{if(0<T&&S[T].type==="group"){S.pop();S.push(d)}else{S.push(d)}}return S}function K(d){var S=d.length-1;if(d[S].type==="dot"){return[]}if(d[S].type==="fun"&&d[S-1].token==="fun"){return d.slice(0,S-1)}switch(d[d.length-1].token){case"}":return P(d,{g:["{"]});case"]":return P(d,{i:["["]});case")":return P(d,{i:["("]});case">>":return P(d,{i:["<<"]});case"end":return P(d,{i:["begin","case","fun","if","receive","try"]});case",":return P(d,{e:["begin","try","when","->",",","(","[","{","<<"]});case"->":return P(d,{r:["when"],m:["try","if","case","receive"]});case";":return P(d,{E:["case","fun","if","receive","try","when"]});case"catch":return P(d,{e:["try"]});case"of":return P(d,{e:["case"]});case"after":return P(d,{e:["receive","try"]});default:return d}}function P(S,W){for(var V in W){var d=S.length-1;var X=W[V];for(var U=d-1;-1<U;U--){if(H(S[U].token,X)){var T=S.slice(0,U);switch(V){case"m":return T.concat(S[U]).concat(S[d]);case"r":return T.concat(S[d]);case"i":return T;case"g":return T.concat(v("group"));case"E":return T.concat(S[U]);case"e":return T.concat(S[U])}}}}return(V=="E"?[]:S)}function f(X,S){var T;var V=w.indentUnit;var U=e(S);var W=j(X,1);var d=j(X,2);if(X.in_string||X.in_atom){return b.Pass}else{if(!d){return 0}else{if(W.token=="when"){return W.column+V}else{if(U==="when"&&d.type==="function"){return d.indent+V}else{if(U==="("&&W.token==="fun"){return W.column+3}else{if(U==="catch"&&(T=m(X,["try"]))){return T.column}else{if(H(U,["end","after","of"])){T=m(X,["begin","case","fun","if","receive","try"]);return T?T.column:b.Pass}else{if(H(U,G)){T=m(X,y);return T?T.column:b.Pass}else{if(H(W.token,[",","|","||"])||H(U,[",","|","||"])){T=N(X);return T?T.column+T.token.length:V}else{if(W.token=="->"){if(H(d.token,["receive","case","if","try"])){return d.column+V+V}else{return d.column+V}}else{if(H(W.token,y)){return W.column+W.token.length}else{T=J(X);return g(T)?T.column+V:0}}}}}}}}}}}}function e(S){var d=S.match(/,|[a-z]+|\}|\]|\)|>>|\|+|\(/);return g(d)&&(d.index===0)?d[0]:""}function N(S){var T=S.tokenStack.slice(0,-1);var d=E(T,"type",["open_paren"]);return g(T[d])?T[d]:false}function J(S){var T=S.tokenStack;var d=E(T,"type",["open_paren","separator","keyword"]);var U=E(T,"type",["operator"]);if(g(d)&&g(U)&&d<U){return T[d+1]}else{if(g(d)){return T[d]}else{return false}}}function m(S,T){var U=S.tokenStack;var d=E(U,"token",T);return g(U[d])?U[d]:false}function E(T,U,d){for(var S=T.length-1;-1<S;S--){if(H(T[S][U],d)){return S}}return false}function g(d){return(d!==false)&&(d!=null)}return{startState:function(){return{tokenStack:[],in_string:false,in_atom:false}},token:function(S,d){return l(S,d)},indent:function(S,d){return f(S,d)},lineComment:"%"}})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("go",function(d){var g=d.indentUnit;var f={"break":true,"case":true,chan:true,"const":true,"continue":true,"default":true,defer:true,"else":true,fallthrough:true,"for":true,func:true,go:true,"goto":true,"if":true,"import":true,"interface":true,map:true,"package":true,range:true,"return":true,select:true,struct:true,"switch":true,type:true,"var":true,bool:true,"byte":true,complex64:true,complex128:true,float32:true,float64:true,int8:true,int16:true,int32:true,int64:true,string:true,uint8:true,uint16:true,uint32:true,uint64:true,"int":true,uint:true,uintptr:true};var h={"true":true,"false":true,iota:true,nil:true,append:true,cap:true,close:true,complex:true,copy:true,imag:true,len:true,make:true,"new":true,panic:true,print:true,println:true,real:true,recover:true};var c=/[+\-*&^%:=<>!|\/]/;var m;function e(s,q){var p=s.next();if(p=='"'||p=="'"||p=="`"){q.tokenize=o(p);return q.tokenize(s,q)}if(/[\d\.]/.test(p)){if(p=="."){s.match(/^[0-9]+([eE][\-+]?[0-9]+)?/)}else{if(p=="0"){s.match(/^[xX][0-9a-fA-F]+/)||s.match(/^0[0-7]+/)}else{s.match(/^[0-9]*\.?[0-9]*([eE][\-+]?[0-9]+)?/)}}return"number"}if(/[\[\]{}\(\),;\:\.]/.test(p)){m=p;return null}if(p=="/"){if(s.eat("*")){q.tokenize=j;return j(s,q)}if(s.eat("/")){s.skipToEnd();return"comment"}}if(c.test(p)){s.eatWhile(c);return"operator"}s.eatWhile(/[\w\$_\xa1-\uffff]/);var r=s.current();if(f.propertyIsEnumerable(r)){if(r=="case"||r=="default"){m="case"}return"keyword"}if(h.propertyIsEnumerable(r)){return"atom"}return"variable"}function o(p){return function(u,s){var t=false,r,q=false;while((r=u.next())!=null){if(r==p&&!t){q=true;break}t=!t&&r=="\\"}if(q||!(t||p=="`")){s.tokenize=e}return"string"}}function j(s,r){var p=false,q;while(q=s.next()){if(q=="/"&&p){r.tokenize=e;break}p=(q=="*")}return"comment"}function n(t,q,p,s,r){this.indented=t;this.column=q;this.type=p;this.align=s;this.prev=r}function i(r,p,q){return r.context=new n(r.indented,p,q,null,r.context)}function l(q){if(!q.context.prev){return}var p=q.context.type;if(p==")"||p=="]"||p=="}"){q.indented=q.context.indented}return q.context=q.context.prev}return{startState:function(p){return{tokenize:null,context:new n((p||0)-g,0,"top",false),indented:0,startOfLine:true}},token:function(s,r){var p=r.context;if(s.sol()){if(p.align==null){p.align=false}r.indented=s.indentation();r.startOfLine=true;if(p.type=="case"){p.type="}"}}if(s.eatSpace()){return null}m=null;var q=(r.tokenize||e)(s,r);if(q=="comment"){return q}if(p.align==null){p.align=true}if(m=="{"){i(r,s.column(),"}")}else{if(m=="["){i(r,s.column(),"]")}else{if(m=="("){i(r,s.column(),")")}else{if(m=="case"){p.type="case"}else{if(m=="}"&&p.type=="}"){p=l(r)}else{if(m==p.type){l(r)}}}}}}r.startOfLine=false;return q},indent:function(t,q){if(t.tokenize!=e&&t.tokenize!=null){return 0}var p=t.context,s=q&&q.charAt(0);if(p.type=="case"&&/^(?:case|default)\b/.test(q)){t.context.type="}";return p.indented}var r=s==p.type;if(p.align){return p.column+(r?0:1)}else{return p.indented+(r?0:g)}},electricChars:"{}):",fold:"brace",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//"}});b.defineMIME("text/x-go","go")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("haskell",function(m,t){function n(v,w,u){w(u);return u(v,w)}var f=/[a-z_]/;var r=/[A-Z]/;var o=/\d/;var e=/[0-9A-Fa-f]/;var s=/[0-7]/;var q=/[a-z_A-Z0-9'\xa1-\uffff]/;var p=/[-!#$%&*+.\/<=>?@\\^|~:]/;var g=/[(),;[\]`{}]/;var i=/[ \t\v\f]/;function j(w,x){if(w.eatWhile(i)){return null}var v=w.next();if(g.test(v)){if(v=="{"&&w.eat("-")){var u="comment";if(w.eat("#")){u="meta"}return n(w,x,l(u,1))}return null}if(v=="'"){if(w.eat("\\")){w.next()}else{w.next()}if(w.eat("'")){return"string"}return"error"}if(v=='"'){return n(w,x,h)}if(r.test(v)){w.eatWhile(q);if(w.eat(".")){return"qualifier"}return"variable-2"}if(f.test(v)){w.eatWhile(q);return"variable"}if(o.test(v)){if(v=="0"){if(w.eat(/[xX]/)){w.eatWhile(e);return"integer"}if(w.eat(/[oO]/)){w.eatWhile(s);return"number"}}w.eatWhile(o);var u="number";if(w.match(/^\.\d+/)){u="number"}if(w.eat(/[eE]/)){u="number";w.eat(/[-+]/);w.eatWhile(o)}return u}if(v=="."&&w.eat(".")){return"keyword"}if(p.test(v)){if(v=="-"&&w.eat(/-/)){w.eatWhile(/-/);if(!w.eat(p)){w.skipToEnd();return"comment"}}var u="variable";if(v==":"){u="variable-2"}w.eatWhile(p);return u}return"error"}function l(u,v){if(v==0){return j}return function(y,z){var w=v;while(!y.eol()){var x=y.next();if(x=="{"&&y.eat("-")){++w}else{if(x=="-"&&y.eat("}")){--w;if(w==0){z(j);return u}}}}z(l(u,w));return u}}function h(v,w){while(!v.eol()){var u=v.next();if(u=='"'){w(j);return"string"}if(u=="\\"){if(v.eol()||v.eat(i)){w(d);return"string"}if(v.eat("&")){}else{v.next()}}}w(j);return"error"}function d(u,v){if(u.eat("\\")){return n(u,v,h)}u.next();v(j);return"error"}var c=(function(){var u={};function x(y){return function(){for(var z=0;z<arguments.length;z++){u[arguments[z]]=y}}}x("keyword")("case","class","data","default","deriving","do","else","foreign","if","import","in","infix","infixl","infixr","instance","let","module","newtype","of","then","type","where","_");x("keyword")("..",":","::","=","\\",'"',"<-","->","@","~","=>");x("builtin")("!!","$!","$","&&","+","++","-",".","/","/=","<","<=","=<<","==",">",">=",">>",">>=","^","^^","||","*","**");x("builtin")("Bool","Bounded","Char","Double","EQ","Either","Enum","Eq","False","FilePath","Float","Floating","Fractional","Functor","GT","IO","IOError","Int","Integer","Integral","Just","LT","Left","Maybe","Monad","Nothing","Num","Ord","Ordering","Rational","Read","ReadS","Real","RealFloat","RealFrac","Right","Show","ShowS","String","True");x("builtin")("abs","acos","acosh","all","and","any","appendFile","asTypeOf","asin","asinh","atan","atan2","atanh","break","catch","ceiling","compare","concat","concatMap","const","cos","cosh","curry","cycle","decodeFloat","div","divMod","drop","dropWhile","either","elem","encodeFloat","enumFrom","enumFromThen","enumFromThenTo","enumFromTo","error","even","exp","exponent","fail","filter","flip","floatDigits","floatRadix","floatRange","floor","fmap","foldl","foldl1","foldr","foldr1","fromEnum","fromInteger","fromIntegral","fromRational","fst","gcd","getChar","getContents","getLine","head","id","init","interact","ioError","isDenormalized","isIEEE","isInfinite","isNaN","isNegativeZero","iterate","last","lcm","length","lex","lines","log","logBase","lookup","map","mapM","mapM_","max","maxBound","maximum","maybe","min","minBound","minimum","mod","negate","not","notElem","null","odd","or","otherwise","pi","pred","print","product","properFraction","putChar","putStr","putStrLn","quot","quotRem","read","readFile","readIO","readList","readLn","readParen","reads","readsPrec","realToFrac","recip","rem","repeat","replicate","return","reverse","round","scaleFloat","scanl","scanl1","scanr","scanr1","seq","sequence","sequence_","show","showChar","showList","showParen","showString","shows","showsPrec","significand","signum","sin","sinh","snd","span","splitAt","sqrt","subtract","succ","sum","tail","take","takeWhile","tan","tanh","toEnum","toInteger","toRational","truncate","uncurry","undefined","unlines","until","unwords","unzip","unzip3","userError","words","writeFile","zip","zip3","zipWith","zipWith3");var v=t.overrideKeywords;if(v){for(var w in v){if(v.hasOwnProperty(w)){u[w]=v[w]}}}return u})();return{startState:function(){return{f:j}},copyState:function(u){return{f:u.f}},token:function(y,x){var v=x.f(y,function(w){x.f=w});var u=y.current();return c.hasOwnProperty(u)?c[u]:v},blockCommentStart:"{-",blockCommentEnd:"-}",lineComment:"--"}});b.defineMIME("text/x-haskell","haskell")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("javascript",function(aa,ak){var m=aa.indentUnit;var B=ak.statementIndent;var aB=ak.jsonld;var A=ak.json||aB;var h=ak.typescript;var av=ak.wordCharacters||/[\w$\xa1-\uffff]/;var at=function(){function aR(aT){return{type:aT,style:"keyword"}}var aM=aR("keyword a"),aK=aR("keyword b"),aJ=aR("keyword c");var aL=aR("operator"),aP={type:"atom",style:"atom"};var aN={"if":aR("if"),"while":aM,"with":aM,"else":aK,"do":aK,"try":aK,"finally":aK,"return":aJ,"break":aJ,"continue":aJ,"new":aJ,"delete":aJ,"throw":aJ,"debugger":aJ,"var":aR("var"),"const":aR("var"),let:aR("var"),"function":aR("function"),"catch":aR("catch"),"for":aR("for"),"switch":aR("switch"),"case":aR("case"),"default":aR("default"),"in":aL,"typeof":aL,"instanceof":aL,"true":aP,"false":aP,"null":aP,"undefined":aP,"NaN":aP,"Infinity":aP,"this":aR("this"),module:aR("module"),"class":aR("class"),"super":aR("atom"),yield:aJ,"export":aR("export"),"import":aR("import"),"extends":aJ};if(h){var aS={type:"variable",style:"variable-3"};var aO={"interface":aR("interface"),"extends":aR("extends"),constructor:aR("constructor"),"public":aR("public"),"private":aR("private"),"protected":aR("protected"),"static":aR("static"),string:aS,number:aS,bool:aS,any:aS};for(var aQ in aO){aN[aQ]=aO[aQ]}}return aN}();var Q=/[+\-*&%=<>!?|~^]/;var ar=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function G(aM){var aK=false,aJ,aL=false;while((aJ=aM.next())!=null){if(!aK){if(aJ=="/"&&!aL){return}if(aJ=="["){aL=true}else{if(aL&&aJ=="]"){aL=false}}}aK=!aK&&aJ=="\\"}}var T,H;function M(aL,aK,aJ){T=aL;H=aJ;return aK}function V(aN,aL){var aJ=aN.next();if(aJ=='"'||aJ=="'"){aL.tokenize=S(aJ);return aL.tokenize(aN,aL)}else{if(aJ=="."&&aN.match(/^\d+(?:[eE][+\-]?\d+)?/)){return M("number","number")}else{if(aJ=="."&&aN.match("..")){return M("spread","meta")}else{if(/[\[\]{}\(\),;\:\.]/.test(aJ)){return M(aJ)}else{if(aJ=="="&&aN.eat(">")){return M("=>","operator")}else{if(aJ=="0"&&aN.eat(/x/i)){aN.eatWhile(/[\da-f]/i);return M("number","number")}else{if(/\d/.test(aJ)){aN.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/);return M("number","number")}else{if(aJ=="/"){if(aN.eat("*")){aL.tokenize=aA;return aA(aN,aL)}else{if(aN.eat("/")){aN.skipToEnd();return M("comment","comment")}else{if(aL.lastType=="operator"||aL.lastType=="keyword c"||aL.lastType=="sof"||/^[\[{}\(,;:]$/.test(aL.lastType)){G(aN);aN.match(/^\b(([gimyu])(?![gimyu]*\2))+\b/);return M("regexp","string-2")}else{aN.eatWhile(Q);return M("operator","operator",aN.current())}}}}else{if(aJ=="`"){aL.tokenize=aC;return aC(aN,aL)}else{if(aJ=="#"){aN.skipToEnd();return M("error","error")}else{if(Q.test(aJ)){aN.eatWhile(Q);return M("operator","operator",aN.current())}else{if(av.test(aJ)){aN.eatWhile(av);var aM=aN.current(),aK=at.propertyIsEnumerable(aM)&&at[aM];return(aK&&aL.lastType!=".")?M(aK.type,aK.style,aM):M("variable","variable",aM)}}}}}}}}}}}}}function S(aJ){return function(aN,aL){var aM=false,aK;if(aB&&aN.peek()=="@"&&aN.match(ar)){aL.tokenize=V;return M("jsonld-keyword","meta")}while((aK=aN.next())!=null){if(aK==aJ&&!aM){break}aM=!aM&&aK=="\\"}if(!aM){aL.tokenize=V}return M("string","string")}}function aA(aM,aL){var aJ=false,aK;while(aK=aM.next()){if(aK=="/"&&aJ){aL.tokenize=V;break}aJ=(aK=="*")}return M("comment","comment")}function aC(aM,aK){var aL=false,aJ;while((aJ=aM.next())!=null){if(!aL&&(aJ=="`"||aJ=="$"&&aM.eat("{"))){aK.tokenize=V;break}aL=!aL&&aJ=="\\"}return M("quasi","string-2",aM.current())}var n="([{}])";function ax(aP,aM){if(aM.fatArrowAt){aM.fatArrowAt=null}var aL=aP.string.indexOf("=>",aP.start);if(aL<0){return}var aO=0,aK=false;for(var aQ=aL-1;aQ>=0;--aQ){var aJ=aP.string.charAt(aQ);var aN=n.indexOf(aJ);if(aN>=0&&aN<3){if(!aO){++aQ;break}if(--aO==0){break}}else{if(aN>=3&&aN<6){++aO}else{if(av.test(aJ)){aK=true}else{if(/["'\/]/.test(aJ)){return}else{if(aK&&!aO){++aQ;break}}}}}}if(aK&&!aO){aM.fatArrowAt=aQ}}var c={atom:true,number:true,variable:true,string:true,regexp:true,"this":true,"jsonld-keyword":true};function K(aO,aK,aJ,aN,aL,aM){this.indented=aO;this.column=aK;this.type=aJ;this.prev=aL;this.info=aM;if(aN!=null){this.align=aN}}function t(aM,aL){for(var aK=aM.localVars;aK;aK=aK.next){if(aK.name==aL){return true}}for(var aJ=aM.context;aJ;aJ=aJ.prev){for(var aK=aJ.vars;aK;aK=aK.next){if(aK.name==aL){return true}}}}function g(aN,aK,aJ,aM,aO){var aP=aN.cc;E.state=aN;E.stream=aO;E.marked=null,E.cc=aP;E.style=aK;if(!aN.lexical.hasOwnProperty("align")){aN.lexical.align=true}while(true){var aL=aP.length?aP.pop():A?ao:aH;if(aL(aJ,aM)){while(aP.length&&aP[aP.length-1].lex){aP.pop()()}if(E.marked){return E.marked}if(aJ=="variable"&&t(aN,aM)){return"variable-2"}return aK}}}var E={state:null,column:null,marked:null,cc:null};function ab(){for(var aJ=arguments.length-1;aJ>=0;aJ--){E.cc.push(arguments[aJ])}}function af(){ab.apply(null,arguments);return true}function aw(aK){function aJ(aN){for(var aM=aN;aM;aM=aM.next){if(aM.name==aK){return true}}return false}var aL=E.state;if(aL.context){E.marked="def";if(aJ(aL.localVars)){return}aL.localVars={name:aK,next:aL.localVars}}else{if(aJ(aL.globalVars)){return}if(ak.globalVars){aL.globalVars={name:aK,next:aL.globalVars}}}}var r={name:"this",next:{name:"arguments"}};function x(){E.state.context={prev:E.state.context,vars:E.state.localVars};E.state.localVars=r}function y(){E.state.localVars=E.state.context.vars;E.state.context=E.state.context.prev}function aF(aK,aL){var aJ=function(){var aO=E.state,aM=aO.indented;if(aO.lexical.type=="stat"){aM=aO.lexical.indented}else{for(var aN=aO.lexical;aN&&aN.type==")"&&aN.align;aN=aN.prev){aM=aN.indented}}aO.lexical=new K(aM,E.stream.column(),aK,null,aO.lexical,aL)};aJ.lex=true;return aJ}function i(){var aJ=E.state;if(aJ.lexical.prev){if(aJ.lexical.type==")"){aJ.indented=aJ.lexical.indented}aJ.lexical=aJ.lexical.prev}}i.lex=true;function s(aJ){function aK(aL){if(aL==aJ){return af()}else{if(aJ==";"){return ab()}else{return af(aK)}}}return aK}function aH(aJ,aK){if(aJ=="var"){return af(aF("vardef",aK.length),e,s(";"),i)}if(aJ=="keyword a"){return af(aF("form"),ao,aH,i)}if(aJ=="keyword b"){return af(aF("form"),aH,i)}if(aJ=="{"){return af(aF("}"),z,i)}if(aJ==";"){return af()}if(aJ=="if"){if(E.state.lexical.info=="else"&&E.state.cc[E.state.cc.length-1]==i){E.state.cc.pop()()}return af(aF("form"),ao,aH,i,f)}if(aJ=="function"){return af(N)}if(aJ=="for"){return af(aF("form"),v,aH,i)}if(aJ=="variable"){return af(aF("stat"),aI)}if(aJ=="switch"){return af(aF("form"),ao,aF("}","switch"),s("{"),z,i,i)}if(aJ=="case"){return af(ao,s(":"))}if(aJ=="default"){return af(s(":"))}if(aJ=="catch"){return af(aF("form"),x,s("("),ag,s(")"),aH,i,y)}if(aJ=="module"){return af(aF("form"),x,I,y,i)}if(aJ=="class"){return af(aF("form"),W,i)}if(aJ=="export"){return af(aF("form"),aG,i)}if(aJ=="import"){return af(aF("form"),ah,i)}return ab(aF("stat"),ao,s(";"),i)}function ao(aJ){return Z(aJ,false)}function aE(aJ){return Z(aJ,true)}function Z(aK,aM){if(E.state.fatArrowAt==E.stream.start){var aJ=aM?O:X;if(aK=="("){return af(x,aF(")"),au(j,")"),i,s("=>"),aJ,y)}else{if(aK=="variable"){return ab(x,j,s("=>"),aJ,y)}}}var aL=aM?l:ac;if(c.hasOwnProperty(aK)){return af(aL)}if(aK=="function"){return af(N,aL)}if(aK=="keyword c"){return af(aM?al:aj)}if(aK=="("){return af(aF(")"),aj,az,s(")"),i,aL)}if(aK=="operator"||aK=="spread"){return af(aM?aE:ao)}if(aK=="["){return af(aF("]"),o,i,aL)}if(aK=="{"){return ay(u,"}",null,aL)}if(aK=="quasi"){return ab(R,aL)}return af()}function aj(aJ){if(aJ.match(/[;\}\)\],]/)){return ab()}return ab(ao)}function al(aJ){if(aJ.match(/[;\}\)\],]/)){return ab()}return ab(aE)}function ac(aJ,aK){if(aJ==","){return af(ao)}return l(aJ,aK,false)}function l(aJ,aL,aN){var aK=aN==false?ac:l;var aM=aN==false?ao:aE;if(aJ=="=>"){return af(x,aN?O:X,y)}if(aJ=="operator"){if(/\+\+|--/.test(aL)){return af(aK)}if(aL=="?"){return af(ao,s(":"),aM)}return af(aM)}if(aJ=="quasi"){return ab(R,aK)}if(aJ==";"){return}if(aJ=="("){return ay(aE,")","call",aK)}if(aJ=="."){return af(am,aK)}if(aJ=="["){return af(aF("]"),aj,s("]"),i,aK)}}function R(aJ,aK){if(aJ!="quasi"){return ab()}if(aK.slice(aK.length-2)!="${"){return af(R)}return af(ao,q)}function q(aJ){if(aJ=="}"){E.marked="string-2";E.state.tokenize=aC;return af(R)}}function X(aJ){ax(E.stream,E.state);return ab(aJ=="{"?aH:ao)}function O(aJ){ax(E.stream,E.state);return ab(aJ=="{"?aH:aE)}function aI(aJ){if(aJ==":"){return af(i,aH)}return ab(ac,s(";"),i)}function am(aJ){if(aJ=="variable"){E.marked="property";return af()}}function u(aJ,aK){if(aJ=="variable"||E.style=="keyword"){E.marked="property";if(aK=="get"||aK=="set"){return af(J)}return af(L)}else{if(aJ=="number"||aJ=="string"){E.marked=aB?"property":(E.style+" property");return af(L)}else{if(aJ=="jsonld-keyword"){return af(L)}else{if(aJ=="["){return af(ao,s("]"),L)}}}}}function J(aJ){if(aJ!="variable"){return ab(L)}E.marked="property";return af(N)}function L(aJ){if(aJ==":"){return af(aE)}if(aJ=="("){return ab(N)}}function au(aL,aJ){function aK(aN){if(aN==","){var aM=E.state.lexical;if(aM.info=="call"){aM.pos=(aM.pos||0)+1}return af(aL,aK)}if(aN==aJ){return af()}return af(s(aJ))}return function(aM){if(aM==aJ){return af()}return ab(aL,aK)}}function ay(aM,aJ,aL){for(var aK=3;aK<arguments.length;aK++){E.cc.push(arguments[aK])}return af(aF(aJ,aL),au(aM,aJ),i)}function z(aJ){if(aJ=="}"){return af()}return ab(aH,z)}function U(aJ){if(h&&aJ==":"){return af(ae)}}function ae(aJ){if(aJ=="variable"){E.marked="variable-3";return af()}}function e(){return ab(j,U,ad,Y)}function j(aJ,aK){if(aJ=="variable"){aw(aK);return af()}if(aJ=="["){return ay(j,"]")}if(aJ=="{"){return ay(aD,"}")}}function aD(aJ,aK){if(aJ=="variable"&&!E.stream.match(/^\s*:/,false)){aw(aK);return af(ad)}if(aJ=="variable"){E.marked="property"}return af(s(":"),j,ad)}function ad(aJ,aK){if(aK=="="){return af(aE)}}function Y(aJ){if(aJ==","){return af(e)}}function f(aJ,aK){if(aJ=="keyword b"&&aK=="else"){return af(aF("form","else"),aH,i)}}function v(aJ){if(aJ=="("){return af(aF(")"),F,s(")"),i)}}function F(aJ){if(aJ=="var"){return af(e,s(";"),D)}if(aJ==";"){return af(D)}if(aJ=="variable"){return af(w)}return ab(ao,s(";"),D)}function w(aJ,aK){if(aK=="in"||aK=="of"){E.marked="keyword";return af(ao)}return af(ac,D)}function D(aJ,aK){if(aJ==";"){return af(C)}if(aK=="in"||aK=="of"){E.marked="keyword";return af(ao)}return ab(ao,s(";"),C)}function C(aJ){if(aJ!=")"){af(ao)}}function N(aJ,aK){if(aK=="*"){E.marked="keyword";return af(N)}if(aJ=="variable"){aw(aK);return af(N)}if(aJ=="("){return af(x,aF(")"),au(ag,")"),i,aH,y)}}function ag(aJ){if(aJ=="spread"){return af(ag)}return ab(j,U)}function W(aJ,aK){if(aJ=="variable"){aw(aK);return af(P)}}function P(aJ,aK){if(aK=="extends"){return af(ao,P)}if(aJ=="{"){return af(aF("}"),p,i)}}function p(aJ,aK){if(aJ=="variable"||E.style=="keyword"){if(aK=="static"){E.marked="keyword";return af(p)}E.marked="property";if(aK=="get"||aK=="set"){return af(d,N,p)}return af(N,p)}if(aK=="*"){E.marked="keyword";return af(p)}if(aJ==";"){return af(p)}if(aJ=="}"){return af()}}function d(aJ){if(aJ!="variable"){return ab()}E.marked="property";return af()}function I(aJ,aK){if(aJ=="string"){return af(aH)}if(aJ=="variable"){aw(aK);return af(ai)}}function aG(aJ,aK){if(aK=="*"){E.marked="keyword";return af(ai,s(";"))}if(aK=="default"){E.marked="keyword";return af(ao,s(";"))}return ab(aH)}function ah(aJ){if(aJ=="string"){return af()}return ab(aq,ai)}function aq(aJ,aK){if(aJ=="{"){return ay(aq,"}")}if(aJ=="variable"){aw(aK)}return af()}function ai(aJ,aK){if(aK=="from"){E.marked="keyword";return af(ao)}}function o(aJ){if(aJ=="]"){return af()}return ab(aE,an)}function an(aJ){if(aJ=="for"){return ab(az,s("]"))}if(aJ==","){return af(au(al,"]"))}return ab(au(aE,"]"))}function az(aJ){if(aJ=="for"){return af(v,az)}if(aJ=="if"){return af(ao,az)}}function ap(aK,aJ){return aK.lastType=="operator"||aK.lastType==","||Q.test(aJ.charAt(0))||/[,.]/.test(aJ.charAt(0))}return{startState:function(aK){var aJ={tokenize:V,lastType:"sof",cc:[],lexical:new K((aK||0)-m,0,"block",false),localVars:ak.localVars,context:ak.localVars&&{vars:ak.localVars},indented:0};if(ak.globalVars&&typeof ak.globalVars=="object"){aJ.globalVars=ak.globalVars}return aJ},token:function(aL,aK){if(aL.sol()){if(!aK.lexical.hasOwnProperty("align")){aK.lexical.align=false}aK.indented=aL.indentation();ax(aL,aK)}if(aK.tokenize!=aA&&aL.eatSpace()){return null}var aJ=aK.tokenize(aL,aK);if(T=="comment"){return aJ}aK.lastType=T=="operator"&&(H=="++"||H=="--")?"incdec":T;return g(aK,aJ,T,H,aL)},indent:function(aP,aJ){if(aP.tokenize==aA){return b.Pass}if(aP.tokenize!=V){return 0}var aO=aJ&&aJ.charAt(0),aM=aP.lexical;if(!/^\s*else\b/.test(aJ)){for(var aL=aP.cc.length-1;aL>=0;--aL){var aQ=aP.cc[aL];if(aQ==i){aM=aM.prev}else{if(aQ!=f){break}}}}if(aM.type=="stat"&&aO=="}"){aM=aM.prev}if(B&&aM.type==")"&&aM.prev.type=="stat"){aM=aM.prev}var aN=aM.type,aK=aO==aN;if(aN=="vardef"){return aM.indented+(aP.lastType=="operator"||aP.lastType==","?aM.info+1:0)}else{if(aN=="form"&&aO=="{"){return aM.indented}else{if(aN=="form"){return aM.indented+m}else{if(aN=="stat"){return aM.indented+(ap(aP,aJ)?B||m:0)}else{if(aM.info=="switch"&&!aK&&ak.doubleIndentSwitch!=false){return aM.indented+(/^(?:case|default)\b/.test(aJ)?m:2*m)}else{if(aM.align){return aM.column+(aK?0:1)}else{return aM.indented+(aK?0:m)}}}}}}},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:A?null:"/*",blockCommentEnd:A?null:"*/",lineComment:A?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:A?"json":"javascript",jsonldMode:aB,jsonMode:A}});b.registerHelper("wordChars","javascript",/[\w$]/);b.defineMIME("text/javascript","javascript");b.defineMIME("text/ecmascript","javascript");b.defineMIME("application/javascript","javascript");b.defineMIME("application/x-javascript","javascript");b.defineMIME("application/ecmascript","javascript");b.defineMIME("application/json",{name:"javascript",json:true});b.defineMIME("application/x-json",{name:"javascript",json:true});b.defineMIME("application/ld+json",{name:"javascript",jsonld:true});b.defineMIME("text/typescript",{name:"javascript",typescript:true});b.defineMIME("application/typescript",{name:"javascript",typescript:true})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("julia",function(c,x){var e="error";function o(C){return new RegExp("^(("+C.join(")|(")+"))\\b")}var s=x.operators||/^\.?[|&^\\%*+\-<>!=\/]=?|\?|~|:|\$|\.[<>]|<<=?|>>>?=?|\.[<>=]=|->?|\/\/|\bin\b/;var j=x.delimiters||/^[;,()[\]{}]/;var l=x.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*!*/;var f=["begin","function","type","immutable","let","macro","for","while","quote","if","else","elseif","try","finally","catch","do"];var v=["end","else","elseif","catch","finally"];var q=["if","else","elseif","while","for","begin","let","end","do","try","catch","finally","return","break","continue","global","local","const","export","import","importall","using","function","macro","module","baremodule","type","immutable","quote","typealias","abstract","bitstype","ccall"];var d=["true","false","enumerate","open","close","nothing","NaN","Inf","print","println","Int","Int8","Uint8","Int16","Uint16","Int32","Uint32","Int64","Uint64","Int128","Uint128","Bool","Char","Float16","Float32","Float64","Array","Vector","Matrix","String","UTF8String","ASCIIString","error","warn","info","@printf"];var n=/^(`|'|"{3}|([br]?"))/;var m=o(q);var h=o(d);var p=o(f);var g=o(v);var z=/^@[_A-Za-z][_A-Za-z0-9]*/;var t=/^:[_A-Za-z][_A-Za-z0-9]*/;var y=null;function u(D){var C=w(D);if(C=="["||C=="{"){return true}else{return false}}function w(C){if(C.scopes.length==0){return null}return C.scopes[C.scopes.length-1]}function B(H,E){var I=E.leaving_expr;if(H.sol()){I=false}E.leaving_expr=false;if(I){if(H.match(/^'+/)){return"operator"}}if(H.match(/^\.{2,3}/)){return"operator"}if(H.eatSpace()){return null}var C=H.peek();if(C==="#"){H.skipToEnd();return"comment"}if(C==="["){E.scopes.push("[")}if(C==="{"){E.scopes.push("{")}var J=w(E);if(J==="["&&C==="]"){E.scopes.pop();E.leaving_expr=true}if(J==="{"&&C==="}"){E.scopes.pop();E.leaving_expr=true}if(C===")"){E.leaving_expr=true}var G;if(!u(E)&&(G=H.match(p,false))){E.scopes.push(G)}if(!u(E)&&H.match(g,false)){E.scopes.pop()}if(u(E)){if(H.match(/^end/)){return"number"}}if(H.match(/^=>/)){return"operator"}if(H.match(/^[0-9\.]/,false)){var D=RegExp(/^im\b/);var K=false;if(H.match(/^\d*\.(?!\.)\d+([ef][\+\-]?\d+)?/i)){K=true}if(H.match(/^\d+\.(?!\.)\d*/)){K=true}if(H.match(/^\.\d+/)){K=true}if(K){H.match(D);E.leaving_expr=true;return"number"}var F=false;if(H.match(/^0x[0-9a-f]+/i)){F=true}if(H.match(/^0b[01]+/i)){F=true}if(H.match(/^0o[0-7]+/i)){F=true}if(H.match(/^[1-9]\d*(e[\+\-]?\d+)?/)){F=true}if(H.match(/^0(?![\dx])/i)){F=true}if(F){H.match(D);E.leaving_expr=true;return"number"}}if(H.match(/^(::)|(<:)/)){return"operator"}if(!I&&H.match(t)){return"string"}if(H.match(s)){return"operator"}if(H.match(n)){E.tokenize=r(H.current());return E.tokenize(H,E)}if(H.match(z)){return"meta"}if(H.match(j)){return null}if(H.match(m)){return"keyword"}if(H.match(h)){return"builtin"}if(H.match(l)){E.leaving_expr=true;return"variable"}H.next();return e}function r(C){while("rub".indexOf(C.charAt(0).toLowerCase())>=0){C=C.substr(1)}var E=C.length==1;var D="string";function F(H,G){while(!H.eol()){H.eatWhile(/[^'"\\]/);if(H.eat("\\")){H.next();if(E&&H.eol()){return D}}else{if(H.match(C)){G.tokenize=B;return D}else{H.eat(/['"]/)}}}if(E){if(x.singleLineStringErrors){return e}else{G.tokenize=B}}return D}F.isString=true;return F}function A(F,D){y=null;var C=D.tokenize(F,D);var E=F.current();if(E==="."){C=F.match(l,false)?null:e;if(C===null&&D.lastStyle==="meta"){C="meta"}return C}return C}var i={startState:function(){return{tokenize:B,scopes:[],leaving_expr:false}},token:function(E,D){var C=A(E,D);D.lastStyle=C;return C},indent:function(D,C){var E=0;if(C=="end"||C=="]"||C=="}"||C=="else"||C=="elseif"||C=="catch"||C=="finally"){E=-1}return(D.scopes.length+E)*4},lineComment:"#",fold:"indent",electricChars:"edlsifyh]}"};return i});b.defineMIME("text/x-julia","julia")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("lua",function(g,i){var l=g.indentUnit;function d(s){return new RegExp("^(?:"+s.join("|")+")","i")}function h(s){return new RegExp("^(?:"+s.join("|")+")$","i")}var o=h(i.specials||[]);var c=h(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load","loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable","debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow","math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep","string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]);var j=h(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]);var r=h(["function","if","repeat","do","\\(","{"]);var p=h(["end","until","\\)","}"]);var e=d(["end","until","\\)","}","else","elseif"]);function f(s){var t=0;while(s.eat("=")){++t}s.eat("[");return t}function n(u,t){var s=u.next();if(s=="-"&&u.eat("-")){if(u.eat("[")&&u.eat("[")){return(t.cur=q(f(u),"comment"))(u,t)}u.skipToEnd();return"comment"}if(s=='"'||s=="'"){return(t.cur=m(s))(u,t)}if(s=="["&&/[\[=]/.test(u.peek())){return(t.cur=q(f(u),"string"))(u,t)}if(/\d/.test(s)){u.eatWhile(/[\w.%]/);return"number"}if(/[\w_]/.test(s)){u.eatWhile(/[\w\\\-_.]/);return"variable"}return null}function q(t,s){return function(x,w){var u=null,v;while((v=x.next())!=null){if(u==null){if(v=="]"){u=0}}else{if(v=="="){++u}else{if(v=="]"&&u==t){w.cur=n;break}else{u=null}}}}return s}}function m(s){return function(w,u){var v=false,t;while((t=w.next())!=null){if(t==s&&!v){break}v=!v&&t=="\\"}if(!v){u.cur=n}return"string"}}return{startState:function(s){return{basecol:s||0,indentDepth:0,cur:n}},token:function(v,t){if(v.eatSpace()){return null}var s=t.cur(v,t);var u=v.current();if(s=="variable"){if(j.test(u)){s="keyword"}else{if(c.test(u)){s="builtin"}else{if(o.test(u)){s="variable-2"}}}}if((s!="comment")&&(s!="string")){if(r.test(u)){++t.indentDepth}else{if(p.test(u)){--t.indentDepth}}}return s},indent:function(u,s){var t=e.test(s);return u.basecol+l*(u.indentDepth-(t?1:0))},lineComment:"--",blockCommentStart:"--[[",blockCommentEnd:"]]"}});b.defineMIME("text/x-lua","lua")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("mllike",function(g,e){var h={let:"keyword",rec:"keyword","in":"keyword",of:"keyword",and:"keyword","if":"keyword",then:"keyword","else":"keyword","for":"keyword",to:"keyword","while":"keyword","do":"keyword",done:"keyword",fun:"keyword","function":"keyword",val:"keyword",type:"keyword",mutable:"keyword",match:"keyword","with":"keyword","try":"keyword",open:"builtin",ignore:"builtin",begin:"keyword",end:"keyword"};var c=e.extraWords||{};for(var j in c){if(c.hasOwnProperty(j)){h[j]=e.extraWords[j]}}function i(o,m){var l=o.next();if(l==='"'){m.tokenize=f;return m.tokenize(o,m)}if(l==="("){if(o.eat("*")){m.commentLevel++;m.tokenize=d;return m.tokenize(o,m)}}if(l==="~"){o.eatWhile(/\w/);return"variable-2"}if(l==="`"){o.eatWhile(/\w/);return"quote"}if(l==="/"&&e.slashComments&&o.eat("/")){o.skipToEnd();return"comment"}if(/\d/.test(l)){o.eatWhile(/[\d]/);if(o.eat(".")){o.eatWhile(/[\d]/)}return"number"}if(/[+\-*&%=<>!?|]/.test(l)){return"operator"}o.eatWhile(/\w/);var n=o.current();return h.hasOwnProperty(n)?h[n]:"variable"}function f(p,n){var m,l=false,o=false;while((m=p.next())!=null){if(m==='"'&&!o){l=true;break}o=!o&&m==="\\"}if(l&&!o){n.tokenize=i}return"string"}function d(o,n){var m,l;while(n.commentLevel>0&&(l=o.next())!=null){if(m==="("&&l==="*"){n.commentLevel++}if(m==="*"&&l===")"){n.commentLevel--}m=l}if(n.commentLevel<=0){n.tokenize=i}return"comment"}return{startState:function(){return{tokenize:i,commentLevel:0}},token:function(m,l){if(m.eatSpace()){return null}return l.tokenize(m,l)},blockCommentStart:"(*",blockCommentEnd:"*)",lineComment:e.slashComments?"//":null}});b.defineMIME("text/x-ocaml",{name:"mllike",extraWords:{succ:"keyword",trace:"builtin",exit:"builtin",print_string:"builtin",print_endline:"builtin","true":"atom","false":"atom",raise:"keyword"}});b.defineMIME("text/x-fsharp",{name:"mllike",extraWords:{"abstract":"keyword",as:"keyword",assert:"keyword",base:"keyword","class":"keyword","default":"keyword",delegate:"keyword",downcast:"keyword",downto:"keyword",elif:"keyword",exception:"keyword",extern:"keyword","finally":"keyword",global:"keyword",inherit:"keyword",inline:"keyword","interface":"keyword",internal:"keyword",lazy:"keyword","let!":"keyword",member:"keyword",module:"keyword",namespace:"keyword","new":"keyword","null":"keyword",override:"keyword","private":"keyword","public":"keyword","return":"keyword","return!":"keyword",select:"keyword","static":"keyword",struct:"keyword",upcast:"keyword",use:"keyword","use!":"keyword",val:"keyword",when:"keyword",yield:"keyword","yield!":"keyword",List:"builtin",Seq:"builtin",Map:"builtin",Set:"builtin","int":"builtin",string:"builtin",raise:"builtin",failwith:"builtin",not:"builtin","true":"builtin","false":"builtin"},slashComments:true})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("perl",function(){var g={"->":4,"++":4,"--":4,"**":4,"=~":4,"!~":4,"*":4,"/":4,"%":4,x:4,"+":4,"-":4,".":4,"<<":4,">>":4,"<":4,">":4,"<=":4,">=":4,lt:4,gt:4,le:4,ge:4,"==":4,"!=":4,"<=>":4,eq:4,ne:4,cmp:4,"~~":4,"&":4,"|":4,"^":4,"&&":4,"||":4,"//":4,"..":4,"...":4,"?":4,":":4,"=":4,"+=":4,"-=":4,"*=":4,",":4,"=>":4,"::":4,not:4,and:4,or:4,xor:4,BEGIN:[5,1],END:[5,1],PRINT:[5,1],PRINTF:[5,1],GETC:[5,1],READ:[5,1],READLINE:[5,1],DESTROY:[5,1],TIE:[5,1],TIEHANDLE:[5,1],UNTIE:[5,1],STDIN:5,STDIN_TOP:5,STDOUT:5,STDOUT_TOP:5,STDERR:5,STDERR_TOP:5,"$ARG":5,"$_":5,"@ARG":5,"@_":5,"$LIST_SEPARATOR":5,'$"':5,"$PROCESS_ID":5,"$PID":5,"$$":5,"$REAL_GROUP_ID":5,"$GID":5,"$(":5,"$EFFECTIVE_GROUP_ID":5,"$EGID":5,"$)":5,"$PROGRAM_NAME":5,"$0":5,"$SUBSCRIPT_SEPARATOR":5,"$SUBSEP":5,"$;":5,"$REAL_USER_ID":5,"$UID":5,"$<":5,"$EFFECTIVE_USER_ID":5,"$EUID":5,"$>":5,"$a":5,"$b":5,"$COMPILING":5,"$^C":5,"$DEBUGGING":5,"$^D":5,"${^ENCODING}":5,"$ENV":5,"%ENV":5,"$SYSTEM_FD_MAX":5,"$^F":5,"@F":5,"${^GLOBAL_PHASE}":5,"$^H":5,"%^H":5,"@INC":5,"%INC":5,"$INPLACE_EDIT":5,"$^I":5,"$^M":5,"$OSNAME":5,"$^O":5,"${^OPEN}":5,"$PERLDB":5,"$^P":5,"$SIG":5,"%SIG":5,"$BASETIME":5,"$^T":5,"${^TAINT}":5,"${^UNICODE}":5,"${^UTF8CACHE}":5,"${^UTF8LOCALE}":5,"$PERL_VERSION":5,"$^V":5,"${^WIN32_SLOPPY_STAT}":5,"$EXECUTABLE_NAME":5,"$^X":5,"$1":5,"$MATCH":5,"$&":5,"${^MATCH}":5,"$PREMATCH":5,"$`":5,"${^PREMATCH}":5,"$POSTMATCH":5,"$'":5,"${^POSTMATCH}":5,"$LAST_PAREN_MATCH":5,"$+":5,"$LAST_SUBMATCH_RESULT":5,"$^N":5,"@LAST_MATCH_END":5,"@+":5,"%LAST_PAREN_MATCH":5,"%+":5,"@LAST_MATCH_START":5,"@-":5,"%LAST_MATCH_START":5,"%-":5,"$LAST_REGEXP_CODE_RESULT":5,"$^R":5,"${^RE_DEBUG_FLAGS}":5,"${^RE_TRIE_MAXBUF}":5,"$ARGV":5,"@ARGV":5,ARGV:5,ARGVOUT:5,"$OUTPUT_FIELD_SEPARATOR":5,"$OFS":5,"$,":5,"$INPUT_LINE_NUMBER":5,"$NR":5,"$.":5,"$INPUT_RECORD_SEPARATOR":5,"$RS":5,"$/":5,"$OUTPUT_RECORD_SEPARATOR":5,"$ORS":5,"$\\":5,"$OUTPUT_AUTOFLUSH":5,"$|":5,"$ACCUMULATOR":5,"$^A":5,"$FORMAT_FORMFEED":5,"$^L":5,"$FORMAT_PAGE_NUMBER":5,"$%":5,"$FORMAT_LINES_LEFT":5,"$-":5,"$FORMAT_LINE_BREAK_CHARACTERS":5,"$:":5,"$FORMAT_LINES_PER_PAGE":5,"$=":5,"$FORMAT_TOP_NAME":5,"$^":5,"$FORMAT_NAME":5,"$~":5,"${^CHILD_ERROR_NATIVE}":5,"$EXTENDED_OS_ERROR":5,"$^E":5,"$EXCEPTIONS_BEING_CAUGHT":5,"$^S":5,"$WARNING":5,"$^W":5,"${^WARNING_BITS}":5,"$OS_ERROR":5,"$ERRNO":5,"$!":5,"%OS_ERROR":5,"%ERRNO":5,"%!":5,"$CHILD_ERROR":5,"$?":5,"$EVAL_ERROR":5,"$@":5,"$OFMT":5,"$#":5,"$*":5,"$ARRAY_BASE":5,"$[":5,"$OLD_PERL_VERSION":5,"$]":5,"if":[1,1],elsif:[1,1],"else":[1,1],"while":[1,1],unless:[1,1],"for":[1,1],foreach:[1,1],abs:1,accept:1,alarm:1,atan2:1,bind:1,binmode:1,bless:1,bootstrap:1,"break":1,caller:1,chdir:1,chmod:1,chomp:1,chop:1,chown:1,chr:1,chroot:1,close:1,closedir:1,connect:1,"continue":[1,1],cos:1,crypt:1,dbmclose:1,dbmopen:1,"default":1,defined:1,"delete":1,die:1,"do":1,dump:1,each:1,endgrent:1,endhostent:1,endnetent:1,endprotoent:1,endpwent:1,endservent:1,eof:1,"eval":1,exec:1,exists:1,exit:1,exp:1,fcntl:1,fileno:1,flock:1,fork:1,format:1,formline:1,getc:1,getgrent:1,getgrgid:1,getgrnam:1,gethostbyaddr:1,gethostbyname:1,gethostent:1,getlogin:1,getnetbyaddr:1,getnetbyname:1,getnetent:1,getpeername:1,getpgrp:1,getppid:1,getpriority:1,getprotobyname:1,getprotobynumber:1,getprotoent:1,getpwent:1,getpwnam:1,getpwuid:1,getservbyname:1,getservbyport:1,getservent:1,getsockname:1,getsockopt:1,given:1,glob:1,gmtime:1,"goto":1,grep:1,hex:1,"import":1,index:1,"int":1,ioctl:1,join:1,keys:1,kill:1,last:1,lc:1,lcfirst:1,length:1,link:1,listen:1,local:2,localtime:1,lock:1,log:1,lstat:1,m:null,map:1,mkdir:1,msgctl:1,msgget:1,msgrcv:1,msgsnd:1,my:2,"new":1,next:1,no:1,oct:1,open:1,opendir:1,ord:1,our:2,pack:1,"package":1,pipe:1,pop:1,pos:1,print:1,printf:1,prototype:1,push:1,q:null,qq:null,qr:null,quotemeta:null,qw:null,qx:null,rand:1,read:1,readdir:1,readline:1,readlink:1,readpipe:1,recv:1,redo:1,ref:1,rename:1,require:1,reset:1,"return":1,reverse:1,rewinddir:1,rindex:1,rmdir:1,s:null,say:1,scalar:1,seek:1,seekdir:1,select:1,semctl:1,semget:1,semop:1,send:1,setgrent:1,sethostent:1,setnetent:1,setpgrp:1,setpriority:1,setprotoent:1,setpwent:1,setservent:1,setsockopt:1,shift:1,shmctl:1,shmget:1,shmread:1,shmwrite:1,shutdown:1,sin:1,sleep:1,socket:1,socketpair:1,sort:1,splice:1,split:1,sprintf:1,sqrt:1,srand:1,stat:1,state:1,study:1,sub:1,substr:1,symlink:1,syscall:1,sysopen:1,sysread:1,sysseek:1,system:1,syswrite:1,tell:1,telldir:1,tie:1,tied:1,time:1,times:1,tr:null,truncate:1,uc:1,ucfirst:1,umask:1,undef:1,unlink:1,unpack:1,unshift:1,untie:1,use:1,utime:1,values:1,vec:1,wait:1,waitpid:1,wantarray:1,warn:1,when:1,write:1,y:null};var l="string-2";var i=/[goseximacplud]/;function h(r,q,o,p,n){q.chain=null;q.style=null;q.tail=null;q.tokenize=function(v,t){var u=false,w,s=0;while(w=v.next()){if(w===o[s]&&!u){if(o[++s]!==undefined){t.chain=o[s];t.style=p;t.tail=n}else{if(n){v.eatWhile(n)}}t.tokenize=m;return p}u=!u&&w=="\\"}return p};return q.tokenize(r,q)}function j(p,o,n){o.tokenize=function(r,q){if(r.string==n){q.tokenize=m}r.skipToEnd();return"string"};return o.tokenize(p,o)}function m(t,r){if(t.eatSpace()){return null}if(r.chain){return h(t,r,r.chain,r.style,r.tail)}if(t.match(/^\-?[\d\.]/,false)){if(t.match(/^(\-?(\d*\.\d+(e[+-]?\d+)?|\d+\.\d*)|0x[\da-fA-F]+|0b[01]+|\d+(e[+-]?\d+)?)/)){return"number"}}if(t.match(/^<<(?=\w)/)){t.eatWhile(/\w/);return j(t,r,t.current().substr(2))}if(t.sol()&&t.match(/^\=item(?!\w)/)){return j(t,r,"=cut")}var q=t.next();if(q=='"'||q=="'"){if(d(t,3)=="<<"+q){var s=t.pos;t.eatWhile(/\w/);var v=t.current().substr(1);if(v&&t.eat(q)){return j(t,r,v)}t.pos=s}return h(t,r,[q],"string")}if(q=="q"){var u=c(t,-2);if(!(u&&/\w/.test(u))){u=c(t,0);if(u=="x"){u=c(t,1);if(u=="("){e(t,2);return h(t,r,[")"],l,i)}if(u=="["){e(t,2);return h(t,r,["]"],l,i)}if(u=="{"){e(t,2);return h(t,r,["}"],l,i)}if(u=="<"){e(t,2);return h(t,r,[">"],l,i)}if(/[\^'"!~\/]/.test(u)){e(t,1);return h(t,r,[t.eat(u)],l,i)}}else{if(u=="q"){u=c(t,1);if(u=="("){e(t,2);return h(t,r,[")"],"string")}if(u=="["){e(t,2);return h(t,r,["]"],"string")}if(u=="{"){e(t,2);return h(t,r,["}"],"string")}if(u=="<"){e(t,2);return h(t,r,[">"],"string")}if(/[\^'"!~\/]/.test(u)){e(t,1);return h(t,r,[t.eat(u)],"string")}}else{if(u=="w"){u=c(t,1);if(u=="("){e(t,2);return h(t,r,[")"],"bracket")}if(u=="["){e(t,2);return h(t,r,["]"],"bracket")}if(u=="{"){e(t,2);return h(t,r,["}"],"bracket")}if(u=="<"){e(t,2);return h(t,r,[">"],"bracket")}if(/[\^'"!~\/]/.test(u)){e(t,1);return h(t,r,[t.eat(u)],"bracket")}}else{if(u=="r"){u=c(t,1);if(u=="("){e(t,2);return h(t,r,[")"],l,i)}if(u=="["){e(t,2);return h(t,r,["]"],l,i)}if(u=="{"){e(t,2);return h(t,r,["}"],l,i)}if(u=="<"){e(t,2);return h(t,r,[">"],l,i)}if(/[\^'"!~\/]/.test(u)){e(t,1);return h(t,r,[t.eat(u)],l,i)}}else{if(/[\^'"!~\/(\[{<]/.test(u)){if(u=="("){e(t,1);return h(t,r,[")"],"string")}if(u=="["){e(t,1);return h(t,r,["]"],"string")}if(u=="{"){e(t,1);return h(t,r,["}"],"string")}if(u=="<"){e(t,1);return h(t,r,[">"],"string")}if(/[\^'"!~\/]/.test(u)){return h(t,r,[t.eat(u)],"string")}}}}}}}}if(q=="m"){var u=c(t,-2);if(!(u&&/\w/.test(u))){u=t.eat(/[(\[{<\^'"!~\/]/);if(u){if(/[\^'"!~\/]/.test(u)){return h(t,r,[u],l,i)}if(u=="("){return h(t,r,[")"],l,i)}if(u=="["){return h(t,r,["]"],l,i)}if(u=="{"){return h(t,r,["}"],l,i)}if(u=="<"){return h(t,r,[">"],l,i)}}}}if(q=="s"){var u=/[\/>\]})\w]/.test(c(t,-2));if(!u){u=t.eat(/[(\[{<\^'"!~\/]/);if(u){if(u=="["){return h(t,r,["]","]"],l,i)}if(u=="{"){return h(t,r,["}","}"],l,i)}if(u=="<"){return h(t,r,[">",">"],l,i)}if(u=="("){return h(t,r,[")",")"],l,i)}return h(t,r,[u,u],l,i)}}}if(q=="y"){var u=/[\/>\]})\w]/.test(c(t,-2));if(!u){u=t.eat(/[(\[{<\^'"!~\/]/);if(u){if(u=="["){return h(t,r,["]","]"],l,i)}if(u=="{"){return h(t,r,["}","}"],l,i)}if(u=="<"){return h(t,r,[">",">"],l,i)}if(u=="("){return h(t,r,[")",")"],l,i)}return h(t,r,[u,u],l,i)}}}if(q=="t"){var u=/[\/>\]})\w]/.test(c(t,-2));if(!u){u=t.eat("r");if(u){u=t.eat(/[(\[{<\^'"!~\/]/);if(u){if(u=="["){return h(t,r,["]","]"],l,i)}if(u=="{"){return h(t,r,["}","}"],l,i)}if(u=="<"){return h(t,r,[">",">"],l,i)}if(u=="("){return h(t,r,[")",")"],l,i)}return h(t,r,[u,u],l,i)}}}}if(q=="`"){return h(t,r,[q],"variable-2")}if(q=="/"){if(!/~\s*$/.test(d(t))){return"operator"}else{return h(t,r,[q],l,i)}}if(q=="$"){var s=t.pos;if(t.eatWhile(/\d/)||t.eat("{")&&t.eatWhile(/\d/)&&t.eat("}")){return"variable-2"}else{t.pos=s}}if(/[$@%]/.test(q)){var s=t.pos;if(t.eat("^")&&t.eat(/[A-Z]/)||!/[@$%&]/.test(c(t,-2))&&t.eat(/[=|\\\-#?@;:&`~\^!\[\]*'"$+.,\/<>()]/)){var u=t.current();if(g[u]){return"variable-2"}}t.pos=s}if(/[$@%&]/.test(q)){if(t.eatWhile(/[\w$\[\]]/)||t.eat("{")&&t.eatWhile(/[\w$\[\]]/)&&t.eat("}")){var u=t.current();if(g[u]){return"variable-2"}else{return"variable"}}}if(q=="#"){if(c(t,-2)!="$"){t.skipToEnd();return"comment"}}if(/[:+\-\^*$&%@=<>!?|\/~\.]/.test(q)){var s=t.pos;t.eatWhile(/[:+\-\^*$&%@=<>!?|\/~\.]/);if(g[t.current()]){return"operator"}else{t.pos=s}}if(q=="_"){if(t.pos==1){if(f(t,6)=="_END__"){return h(t,r,["\0"],"comment")}else{if(f(t,7)=="_DATA__"){return h(t,r,["\0"],"variable-2")}else{if(f(t,7)=="_C__"){return h(t,r,["\0"],"string")}}}}}if(/\w/.test(q)){var s=t.pos;if(c(t,-2)=="{"&&(c(t,0)=="}"||t.eatWhile(/\w/)&&c(t,0)=="}")){return"string"}else{t.pos=s}}if(/[A-Z]/.test(q)){var o=c(t,-2);var s=t.pos;t.eatWhile(/[A-Z_]/);if(/[\da-z]/.test(c(t,0))){t.pos=s}else{var u=g[t.current()];if(!u){return"meta"}if(u[1]){u=u[0]}if(o!=":"){if(u==1){return"keyword"}else{if(u==2){return"def"}else{if(u==3){return"atom"}else{if(u==4){return"operator"}else{if(u==5){return"variable-2"}else{return"meta"}}}}}}else{return"meta"}}}if(/[a-zA-Z_]/.test(q)){var o=c(t,-2);t.eatWhile(/\w/);var u=g[t.current()];if(!u){return"meta"}if(u[1]){u=u[0]}if(o!=":"){if(u==1){return"keyword"}else{if(u==2){return"def"}else{if(u==3){return"atom"}else{if(u==4){return"operator"}else{if(u==5){return"variable-2"}else{return"meta"}}}}}}else{return"meta"}}return null}return{startState:function(){return{tokenize:m,chain:null,style:null,tail:null}},token:function(o,n){return(n.tokenize||m)(o,n)},lineComment:"#"}});b.registerHelper("wordChars","perl",/[\w$]/);b.defineMIME("text/x-perl","perl");function c(g,h){return g.string.charAt(g.pos+(h||0))}function d(h,i){if(i){var g=h.pos-i;return h.string.substr((g>=0?g:0),i)}else{return h.string.substr(0,h.pos-1)}}function f(h,j){var i=h.string.length;var g=i-h.pos+1;return h.string.substr(h.pos,(j&&j<i?j:g))}function e(h,j){var g=h.pos+j;var i;if(g<=0){h.pos=0}else{if(g>=(i=h.string.length-1)){h.pos=i}else{h.pos=g}}}});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed"),require("../clike/clike"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../htmlmixed/htmlmixed","../clike/clike"],b)}else{b(CodeMirror)}}})(function(d){function f(o){var m={},n=o.split(" ");for(var l=0;l<n.length;++l){m[n[l]]=true}return m}function e(m,l){if(m.length==0){return h(l)}return function(q,p){var o=m[0];for(var n=0;n<o.length;n++){if(q.match(o[n][0])){p.tokenize=e(m.slice(1),l);return o[n][1]}}p.tokenize=h(l);return"string"}}function h(l){return function(n,m){return b(n,m,l)}}function b(o,m,l){if(o.match("${",false)||o.match("{$",false)){m.tokenize=null;return"string"}if(o.match(/^\$[a-zA-Z_][a-zA-Z0-9_]*/)){if(o.match("[",false)){m.tokenize=e([[["[",null]],[[/\d[\w\.]*/,"number"],[/\$[a-zA-Z_][a-zA-Z0-9_]*/,"variable-2"],[/[\w\$]+/,"variable"]],[["]",null]]],l)}if(o.match(/\-\>\w/,false)){m.tokenize=e([[["->",null]],[[/[\w]+/,"variable"]]],l)}return"variable-2"}var n=false;while(!o.eol()&&(n||(!o.match("{$",false)&&!o.match(/^(\$[a-zA-Z_][a-zA-Z0-9_]*|\$\{)/,false)))){if(!n&&o.match(l)){m.tokenize=null;m.tokStack.pop();m.tokStack.pop();break}n=o.next()=="\\"&&!n}return"string"}var i="abstract and array as break case catch class clone const continue declare default do else elseif enddeclare endfor endforeach endif endswitch endwhile extends final for foreach function global goto if implements interface instanceof namespace new or private protected public static switch throw trait try use var while xor die echo empty exit eval include include_once isset list require require_once return print unset __halt_compiler self static parent yield insteadof finally";var j="true false null TRUE FALSE NULL __CLASS__ __DIR__ __FILE__ __LINE__ __METHOD__ __FUNCTION__ __NAMESPACE__ __TRAIT__";var c="func_num_args func_get_arg func_get_args strlen strcmp strncmp strcasecmp strncasecmp each error_reporting define defined trigger_error user_error set_error_handler restore_error_handler get_declared_classes get_loaded_extensions extension_loaded get_extension_funcs debug_backtrace constant bin2hex hex2bin sleep usleep time mktime gmmktime strftime gmstrftime strtotime date gmdate getdate localtime checkdate flush wordwrap htmlspecialchars htmlentities html_entity_decode md5 md5_file crc32 getimagesize image_type_to_mime_type phpinfo phpversion phpcredits strnatcmp strnatcasecmp substr_count strspn strcspn strtok strtoupper strtolower strpos strrpos strrev hebrev hebrevc nl2br basename dirname pathinfo stripslashes stripcslashes strstr stristr strrchr str_shuffle str_word_count strcoll substr substr_replace quotemeta ucfirst ucwords strtr addslashes addcslashes rtrim str_replace str_repeat count_chars chunk_split trim ltrim strip_tags similar_text explode implode setlocale localeconv parse_str str_pad chop strchr sprintf printf vprintf vsprintf sscanf fscanf parse_url urlencode urldecode rawurlencode rawurldecode readlink linkinfo link unlink exec system escapeshellcmd escapeshellarg passthru shell_exec proc_open proc_close rand srand getrandmax mt_rand mt_srand mt_getrandmax base64_decode base64_encode abs ceil floor round is_finite is_nan is_infinite bindec hexdec octdec decbin decoct dechex base_convert number_format fmod ip2long long2ip getenv putenv getopt microtime gettimeofday getrusage uniqid quoted_printable_decode set_time_limit get_cfg_var magic_quotes_runtime set_magic_quotes_runtime get_magic_quotes_gpc get_magic_quotes_runtime import_request_variables error_log serialize unserialize memory_get_usage var_dump var_export debug_zval_dump print_r highlight_file show_source highlight_string ini_get ini_get_all ini_set ini_alter ini_restore get_include_path set_include_path restore_include_path setcookie header headers_sent connection_aborted connection_status ignore_user_abort parse_ini_file is_uploaded_file move_uploaded_file intval floatval doubleval strval gettype settype is_null is_resource is_bool is_long is_float is_int is_integer is_double is_real is_numeric is_string is_array is_object is_scalar ereg ereg_replace eregi eregi_replace split spliti join sql_regcase dl pclose popen readfile rewind rmdir umask fclose feof fgetc fgets fgetss fread fopen fpassthru ftruncate fstat fseek ftell fflush fwrite fputs mkdir rename copy tempnam tmpfile file file_get_contents stream_select stream_context_create stream_context_set_params stream_context_set_option stream_context_get_options stream_filter_prepend stream_filter_append fgetcsv flock get_meta_tags stream_set_write_buffer set_file_buffer set_socket_blocking stream_set_blocking socket_set_blocking stream_get_meta_data stream_register_wrapper stream_wrapper_register stream_set_timeout socket_set_timeout socket_get_status realpath fnmatch fsockopen pfsockopen pack unpack get_browser crypt opendir closedir chdir getcwd rewinddir readdir dir glob fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype file_exists is_writable is_writeable is_readable is_executable is_file is_dir is_link stat lstat chown touch clearstatcache mail ob_start ob_flush ob_clean ob_end_flush ob_end_clean ob_get_flush ob_get_clean ob_get_length ob_get_level ob_get_status ob_get_contents ob_implicit_flush ob_list_handlers ksort krsort natsort natcasesort asort arsort sort rsort usort uasort uksort shuffle array_walk count end prev next reset current key min max in_array array_search extract compact array_fill range array_multisort array_push array_pop array_shift array_unshift array_splice array_slice array_merge array_merge_recursive array_keys array_values array_count_values array_reverse array_reduce array_pad array_flip array_change_key_case array_rand array_unique array_intersect array_intersect_assoc array_diff array_diff_assoc array_sum array_filter array_map array_chunk array_key_exists pos sizeof key_exists assert assert_options version_compare ftok str_rot13 aggregate session_name session_module_name session_save_path session_id session_regenerate_id session_decode session_register session_unregister session_is_registered session_encode session_start session_destroy session_unset session_set_save_handler session_cache_limiter session_cache_expire session_set_cookie_params session_get_cookie_params session_write_close preg_match preg_match_all preg_replace preg_replace_callback preg_split preg_quote preg_grep overload ctype_alnum ctype_alpha ctype_cntrl ctype_digit ctype_lower ctype_graph ctype_print ctype_punct ctype_space ctype_upper ctype_xdigit virtual apache_request_headers apache_note apache_lookup_uri apache_child_terminate apache_setenv apache_response_headers apache_get_version getallheaders mysql_connect mysql_pconnect mysql_close mysql_select_db mysql_create_db mysql_drop_db mysql_query mysql_unbuffered_query mysql_db_query mysql_list_dbs mysql_list_tables mysql_list_fields mysql_list_processes mysql_error mysql_errno mysql_affected_rows mysql_insert_id mysql_result mysql_num_rows mysql_num_fields mysql_fetch_row mysql_fetch_array mysql_fetch_assoc mysql_fetch_object mysql_data_seek mysql_fetch_lengths mysql_fetch_field mysql_field_seek mysql_free_result mysql_field_name mysql_field_table mysql_field_len mysql_field_type mysql_field_flags mysql_escape_string mysql_real_escape_string mysql_stat mysql_thread_id mysql_client_encoding mysql_get_client_info mysql_get_host_info mysql_get_proto_info mysql_get_server_info mysql_info mysql mysql_fieldname mysql_fieldtable mysql_fieldlen mysql_fieldtype mysql_fieldflags mysql_selectdb mysql_createdb mysql_dropdb mysql_freeresult mysql_numfields mysql_numrows mysql_listdbs mysql_listtables mysql_listfields mysql_db_name mysql_dbname mysql_tablename mysql_table_name pg_connect pg_pconnect pg_close pg_connection_status pg_connection_busy pg_connection_reset pg_host pg_dbname pg_port pg_tty pg_options pg_ping pg_query pg_send_query pg_cancel_query pg_fetch_result pg_fetch_row pg_fetch_assoc pg_fetch_array pg_fetch_object pg_fetch_all pg_affected_rows pg_get_result pg_result_seek pg_result_status pg_free_result pg_last_oid pg_num_rows pg_num_fields pg_field_name pg_field_num pg_field_size pg_field_type pg_field_prtlen pg_field_is_null pg_get_notify pg_get_pid pg_result_error pg_last_error pg_last_notice pg_put_line pg_end_copy pg_copy_to pg_copy_from pg_trace pg_untrace pg_lo_create pg_lo_unlink pg_lo_open pg_lo_close pg_lo_read pg_lo_write pg_lo_read_all pg_lo_import pg_lo_export pg_lo_seek pg_lo_tell pg_escape_string pg_escape_bytea pg_unescape_bytea pg_client_encoding pg_set_client_encoding pg_meta_data pg_convert pg_insert pg_update pg_delete pg_select pg_exec pg_getlastoid pg_cmdtuples pg_errormessage pg_numrows pg_numfields pg_fieldname pg_fieldsize pg_fieldtype pg_fieldnum pg_fieldprtlen pg_fieldisnull pg_freeresult pg_result pg_loreadall pg_locreate pg_lounlink pg_loopen pg_loclose pg_loread pg_lowrite pg_loimport pg_loexport http_response_code get_declared_traits getimagesizefromstring socket_import_stream stream_set_chunk_size trait_exists header_register_callback class_uses session_status session_register_shutdown echo print global static exit array empty eval isset unset die include require include_once require_once json_decode json_encode json_last_error json_last_error_msg curl_close curl_copy_handle curl_errno curl_error curl_escape curl_exec curl_file_create curl_getinfo curl_init curl_multi_add_handle curl_multi_close curl_multi_exec curl_multi_getcontent curl_multi_info_read curl_multi_init curl_multi_remove_handle curl_multi_select curl_multi_setopt curl_multi_strerror curl_pause curl_reset curl_setopt_array curl_setopt curl_share_close curl_share_init curl_share_setopt curl_strerror curl_unescape curl_version mysqli_affected_rows mysqli_autocommit mysqli_change_user mysqli_character_set_name mysqli_close mysqli_commit mysqli_connect_errno mysqli_connect_error mysqli_connect mysqli_data_seek mysqli_debug mysqli_dump_debug_info mysqli_errno mysqli_error_list mysqli_error mysqli_fetch_all mysqli_fetch_array mysqli_fetch_assoc mysqli_fetch_field_direct mysqli_fetch_field mysqli_fetch_fields mysqli_fetch_lengths mysqli_fetch_object mysqli_fetch_row mysqli_field_count mysqli_field_seek mysqli_field_tell mysqli_free_result mysqli_get_charset mysqli_get_client_info mysqli_get_client_stats mysqli_get_client_version mysqli_get_connection_stats mysqli_get_host_info mysqli_get_proto_info mysqli_get_server_info mysqli_get_server_version mysqli_info mysqli_init mysqli_insert_id mysqli_kill mysqli_more_results mysqli_multi_query mysqli_next_result mysqli_num_fields mysqli_num_rows mysqli_options mysqli_ping mysqli_prepare mysqli_query mysqli_real_connect mysqli_real_escape_string mysqli_real_query mysqli_reap_async_query mysqli_refresh mysqli_rollback mysqli_select_db mysqli_set_charset mysqli_set_local_infile_default mysqli_set_local_infile_handler mysqli_sqlstate mysqli_ssl_set mysqli_stat mysqli_stmt_init mysqli_store_result mysqli_thread_id mysqli_thread_safe mysqli_use_result mysqli_warning_count";d.registerHelper("hintWords","php",[i,j,c].join(" ").split(" "));d.registerHelper("wordChars","php",/[\w$]/);var g={name:"clike",helperType:"php",keywords:f(i),blockKeywords:f("catch do else elseif for foreach if switch try while finally"),atoms:f(j),builtin:f(c),multiLineStrings:true,hooks:{"$":function(l){l.eatWhile(/[\w\$_]/);return"variable-2"},"<":function(n,l){if(n.match(/<</)){n.eatWhile(/[\w\.]/);var m=n.current().slice(3);if(m){(l.tokStack||(l.tokStack=[])).push(m,0);l.tokenize=h(m);return"string"}}return false},"#":function(l){while(!l.eol()&&!l.match("?>",false)){l.next()}return"comment"},"/":function(l){if(l.eat("/")){while(!l.eol()&&!l.match("?>",false)){l.next()}return"comment"}return false},'"':function(l,m){(m.tokStack||(m.tokStack=[])).push('"',0);m.tokenize=h('"');return"string"},"{":function(l,m){if(m.tokStack&&m.tokStack.length){m.tokStack[m.tokStack.length-1]++}return false},"}":function(l,m){if(m.tokStack&&m.tokStack.length>0&&!--m.tokStack[m.tokStack.length-1]){m.tokenize=h(m.tokStack[m.tokStack.length-2])}return false}}};d.defineMode("php",function(n,o){var p=d.getMode(n,"text/html");var l=d.getMode(n,g);function m(w,u){var t=u.curMode==l;if(w.sol()&&u.pending&&u.pending!='"'&&u.pending!="'"){u.pending=null}if(!t){if(w.match(/^<\?\w*/)){u.curMode=l;u.curState=u.php;return"meta"}if(u.pending=='"'||u.pending=="'"){while(!w.eol()&&w.next()!=u.pending){}var s="string"}else{if(u.pending&&w.pos<u.pending.end){w.pos=u.pending.end;var s=u.pending.style}else{var s=p.token(w,u.curState)}}if(u.pending){u.pending=null}var v=w.current(),r=v.search(/<\?/),q;if(r!=-1){if(s=="string"&&(q=v.match(/[\'\"]$/))&&!/\?>/.test(v)){u.pending=q[0]}else{u.pending={end:w.pos,style:s}}w.backUp(v.length-r)}return s}else{if(t&&u.php.tokenize==null&&w.match("?>")){u.curMode=p;u.curState=u.html;return"meta"}else{return l.token(w,u.curState)}}}return{startState:function(){var q=d.startState(p),r=d.startState(l);return{html:q,php:r,curMode:o.startOpen?l:p,curState:o.startOpen?r:q,pending:null}},copyState:function(t){var r=t.html,s=d.copyState(p,r),v=t.php,q=d.copyState(l,v),u;if(t.curMode==p){u=s}else{u=q}return{html:s,php:q,curMode:t.curMode,curState:u,pending:t.pending}},token:m,indent:function(r,q){if((r.curMode!=l&&/^\s*<\//.test(q))||(r.curMode==l&&/^\?>/.test(q))){return p.indent(r.html,q)}return r.curMode.indent(r.curState,q)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",innerMode:function(q){return{state:q.curState,mode:q.curMode}}}},"htmlmixed","clike");d.defineMIME("application/x-httpd-php","php");d.defineMIME("application/x-httpd-php-open",{name:"php",startOpen:true});d.defineMIME("text/x-php",g)});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(d){function f(l){return new RegExp("^(("+l.join(")|(")+"))\\b")}var i=f(["and","or","not","is"]);var j=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"];var e=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"];var c={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]};var b={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None"]};d.registerHelper("hintWords","python",j.concat(e));function h(l){return l.scopes[l.scopes.length-1]}d.defineMode("python",function(u,D){var m="error";var y=D.singleDelimiters||new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var l=D.doubleOperators||new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var s=D.doubleDelimiters||new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var E=D.tripleDelimiters||new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");if(D.version&&parseInt(D.version,10)==3){var x=D.singleOperators||new RegExp("^[\\+\\-\\*/%&|\\^~<>!@]");var r=D.identifiers||new RegExp("^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*")}else{var x=D.singleOperators||new RegExp("^[\\+\\-\\*/%&|\\^~<>!]");var r=D.identifiers||new RegExp("^[_A-Za-z][_A-Za-z0-9]*")}var n=D.hangingIndent||u.indentUnit;var C=j,z=e;if(D.extra_keywords!=undefined){C=C.concat(D.extra_keywords)}if(D.extra_builtins!=undefined){z=z.concat(D.extra_builtins)}if(D.version&&parseInt(D.version,10)==3){C=C.concat(b.keywords);z=z.concat(b.builtins);var v=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}else{C=C.concat(c.keywords);z=z.concat(c.builtins);var v=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var t=f(C);var o=f(z);function G(L,K){if(L.sol()&&h(K).type=="py"){var H=h(K).offset;if(L.eatSpace()){var I=L.indentation();if(I>H){w(L,K,"py")}else{if(I<H&&p(L,K)){K.errorToken=true}}return null}else{var J=A(L,K);if(H>0&&p(L,K)){J+=" "+m}return J}}return A(L,K)}function A(L,K){if(L.eatSpace()){return null}var J=L.peek();if(J=="#"){L.skipToEnd();return"comment"}if(L.match(/^[0-9\.]/,false)){var I=false;if(L.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)){I=true}if(L.match(/^\d+\.\d*/)){I=true}if(L.match(/^\.\d+/)){I=true}if(I){L.eat(/J/i);return"number"}var H=false;if(L.match(/^0x[0-9a-f]+/i)){H=true}if(L.match(/^0b[01]+/i)){H=true}if(L.match(/^0o[0-7]+/i)){H=true}if(L.match(/^[1-9]\d*(e[\+\-]?\d+)?/)){L.eat(/J/i);H=true}if(L.match(/^0(?![\dx])/i)){H=true}if(H){L.eat(/L/i);return"number"}}if(L.match(v)){K.tokenize=B(L.current());return K.tokenize(L,K)}if(L.match(E)||L.match(s)){return null}if(L.match(l)||L.match(x)||L.match(i)){return"operator"}if(L.match(y)){return null}if(L.match(t)){return"keyword"}if(L.match(o)){return"builtin"}if(L.match(/^(self|cls)\b/)){return"variable-2"}if(L.match(r)){if(K.lastToken=="def"||K.lastToken=="class"){return"def"}return"variable"}L.next();return m}function B(H){while("rub".indexOf(H.charAt(0).toLowerCase())>=0){H=H.substr(1)}var J=H.length==1;var I="string";function K(M,L){while(!M.eol()){M.eatWhile(/[^'"\\]/);if(M.eat("\\")){M.next();if(J&&M.eol()){return I}}else{if(M.match(H)){L.tokenize=G;return I}else{M.eat(/['"]/)}}}if(J){if(D.singleLineStringErrors){return m}else{L.tokenize=G}}return I}K.isString=true;return K}function w(K,I,H){var J=0,L=null;if(H=="py"){while(h(I).type!="py"){I.scopes.pop()}}J=h(I).offset+(H=="py"?u.indentUnit:n);if(H!="py"&&!K.match(/^(\s|#.*)*$/,false)){L=K.column()+1}I.scopes.push({offset:J,type:H,align:L})}function p(I,H){var J=I.indentation();while(h(H).offset>J){if(h(H).type!="py"){return true}H.scopes.pop()}return h(H).offset!=J}function F(L,J){var I=J.tokenize(L,J);var K=L.current();if(K=="."){I=L.match(r,false)?null:m;if(I==null&&J.lastStyle=="meta"){I="meta"}return I}if(K=="@"){if(D.version&&parseInt(D.version,10)==3){return L.match(r,false)?"meta":"operator"}else{return L.match(r,false)?"meta":m}}if((I=="variable"||I=="builtin")&&J.lastStyle=="meta"){I="meta"}if(K=="pass"||K=="return"){J.dedent+=1}if(K=="lambda"){J.lambda=true}if(K==":"&&!J.lambda&&h(J).type=="py"){w(L,J,"py")}var H=K.length==1?"[({".indexOf(K):-1;if(H!=-1){w(L,J,"])}".slice(H,H+1))}H="])}".indexOf(K);if(H!=-1){if(h(J).type==K){J.scopes.pop()}else{return m}}if(J.dedent>0&&L.eol()&&h(J).type=="py"){if(J.scopes.length>1){J.scopes.pop()}J.dedent-=1}return I}var q={startState:function(H){return{tokenize:G,scopes:[{offset:H||0,type:"py",align:null}],lastStyle:null,lastToken:null,lambda:false,dedent:0}},token:function(L,I){var K=I.errorToken;if(K){I.errorToken=false}var H=F(L,I);I.lastStyle=H;var J=L.current();if(J&&H){I.lastToken=J}if(L.eol()&&I.lambda){I.lambda=false}return K?H+" "+m:H},indent:function(K,H){if(K.tokenize!=G){return K.tokenize.isString?d.Pass:0}var J=h(K);var I=H&&H.charAt(0)==J.type;if(J.align!=null){return J.align-(I?1:0)}else{if(I&&K.scopes.length>1){return K.scopes[K.scopes.length-2].offset}else{return J.offset}}},closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"};return q});d.defineMIME("text/x-python","python");var g=function(l){return l.split(" ")};d.defineMIME("text/x-cython",{name:"python",extra_keywords:g("by cdef cimport cpdef ctypedef enum exceptextern gil include nogil property publicreadonly struct union DEF IF ELIF ELSE")})});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("r",function(f){function c(s){var r=s.split(" "),q={};for(var p=0;p<r.length;++p){q[r[p]]=true}return q}var j=c("NULL NA Inf NaN NA_integer_ NA_real_ NA_complex_ NA_character_");var d=c("list quote bquote eval return call parse deparse");var i=c("if else repeat while function for in next break");var h=c("if else repeat while function for");var e=/[+\-*\/^<>=!&|~$:]/;var m;function g(s,q){m=null;var p=s.next();if(p=="#"){s.skipToEnd();return"comment"}else{if(p=="0"&&s.eat("x")){s.eatWhile(/[\da-f]/i);return"number"}else{if(p=="."&&s.eat(/\d/)){s.match(/\d*(?:e[+\-]?\d+)?/);return"number"}else{if(/\d/.test(p)){s.match(/\d*(?:\.\d+)?(?:e[+\-]\d+)?L?/);return"number"}else{if(p=="'"||p=='"'){q.tokenize=n(p);return"string"}else{if(p=="."&&s.match(/.[.\d]+/)){return"keyword"}else{if(/[\w\.]/.test(p)&&p!="_"){s.eatWhile(/[\w\.]/);var r=s.current();if(j.propertyIsEnumerable(r)){return"atom"}if(i.propertyIsEnumerable(r)){if(h.propertyIsEnumerable(r)&&!s.match(/\s*if(\s+|$)/,false)){m="block"}return"keyword"}if(d.propertyIsEnumerable(r)){return"builtin"}return"variable"}else{if(p=="%"){if(s.skipTo("%")){s.next()}return"variable-2"}else{if(p=="<"&&s.eat("-")){return"arrow"}else{if(p=="="&&q.ctx.argList){return"arg-is"}else{if(e.test(p)){if(p=="$"){return"dollar"}s.eatWhile(e);return"operator"}else{if(/[\(\){}\[\];]/.test(p)){m=p;if(p==";"){return"semi"}return null}else{return null}}}}}}}}}}}}}function n(p){return function(t,s){if(t.eat("\\")){var r=t.next();if(r=="x"){t.match(/^[a-f0-9]{2}/i)}else{if((r=="u"||r=="U")&&t.eat("{")&&t.skipTo("}")){t.next()}else{if(r=="u"){t.match(/^[a-f0-9]{4}/i)}else{if(r=="U"){t.match(/^[a-f0-9]{8}/i)}else{if(/[0-7]/.test(r)){t.match(/^[0-7]{1,2}/)}}}}}return"string-2"}else{var q;while((q=t.next())!=null){if(q==p){s.tokenize=g;break}if(q=="\\"){t.backUp(1);break}}return"string"}}}function l(q,p,r){q.ctx={type:p,indent:q.indent,align:null,column:r.column(),prev:q.ctx}}function o(p){p.indent=p.ctx.indent;p.ctx=p.ctx.prev}return{startState:function(){return{tokenize:g,ctx:{type:"top",indent:-f.indentUnit,align:false},indent:0,afterIdent:false}},token:function(s,r){if(s.sol()){if(r.ctx.align==null){r.ctx.align=false}r.indent=s.indentation()}if(s.eatSpace()){return null}var q=r.tokenize(s,r);if(q!="comment"&&r.ctx.align==null){r.ctx.align=true}var p=r.ctx.type;if((m==";"||m=="{"||m=="}")&&p=="block"){o(r)}if(m=="{"){l(r,"}",s)}else{if(m=="("){l(r,")",s);if(r.afterIdent){r.ctx.argList=true}}else{if(m=="["){l(r,"]",s)}else{if(m=="block"){l(r,"block",s)}else{if(m==p){o(r)}}}}}r.afterIdent=q=="variable"||q=="keyword";return q},indent:function(t,q){if(t.tokenize!=g){return 0}var s=q&&q.charAt(0),p=t.ctx,r=s==p.type;if(p.type=="block"){return p.indent+(s=="{"?0:f.indentUnit)}else{if(p.align){return p.column+(r?0:1)}else{return p.indent+(r?0:f.indentUnit)}}},lineComment:"#"}});b.defineMIME("text/x-rsrc","r")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("ruby",function(g){function c(u){var t={};for(var r=0,s=u.length;r<s;++r){t[u[r]]=true}return t}var m=c(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload","__END__","__FILE__","__LINE__","__dir__"]);var l=c(["def","class","case","for","while","module","then","catch","loop","proc","begin"]);var f=c(["end","until"]);var e={"[":"]","{":"}","(":")"};var o;function d(r,t,s){s.tokenize.push(r);return r(t,s)}function h(C,t){o=null;if(C.sol()&&C.match("=begin")&&C.eol()){t.tokenize.push(n);return"comment"}if(C.eatSpace()){return null}var r=C.next(),w;if(r=="`"||r=="'"||r=='"'){return d(p(r,"string",r=='"'||r=="`"),C,t)}else{if(r=="/"){var z=C.current().length;if(C.skipTo("/")){var x=C.current().length;C.backUp(C.current().length-z);var v=0;while(C.current().length<x){var B=C.next();if(B=="("){v+=1}else{if(B==")"){v-=1}}if(v<0){break}}C.backUp(C.current().length-z);if(v==0){return d(p(r,"string-2",true),C,t)}}return"operator"}else{if(r=="%"){var s="string",y=true;if(C.eat("s")){s="atom"}else{if(C.eat(/[WQ]/)){s="string"}else{if(C.eat(/[r]/)){s="string-2"}else{if(C.eat(/[wxq]/)){s="string";y=false}}}}var u=C.eat(/[^\w\s=]/);if(!u){return"operator"}if(e.propertyIsEnumerable(u)){u=e[u]}return d(p(u,s,y,true),C,t)}else{if(r=="#"){C.skipToEnd();return"comment"}else{if(r=="<"&&(w=C.match(/^<-?[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/))){return d(j(w[1]),C,t)}else{if(r=="0"){if(C.eat("x")){C.eatWhile(/[\da-fA-F]/)}else{if(C.eat("b")){C.eatWhile(/[01]/)}else{C.eatWhile(/[0-7]/)}}return"number"}else{if(/\d/.test(r)){C.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/);return"number"}else{if(r=="?"){while(C.match(/^\\[CM]-/)){}if(C.eat("\\")){C.eatWhile(/\w/)}else{C.next()}return"string"}else{if(r==":"){if(C.eat("'")){return d(p("'","atom",false),C,t)}if(C.eat('"')){return d(p('"',"atom",true),C,t)}if(C.eat(/[\<\>]/)){C.eat(/[\<\>]/);return"atom"}if(C.eat(/[\+\-\*\/\&\|\:\!]/)){return"atom"}if(C.eat(/[a-zA-Z$@_\xa1-\uffff]/)){C.eatWhile(/[\w$\xa1-\uffff]/);C.eat(/[\?\!\=]/);return"atom"}return"operator"}else{if(r=="@"&&C.match(/^@?[a-zA-Z_\xa1-\uffff]/)){C.eat("@");C.eatWhile(/[\w\xa1-\uffff]/);return"variable-2"}else{if(r=="$"){if(C.eat(/[a-zA-Z_]/)){C.eatWhile(/[\w]/)}else{if(C.eat(/\d/)){C.eat(/\d/)}else{C.next()}}return"variable-3"}else{if(/[a-zA-Z_\xa1-\uffff]/.test(r)){C.eatWhile(/[\w\xa1-\uffff]/);C.eat(/[\?\!]/);if(C.eat(":")){return"atom"}return"ident"}else{if(r=="|"&&(t.varList||t.lastTok=="{"||t.lastTok=="do")){o="|";return null}else{if(/[\(\)\[\]{}\\;]/.test(r)){o=r;return null}else{if(r=="-"&&C.eat(">")){return"arrow"}else{if(/[=+\-\/*:\.^%<>~|]/.test(r)){var A=C.eatWhile(/[=+\-\/*:\.^%<>~|]/);if(r=="."&&!A){o="."}return"operator"}else{return null}}}}}}}}}}}}}}}}}function q(r){if(!r){r=1}return function(t,s){if(t.peek()=="}"){if(r==1){s.tokenize.pop();return s.tokenize[s.tokenize.length-1](t,s)}else{s.tokenize[s.tokenize.length-1]=q(r-1)}}else{if(t.peek()=="{"){s.tokenize[s.tokenize.length-1]=q(r+1)}}return h(t,s)}}function i(){var r=false;return function(t,s){if(r){s.tokenize.pop();return s.tokenize[s.tokenize.length-1](t,s)}r=true;return h(t,s)}}function p(r,s,u,t){return function(y,w){var x=false,v;if(w.context.type==="read-quoted-paused"){w.context=w.context.prev;y.eat("}")}while((v=y.next())!=null){if(v==r&&(t||!x)){w.tokenize.pop();break}if(u&&v=="#"&&!x){if(y.eat("{")){if(r=="}"){w.context={prev:w.context,type:"read-quoted-paused"}}w.tokenize.push(q());break}else{if(/[@\$]/.test(y.peek())){w.tokenize.push(i());break}}}x=!x&&v=="\\"}return s}}function j(r){return function(t,s){if(t.match(r)){s.tokenize.pop()}else{t.skipToEnd()}return"string"}}function n(s,r){if(s.sol()&&s.match("=end")&&s.eol()){r.tokenize.pop()}s.skipToEnd();return"comment"}return{startState:function(){return{tokenize:[h],indented:0,context:{type:"top",indented:-g.indentUnit},continuedLine:false,lastTok:null,varList:false}},token:function(w,t){if(w.sol()){t.indented=w.indentation()}var s=t.tokenize[t.tokenize.length-1](w,t),v;var r=o;if(s=="ident"){var u=w.current();s=t.lastTok=="."?"property":m.propertyIsEnumerable(w.current())?"keyword":/^[A-Z]/.test(u)?"tag":(t.lastTok=="def"||t.lastTok=="class"||t.varList)?"def":"variable";if(s=="keyword"){r=u;if(l.propertyIsEnumerable(u)){v="indent"}else{if(f.propertyIsEnumerable(u)){v="dedent"}else{if((u=="if"||u=="unless")&&w.column()==w.indentation()){v="indent"}else{if(u=="do"&&t.context.indented<t.indented){v="indent"}}}}}}if(o||(s&&s!="comment")){t.lastTok=r}if(o=="|"){t.varList=!t.varList}if(v=="indent"||/[\(\[\{]/.test(o)){t.context={prev:t.context,type:o||s,indented:t.indented}}else{if((v=="dedent"||/[\)\]\}]/.test(o))&&t.context.prev){t.context=t.context.prev}}if(w.eol()){t.continuedLine=(o=="\\"||s=="operator")}return s},indent:function(v,r){if(v.tokenize[v.tokenize.length-1]!=h){return 0}var u=r&&r.charAt(0);var t=v.context;var s=t.type==e[u]||t.type=="keyword"&&/^(?:end|until|else|elsif|when|rescue)\b/.test(r);return t.indented+(s?0:g.indentUnit)+(v.continuedLine?g.indentUnit:0)},electricChars:"}de",lineComment:"#"}});b.defineMIME("text/x-ruby","ruby")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("rust",function(){var C=4,M=2;var m={"if":"if-style","while":"if-style",loop:"else-style","else":"else-style","do":"else-style",ret:"else-style",fail:"else-style","break":"atom",cont:"atom","const":"let",resource:"fn",let:"let",fn:"fn","for":"for",alt:"alt",iface:"iface",impl:"impl",type:"type","enum":"enum",mod:"mod",as:"op","true":"atom","false":"atom",assert:"op",check:"op",claim:"op","native":"ignore",unsafe:"ignore","import":"else-style","export":"else-style",copy:"op",log:"op",log_err:"op",use:"op",bind:"op",self:"atom",struct:"enum"};var g=function(){var af={fn:"fn",block:"fn",obj:"obj"};var r="bool uint int i8 i16 i32 i64 u8 u16 u32 u64 float f32 f64 str char".split(" ");for(var ae=0,ag=r.length;ae<ag;++ae){af[r[ae]]="atom"}return af}();var aa=/[+\-*&%=<>!?|\.@]/;var t,q;function Y(r,ae){t=r;return ae}function Q(ag,af){var ae=ag.next();if(ae=='"'){af.tokenize=p;return af.tokenize(ag,af)}if(ae=="'"){t="atom";if(ag.eat("\\")){if(ag.skipTo("'")){ag.next();return"string"}else{return"error"}}else{ag.next();return ag.eat("'")?"string":"error"}}if(ae=="/"){if(ag.eat("/")){ag.skipToEnd();return"comment"}if(ag.eat("*")){af.tokenize=y(1);return af.tokenize(ag,af)}}if(ae=="#"){if(ag.eat("[")){t="open-attr";return null}ag.eatWhile(/\w/);return Y("macro","meta")}if(ae==":"&&ag.match(":<")){return Y("op",null)}if(ae.match(/\d/)||(ae=="."&&ag.eat(/\d/))){var r=false;if(!ag.match(/^x[\da-f]+/i)&&!ag.match(/^b[01]+/)){ag.eatWhile(/\d/);if(ag.eat(".")){r=true;ag.eatWhile(/\d/)}if(ag.match(/^e[+\-]?\d+/i)){r=true}}if(r){ag.match(/^f(?:32|64)/)}else{ag.match(/^[ui](?:8|16|32|64)/)}return Y("atom","number")}if(ae.match(/[()\[\]{}:;,]/)){return Y(ae,null)}if(ae=="-"&&ag.eat(">")){return Y("->",null)}if(ae.match(aa)){ag.eatWhile(aa);return Y("op",null)}ag.eatWhile(/\w/);q=ag.current();if(ag.match(/^::\w/)){ag.backUp(1);return Y("prefix","variable-2")}if(af.keywords.propertyIsEnumerable(q)){return Y(af.keywords[q],q.match(/true|false/)?"atom":"keyword")}return Y("name","variable")}function p(ag,ae){var r,af=false;while(r=ag.next()){if(r=='"'&&!af){ae.tokenize=Q;return Y("atom","string")}af=!af&&r=="\\"}return Y("op","string")}function y(r){return function(ah,ag){var ae=null,af;while(af=ah.next()){if(af=="/"&&ae=="*"){if(r==1){ag.tokenize=Q;break}else{ag.tokenize=y(r-1);return ag.tokenize(ah,ag)}}if(af=="*"&&ae=="/"){ag.tokenize=y(r+1);return ag.tokenize(ah,ag)}ae=af}return"comment"}}var B={state:null,stream:null,marked:null,cc:null};function c(){for(var r=arguments.length-1;r>=0;r--){B.cc.push(arguments[r])}}function P(){c.apply(null,arguments);return true}function h(ae,af){var r=function(){var ag=B.state;ag.lexical={indented:ag.indented,column:B.stream.column(),type:ae,prev:ag.lexical,info:af}};r.lex=true;return r}function O(){var r=B.state;if(r.lexical.prev){if(r.lexical.type==")"){r.indented=r.lexical.indented}r.lexical=r.lexical.prev}}function E(){B.state.keywords=g}function D(){B.state.keywords=m}O.lex=E.lex=D.lex=true;function Z(af,r){function ae(ag){if(ag==","){return P(af,ae)}if(ag==r){return P()}return P(ae)}return function(ag){if(ag==r){return P()}return c(af,ae)}}function ac(ae,r){return P(h("stat",r),ae,O,o)}function o(r){if(r=="}"){return P()}if(r=="let"){return ac(n,"let")}if(r=="fn"){return ac(L)}if(r=="type"){return P(h("stat"),u,R,O,o)}if(r=="enum"){return ac(f)}if(r=="mod"){return ac(e)}if(r=="iface"){return ac(I)}if(r=="impl"){return ac(X)}if(r=="open-attr"){return P(h("]"),Z(F,"]"),O)}if(r=="ignore"||r.match(/[\]\);,]/)){return P(o)}return c(h("stat"),F,O,R,o)}function R(r){if(r==";"){return P()}return c()}function F(r){if(r=="atom"||r=="name"){return P(w)}if(r=="{"){return P(h("}"),ab,O)}if(r.match(/[\[\(]/)){return V(r,F)}if(r.match(/[\]\)\};,]/)){return c()}if(r=="if-style"){return P(F,F)}if(r=="else-style"||r=="op"){return P(F)}if(r=="for"){return P(j,s,ad,F,F)}if(r=="alt"){return P(F,S)}if(r=="fn"){return P(L)}if(r=="macro"){return P(i)}return P()}function w(r){if(q=="."){return P(N)}if(q=="::<"){return P(z,w)}if(r=="op"||q==":"){return P(F)}if(r=="("||r=="["){return V(r,F)}return c()}function N(){if(q.match(/^\w+$/)){B.marked="variable";return P(w)}return c(F)}function ab(r){if(r=="op"){if(q=="|"){return P(d,O,h("}","block"),o)}if(q=="||"){return P(O,h("}","block"),o)}}if(q=="mutable"||(q.match(/^\w+$/)&&B.stream.peek()==":"&&!B.stream.match("::",false))){return c(K(F))}return c(o)}function K(r){function ae(af){if(q=="mutable"||q=="with"){B.marked="keyword";return P(ae)}if(q.match(/^\w*$/)){B.marked="variable";return P(ae)}if(af==":"){return P(r,ae)}if(af=="}"){return P()}return P(ae)}return ae}function d(r){if(r=="name"){B.marked="def";return P(d)}if(r=="op"&&q=="|"){return P()}return P(d)}function n(r){if(r.match(/[\]\)\};]/)){return P()}if(q=="="){return P(F,l)}if(r==","){return P(n)}return c(j,s,n)}function l(r){if(r.match(/[\]\)\};,]/)){return c(n)}else{return c(F,l)}}function s(r){if(r==":"){return P(E,W,D)}return c()}function ad(r){if(r=="name"&&q=="in"){B.marked="keyword";return P()}return c()}function L(r){if(q=="@"||q=="~"){B.marked="keyword";return P(L)}if(r=="name"){B.marked="def";return P(L)}if(q=="<"){return P(z,L)}if(r=="{"){return c(F)}if(r=="("){return P(h(")"),Z(H,")"),O,L)}if(r=="->"){return P(E,W,D,L)}if(r==";"){return P()}return P(L)}function u(r){if(r=="name"){B.marked="def";return P(u)}if(q=="<"){return P(z,u)}if(q=="="){return P(E,W,D)}return P(u)}function f(r){if(r=="name"){B.marked="def";return P(f)}if(q=="<"){return P(z,f)}if(q=="="){return P(E,W,D,R)}if(r=="{"){return P(h("}"),E,A,D,O)}return P(f)}function A(r){if(r=="}"){return P()}if(r=="("){return P(h(")"),Z(W,")"),O,A)}if(q.match(/^\w+$/)){B.marked="def"}return P(A)}function e(r){if(r=="name"){B.marked="def";return P(e)}if(r=="{"){return P(h("}"),o,O)}return c()}function I(r){if(r=="name"){B.marked="def";return P(I)}if(q=="<"){return P(z,I)}if(r=="{"){return P(h("}"),o,O)}return c()}function X(r){if(q=="<"){return P(z,X)}if(q=="of"||q=="for"){B.marked="keyword";return P(W,X)}if(r=="name"){B.marked="def";return P(X)}if(r=="{"){return P(h("}"),o,O)}return c()}function z(){if(q==">"){return P()}if(q==","){return P(z)}if(q==":"){return P(W,z)}return c(W,z)}function H(r){if(r=="name"){B.marked="def";return P(H)}if(r==":"){return P(E,W,D)}return c()}function W(r){if(r=="name"){B.marked="variable-3";return P(J)}if(q=="mutable"){B.marked="keyword";return P(W)}if(r=="atom"){return P(J)}if(r=="op"||r=="obj"){return P(W)}if(r=="fn"){return P(G)}if(r=="{"){return P(h("{"),K(W),O)}return V(r,W)}function J(){if(q=="<"){return P(z)}return c()}function G(r){if(r=="("){return P(h("("),Z(W,")"),O,G)}if(r=="->"){return P(W)}return c()}function j(r){if(r=="name"){B.marked="def";return P(v)}if(r=="atom"){return P(v)}if(r=="op"){return P(j)}if(r.match(/[\]\)\};,]/)){return c()}return V(r,j)}function v(r){if(r=="op"&&q=="."){return P()}if(q=="to"){B.marked="keyword";return P(j)}else{return c()}}function S(r){if(r=="{"){return P(h("}","alt"),U,O)}return c()}function U(r){if(r=="}"){return P()}if(r=="|"){return P(U)}if(q=="when"){B.marked="keyword";return P(F,T)}if(r.match(/[\]\);,]/)){return P(U)}return c(j,T)}function T(r){if(r=="{"){return P(h("}","alt"),o,O,U)}else{return c(U)}}function i(r){if(r.match(/[\[\(\{]/)){return V(r,F)}return c()}function V(ae,r){if(ae=="["){return P(h("]"),Z(r,"]"),O)}if(ae=="("){return P(h(")"),Z(r,")"),O)}if(ae=="{"){return P(h("}"),Z(r,"}"),O)}return P()}function x(af,ag,r){var ah=af.cc;B.state=af;B.stream=ag;B.marked=null,B.cc=ah;while(true){var ae=ah.length?ah.pop():o;if(ae(t)){while(ah.length&&ah[ah.length-1].lex){ah.pop()()}return B.marked||r}}}return{startState:function(){return{tokenize:Q,cc:[],lexical:{indented:-C,column:0,type:"top",align:false},keywords:m,indented:0}},token:function(af,ae){if(af.sol()){if(!ae.lexical.hasOwnProperty("align")){ae.lexical.align=false}ae.indented=af.indentation()}if(af.eatSpace()){return null}t=q=null;var r=ae.tokenize(af,ae);if(r=="comment"){return r}if(!ae.lexical.hasOwnProperty("align")){ae.lexical.align=true}if(t=="prefix"){return r}if(!q){q=af.current()}return x(ae,af,r)},indent:function(ai,r){if(ai.tokenize!=Q){return 0}var ah=r&&r.charAt(0),af=ai.lexical,ag=af.type,ae=ah==ag;if(ag=="stat"){return af.indented+C}if(af.align){return af.column+(ae?0:1)}return af.indented+(ae?0:(af.info=="alt"?M:C))},electricChars:"{}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",fold:"brace"}});b.defineMIME("text/x-rustsrc","rust")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("sql",function(d,g){var e=g.client||{},j=g.atoms||{"false":true,"true":true,"null":true},o=g.builtin||{},h=g.keywords||{},i=g.operatorChars||/^[*+\-%<>!=&|~^]/,p=g.support||{},r=g.hooks||{},c=g.dateSQL||{date:true,time:true,timestamp:true};function f(w,u){var t=w.next();if(r[t]){var s=r[t](w,u);if(s!==false){return s}}if(p.hexNumber==true&&((t=="0"&&w.match(/^[xX][0-9a-fA-F]+/))||(t=="x"||t=="X")&&w.match(/^'[0-9a-fA-F]+'/))){return"number"}else{if(p.binaryNumber==true&&(((t=="b"||t=="B")&&w.match(/^'[01]+'/))||(t=="0"&&w.match(/^b[01]+/)))){return"number"}else{if(t.charCodeAt(0)>47&&t.charCodeAt(0)<58){w.match(/^[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/);p.decimallessFloat==true&&w.eat(".");return"number"}else{if(t=="?"&&(w.eatSpace()||w.eol()||w.eat(";"))){return"variable-3"}else{if(t=="'"||(t=='"'&&p.doubleQuote)){u.tokenize=q(t);return u.tokenize(w,u)}else{if((((p.nCharCast==true&&(t=="n"||t=="N"))||(p.charsetCast==true&&t=="_"&&w.match(/[a-z][a-z0-9]*/i)))&&(w.peek()=="'"||w.peek()=='"'))){return"keyword"}else{if(/^[\(\),\;\[\]]/.test(t)){return null}else{if(p.commentSlashSlash&&t=="/"&&w.eat("/")){w.skipToEnd();return"comment"}else{if((p.commentHash&&t=="#")||(t=="-"&&w.eat("-")&&(!p.commentSpaceRequired||w.eat(" ")))){w.skipToEnd();return"comment"}else{if(t=="/"&&w.eat("*")){u.tokenize=m;return u.tokenize(w,u)}else{if(t=="."){if(p.zerolessFloat==true&&w.match(/^(?:\d+(?:e[+-]?\d+)?)/i)){return"number"}if(p.ODBCdotTable==true&&w.match(/^[a-zA-Z_]+/)){return"variable-2"}}else{if(i.test(t)){w.eatWhile(i);return null}else{if(t=="{"&&(w.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||w.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/))){return"number"}else{w.eatWhile(/^[_\w\d]/);var v=w.current().toLowerCase();if(c.hasOwnProperty(v)&&(w.match(/^( )+'[^']*'/)||w.match(/^( )+"[^"]*"/))){return"number"}if(j.hasOwnProperty(v)){return"atom"}if(o.hasOwnProperty(v)){return"builtin"}if(h.hasOwnProperty(v)){return"keyword"}if(e.hasOwnProperty(v)){return"string-2"}return null}}}}}}}}}}}}}}function q(s){return function(w,u){var v=false,t;while((t=w.next())!=null){if(t==s&&!v){u.tokenize=f;break}v=!v&&t=="\\"}return"string"}}function m(t,s){while(true){if(t.skipTo("*")){t.next();if(t.eat("/")){s.tokenize=f;break}}else{t.skipToEnd();break}}return"comment"}function l(u,t,s){t.context={prev:t.context,indent:u.indentation(),col:u.column(),type:s}}function n(s){s.indent=s.context.indent;s.context=s.context.prev}return{startState:function(){return{tokenize:f,context:null}},token:function(v,u){if(v.sol()){if(u.context&&u.context.align==null){u.context.align=false}}if(v.eatSpace()){return null}var t=u.tokenize(v,u);if(t=="comment"){return t}if(u.context&&u.context.align==null){u.context.align=true}var s=v.current();if(s=="("){l(v,u,")")}else{if(s=="["){l(v,u,"]")}else{if(u.context&&u.context.type==s){n(u)}}}return t},indent:function(v,t){var s=v.context;if(!s){return b.Pass}var u=t.charAt(0)==s.type;if(s.align){return s.col+(u?0:1)}else{return s.indent+(u?0:d.indentUnit)}},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:p.commentSlashSlash?"//":p.commentHash?"#":null}});(function(){function d(i){var h;while((h=i.next())!=null){if(h=="`"&&!i.eat("`")){return"variable-2"}}i.backUp(i.current().length-1);return i.eatWhile(/\w/)?"variable-2":null}function c(h){if(h.eat("@")){h.match(/^session\./);h.match(/^local\./);h.match(/^global\./)}if(h.eat("'")){h.match(/^.*'/);return"variable-2"}else{if(h.eat('"')){h.match(/^.*"/);return"variable-2"}else{if(h.eat("`")){h.match(/^.*`/);return"variable-2"}else{if(h.match(/^[0-9a-zA-Z$\.\_]+/)){return"variable-2"}}}}return null}function e(h){if(h.eat("N")){return"atom"}return h.match(/^[a-zA-Z.#!?]/)?"variable-2":null}var f="alter and as asc between by count create delete desc distinct drop from having in insert into is join like not on or order select set table union update values where ";function g(m){var j={},l=m.split(" ");for(var h=0;h<l.length;++h){j[l[h]]=true}return j}b.defineMIME("text/x-sql",{name:"sql",keywords:g(f+"begin"),builtin:g("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:g("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:g("date time timestamp"),support:g("ODBCdotTable doubleQuote binaryNumber hexNumber")});b.defineMIME("text/x-mssql",{name:"sql",client:g("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:g(f+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered"),builtin:g("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:g("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:g("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":c}});b.defineMIME("text/x-mysql",{name:"sql",client:g("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:g(f+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group groupby_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:g("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:g("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:g("date time timestamp"),support:g("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":c,"`":d,"\\":e}});b.defineMIME("text/x-mariadb",{name:"sql",client:g("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:g(f+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:g("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:g("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:g("date time timestamp"),support:g("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":c,"`":d,"\\":e}});b.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:g("use select from using consistency where limit first reversed first and in insert into values using consistency ttl update set delete truncate begin batch apply create keyspace with columnfamily primary key index on drop alter type add any one quorum all local_quorum each_quorum"),builtin:g("ascii bigint blob boolean counter decimal double float int text timestamp uuid varchar varint"),atoms:g("false true"),operatorChars:/^[<>=]/,dateSQL:{},support:g("commentSlashSlash decimallessFloat"),hooks:{}});b.defineMIME("text/x-plsql",{name:"sql",client:g("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:g("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:g("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least lenght lenghtb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:g("date time timestamp"),support:g("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")});b.defineMIME("text/x-hive",{name:"sql",keywords:g("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:g("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:g("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:g("date timestamp"),support:g("ODBCdotTable doubleQuote binaryNumber hexNumber")})}())});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(d){function f(u){var v={};for(var t=0;t<u.length;t++){v[u[t]]=true}return v}var g=f(["var","let","class","deinit","enum","extension","func","import","init","protocol","static","struct","subscript","typealias","as","dynamicType","is","new","super","self","Self","Type","__COLUMN__","__FILE__","__FUNCTION__","__LINE__","break","case","continue","default","do","else","fallthrough","if","in","for","return","switch","where","while","associativity","didSet","get","infix","inout","left","mutating","none","nonmutating","operator","override","postfix","precedence","prefix","right","set","unowned","weak","willSet"]);var s=f(["var","let","class","enum","extension","func","import","protocol","struct","typealias","dynamicType","for"]);var h=f(["Infinity","NaN","undefined","null","true","false","on","off","yes","no","nil","null","this","super"]);var i=f(["String","bool","int","string","double","Double","Int","Float","float","public","private","extension"]);var e="+-/*%=|&<>#";var n=";,.(){}[]";var p=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var c=/^-?(?:(?:[\d_]+\.[_\d]*|\.[_\d]+|0o[0-7_\.]+|0b[01_\.]+)(?:e-?[\d_]+)?|0x[\d_a-f\.]+(?:p-?[\d_]+)?)/i;var l=/^[_A-Za-z$][_A-Za-z$0-9]*/;var r=/^[@\.][_A-Za-z$][_A-Za-z$0-9]*/;var m=/^\/(?!\s)(?:\/\/)?(?:\\.|[^\/])+\//;function b(y,w,u){if(y.eatSpace()){return null}var t=y.peek();if(t=="/"){if(y.match("//")){y.skipToEnd();return"comment"}if(y.match("/*")){w.tokenize.push(j);return j(y,w)}if(y.match(m)){return"string-2"}}if(e.indexOf(t)>-1){y.next();return"operator"}if(n.indexOf(t)>-1){y.match(p);return"punctuation"}if(t=='"'||t=="'"){y.next();var x=q(t);w.tokenize.push(x);return x(y,w)}if(y.match(c)){return"number"}if(y.match(r)){return"property"}if(y.match(l)){var v=y.current();if(g.hasOwnProperty(v)){if(s.hasOwnProperty(v)){w.prev="define"}return"keyword"}if(i.hasOwnProperty(v)){return"variable-2"}if(h.hasOwnProperty(v)){return"atom"}if(u=="define"){return"def"}return"variable"}y.next();return null}function o(){var t=0;return function(x,w,v){var u=b(x,w,v);if(u=="punctuation"){if(x.current()=="("){++t}else{if(x.current()==")"){if(t==0){x.backUp(1);w.tokenize.pop();return w.tokenize[w.tokenize.length-1](x,w)}else{--t}}}}return u}}function q(t){return function(x,v){var u,w=false;while(u=x.next()){if(w){if(u=="("){v.tokenize.push(o());return"string"}w=false}else{if(u==t){break}else{w=u=="\\"}}}v.tokenize.pop();return"string"}}function j(u,t){u.match(/^(?:[^*]|\*(?!\/))*/);if(u.match("*/")){t.tokenize.pop()}return"comment"}d.defineMode("swift",function(){return{startState:function(){return{prev:null,tokenize:[]}},token:function(x,v){var u=v.prev;v.prev=null;var w=v.tokenize[v.tokenize.length-1]||b;var t=w(x,v,u);if(!t||t=="comment"){v.prev=u}else{if(!v.prev){v.prev=t}}return t},lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/"}});d.defineMIME("text/x-swift","swift")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}});(function(b){b.defineMode("vb",function(o,C){var d="error";function s(J){return new RegExp("^(("+J.join(")|(")+"))\\b","i")}var r=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var w=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var c=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var l=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var F=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var j=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var y=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var u=["else","elseif","case","catch"];var I=["next","loop"];var v=["and","or","not","xor","in"];var f=s(v);var B=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var z=["integer","string","double","decimal","boolean","short","char","float","single"];var m=s(B);var q=s(z);var n='"';var x=s(y);var E=s(u);var i=s(I);var t=s(["end"]);var e=s(["do"]);var D=null;b.registerHelper("hintWords","vb",y.concat(u).concat(I).concat(v).concat(B).concat(z));function p(J,K){K.currentIndent++}function g(J,K){K.currentIndent--}function H(N,M){if(N.eatSpace()){return null}var L=N.peek();if(L==="'"){N.skipToEnd();return"comment"}if(N.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var K=false;if(N.match(/^\d*\.\d+F?/i)){K=true}else{if(N.match(/^\d+\.\d*F?/)){K=true}else{if(N.match(/^\.\d+F?/)){K=true}}}if(K){N.eat(/J/i);return"number"}var J=false;if(N.match(/^&H[0-9a-f]+/i)){J=true}else{if(N.match(/^&O[0-7]+/i)){J=true}else{if(N.match(/^[1-9]\d*F?/)){N.eat(/J/i);J=true}else{if(N.match(/^0(?![\dx])/i)){J=true}}}}if(J){N.eat(/L/i);return"number"}}if(N.match(n)){M.tokenize=A(N.current());return M.tokenize(N,M)}if(N.match(F)||N.match(l)){return null}if(N.match(c)||N.match(r)||N.match(f)){return"operator"}if(N.match(w)){return null}if(N.match(e)){p(N,M);M.doInCurrentLine=true;return"keyword"}if(N.match(x)){if(!M.doInCurrentLine){p(N,M)}else{M.doInCurrentLine=false}return"keyword"}if(N.match(E)){return"keyword"}if(N.match(t)){g(N,M);g(N,M);return"keyword"}if(N.match(i)){g(N,M);return"keyword"}if(N.match(q)){return"keyword"}if(N.match(m)){return"keyword"}if(N.match(j)){return"variable"}N.next();return d}function A(J){var L=J.length==1;var K="string";return function(N,M){while(!N.eol()){N.eatWhile(/[^'"]/);if(N.match(J)){M.tokenize=H;return K}else{N.eat(/['"]/)}}if(L){if(C.singleLineStringErrors){return d}else{M.tokenize=H}}return K}}function G(N,L){var K=L.tokenize(N,L);var M=N.current();if(M==="."){K=L.tokenize(N,L);M=N.current();if(K==="variable"){return"variable"}else{return d}}var J="[({".indexOf(M);if(J!==-1){p(N,L)}if(D==="dedent"){if(g(N,L)){return d}}J="])}".indexOf(M);if(J!==-1){if(g(N,L)){return d}}return K}var h={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:H,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(L,K){if(L.sol()){K.currentIndent+=K.nextLineIndent;K.nextLineIndent=0;K.doInCurrentLine=0}var J=G(L,K);K.lastToken={style:J,content:L.current()};return J},indent:function(L,J){var K=J.replace(/^\s+|\s+$/g,"");if(K.match(i)||K.match(t)||K.match(E)){return o.indentUnit*(L.currentIndent-1)}if(L.currentIndent<0){return 0}return L.currentIndent*o.indentUnit}};return h});b.defineMIME("text/x-vb","vb")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(y){var n=y.Pos;function N(R,i){return R.line==i.line&&R.ch==i.ch}var q=[];function O(i){q.push(i);if(q.length>50){q.shift()}}function F(i){if(!q.length){return O(i)}q[q.length-1]+=i}function g(i){return q[q.length-(i?Math.min(i,1):1)]||""}function w(){if(q.length>1){q.pop()}return g()}var B=null;function u(i,U,T,S,R){if(R==null){R=i.getRange(U,T)}if(S&&B&&B.cm==i&&N(U,B.pos)&&i.isClean(B.gen)){F(R)}else{O(R)}i.replaceRange("",U,T,"+delete");if(S){B={cm:i,pos:U,gen:i.changeGeneration()}}else{B=null}}function d(i,S,R){return i.findPosH(S,R,"char",true)}function e(i,S,R){return i.findPosH(S,R,"word",true)}function A(i,S,R){return i.findPosV(S,R,"line",i.doc.sel.goalColumn)}function v(i,S,R){return i.findPosV(S,R,"page",i.doc.sel.goalColumn)}function E(V,U,R){var W=U.line,Y=V.getLine(W);var X=/\S/.test(R<0?Y.slice(0,U.ch):Y.slice(U.ch));var i=V.firstLine(),S=V.lastLine();for(;;){W+=R;if(W<i||W>S){return V.clipPos(n(W-R,R<0?0:null))}Y=V.getLine(W);var T=/\S/.test(Y);if(T){X=true}else{if(X){return n(W,0)}}}}function c(i,X,T){var R=X.line,V=X.ch;var W=i.getLine(X.line),S=false;for(;;){var U=W.charAt(V+(T<0?-1:0));if(!U){if(R==(T<0?i.firstLine():i.lastLine())){return n(R,V)}W=i.getLine(R+T);if(!/\S/.test(W)){return n(R,V)}R+=T;V=T<0?W.length:0;continue}if(S&&/[!?.]/.test(U)){return n(R,V+(T>0?1:0))}if(!S){S=/\w/.test(U)}V+=T}}function h(i,X,R){var U;if(i.findMatchingBracket&&(U=i.findMatchingBracket(X,true))&&U.match&&(U.forward?1:-1)==R){return R>0?n(U.to.line,U.to.ch+1):U.to}for(var W=true;;W=false){var T=i.getTokenAt(X);var V=n(X.line,R<0?T.start:T.end);if(W&&R>0&&T.end==X.ch||!/\w/.test(T.string)){var S=i.findPosH(V,R,"char");if(N(V,S)){return X}else{X=S}}else{return V}}}function m(i,R){var S=i.state.emacsPrefix;if(!S){return R?null:1}J(i);return S=="-"?-1:Number(S)}function H(R){var i=typeof R=="string"?function(S){S.execCommand(R)}:R;return function(S){var U=m(S);i(S);for(var T=1;T<U;++T){i(S)}}}function x(R,X,W,S){var V=m(R);if(V<0){S=-S;V=-V}for(var U=0;U<V;++U){var T=W(R,X,S);if(N(T,X)){break}X=T}return X}function p(S,i){var R=function(T){T.extendSelection(x(T,T.getCursor(),S,i))};R.motion=true;return R}function I(R,V,S){var U=R.listSelections(),W;var T=U.length;while(T--){W=U[T].head;u(R,W,x(R,W,V,S),true)}}function f(R){if(R.somethingSelected()){var U=R.listSelections(),T;var S=U.length;while(S--){T=U[S];u(R,T.anchor,T.head)}return true}}function C(i,R){if(i.state.emacsPrefix){if(R!="-"){i.state.emacsPrefix+=R}return}i.state.emacsPrefix=R;i.on("keyHandled",l);i.on("inputRead",D)}var j={"Alt-G":true,"Ctrl-X":true,"Ctrl-Q":true,"Ctrl-U":true};function l(R,i){if(!R.state.emacsPrefixMap&&!j.hasOwnProperty(i)){J(R)}}function J(i){i.state.emacsPrefix=null;i.off("keyHandled",l);i.off("inputRead",D)}function D(S,V){var W=m(S);if(W>1&&V.origin=="+input"){var U=V.text.join("\n"),R="";for(var T=1;T<W;++T){R+=U}S.replaceSelection(R)}}function t(i){i.state.emacsPrefixMap=true;i.addKeyMap(o);i.on("keyHandled",s);i.on("inputRead",s)}function s(R,i){if(typeof i=="string"&&(/^\d$/.test(i)||i=="Ctrl-U")){return}R.removeKeyMap(o);R.state.emacsPrefixMap=false;R.off("keyHandled",s);R.off("inputRead",s)}function G(i){i.setCursor(i.getCursor());i.setExtending(!i.getExtending());i.on("change",function(){i.setExtending(false)})}function K(i){i.setExtending(false);i.setCursor(i.getCursor())}function Q(i,S,R){if(i.openDialog){i.openDialog(S+': <input type="text" style="width: 10em"/>',R,{bottom:true})}else{R(prompt(S,""))}}function L(i,T){var S=i.getCursor(),R=i.findPosH(S,1,"word");i.replaceRange(T(i.getRange(S,R)),S,R);i.setCursor(R)}function b(S){var X=S.getCursor(),T=X.line,V=X.ch;var R=[];while(T>=S.firstLine()){var W=S.getLine(T);for(var U=V==null?W.length:V;U>0;){var V=W.charAt(--U);if(V==")"){R.push("(")}else{if(V=="]"){R.push("[")}else{if(V=="}"){R.push("{")}else{if(/[\(\{\[]/.test(V)&&(!R.length||R.pop()!=V)){return S.extendSelection(n(T,U))}}}}}--T;V=null}}function r(i){i.execCommand("clearSearch");K(i)}var z=y.keyMap.emacs=y.normalizeKeyMap({"Ctrl-W":function(i){u(i,i.getCursor("start"),i.getCursor("end"))},"Ctrl-K":H(function(i){var T=i.getCursor(),R=i.clipPos(n(T.line));var S=i.getRange(T,R);if(!/\S/.test(S)){S+="\n";R=n(T.line+1,0)}u(i,T,R,true,S)}),"Alt-W":function(i){O(i.getSelection());K(i)},"Ctrl-Y":function(i){var R=i.getCursor();i.replaceRange(g(m(i)),R,R,"paste");i.setSelection(R,i.getCursor())},"Alt-Y":function(i){i.replaceSelection(w(),"around","paste")},"Ctrl-Space":G,"Ctrl-Shift-2":G,"Ctrl-F":p(d,1),"Ctrl-B":p(d,-1),Right:p(d,1),Left:p(d,-1),"Ctrl-D":function(i){I(i,d,1)},Delete:function(i){f(i)||I(i,d,1)},"Ctrl-H":function(i){I(i,d,-1)},Backspace:function(i){f(i)||I(i,d,-1)},"Alt-F":p(e,1),"Alt-B":p(e,-1),"Alt-D":function(i){I(i,e,1)},"Alt-Backspace":function(i){I(i,e,-1)},"Ctrl-N":p(A,1),"Ctrl-P":p(A,-1),Down:p(A,1),Up:p(A,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":p(v,-1),"Ctrl-V":p(v,1),PageUp:p(v,-1),PageDown:p(v,1),"Ctrl-Up":p(E,-1),"Ctrl-Down":p(E,1),"Alt-A":p(c,-1),"Alt-E":p(c,1),"Alt-K":function(i){I(i,c,1)},"Ctrl-Alt-K":function(i){I(i,h,1)},"Ctrl-Alt-Backspace":function(i){I(i,h,-1)},"Ctrl-Alt-F":p(h,1),"Ctrl-Alt-B":p(h,-1),"Shift-Ctrl-Alt-2":function(i){var R=i.getCursor();i.setSelection(x(i,R,h,1),R)},"Ctrl-Alt-T":function(i){var R=h(i,i.getCursor(),-1),T=h(i,R,1);var U=h(i,T,1),S=h(i,U,-1);i.replaceRange(i.getRange(S,U)+i.getRange(T,S)+i.getRange(R,T),R,U)},"Ctrl-Alt-U":H(b),"Alt-Space":function(i){var U=i.getCursor(),T=U.ch,S=U.ch,R=i.getLine(U.line);while(T&&/\s/.test(R.charAt(T-1))){--T}while(S<R.length&&/\s/.test(R.charAt(S))){++S}i.replaceRange(" ",n(U.line,T),n(U.line,S))},"Ctrl-O":H(function(i){i.replaceSelection("\n","start")}),"Ctrl-T":H(function(i){i.execCommand("transposeChars")}),"Alt-C":H(function(i){L(i,function(R){var S=R.search(/\w/);if(S==-1){return R}return R.slice(0,S)+R.charAt(S).toUpperCase()+R.slice(S+1).toLowerCase()})}),"Alt-U":H(function(i){L(i,function(R){return R.toUpperCase()})}),"Alt-L":H(function(i){L(i,function(R){return R.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":H("undo"),"Shift-Ctrl--":H("undo"),"Ctrl-Z":H("undo"),"Cmd-Z":H("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":r,"Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:false,Tab:"indentAuto","Alt-G G":function(i){var R=m(i,true);if(R!=null&&R>0){return i.setCursor(R-1)}Q(i,"Goto line",function(T){var S;if(T&&!isNaN(S=Number(T))&&S==S|0&&S>0){i.setCursor(S-1)}})},"Ctrl-X Tab":function(i){i.indentSelection(m(i,true)||i.getOption("indentUnit"))},"Ctrl-X Ctrl-X":function(i){i.setSelection(i.getCursor("head"),i.getCursor("anchor"))},"Ctrl-X Ctrl-S":"save","Ctrl-X Ctrl-W":"save","Ctrl-X S":"saveAll","Ctrl-X F":"open","Ctrl-X U":H("undo"),"Ctrl-X K":"close","Ctrl-X Delete":function(i){u(i,i.getCursor(),c(i,i.getCursor(),1),true)},"Ctrl-X H":"selectAll","Ctrl-Q Tab":H("insertTab"),"Ctrl-U":t});var o={"Ctrl-G":J};function P(i){o[i]=function(R){C(R,i)};z["Ctrl-"+i]=function(R){C(R,i)};j["Ctrl-"+i]=true}for(var M=0;M<10;++M){P(String(M))}P("-")});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],b)}else{b(CodeMirror)}}})(function(n){var s=n.keyMap.sublime={fallthrough:"default"};var l=n.commands;var j=n.Pos;var e=n.keyMap["default"]==n.keyMap.macDefault;var g=e?"Cmd-":"Ctrl-";function f(D,v,w){if(w<0&&v.ch==0){return D.clipPos(j(v.line-1))}var E=D.getLine(v.line);if(w>0&&v.ch>=E.length){return D.clipPos(j(v.line+1,0))}var u="start",A;for(var C=v.ch,z=w<0?0:E.length,x=0;C!=z;C+=w,x++){var y=E.charAt(w<0?C-1:C);var B=y!="_"&&n.isWordChar(y)?"w":"o";if(B=="w"&&y.toUpperCase()==y){B="W"}if(u=="start"){if(B!="o"){u="in";A=B}}else{if(u=="in"){if(A!=B){if(A=="w"&&B=="W"&&w<0){C--}if(A=="W"&&B=="w"&&w>0){A="w";continue}break}}}}return j(v.line,C)}function q(u,v){u.extendSelectionsBy(function(w){if(u.display.shift||u.doc.extend||w.empty()){return f(u.doc,w.head,v)}else{return v<0?w.from():w.to()}})}l[s["Alt-Left"]="goSubwordLeft"]=function(u){q(u,-1)};l[s["Alt-Right"]="goSubwordRight"]=function(u){q(u,1)};l[s[g+"Up"]="scrollLineUp"]=function(u){var w=u.getScrollInfo();if(!u.somethingSelected()){var v=u.lineAtHeight(w.top+w.clientHeight,"local");if(u.getCursor().line>=v){u.execCommand("goLineUp")}}u.scrollTo(null,w.top-u.defaultTextHeight())};l[s[g+"Down"]="scrollLineDown"]=function(u){var w=u.getScrollInfo();if(!u.somethingSelected()){var v=u.lineAtHeight(w.top,"local")+1;if(u.getCursor().line<=v){u.execCommand("goLineDown")}}u.scrollTo(null,w.top+u.defaultTextHeight())};l[s["Shift-"+g+"L"]="splitSelectionByLine"]=function(u){var w=u.listSelections(),y=[];for(var x=0;x<w.length;x++){var A=w[x].from(),z=w[x].to();for(var v=A.line;v<=z.line;++v){if(!(z.line>A.line&&v==z.line&&z.ch==0)){y.push({anchor:v==A.line?A:j(v,0),head:v==z.line?z:j(v)})}}}u.setSelections(y,0)};s["Shift-Tab"]="indentLess";l[s.Esc="singleSelectionTop"]=function(u){var v=u.listSelections()[0];u.setSelection(v.anchor,v.head,{scroll:false})};l[s[g+"L"]="selectLine"]=function(v){var w=v.listSelections(),u=[];for(var y=0;y<w.length;y++){var x=w[y];u.push({anchor:j(x.from().line,0),head:j(x.to().line+1,0)})}v.setSelections(u)};s["Shift-"+g+"K"]="deleteLine";function b(v,u){v.operation(function(){var y=v.listSelections().length,x=[],B=-1;for(var A=0;A<y;A++){var z=v.listSelections()[A].head;if(z.line<=B){continue}var w=j(z.line+(u?0:1),0);v.replaceRange("\n",w,null,"+insertLine");v.indentLine(w.line,null,true);x.push({head:w,anchor:w});B=z.line+1}v.setSelections(x)})}l[s[g+"Enter"]="insertLineAfter"]=function(u){b(u,false)};l[s["Shift-"+g+"Enter"]="insertLineBefore"]=function(u){b(u,true)};function c(u,y){var x=y.ch,w=x,v=u.getLine(y.line);while(x&&n.isWordChar(v.charAt(x-1))){--x}while(w<v.length&&n.isWordChar(v.charAt(w))){++w}return{from:j(y.line,x),to:j(y.line,w),word:v.slice(x,w)}}l[s[g+"D"]="selectNextOccurrence"]=function(u){var B=u.getCursor("from"),A=u.getCursor("to");var v=u.state.sublimeFindFullWord==u.doc.sel;if(n.cmpPos(B,A)==0){var x=c(u,B);if(!x.word){return}u.setSelection(x.from,x.to);v=true}else{var z=u.getRange(B,A);var w=v?new RegExp("\\b"+z+"\\b"):z;var y=u.getSearchCursor(w,A);if(y.findNext()){u.addSelection(y.from(),y.to())}else{y=u.getSearchCursor(w,j(u.firstLine(),0));if(y.findNext()){u.addSelection(y.from(),y.to())}}}if(v){u.state.sublimeFindFullWord=u.doc.sel}};var i="(){}[]";function p(v){var x=v.getCursor(),u=v.scanForBracket(x,-1);if(!u){return}for(;;){var w=v.scanForBracket(x,1);if(!w){return}if(w.ch==i.charAt(i.indexOf(u.ch)+1)){v.setSelection(j(u.pos.line,u.pos.ch+1),w.pos,false);return true}x=j(w.pos.line,w.pos.ch+1)}}l[s["Shift-"+g+"Space"]="selectScope"]=function(u){p(u)||u.execCommand("selectAll")};l[s["Shift-"+g+"M"]="selectBetweenBrackets"]=function(u){if(!p(u)){return n.Pass}};l[s[g+"M"]="goToBracket"]=function(u){u.extendSelectionsBy(function(v){var w=u.scanForBracket(v.head,1);if(w&&n.cmpPos(w.pos,v.head)!=0){return w.pos}var x=u.scanForBracket(v.head,-1);return x&&j(x.pos.line,x.pos.ch+1)||v.head})};var o=e?"Cmd-Ctrl-":"Shift-Ctrl-";l[s[o+"Up"]="swapLineUp"]=function(B){var u=B.listSelections(),y=[],v=B.firstLine()-1,C=[];for(var w=0;w<u.length;w++){var x=u[w],A=x.from().line-1,z=x.to().line;C.push({anchor:j(x.anchor.line-1,x.anchor.ch),head:j(x.head.line-1,x.head.ch)});if(x.to().ch==0&&!x.empty()){--z}if(A>v){y.push(A,z)}else{if(y.length){y[y.length-1]=z}}v=z}B.operation(function(){for(var E=0;E<y.length;E+=2){var G=y[E],F=y[E+1];var D=B.getLine(G);B.replaceRange("",j(G,0),j(G+1,0),"+swapLine");if(F>B.lastLine()){B.replaceRange("\n"+D,j(B.lastLine()),null,"+swapLine")}else{B.replaceRange(D+"\n",j(F,0),null,"+swapLine")}}B.setSelections(C);B.scrollIntoView()})};l[s[o+"Down"]="swapLineDown"]=function(v){var w=v.listSelections(),z=[],u=v.lastLine()+1;for(var y=w.length-1;y>=0;y--){var x=w[y],B=x.to().line+1,A=x.from().line;if(x.to().ch==0&&!x.empty()){B--}if(B<u){z.push(B,A)}else{if(z.length){z[z.length-1]=A}}u=A}v.operation(function(){for(var D=z.length-2;D>=0;D-=2){var F=z[D],E=z[D+1];var C=v.getLine(F);if(F==v.lastLine()){v.replaceRange("",j(F-1),j(F),"+swapLine")}else{v.replaceRange("",j(F,0),j(F+1,0),"+swapLine")}v.replaceRange(C+"\n",j(E,0),null,"+swapLine")}v.scrollIntoView()})};s[g+"/"]="toggleComment";l[s[g+"J"]="joinLines"]=function(u){var w=u.listSelections(),z=[];for(var y=0;y<w.length;y++){var x=w[y],B=x.from();var A=B.line,v=x.to().line;while(y<w.length-1&&w[y+1].from().line==v){v=w[++y].to().line}z.push({start:A,end:v,anchor:!x.empty()&&B})}u.operation(function(){var I=0,D=[];for(var G=0;G<z.length;G++){var H=z[G];var E=H.anchor&&j(H.anchor.line-I,H.anchor.ch),F;for(var C=H.start;C<=H.end;C++){var J=C-I;if(C==H.end){F=j(J,u.getLine(J).length+1)}if(J<u.lastLine()){u.replaceRange(" ",j(J),j(J+1,/^\s*/.exec(u.getLine(J+1))[0].length));++I}}D.push({anchor:E||F,head:F})}u.setSelections(D,0)})};l[s["Shift-"+g+"D"]="duplicateLine"]=function(u){u.operation(function(){var w=u.listSelections().length;for(var x=0;x<w;x++){var v=u.listSelections()[x];if(v.empty()){u.replaceRange(u.getLine(v.head.line)+"\n",j(v.head.line,0))}else{u.replaceRange(u.getRange(v.from(),v.to()),v.from())}}u.scrollIntoView()})};s[g+"T"]="transposeChars";function t(C,z){var u=C.listSelections(),y=[],v;for(var w=0;w<u.length;w++){var x=u[w];if(x.empty()){continue}var B=x.from().line,A=x.to().line;while(w<u.length-1&&u[w+1].from().line==A){A=x[++w].to().line}y.push(B,A)}if(y.length){v=true}else{y.push(C.firstLine(),C.lastLine())}C.operation(function(){var F=[];for(var G=0;G<y.length;G+=2){var J=y[G],I=y[G+1];var H=j(J,0),E=j(I);var D=C.getRange(H,E,false);if(z){D.sort()}else{D.sort(function(M,K){var N=M.toUpperCase(),L=K.toUpperCase();if(N!=L){M=N;K=L}return M<K?-1:M==K?0:1})}C.replaceRange(D,H,E);if(v){F.push({anchor:H,head:E})}}if(v){C.setSelections(F,0)}})}l[s.F9="sortLines"]=function(u){t(u,true)};l[s[g+"F9"]="sortLinesInsensitive"]=function(u){t(u,false)};l[s.F2="nextBookmark"]=function(u){var v=u.state.sublimeBookmarks;if(v){while(v.length){var x=v.shift();var w=x.find();if(w){v.push(x);return u.setSelection(w.from,w.to)}}}};l[s["Shift-F2"]="prevBookmark"]=function(u){var v=u.state.sublimeBookmarks;if(v){while(v.length){v.unshift(v.pop());var w=v[v.length-1].find();if(!w){v.pop()}else{return u.setSelection(w.from,w.to)}}}};l[s[g+"F2"]="toggleBookmark"]=function(B){var u=B.listSelections();var y=B.state.sublimeBookmarks||(B.state.sublimeBookmarks=[]);for(var x=0;x<u.length;x++){var z=u[x].from(),A=u[x].to();var C=B.findMarks(z,A);for(var w=0;w<C.length;w++){if(C[w].sublimeBookmark){C[w].clear();for(var v=0;v<y.length;v++){if(y[v]==C[w]){y.splice(v--,1)}}break}}if(w==C.length){y.push(B.markText(z,A,{sublimeBookmark:true,clearWhenEmpty:false}))}}};l[s["Shift-"+g+"F2"]="clearBookmarks"]=function(u){var w=u.state.sublimeBookmarks;if(w){for(var v=0;v<w.length;v++){w[v].clear()}}w.length=0};l[s["Alt-F2"]="selectBookmarks"]=function(u){var x=u.state.sublimeBookmarks,v=[];if(x){for(var w=0;w<x.length;w++){var y=x[w].find();if(!y){x.splice(w--,0)}else{v.push({anchor:y.from,head:y.to})}}}if(v.length){u.setSelections(v,0)}};s["Alt-Q"]="wrapLines";var d=g+"K ";function h(u,v){u.operation(function(){var x=u.listSelections(),C=[],A=[];for(var z=0;z<x.length;z++){var y=x[z];if(y.empty()){C.push(z);A.push("")}else{A.push(v(u.getRange(y.from(),y.to())))}}u.replaceSelections(A,"around","case");for(var z=C.length-1,w;z>=0;z--){var y=x[C[z]];if(w&&n.cmpPos(y.head,w)>0){continue}var B=c(u,y.head);w=B.from;u.replaceRange(v(B.word),B.from,B.to)}})}s[d+g+"Backspace"]="delLineLeft";l[s.Backspace="smartBackspace"]=function(u){if(u.somethingSelected()){return n.Pass}var x=u.getCursor();var w=u.getRange({line:x.line,ch:0},x);var v=n.countColumn(w,null,u.getOption("tabSize"));if(!/\S/.test(w)&&v%u.getOption("indentUnit")==0){return u.indentSelection("subtract")}else{return n.Pass}};l[s[d+g+"K"]="delLineRight"]=function(u){u.operation(function(){var v=u.listSelections();for(var w=v.length-1;w>=0;w--){u.replaceRange("",v[w].anchor,j(v[w].to().line),"+delete")}u.scrollIntoView()})};l[s[d+g+"U"]="upcaseAtCursor"]=function(u){h(u,function(v){return v.toUpperCase()})};l[s[d+g+"L"]="downcaseAtCursor"]=function(u){h(u,function(v){return v.toLowerCase()})};l[s[d+g+"Space"]="setSublimeMark"]=function(u){if(u.state.sublimeMark){u.state.sublimeMark.clear()}u.state.sublimeMark=u.setBookmark(u.getCursor())};l[s[d+g+"A"]="selectToSublimeMark"]=function(u){var v=u.state.sublimeMark&&u.state.sublimeMark.find();if(v){u.setSelection(u.getCursor(),v)}};l[s[d+g+"W"]="deleteToSublimeMark"]=function(u){var w=u.state.sublimeMark&&u.state.sublimeMark.find();if(w){var y=u.getCursor(),x=w;if(n.cmpPos(y,x)>0){var v=x;x=y;y=v}u.state.sublimeKilled=u.getRange(y,x);u.replaceRange("",y,x)}};l[s[d+g+"X"]="swapWithSublimeMark"]=function(u){var v=u.state.sublimeMark&&u.state.sublimeMark.find();if(v){u.state.sublimeMark.clear();u.state.sublimeMark=u.setBookmark(u.getCursor());u.setCursor(v)}};l[s[d+g+"Y"]="sublimeYank"]=function(u){if(u.state.sublimeKilled!=null){u.replaceSelection(u.state.sublimeKilled,null,"paste")}};s[d+g+"G"]="clearBookmarks";l[s[d+g+"C"]="showInCenter"]=function(u){var v=u.cursorCoords(null,"local");u.scrollTo(null,(v.top+v.bottom)/2-u.getScrollInfo().clientHeight/2)};l[s["Shift-Alt-Up"]="selectLinesUpward"]=function(u){u.operation(function(){var v=u.listSelections();for(var x=0;x<v.length;x++){var w=v[x];if(w.head.line>u.firstLine()){u.addSelection(j(w.head.line-1,w.head.ch))}}})};l[s["Shift-Alt-Down"]="selectLinesDownward"]=function(u){u.operation(function(){var v=u.listSelections();for(var x=0;x<v.length;x++){var w=v[x];if(w.head.line<u.lastLine()){u.addSelection(j(w.head.line+1,w.head.ch))}}})};function r(u){var x=u.getCursor("from"),w=u.getCursor("to");if(n.cmpPos(x,w)==0){var v=c(u,x);if(!v.word){return}x=v.from;w=v.to}return{from:x,to:w,query:u.getRange(x,w),word:v}}function m(u,v){var x=r(u);if(!x){return}var w=x.query;var y=u.getSearchCursor(w,v?x.to:x.from);if(v?y.findNext():y.findPrevious()){u.setSelection(y.from(),y.to())}else{y=u.getSearchCursor(w,v?j(u.firstLine(),0):u.clipPos(j(u.lastLine())));if(v?y.findNext():y.findPrevious()){u.setSelection(y.from(),y.to())}else{if(x.word){u.setSelection(x.from,x.to)}}}}l[s[g+"F3"]="findUnder"]=function(u){m(u,true)};l[s["Shift-"+g+"F3"]="findUnderPrevious"]=function(u){m(u,false)};l[s["Alt-F3"]="findAllUnder"]=function(u){var x=r(u);if(!x){return}var y=u.getSearchCursor(x.query);var w=[];var v=-1;while(y.findNext()){w.push({anchor:y.from(),head:y.to()});if(y.from().line<=x.from.line&&y.from().ch<=x.from.ch){v++}}u.setSelections(w,v)};s["Shift-"+g+"["]="fold";s["Shift-"+g+"]"]="unfold";s[d+g+"0"]=s[d+g+"j"]="unfoldAll";s[g+"I"]="findIncremental";s["Shift-"+g+"I"]="findIncrementalReverse";s[g+"H"]="replace";s.F3="findNext";s["Shift-F3"]="findPrev";n.normalizeKeyMap(s)});(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],b)}else{b(CodeMirror)}}})(function(c){var b=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"xi",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"dcc",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:false}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:true}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:true,linewise:true}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:false,linewise:true}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:true}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:false}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false,bigWord:true}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,inclusive:true}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,bigWord:true,inclusive:true}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false,bigWord:true}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,inclusive:true}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,bigWord:true,inclusive:true}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:false,toJumplist:true}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:true,toJumplist:true}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:true}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:false}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:true,explicitRepeat:true}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:false,explicitRepeat:true}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:true,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:false,toFirstChar:true}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:true}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:true,toJumplist:true}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:true,inclusive:true}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:false}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:true,inclusive:true}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:false}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:true}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:false}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:true,linewise:true}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:true}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:true}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:false}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:true,linewise:true}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:false,linewise:true}},{keys:"]p",type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true,matchIndent:true}},{keys:"[p",type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true,matchIndent:true}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:true,toJumplist:true}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:false,toJumplist:true}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:true},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:true}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:false}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:true},isEdit:true},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:false},isEdit:true},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:true}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:false,toJumplist:true}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:true},operatorMotionArgs:{visualLine:false}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:false},operatorMotionArgs:{visualLine:true}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:true},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:true},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:true},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:true},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:true},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:true},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:true},operatorArgs:{shouldMoveCursor:true},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:true}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:false}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:true,linewise:true}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:false,linewise:true}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:true},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:false},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:true}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:true}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:true},{keys:"p",type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true}},{keys:"P",type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true}},{keys:"r<character>",type:"action",action:"replace",isEdit:true},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{replace:true}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:true},context:"visual",isEdit:true},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:false},context:"visual",isEdit:true},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:true,backtrack:false}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:false,backtrack:false}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:true}},{keys:"/",type:"search",searchArgs:{forward:true,querySrc:"prompt",toJumplist:true}},{keys:"?",type:"search",searchArgs:{forward:false,querySrc:"prompt",toJumplist:true}},{keys:"*",type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:"#",type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:"g*",type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",toJumplist:true}},{keys:"g#",type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",toJumplist:true}},{keys:":",type:"ex"}];var d=c.Pos;var e=function(){function aY(bE){bE.setOption("disableInput",true);bE.setOption("showCursorWhenSelecting",false);c.signal(bE,"vim-mode-change",{mode:"normal"});bE.on("cursorActivity",ac);I(bE);c.on(bE.getInputField(),"paste",W(bE))}function aU(bE){bE.setOption("disableInput",false);bE.off("cursorActivity",ac);c.off(bE.getInputField(),"paste",W(bE));bE.state.vim=null}function i(bE,bF){if(this==c.keyMap.vim){c.rmClass(bE.getWrapperElement(),"cm-fat-cursor")}if(!bF||bF.attach!=u){aU(bE,false)}}function u(bE,bF){if(this==c.keyMap.vim){c.addClass(bE.getWrapperElement(),"cm-fat-cursor")}if(!bF||bF.attach!=u){aY(bE)}}c.defineOption("vimMode",false,function(bE,bG,bF){if(bG&&bE.getOption("keyMap")!="vim"){bE.setOption("keyMap","vim")}else{if(!bG&&bF!=c.Init&&/^vim/.test(bE.getOption("keyMap"))){bE.setOption("keyMap","default")}}});function a6(bG,bF){if(!bF){return undefined}var bE=N(bG);if(!bE){return false}var bH=c.Vim.findKey(bF,bE);if(typeof bH=="function"){c.signal(bF,"vim-keypress",bE)}return bH}var aD={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"};var aX={Enter:"CR",Backspace:"BS",Delete:"Del"};function N(bG){if(bG.charAt(0)=="'"){return bG.charAt(1)}var bJ=bG.split("-");if(/-$/.test(bG)){bJ.splice(-2,2,"-")}var bE=bJ[bJ.length-1];if(bJ.length==1&&bJ[0].length==1){return false}else{if(bJ.length==2&&bJ[0]=="Shift"&&bE.length==1){return false}}var bI=false;for(var bF=0;bF<bJ.length;bF++){var bH=bJ[bF];if(bH in aD){bJ[bF]=aD[bH]}else{bI=true}if(bH in aX){bJ[bF]=aX[bH]}}if(!bI){return false}if(C(bE)){bJ[bJ.length-1]=bE.toLowerCase()}return"<"+bJ.join("-")+">"}function W(bE){var bF=bE.state.vim;if(!bF.onPasteFn){bF.onPasteFn=function(){if(!bF.insertMode){bE.setCursor(F(bE.getCursor(),0,1));r.enterInsertMode(bE,{},bF)}}}return bF.onPasteFn}var a2=/[\d]/;var aq=[c.isWordChar,function(bE){return bE&&!c.isWordChar(bE)&&!/\s/.test(bE)}],by=[function(bE){return/\S/.test(bE)}];function au(bH,bF){var bG=[];for(var bE=bH;bE<bH+bF;bE++){bG.push(String.fromCharCode(bE))}return bG}var aj=au(65,26);var ao=au(97,26);var X=au(48,10);var aI=[].concat(aj,ao,X,["<",">"]);var m=[].concat(aj,ao,X,["-",'"',".",":","/"]);function g(bE,bF){return bF>=bE.firstLine()&&bF<=bE.lastLine()}function G(bE){return(/^[a-z]$/).test(bE)}function P(bE){return"()[]{}".indexOf(bE)!=-1}function ai(bE){return a2.test(bE)}function C(bE){return(/^[A-Z]$/).test(bE)}function V(bE){return(/^\s*$/).test(bE)}function L(bG,bE){for(var bF=0;bF<bE.length;bF++){if(bE[bF]==bG){return true}}return false}var aw={};function aN(bF,bE,bG){if(bE===undefined){throw Error("defaultValue is required")}if(!bG){bG="string"}aw[bF]={type:bG,defaultValue:bE};aL(bF,bE)}function aL(bE,bG){var bF=aw[bE];if(!bF){throw Error("Unknown option: "+bE)}if(bF.type=="boolean"){if(bG&&bG!==true){throw Error("Invalid argument: "+bE+"="+bG)}else{if(bG!==false){bG=true}}}bF.value=bF.type=="boolean"?!!bG:bG}function p(bE){var bF=aw[bE];if(!bF){throw Error("Unknown option: "+bE)}return bF.value}var ar=function(){var bI=100;var bK=-1;var bH=0;var bG=0;var bF=new Array(bI);function bJ(bL,bN,bO){var bP=bK%bI;var bQ=bF[bP];function bM(bT){var bS=++bK%bI;var bU=bF[bS];if(bU){bU.clear()}bF[bS]=bL.setBookmark(bT)}if(bQ){var bR=bQ.find();if(bR&&!bB(bR,bN)){bM(bN)}}else{bM(bN)}bM(bO);bH=bK;bG=bK-bI+1;if(bG<0){bG=0}}function bE(bL,bP){bK+=bP;if(bK>bH){bK=bH}else{if(bK<bG){bK=bG}}var bQ=bF[(bI+bK)%bI];if(bQ&&!bQ.find()){var bO=bP>0?1:-1;var bN;var bM=bL.getCursor();do{bK+=bO;bQ=bF[(bI+bK)%bI];if(bQ&&(bN=bQ.find())&&!bB(bM,bN)){break}}while(bK<bH&&bK>bG)}return bQ}return{cachedCursor:undefined,add:bJ,move:bE}};var j=function(bE){if(bE){return{changes:bE.changes,expectCursorActivityForChange:bE.expectCursorActivityForChange}}return{changes:[],expectCursorActivityForChange:false}};function aA(){this.latestRegister=undefined;this.isPlaying=false;this.isRecording=false;this.replaySearchQueries=[];this.onRecordingDone=undefined;this.lastInsertModeChanges=j()}aA.prototype={exitMacroRecordMode:function(){var bE=s.macroModeState;if(bE.onRecordingDone){bE.onRecordingDone()}bE.onRecordingDone=undefined;bE.isRecording=false},enterMacroRecordMode:function(bE,bG){var bF=s.registerController.getRegister(bG);if(bF){bF.clear();this.latestRegister=bG;if(bE.openDialog){this.onRecordingDone=bE.openDialog("(recording)["+bG+"]",null,{bottom:true})}this.isRecording=true}}};function I(bE){if(!bE.state.vim){bE.state.vim={inputState:new aE(),lastEditInputState:undefined,lastEditActionCommand:undefined,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:false,insertModeRepeat:undefined,visualMode:false,visualLine:false,visualBlock:false,lastSelection:null,lastPastedText:null,sel:{}}}return bE.state.vim}var s;function B(){s={searchQuery:null,searchIsReversed:false,lastSubstituteReplacePart:undefined,jumpList:ar(),macroModeState:new aA,lastChararacterSearch:{increment:0,forward:true,selectedCharacter:""},registerController:new ak({}),searchHistoryController:new a7({}),exCommandHistoryController:new a7({})};for(var bE in aw){var bF=aw[bE];bF.value=bF.defaultValue}}var bz;var aR={buildKeyMap:function(){},getRegisterController:function(){return s.registerController},resetVimGlobalState_:B,getVimGlobalState_:function(){return s},maybeInitVimState_:I,suppressErrorLogging:false,InsertModeKey:bn,map:function(bF,bG,bE){n.map(bF,bG,bE)},setOption:aL,getOption:p,defineOption:aN,defineEx:function(bE,bG,bF){if(bE.indexOf(bG)!==0){throw new Error('(Vim.defineEx) "'+bG+'" is not a prefix of "'+bE+'", command not registered')}a8[bE]=bF;n.commandMap_[bG]={name:bE,shortName:bG,type:"api"}},handleKey:function(bE,bG,bF){var bH=this.findKey(bE,bG,bF);if(typeof bH==="function"){return bH()}},findKey:function(bK,bL,bJ){var bH=I(bK);function bM(){var bO=s.macroModeState;if(bO.isRecording){if(bL=="q"){bO.exitMacroRecordMode();l(bK);return true}if(bJ!="mapping"){K(bO,bL)}}}function bN(){if(bL=="<Esc>"){l(bK);if(bH.visualMode){aV(bK)}else{if(bH.insertMode){x(bK)}}return true}}function bE(bP){var bO;while(bP){bO=(/<\w+-.+?>|<\w+>|./).exec(bP);bL=bO[0];bP=bP.substring(bO.index+bL.length);c.Vim.handleKey(bK,bL,"mapping")}}function bI(){if(bN()){return true}var bQ=bH.inputState.keyBuffer=bH.inputState.keyBuffer+bL;var bR=bL.length==1;var bO=be.matchCommand(bQ,b,bH.inputState,"insert");while(bQ.length>1&&bO.type!="full"){var bQ=bH.inputState.keyBuffer=bQ.slice(1);var bS=be.matchCommand(bQ,b,bH.inputState,"insert");if(bS.type!="none"){bO=bS}}if(bO.type=="none"){l(bK);return false}else{if(bO.type=="partial"){if(bz){window.clearTimeout(bz)}bz=window.setTimeout(function(){if(bH.insertMode&&bH.inputState.keyBuffer){l(bK)}},p("insertModeEscKeysTimeout"));return !bR}}if(bz){window.clearTimeout(bz)}if(bR){var bP=bK.getCursor();bK.replaceRange("",F(bP,0,-(bQ.length-1)),bP,"+input")}l(bK);return bO.command}function bG(){if(bM()||bN()){return true}var bQ=bH.inputState.keyBuffer=bH.inputState.keyBuffer+bL;if(/^[1-9]\d*$/.test(bQ)){return true}var bR=/^(\d*)(.*)$/.exec(bQ);if(!bR){l(bK);return false}var bP=bH.visualMode?"visual":"normal";var bO=be.matchCommand(bR[2]||bR[1],b,bH.inputState,bP);if(bO.type=="none"){l(bK);return false}else{if(bO.type=="partial"){return true}}bH.inputState.keyBuffer="";var bR=/^(\d*)(.*)$/.exec(bQ);if(bR[1]&&bR[1]!="0"){bH.inputState.pushRepeatDigit(bR[1])}return bO.command}var bF;if(bH.insertMode){bF=bI()}else{bF=bG()}if(bF===false){return undefined}else{if(bF===true){return function(){}}else{return function(){return bK.operation(function(){bK.curOp.isVimOp=true;try{if(bF.type=="keyToKey"){bE(bF.toKeys)}else{be.processCommand(bK,bH,bF)}}catch(bO){bK.state.vim=undefined;I(bK);if(!c.Vim.suppressErrorLogging){console.log(bO)}throw bO}return true})}}}},handleEx:function(bE,bF){n.processCommand(bE,bF)},defineMotion:at,defineAction:bs,defineOperator:bl,mapCommand:aB,_mapCommand:q,exitVisualMode:aV,exitInsertMode:x};function aE(){this.prefixRepeat=[];this.motionRepeat=[];this.operator=null;this.operatorArgs=null;this.motion=null;this.motionArgs=null;this.keyBuffer=[];this.registerName=null}aE.prototype.pushRepeatDigit=function(bE){if(!this.operator){this.prefixRepeat=this.prefixRepeat.concat(bE)}else{this.motionRepeat=this.motionRepeat.concat(bE)}};aE.prototype.getRepeat=function(){var bE=0;if(this.prefixRepeat.length>0||this.motionRepeat.length>0){bE=1;if(this.prefixRepeat.length>0){bE*=parseInt(this.prefixRepeat.join(""),10)}if(this.motionRepeat.length>0){bE*=parseInt(this.motionRepeat.join(""),10)}}return bE};function l(bE,bF){bE.state.vim.inputState=new aE();c.signal(bE,"vim-command-done",bF)}function br(bG,bF,bE){this.clear();this.keyBuffer=[bG||""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!bF;this.blockwise=!!bE}br.prototype={setText:function(bG,bF,bE){this.keyBuffer=[bG||""];this.linewise=!!bF;this.blockwise=!!bE},pushText:function(bF,bE){if(bE){if(!this.linewise){this.keyBuffer.push("\n")}this.linewise=true}this.keyBuffer.push(bF)},pushInsertModeChanges:function(bE){this.insertModeChanges.push(j(bE))},pushSearchQuery:function(bE){this.searchQueries.push(bE)},clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=false},toString:function(){return this.keyBuffer.join("")}};function ak(bE){this.registers=bE;this.unnamedRegister=bE['"']=new br();bE["."]=new br();bE[":"]=new br();bE["/"]=new br()}ak.prototype={pushText:function(bI,bF,bK,bJ,bG){if(bJ&&bK.charAt(0)=="\n"){bK=bK.slice(1)+"\n"}if(bJ&&bK.charAt(bK.length-1)!=="\n"){bK+="\n"}var bH=this.isValidRegister(bI)?this.getRegister(bI):null;if(!bH){switch(bF){case"yank":this.registers["0"]=new br(bK,bJ,bG);break;case"delete":case"change":if(bK.indexOf("\n")==-1){this.registers["-"]=new br(bK,bJ)}else{this.shiftNumericRegisters_();this.registers["1"]=new br(bK,bJ)}break}this.unnamedRegister.setText(bK,bJ,bG);return}var bE=C(bI);if(bE){bH.pushText(bK,bJ)}else{bH.setText(bK,bJ,bG)}this.unnamedRegister.setText(bH.toString(),bJ)},getRegister:function(bE){if(!this.isValidRegister(bE)){return this.unnamedRegister}bE=bE.toLowerCase();if(!this.registers[bE]){this.registers[bE]=new br()}return this.registers[bE]},isValidRegister:function(bE){return bE&&L(bE,m)},shiftNumericRegisters_:function(){for(var bE=9;bE>=2;bE--){this.registers[bE]=this.getRegister(""+(bE-1))}}};function a7(){this.historyBuffer=[];this.iterator;this.initialPrefix=null}a7.prototype={nextMatch:function(bF,bE){var bK=this.historyBuffer;var bH=bE?-1:1;if(this.initialPrefix===null){this.initialPrefix=bF}for(var bJ=this.iterator+bH;bE?bJ>=0:bJ<bK.length;bJ+=bH){var bI=bK[bJ];for(var bG=0;bG<=bI.length;bG++){if(this.initialPrefix==bI.substring(0,bG)){this.iterator=bJ;return bI}}}if(bJ>=bK.length){this.iterator=bK.length;return this.initialPrefix}if(bJ<0){return bF}},pushInput:function(bE){var bF=this.historyBuffer.indexOf(bE);if(bF>-1){this.historyBuffer.splice(bF,1)}if(bE.length){this.historyBuffer.push(bE)}},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var be={matchCommand:function(bJ,bL,bE,bH){var bK=bo(bJ,bL,bH,bE);if(!bK.full&&!bK.partial){return{type:"none"}}else{if(!bK.full&&bK.partial){return{type:"partial"}}}var bI;for(var bG=0;bG<bK.full.length;bG++){var bF=bK.full[bG];if(!bI){bI=bF}}if(bI.keys.slice(-11)=="<character>"){bE.selectedCharacter=S(bJ)}return{type:"full",command:bI}},processCommand:function(bE,bF,bG){bF.inputState.repeatOverride=bG.repeatOverride;switch(bG.type){case"motion":this.processMotion(bE,bF,bG);break;case"operator":this.processOperator(bE,bF,bG);break;case"operatorMotion":this.processOperatorMotion(bE,bF,bG);break;case"action":this.processAction(bE,bF,bG);break;case"search":this.processSearch(bE,bF,bG);break;case"ex":case"keyToEx":this.processEx(bE,bF,bG);break;default:break}},processMotion:function(bE,bF,bG){bF.inputState.motion=bG.motion;bF.inputState.motionArgs=bm(bG.motionArgs);this.evalInput(bE,bF)},processOperator:function(bF,bG,bH){var bE=bG.inputState;if(bE.operator){if(bE.operator==bH.operator){bE.motion="expandToLine";bE.motionArgs={linewise:true};this.evalInput(bF,bG);return}else{l(bF)}}bE.operator=bH.operator;bE.operatorArgs=bm(bH.operatorArgs);if(bG.visualMode){this.evalInput(bF,bG)}},processOperatorMotion:function(bE,bH,bI){var bG=bH.visualMode;var bF=bm(bI.operatorMotionArgs);if(bF){if(bG&&bF.visualLine){bH.visualLine=true}}this.processOperator(bE,bH,bI);if(!bG){this.processMotion(bE,bH,bI)}},processAction:function(bF,bH,bK){var bE=bH.inputState;var bJ=bE.getRepeat();var bI=!!bJ;var bG=bm(bK.actionArgs)||{};if(bE.selectedCharacter){bG.selectedCharacter=bE.selectedCharacter}if(bK.operator){this.processOperator(bF,bH,bK)}if(bK.motion){this.processMotion(bF,bH,bK)}if(bK.motion||bK.operator){this.evalInput(bF,bH)}bG.repeat=bJ||1;bG.repeatIsExplicit=bI;bG.registerName=bE.registerName;l(bF);bH.lastMotion=null;if(bK.isEdit){this.recordLastEdit(bH,bE,bK)}r[bK.action](bF,bG,bH)},processSearch:function(bT,bM,bL){if(!bT.getSearchCursor){return}var bO=bL.searchArgs.forward;var bJ=bL.searchArgs.wholeWordOnly;aK(bT).setReversed(!bO);var bP=(bO)?"/":"?";var bR=aK(bT).getQuery();var bG=bT.getScrollInfo();function bK(bW,bU,bV){s.searchHistoryController.pushInput(bW);s.searchHistoryController.reset();try{bA(bT,bW,bU,bV)}catch(bX){bp(bT,"Invalid regex: "+bW);l(bT);return}be.processMotion(bT,bM,{type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:bL.searchArgs.toJumplist}})}function bS(bU){bT.scrollTo(bG.left,bG.top);bK(bU,true,true);var bV=s.macroModeState;if(bV.isRecording){Q(bV,bU)}}function bI(bY,bX,bZ){var bW=c.keyName(bY),bU;if(bW=="Up"||bW=="Down"){bU=bW=="Up"?true:false;bX=s.searchHistoryController.nextMatch(bX,bU)||"";bZ(bX)}else{if(bW!="Left"&&bW!="Right"&&bW!="Ctrl"&&bW!="Alt"&&bW!="Shift"){s.searchHistoryController.reset()}}var bV;try{bV=bA(bT,bX,true,true)}catch(bY){}if(bV){bT.scrollIntoView(bC(bT,!bO,bV),30)}else{aO(bT);bT.scrollTo(bG.left,bG.top)}}function bF(bW,bV,bX){var bU=c.keyName(bW);if(bU=="Esc"||bU=="Ctrl-C"||bU=="Ctrl-["){s.searchHistoryController.pushInput(bV);s.searchHistoryController.reset();bA(bT,bR);aO(bT);bT.scrollTo(bG.left,bG.top);c.e_stop(bW);l(bT);bX();bT.focus()}}switch(bL.searchArgs.querySrc){case"prompt":var bN=s.macroModeState;if(bN.isPlaying){var bQ=bN.replaySearchQueries.shift();bK(bQ,true,false)}else{a4(bT,{onClose:bS,prefix:bP,desc:R,onKeyUp:bI,onKeyDown:bF})}break;case"wordUnderCursor":var bH=aH(bT,false,true,false,true);var bE=true;if(!bH){bH=aH(bT,false,true,false,false);bE=false}if(!bH){return}var bQ=bT.getLine(bH.start.line).substring(bH.start.ch,bH.end.ch);if(bE&&bJ){bQ="\\b"+bQ+"\\b"}else{bQ=h(bQ)}s.jumpList.cachedCursor=bT.getCursor();bT.setCursor(bH.start);bK(bQ,true,false);break}},processEx:function(bE,bF,bI){function bH(bJ){s.exCommandHistoryController.pushInput(bJ);s.exCommandHistoryController.reset();n.processCommand(bE,bJ)}function bG(bM,bK,bN){var bL=c.keyName(bM),bJ;if(bL=="Esc"||bL=="Ctrl-C"||bL=="Ctrl-["){s.exCommandHistoryController.pushInput(bK);s.exCommandHistoryController.reset();c.e_stop(bM);l(bE);bN();bE.focus()}if(bL=="Up"||bL=="Down"){bJ=bL=="Up"?true:false;bK=s.exCommandHistoryController.nextMatch(bK,bJ)||"";bN(bK)}else{if(bL!="Left"&&bL!="Right"&&bL!="Ctrl"&&bL!="Alt"&&bL!="Shift"){s.exCommandHistoryController.reset()}}}if(bI.type=="keyToEx"){n.processCommand(bE,bI.exArgs.input)}else{if(bF.visualMode){a4(bE,{onClose:bH,prefix:":",value:"'<,'>",onKeyDown:bG})}else{a4(bE,{onClose:bH,prefix:":",onKeyDown:bG})}}},evalInput:function(bM,bY){var bR=bY.inputState;var bV=bR.motion;var bS=bR.motionArgs||{};var bN=bR.operator;var b8=bR.operatorArgs||{};var bT=bR.registerName;var bZ=bY.sel;var b9=E(bY.visualMode?bZ.head:bM.getCursor("head"));var bK=E(bY.visualMode?bZ.anchor:bM.getCursor("anchor"));var bH=E(b9);var bG=E(bK);var bX,bQ;var bO;if(bN){this.recordLastEdit(bY,bR)}if(bR.repeatOverride!==undefined){bO=bR.repeatOverride}else{bO=bR.getRepeat()}if(bO>0&&bS.explicitRepeat){bS.repeatIsExplicit=true}else{if(bS.noRepeat||(!bS.explicitRepeat&&bO===0)){bO=1;bS.repeatIsExplicit=false}}if(bR.selectedCharacter){bS.selectedCharacter=b8.selectedCharacter=bR.selectedCharacter}bS.repeat=bO;l(bM);if(bV){var bW=a5[bV](bM,b9,bS,bY);bY.lastMotion=a5[bV];if(!bW){return}if(bS.toJumplist){var b7=s.jumpList;var bP=b7.cachedCursor;if(bP){bi(bM,bP,bW);delete b7.cachedCursor}else{bi(bM,b9,bW)}}if(bW instanceof Array){bQ=bW[0];bX=bW[1]}else{bX=bW}if(!bX){bX=E(b9)}if(bY.visualMode){if(!(bY.visualBlock&&bX.ch===Infinity)){bX=ab(bM,bX,bY.visualBlock)}if(bQ){bQ=ab(bM,bQ,true)}bQ=bQ||bG;bZ.anchor=bQ;bZ.head=bX;O(bM);aT(bM,bY,"<",aQ(bQ,bX)?bQ:bX);aT(bM,bY,">",aQ(bQ,bX)?bX:bQ)}else{if(!bN){bX=ab(bM,bX);bM.setCursor(bX.line,bX.ch)}}}if(bN){if(b8.lastSel){bQ=bG;var bE=b8.lastSel;var b4=Math.abs(bE.head.line-bE.anchor.line);var b6=Math.abs(bE.head.ch-bE.anchor.ch);if(bE.visualLine){bX=d(bG.line+b4,bG.ch)}else{if(bE.visualBlock){bX=d(bG.line+b4,bG.ch+b6)}else{if(bE.head.line==bE.anchor.line){bX=d(bG.line,bG.ch+b6)}else{bX=d(bG.line+b4,bG.ch)}}}bY.visualMode=true;bY.visualLine=bE.visualLine;bY.visualBlock=bE.visualBlock;bZ=bY.sel={anchor:bQ,head:bX};O(bM)}else{if(bY.visualMode){b8.lastSel={anchor:E(bZ.anchor),head:E(bZ.head),visualBlock:bY.visualBlock,visualLine:bY.visualLine}}}var bL,b0,bI,bU;var bJ;if(bY.visualMode){bL=ay(bZ.head,bZ.anchor);b0=bc(bZ.head,bZ.anchor);bI=bY.visualLine||b8.linewise;bU=bY.visualBlock?"block":bI?"line":"char";bJ=bD(bM,{anchor:bL,head:b0},bU);if(bI){var bF=bJ.ranges;if(bU=="block"){for(var b1=0;b1<bF.length;b1++){bF[b1].head.ch=aZ(bM,bF[b1].head.line)}}else{if(bU=="line"){bF[0].head=d(bF[0].head.line+1,0)}}}}else{bL=E(bQ||bG);b0=E(bX||bH);if(aQ(b0,bL)){var b5=bL;bL=b0;b0=b5}bI=bS.linewise||b8.linewise;if(bI){bg(bM,bL,b0)}else{if(bS.forward){an(bM,bL,b0)}}bU="char";var b3=!bS.inclusive||bI;bJ=bD(bM,{anchor:bL,head:b0},bU,b3)}bM.setSelections(bJ.ranges,bJ.primary);bY.lastMotion=null;b8.repeat=bO;b8.registerName=bT;b8.linewise=bI;var b2=M[bN](bM,b8,bJ.ranges,bG,bX);if(bY.visualMode){aV(bM,b2!=null)}if(b2){bM.setCursor(b2)}}},recordLastEdit:function(bF,bE,bG){var bH=s.macroModeState;if(bH.isPlaying){return}bF.lastEditInputState=bE;bF.lastEditActionCommand=bG;bH.lastInsertModeChanges.changes=[];bH.lastInsertModeChanges.expectCursorActivityForChange=false}};var a5={moveToTopLine:function(bE,bG,bH){var bF=bf(bE).top+bH.repeat-1;return d(bF,a3(bE.getLine(bF)))},moveToMiddleLine:function(bE){var bG=bf(bE);var bF=Math.floor((bG.top+bG.bottom)*0.5);return d(bF,a3(bE.getLine(bF)))},moveToBottomLine:function(bE,bG,bH){var bF=bf(bE).bottom-bH.repeat+1;return d(bF,a3(bE.getLine(bF)))},expandToLine:function(bG,bF,bE){var bH=bF;return d(bH.line+bE.repeat-1,Infinity)},findNext:function(bE,bF,bG){var bJ=aK(bE);var bI=bJ.getQuery();if(!bI){return}var bH=!bG.forward;bH=(bJ.isReversed())?!bH:bH;aM(bE,bI);return bC(bE,bH,bI,bG.repeat)},goToMark:function(bE,bG,bH,bF){var bJ=bF.marks[bH.selectedCharacter];if(bJ){var bI=bJ.find();return bH.linewise?{line:bI.line,ch:a3(bE.getLine(bI.line))}:bI}return null},moveToOtherHighlightedEnd:function(bE,bG,bH,bF){if(bF.visualBlock&&bH.sameLine){var bI=bF.sel;return[ab(bE,d(bI.anchor.line,bI.head.ch)),ab(bE,d(bI.head.line,bI.anchor.ch))]}else{return([bF.sel.head,bF.sel.anchor])}},jumpToMark:function(bM,bL,bH,bI){var bG=bL;for(var bJ=0;bJ<bH.repeat;bJ++){var bO=bG;for(var bN in bI.marks){if(!G(bN)){continue}var bF=bI.marks[bN].find();var bE=(bH.forward)?aQ(bF,bO):aQ(bO,bF);if(bE){continue}if(bH.linewise&&(bF.line==bO.line)){continue}var bK=bB(bO,bG);var bP=(bH.forward)?ax(bO,bF,bG):ax(bG,bF,bO);if(bK||bP){bG=bF}}}if(bH.linewise){bG=d(bG.line,a3(bM.getLine(bG.line)))}return bG},moveByCharacters:function(bH,bF,bE){var bJ=bF;var bI=bE.repeat;var bG=bE.forward?bJ.ch+bI:bJ.ch-bI;return d(bJ.line,bG)},moveByLines:function(bK,bJ,bF,bG){var bM=bJ;var bH=bM.ch;switch(bG.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:bH=bG.lastHPos;break;default:bG.lastHPos=bH}var bE=bF.repeat+(bF.repeatOffset||0);var bN=bF.forward?bM.line+bE:bM.line-bE;var bI=bK.firstLine();var bL=bK.lastLine();if((bN<bI&&bM.line==bI)||(bN>bL&&bM.line==bL)){return}if(bF.toFirstChar){bH=a3(bK.getLine(bN));bG.lastHPos=bH}bG.lastHSPos=bK.charCoords(d(bN,bH),"div").left;return d(bN,bH)},moveByDisplayLines:function(bM,bL,bG,bH){var bN=bL;switch(bH.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:bH.lastHSPos=bM.charCoords(bN,"div").left}var bE=bG.repeat;var bK=bM.findPosV(bN,(bG.forward?bE:-bE),"line",bH.lastHSPos);if(bK.hitSide){if(bG.forward){var bF=bM.charCoords(bK,"div");var bI={top:bF.top+8,left:bH.lastHSPos};var bK=bM.coordsChar(bI,"div")}else{var bJ=bM.charCoords(d(bM.firstLine(),0),"div");bJ.left=bH.lastHSPos;bK=bM.coordsChar(bJ,"div")}}bH.lastHPos=bK.ch;return bK},moveByPage:function(bF,bH,bG){var bE=bH;var bI=bG.repeat;return bF.findPosV(bE,(bG.forward?bI:-bI),"page")},moveByParagraph:function(bE,bH,bG){var bF=bG.forward?1:-1;return bq(bE,bH,bG.repeat,bF)},moveByScroll:function(bK,bH,bF,bG){var bL=bK.getScrollInfo();var bM=null;var bE=bF.repeat;if(!bE){bE=bL.clientHeight/(2*bK.defaultTextHeight())}var bJ=bK.charCoords(bH,"local");bF.repeat=bE;var bM=a5.moveByDisplayLines(bK,bH,bF,bG);if(!bM){return null}var bI=bK.charCoords(bM,"local");bK.scrollTo(null,bL.top+bI.top-bJ.top);return bM},moveByWords:function(bE,bG,bF){return aF(bE,bG,bF.repeat,!!bF.forward,!!bF.wordEnd,!!bF.bigWord)},moveTillCharacter:function(bF,bG,bH){var bJ=bH.repeat;var bI=bu(bF,bJ,bH.forward,bH.selectedCharacter);var bE=bH.forward?-1:1;aG(bE,bH);if(!bI){return null}bI.ch+=bE;return bI},moveToCharacter:function(bE,bG,bF){var bH=bF.repeat;aG(0,bF);return bu(bE,bH,bF.forward,bF.selectedCharacter)||bG},moveToSymbol:function(bE,bG,bF){var bH=bF.repeat;return bv(bE,bH,bF.forward,bF.selectedCharacter)||bG},moveToColumn:function(bE,bH,bG,bF){var bI=bG.repeat;bF.lastHPos=bI-1;bF.lastHSPos=bE.charCoords(bH,"div").left;return al(bE,bI)},moveToEol:function(bE,bJ,bI,bH){var bK=bJ;bH.lastHPos=Infinity;var bG=d(bK.line+bI.repeat-1,Infinity);var bF=bE.clipPos(bG);bF.ch--;bH.lastHSPos=bE.charCoords(bF,"div").left;return bG},moveToFirstNonWhiteSpaceCharacter:function(bE,bF){var bG=bF;return d(bG.line,a3(bE.getLine(bG.line)))},moveToMatchedSymbol:function(bK,bI){var bL=bI;var bM=bL.line;var bE=bL.ch;var bJ=bK.getLine(bM);var bH;do{bH=bJ.charAt(bE++);if(bH&&P(bH)){var bF=bK.getTokenTypeAt(d(bM,bE));if(bF!=="string"&&bF!=="comment"){break}}}while(bH);if(bH){var bG=bK.findMatchingBracket(d(bM,bE));return bG.to}else{return bL}},moveToStartOfLine:function(bF,bE){return d(bE.line,0)},moveToLineOrEdgeOfDocument:function(bE,bF,bG){var bH=bG.forward?bE.lastLine():bE.firstLine();if(bG.repeatIsExplicit){bH=bG.repeat-bE.getOption("firstLineNumber")}return d(bH,a3(bE.getLine(bH)))},textObjectManipulation:function(bM,bK,bG,bH){var bE={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["};var bN={"'":true,'"':true};var bJ=bG.selectedCharacter;if(bJ=="b"){bJ="("}else{if(bJ=="B"){bJ="{"}}var bL=!bG.textObjectInner;var bI;if(bE[bJ]){bI=o(bM,bK,bJ,bL)}else{if(bN[bJ]){bI=aS(bM,bK,bJ,bL)}else{if(bJ==="W"){bI=aH(bM,bL,true,true)}else{if(bJ==="w"){bI=aH(bM,bL,true,false)}else{if(bJ==="p"){bI=bq(bM,bK,bG.repeat,0,bL);bG.linewise=true;if(bH.visualMode){if(!bH.visualLine){bH.visualLine=true}}else{var bF=bH.inputState.operatorArgs;if(bF){bF.linewise=true}bI.end.line--}}else{return null}}}}}if(!bM.state.vim.visualMode){return[bI.start,bI.end]}else{return v(bM,bI.start,bI.end)}},repeatLastCharacterSearch:function(bG,bJ,bI){var bF=s.lastChararacterSearch;var bL=bI.repeat;var bH=bI.forward===bF.forward;var bE=(bF.increment?1:0)*(bH?-1:1);bG.moveH(-bE,"char");bI.inclusive=bH?true:false;var bK=bu(bG,bL,bH,bF.selectedCharacter);if(!bK){bG.moveH(bE,"char");return bJ}bK.ch+=bE;return bK}};function at(bE,bF){a5[bE]=bF}function A(bH,bG){var bE=[];for(var bF=0;bF<bG;bF++){bE.push(bH)}return bE}var M={change:function(bN,bL,bF){var bK,bO;var bH=bN.state.vim;s.macroModeState.lastInsertModeChanges.inVisualBlock=bH.visualBlock;if(!bH.visualMode){var bI=bF[0].anchor,bM=bF[0].head;bO=bN.getRange(bI,bM);if(!V(bO)){var bJ=(/\s+$/).exec(bO);if(bJ){bM=F(bM,0,-bJ[0].length);bO=bO.slice(0,-bJ[0].length)}}var bE=bM.line-1==bN.lastLine();bN.replaceRange("",bI,bM);if(bL.linewise&&!bE){c.commands.newlineAndIndent(bN);bI.ch=null}bK=bI}else{bO=bN.getSelection();var bG=A("",bF.length);bN.replaceSelections(bG);bK=ay(bF[0].head,bF[0].anchor)}s.registerController.pushText(bL.registerName,"change",bO,bL.linewise,bF.length>1);r.enterInsertMode(bN,{head:bK},bN.state.vim)},"delete":function(bL,bJ,bE){var bI,bM;var bG=bL.state.vim;if(!bG.visualBlock){var bH=bE[0].anchor,bK=bE[0].head;if(bJ.linewise&&bK.line!=bL.firstLine()&&bH.line==bL.lastLine()&&bH.line==bK.line-1){if(bH.line==bL.firstLine()){bH.ch=0}else{bH=d(bH.line-1,aZ(bL,bH.line-1))}}bM=bL.getRange(bH,bK);bL.replaceRange("",bH,bK);bI=bH;if(bJ.linewise){bI=a5.moveToFirstNonWhiteSpaceCharacter(bL,bH)}}else{bM=bL.getSelection();var bF=A("",bE.length);bL.replaceSelections(bF);bI=bE[0].anchor}s.registerController.pushText(bJ.registerName,"delete",bM,bJ.linewise,bG.visualBlock);return ab(bL,bI)},indent:function(bL,bK,bE){var bI=bL.state.vim;var bM=bE[0].anchor.line;var bG=bI.visualBlock?bE[bE.length-1].anchor.line:bE[0].head.line;var bF=(bI.visualMode)?bK.repeat:1;if(bK.linewise){bG--}for(var bJ=bM;bJ<=bG;bJ++){for(var bH=0;bH<bF;bH++){bL.indentLine(bJ,bK.indentRight)}}return a5.moveToFirstNonWhiteSpaceCharacter(bL,bE[0].anchor)},changeCase:function(bP,bO,bE,bL,bI){var bF=bP.getSelections();var bG=[];var bH=bO.toLower;for(var bJ=0;bJ<bF.length;bJ++){var bM=bF[bJ];var bQ="";if(bH===true){bQ=bM.toLowerCase()}else{if(bH===false){bQ=bM.toUpperCase()}else{for(var bK=0;bK<bM.length;bK++){var bN=bM.charAt(bK);bQ+=C(bN)?bN.toLowerCase():bN.toUpperCase()}}}bG.push(bQ)}bP.replaceSelections(bG);if(bO.shouldMoveCursor){return bI}else{if(!bP.state.vim.visualMode&&bO.linewise&&bE[0].anchor.line+1==bE[0].head.line){return a5.moveToFirstNonWhiteSpaceCharacter(bP,bL)}else{if(bO.linewise){return bL}else{return ay(bE[0].anchor,bE[0].head)}}}},yank:function(bE,bJ,bF,bH){var bG=bE.state.vim;var bK=bE.getSelection();var bI=bG.visualMode?ay(bG.sel.anchor,bG.sel.head,bF[0].head,bF[0].anchor):bH;s.registerController.pushText(bJ.registerName,"yank",bK,bJ.linewise,bG.visualBlock);return bI}};function bl(bE,bF){M[bE]=bF}var r={jumpListWalk:function(bE,bG,bH){if(bH.visualMode){return}var bJ=bG.repeat;var bI=bG.forward;var bF=s.jumpList;var bL=bF.move(bE,bI?bJ:-bJ);var bK=bL?bL.find():undefined;bK=bK?bK:bE.getCursor();bE.setCursor(bK)},scroll:function(bM,bG,bI){if(bI.visualMode){return}var bE=bG.repeat||1;var bL=bM.defaultTextHeight();var bK=bM.getScrollInfo().top;var bN=bL*bE;var bJ=bG.forward?bK+bN:bK-bN;var bO=E(bM.getCursor());var bH=bM.charCoords(bO,"local");if(bG.forward){if(bJ>bH.top){bO.line+=(bJ-bH.top)/bL;bO.line=Math.ceil(bO.line);bM.setCursor(bO);bH=bM.charCoords(bO,"local");bM.scrollTo(null,bH.top)}else{bM.scrollTo(null,bJ)}}else{var bF=bJ+bM.getScrollInfo().clientHeight;if(bF<bH.bottom){bO.line-=(bH.bottom-bF)/bL;bO.line=Math.floor(bO.line);bM.setCursor(bO);bH=bM.charCoords(bO,"local");bM.scrollTo(null,bH.bottom-bM.getScrollInfo().clientHeight)}else{bM.scrollTo(null,bJ)}}},scrollToCursor:function(bF,bG){var bJ=bF.getCursor().line;var bH=bF.charCoords(d(bJ,0),"local");var bE=bF.getScrollInfo().clientHeight;var bK=bH.top;var bI=bH.bottom-bK;switch(bG.position){case"center":bK=bK-(bE/2)+bI;break;case"bottom":bK=bK-bE+bI*1.4;break;case"top":bK=bK+bI*0.4;break}bF.scrollTo(null,bK)},replayMacro:function(bE,bF,bG){var bH=bF.selectedCharacter;var bI=bF.repeat;var bJ=s.macroModeState;if(bH=="@"){bH=bJ.latestRegister}while(bI--){J(bE,bG,bJ,bH)}},enterMacroRecordMode:function(bE,bF){var bH=s.macroModeState;var bG=bF.selectedCharacter;bH.enterMacroRecordMode(bE,bG)},enterInsertMode:function(bF,bG,bH){if(bF.getOption("readOnly")){return}bH.insertMode=true;bH.insertModeRepeat=bG&&bG.repeat||1;var bJ=(bG)?bG.insertAt:null;var bK=bH.sel;var bI=bG.head||bF.getCursor("head");var bE=bF.listSelections().length;if(bJ=="eol"){bI=d(bI.line,aZ(bF,bI.line))}else{if(bJ=="charAfter"){bI=F(bI,0,1)}else{if(bJ=="firstNonBlank"){bI=a5.moveToFirstNonWhiteSpaceCharacter(bF,bI)}else{if(bJ=="startOfSelectedArea"){if(!bH.visualBlock){if(bK.head.line<bK.anchor.line){bI=bK.head}else{bI=d(bK.anchor.line,0)}}else{bI=d(Math.min(bK.head.line,bK.anchor.line),Math.min(bK.head.ch,bK.anchor.ch));bE=Math.abs(bK.head.line-bK.anchor.line)+1}}else{if(bJ=="endOfSelectedArea"){if(!bH.visualBlock){if(bK.head.line>=bK.anchor.line){bI=F(bK.head,0,1)}else{bI=d(bK.anchor.line,0)}}else{bI=d(Math.min(bK.head.line,bK.anchor.line),Math.max(bK.head.ch+1,bK.anchor.ch));bE=Math.abs(bK.head.line-bK.anchor.line)+1}}else{if(bJ=="inplace"){if(bH.visualMode){return}}}}}}}bF.setOption("keyMap","vim-insert");bF.setOption("disableInput",false);if(bG&&bG.replace){bF.toggleOverwrite(true);bF.setOption("keyMap","vim-replace");c.signal(bF,"vim-mode-change",{mode:"replace"})}else{bF.setOption("keyMap","vim-insert");c.signal(bF,"vim-mode-change",{mode:"insert"})}if(!s.macroModeState.isPlaying){bF.on("change",bk);c.on(bF.getInputField(),"keydown",Y)}if(bH.visualMode){aV(bF)}aW(bF,bI,bE)},toggleVisualMode:function(bE,bF,bG){var bJ=bF.repeat;var bH=bE.getCursor();var bI;if(!bG.visualMode){bG.visualMode=true;bG.visualLine=!!bF.linewise;bG.visualBlock=!!bF.blockwise;bI=ab(bE,d(bH.line,bH.ch+bJ-1),true);bG.sel={anchor:bH,head:bI};c.signal(bE,"vim-mode-change",{mode:"visual",subMode:bG.visualLine?"linewise":bG.visualBlock?"blockwise":""});O(bE);aT(bE,bG,"<",ay(bH,bI));aT(bE,bG,">",bc(bH,bI))}else{if(bG.visualLine^bF.linewise||bG.visualBlock^bF.blockwise){bG.visualLine=!!bF.linewise;bG.visualBlock=!!bF.blockwise;c.signal(bE,"vim-mode-change",{mode:"visual",subMode:bG.visualLine?"linewise":bG.visualBlock?"blockwise":""});O(bE)}else{aV(bE)}}},reselectLastSelection:function(bE,bJ,bG){var bF=bG.lastSelection;if(bG.visualMode){bj(bE,bG)}if(bF){var bH=bF.anchorMark.find();var bI=bF.headMark.find();if(!bH||!bI){return}bG.sel={anchor:bH,head:bI};bG.visualMode=true;bG.visualLine=bF.visualLine;bG.visualBlock=bF.visualBlock;O(bE);aT(bE,bG,"<",ay(bH,bI));aT(bE,bG,">",bc(bH,bI));c.signal(bE,"vim-mode-change",{mode:"visual",subMode:bG.visualLine?"linewise":bG.visualBlock?"blockwise":""})}},joinLines:function(bL,bF,bH){var bK,bN;if(bH.visualMode){bK=bL.getCursor("anchor");bN=bL.getCursor("head");if(aQ(bN,bK)){var bJ=bN;bN=bK;bK=bJ}bN.ch=aZ(bL,bN.line)-1}else{var bE=Math.max(bF.repeat,2);bK=bL.getCursor();bN=ab(bL,d(bK.line+bE-1,Infinity))}var bG=0;for(var bI=bK.line;bI<bN.line;bI++){bG=aZ(bL,bK.line);var bJ=d(bK.line+1,aZ(bL,bK.line+1));var bO=bL.getRange(bK,bJ);bO=bO.replace(/\n\s*/g," ");bL.replaceRange(bO,bK,bJ)}var bM=d(bK.line,bG);if(bH.visualMode){aV(bL,false)}bL.setCursor(bM)},newLineAndEnterInsertMode:function(bE,bF,bG){bG.insertMode=true;var bH=E(bE.getCursor());if(bH.line===bE.firstLine()&&!bF.after){bE.replaceRange("\n",d(bE.firstLine(),0));bE.setCursor(bE.firstLine(),0)}else{bH.line=(bF.after)?bH.line:bH.line-1;bH.ch=aZ(bE,bH.line);bE.setCursor(bH);var bI=c.commands.newlineAndIndentContinueComment||c.commands.newlineAndIndent;bI(bE)}this.enterInsertMode(bE,{repeat:bF.repeat},bG)},paste:function(bS,bR,b0){var bL=E(bS.getCursor());var bF=s.registerController.getRegister(bR.registerName);var bV=bF.toString();if(!bV){return}if(bR.matchIndent){var bX=bS.getOption("tabSize");var bM=function(b7){var b6=(b7.split("\t").length-1);var b5=(b7.split(" ").length-1);return b6*bX+b5*1};var b2=bS.getLine(bS.getCursor().line);var bU=bM(b2.match(/^\s*/)[0]);var bE=bV.replace(/\n$/,"");var bJ=bV!==bE;var bP=bM(bV.match(/^\s*/)[0]);var bV=bE.replace(/^\s*/gm,function(b5){var b6=bU+(bM(b5)-bP);if(b6<0){return""}else{if(bS.getOption("indentWithTabs")){var b7=Math.floor(b6/bX);return Array(b7+1).join("\t")}else{return Array(b6+1).join(" ")}}});bV+=bJ?"\n":""}if(bR.repeat>1){var bV=Array(bR.repeat+1).join(bV)}var bO=bF.linewise;var bQ=bF.blockwise;if(bO){if(b0.visualMode){bV=b0.visualLine?bV.slice(0,-1):"\n"+bV.slice(0,bV.length-1)+"\n"}else{if(bR.after){bV="\n"+bV.slice(0,bV.length-1);bL.ch=aZ(bS,bL.line)}else{bL.ch=0}}}else{if(bQ){bV=bV.split("\n");for(var b1=0;b1<bV.length;b1++){bV[b1]=(bV[b1]=="")?" ":bV[b1]}}bL.ch+=bR.after?1:0}var bI;var bW;if(b0.visualMode){b0.lastPastedText=bV;var bH;var b4=a9(bS,b0);var bY=b4[0];var bG=b4[1];var bZ=bS.getSelection();var bN=bS.listSelections();var bK=new Array(bN.length).join("1").split("1");if(b0.lastSelection){bH=b0.lastSelection.headMark.find()}s.registerController.unnamedRegister.setText(bZ);if(bQ){bS.replaceSelections(bK);bG=d(bY.line+bV.length-1,bY.ch);bS.setCursor(bY);H(bS,bG);bS.replaceSelections(bV);bI=bY}else{if(b0.visualBlock){bS.replaceSelections(bK);bS.setCursor(bY);bS.replaceRange(bV,bY,bY);bI=bY}else{bS.replaceRange(bV,bY,bG);bI=bS.posFromIndex(bS.indexFromPos(bY)+bV.length-1)}}if(bH){b0.lastSelection.headMark=bS.setBookmark(bH)}if(bO){bI.ch=0}}else{if(bQ){bS.setCursor(bL);for(var b1=0;b1<bV.length;b1++){var bT=bL.line+b1;if(bT>bS.lastLine()){bS.replaceRange("\n",d(bT,0))}var b3=aZ(bS,bT);if(b3<bL.ch){a0(bS,bT,bL.ch)}}bS.setCursor(bL);H(bS,d(bL.line+bV.length-1,bL.ch));bS.replaceSelections(bV);bI=bL}else{bS.replaceRange(bV,bL);if(bO&&bR.after){bI=d(bL.line+1,a3(bS.getLine(bL.line+1)))}else{if(bO&&!bR.after){bI=d(bL.line,a3(bS.getLine(bL.line)))}else{if(!bO&&bR.after){bW=bS.indexFromPos(bL);bI=bS.posFromIndex(bW+bV.length-1)}else{bW=bS.indexFromPos(bL);bI=bS.posFromIndex(bW+bV.length)}}}}}if(b0.visualMode){aV(bS,false)}bS.setCursor(bI)},undo:function(bE,bF){bE.operation(function(){az(bE,c.commands.undo,bF.repeat)();bE.setCursor(bE.getCursor("anchor"))})},redo:function(bE,bF){az(bE,c.commands.redo,bF.repeat)()},setRegister:function(bG,bE,bF){bF.inputState.registerName=bE.selectedCharacter},setMark:function(bE,bF,bG){var bH=bF.selectedCharacter;aT(bE,bG,bH,bE.getCursor())},replace:function(bM,bG,bI){var bH=bG.selectedCharacter;var bL=bM.getCursor();var bK;var bN;var bF=bM.listSelections();if(bI.visualMode){bL=bM.getCursor("start");bN=bM.getCursor("end")}else{var bO=bM.getLine(bL.line);bK=bL.ch+bG.repeat;if(bK>bO.length){bK=bO.length}bN=d(bL.line,bK)}if(bH=="\n"){if(!bI.visualMode){bM.replaceRange("",bL,bN)}(c.commands.newlineAndIndentContinueComment||c.commands.newlineAndIndent)(bM)}else{var bE=bM.getRange(bL,bN);bE=bE.replace(/[^\n]/g,bH);if(bI.visualBlock){var bJ=new Array(bM.getOption("tabSize")+1).join(" ");bE=bM.getSelection();bE=bE.replace(/\t/g,bJ).replace(/[^\n]/g,bH).split("\n");bM.replaceSelections(bE)}else{bM.replaceRange(bE,bL,bN)}if(bI.visualMode){bL=aQ(bF[0].anchor,bF[0].head)?bF[0].anchor:bF[0].head;bM.setCursor(bL);aV(bM,false)}else{bM.setCursor(F(bN,0,-1))}}},incrementNumberToken:function(bO,bF){var bP=bO.getCursor();var bK=bO.getLine(bP.line);var bR=/-?\d+/g;var bJ;var bE;var bI;var bQ;var bG;while((bJ=bR.exec(bK))!==null){bG=bJ[0];bE=bJ.index;bI=bE+bG.length;if(bP.ch<bI){break}}if(!bF.backtrack&&(bI<=bP.ch)){return}if(bG){var bN=bF.increase?1:-1;var bH=parseInt(bG)+(bN*bF.repeat);var bM=d(bP.line,bE);var bL=d(bP.line,bI);bQ=bH.toString();bO.replaceRange(bQ,bM,bL)}else{return}bO.setCursor(d(bP.line,bE+bQ.length-1))},repeatLastEdit:function(bF,bG,bH){var bE=bH.lastEditInputState;if(!bE){return}var bI=bG.repeat;if(bI&&bG.repeatIsExplicit){bH.lastEditInputState.repeatOverride=bI}else{bI=bH.lastEditInputState.repeatOverride||bI}z(bF,bH,bI,false)},exitInsertMode:x};function bs(bE,bF){r[bE]=bF}function ab(bF,bJ,bH){var bG=Math.min(Math.max(bF.firstLine(),bJ.line),bF.lastLine());var bE=aZ(bF,bG)-1;bE=(bH)?bE+1:bE;var bI=Math.min(Math.max(0,bJ.ch),bE);return d(bG,bI)}function bm(bF){var bE={};for(var bG in bF){if(bF.hasOwnProperty(bG)){bE[bG]=bF[bG]}}return bE}function F(bF,bE,bG){if(typeof bE==="object"){bG=bE.ch;bE=bE.line}return d(bF.line+bE,bF.ch+bG)}function bh(bE,bF){return{line:bF.line-bE.line,ch:bF.line-bE.line}}function bo(bM,bK,bE,bI){var bH,bL=[],bJ=[];for(var bG=0;bG<bK.length;bG++){var bF=bK[bG];if(bE=="insert"&&bF.context!="insert"||bF.context&&bF.context!=bE||bI.operator&&bF.type=="action"||!(bH=T(bM,bF.keys))){continue}if(bH=="partial"){bL.push(bF)}if(bH=="full"){bJ.push(bF)}}return{partial:bL.length&&bL,full:bJ.length&&bJ}}function T(bH,bE){if(bE.slice(-11)=="<character>"){var bF=bE.length-11;var bI=bH.slice(0,bF);var bG=bE.slice(0,bF);return bI==bG&&bH.length>bF?"full":bG.indexOf(bI)==0?"partial":false}else{return bH==bE?"full":bE.indexOf(bH)==0?"partial":false}}function S(bG){var bF=/^.*(<[\w\-]+>)$/.exec(bG);var bE=bF?bF[1]:bG.slice(-1);if(bE.length>1){switch(bE){case"<CR>":bE="\n";break;case"<Space>":bE=" ";break;default:break}}return bE}function az(bE,bF,bG){return function(){for(var bH=0;bH<bG;bH++){bF(bE)}}}function E(bE){return d(bE.line,bE.ch)}function bB(bF,bE){return bF.ch==bE.ch&&bF.line==bE.line}function aQ(bF,bE){if(bF.line<bE.line){return true}if(bF.line==bE.line&&bF.ch<bE.ch){return true}return false}function ay(bF,bE){if(arguments.length>2){bE=ay.apply(undefined,Array.prototype.slice.call(arguments,1))}return aQ(bF,bE)?bF:bE}function bc(bF,bE){if(arguments.length>2){bE=bc.apply(undefined,Array.prototype.slice.call(arguments,1))}return aQ(bF,bE)?bE:bF}function ax(bH,bG,bF){var bI=aQ(bH,bG);var bE=aQ(bG,bF);return bI&&bE}function aZ(bE,bF){return bE.getLine(bF).length}function bb(bE){if(bE.trim){return bE.trim()}return bE.replace(/^\s+|\s+$/g,"")}function h(bE){return bE.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function a0(bE,bI,bH){var bG=aZ(bE,bI);var bF=new Array(bH-bG+1).join(" ");bE.setCursor(d(bI,bG));bE.replaceRange(bF,bE.getCursor())}function H(bM,bF){var bH=[],bG=bM.listSelections();var bI=E(bM.clipPos(bF));var bX=!bB(bF,bI);var bK=bM.getCursor("head");var bW=w(bG,bK);var bN=bB(bG[bW].head,bG[bW].anchor);var bV=bG.length-1;var bL=bV-bW>bW?bV:0;var bJ=bG[bL].anchor;var bS=Math.min(bJ.line,bI.line);var bE=Math.max(bJ.line,bI.line);var bO=bJ.ch,bP=bI.ch;var bU=bG[bL].head.ch-bO;var bR=bP-bO;if(bU>0&&bR<=0){bO++;if(!bX){bP--}}else{if(bU<0&&bR>=0){bO--;if(!bN){bP++}}else{if(bU<0&&bR==-1){bO--;bP++}}}for(var bQ=bS;bQ<=bE;bQ++){var bT={anchor:new d(bQ,bO),head:new d(bQ,bP)};bH.push(bT)}bW=bI.line==bE?bH.length-1:0;bM.setSelections(bH);bF.ch=bP;bJ.ch=bO;return bJ}function aW(bF,bH,bE){var bJ=[];for(var bG=0;bG<bE;bG++){var bI=F(bH,bG,0);bJ.push({anchor:bI,head:bI})}bF.setSelections(bJ,0)}function w(bF,bJ,bE){for(var bG=0;bG<bF.length;bG++){var bH=bE!="head"&&bB(bF[bG].anchor,bJ);var bI=bE!="anchor"&&bB(bF[bG].head,bJ);if(bH||bI){return bG}}return -1}function a9(bF,bH){var bG=bH.lastSelection;var bE=function(){var bK=bF.listSelections();var bN=bK[0];var bJ=bK[bK.length-1];var bL=aQ(bN.anchor,bN.head)?bN.anchor:bN.head;var bM=aQ(bJ.anchor,bJ.head)?bJ.head:bJ.anchor;return[bL,bM]};var bI=function(){var bT=bF.getCursor();var bU=bF.getCursor();var bO=bG.visualBlock;if(bO){var bL=bO.width;var bV=bO.height;bU=d(bT.line+bV,bT.ch+bL);var bM=[];for(var bP=bT.line;bP<bU.line;bP++){var bQ=d(bP,bT.ch);var bS=d(bP,bU.ch);var bR={anchor:bQ,head:bS};bM.push(bR)}bF.setSelections(bM)}else{var bK=bG.anchorMark.find();var bN=bG.headMark.find();var bW=bN.line-bK.line;var bJ=bN.ch-bK.ch;bU={line:bU.line+bW,ch:bW?bU.ch:bJ+bU.ch};if(bG.visualLine){bT=d(bT.line,0);bU=d(bU.line,aZ(bF,bU.line))}bF.setSelection(bT,bU)}return[bT,bU]};if(!bH.visualMode){return bI()}else{return bE()}}function bj(bE,bF){var bG=bF.sel.anchor;var bH=bF.sel.head;if(bF.lastPastedText){bH=bE.posFromIndex(bE.indexFromPos(bG)+bF.lastPastedText.length);bF.lastPastedText=null}bF.lastSelection={anchorMark:bE.setBookmark(bG),headMark:bE.setBookmark(bH),anchor:E(bG),head:E(bH),visualMode:bF.visualMode,visualLine:bF.visualLine,visualBlock:bF.visualBlock}}function v(bE,bK,bF){var bJ=bE.state.vim.sel;var bI=bJ.head;var bG=bJ.anchor;var bH;if(aQ(bF,bK)){bH=bF;bF=bK;bK=bH}if(aQ(bI,bG)){bI=ay(bK,bI);bG=bc(bG,bF)}else{bG=ay(bK,bG);bI=bc(bI,bF);bI=F(bI,0,-1);if(bI.ch==-1&&bI.line!=bE.firstLine()){bI=d(bI.line-1,aZ(bE,bI.line-1))}}return[bG,bI]}function O(bE,bH,bI){var bF=bE.state.vim;bH=bH||bF.sel;var bI=bI||bF.visualLine?"line":bF.visualBlock?"block":"char";var bG=bD(bE,bH,bI);bE.setSelections(bG.ranges,bG.primary);ae(bE)}function bD(bS,bH,bN,bG){var bP=E(bH.head);var bM=E(bH.anchor);if(bN=="char"){var bQ=!bG&&!aQ(bH.head,bH.anchor)?1:0;var bI=aQ(bH.head,bH.anchor)?1:0;bP=F(bH.head,0,bQ);bM=F(bH.anchor,0,bI);return{ranges:[{anchor:bM,head:bP}],primary:0}}else{if(bN=="line"){if(!aQ(bH.head,bH.anchor)){bM.ch=0;var bR=bS.lastLine();if(bP.line>bR){bP.line=bR}bP.ch=aZ(bS,bP.line)}else{bP.ch=0;bM.ch=aZ(bS,bM.line)}return{ranges:[{anchor:bM,head:bP}],primary:0}}else{if(bN=="block"){var bO=Math.min(bM.line,bP.line),bK=Math.min(bM.ch,bP.ch),bE=Math.max(bM.line,bP.line),bT=Math.max(bM.ch,bP.ch)+1;var bU=bE-bO+1;var bJ=bP.line==bO?0:bU-1;var bF=[];for(var bL=0;bL<bU;bL++){bF.push({anchor:d(bO+bL,bK),head:d(bO+bL,bT)})}return{ranges:bF,primary:bJ}}}}}function f(bE){var bF=bE.getCursor("head");if(bE.getSelection().length==1){bF=ay(bF,bE.getCursor("anchor"))}return bF}function aV(bE,bG){var bF=bE.state.vim;if(bG!==false){bE.setCursor(ab(bE,bF.sel.head))}bj(bE,bF);bF.visualMode=false;bF.visualLine=false;bF.visualBlock=false;c.signal(bE,"vim-mode-change",{mode:"normal"});if(bF.fakeCursor){bF.fakeCursor.clear()}}function an(bF,bE,bJ){var bI=bF.getRange(bE,bJ);if(/\n\s*$/.test(bI)){var bH=bI.split("\n");bH.pop();var bG;for(var bG=bH.pop();bH.length>0&&bG&&V(bG);bG=bH.pop()){bJ.line--;bJ.ch=0}if(bG){bJ.line--;bJ.ch=aZ(bF,bJ.line)}else{bJ.ch=0}}}function bg(bF,bE,bG){bE.ch=0;bG.ch=0;bG.line++}function a3(bF){if(!bF){return 0}var bE=bF.search(/\S/);return bE==-1?bF.length:bE}function aH(bK,bJ,bG,bI,bP){var bM=f(bK);var bQ=bK.getLine(bM.line);var bL=bM.ch;var bH=bP?aq[0]:by[0];while(!bH(bQ.charAt(bL))){bL++;if(bL>=bQ.length){return null}}if(bI){bH=by[0]}else{bH=aq[0];if(!bH(bQ.charAt(bL))){bH=aq[1]}}var bF=bL,bE=bL;while(bH(bQ.charAt(bF))&&bF<bQ.length){bF++}while(bH(bQ.charAt(bE))&&bE>=0){bE--}bE++;if(bJ){var bN=bF;while(/\s/.test(bQ.charAt(bF))&&bF<bQ.length){bF++}if(bN==bF){var bO=bE;while(/\s/.test(bQ.charAt(bE-1))&&bE>0){bE--}if(!bE){bE=bO}}}return{start:d(bM.line,bE),end:d(bM.line,bF)}}function bi(bE,bF,bG){if(!bB(bF,bG)){s.jumpList.add(bE,bF,bG)}}function aG(bE,bF){s.lastChararacterSearch.increment=bE;s.lastChararacterSearch.forward=bF.forward;s.lastChararacterSearch.selectedCharacter=bF.selectedCharacter}var U={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"};var a1={bracket:{isComplete:function(bE){if(bE.nextCh===bE.symb){bE.depth++;if(bE.depth>=1){return true}}else{if(bE.nextCh===bE.reverseSymb){bE.depth--}}return false}},section:{init:function(bE){bE.curMoveThrough=true;bE.symb=(bE.forward?"]":"[")===bE.symb?"{":"}"},isComplete:function(bE){return bE.index===0&&bE.nextCh===bE.symb}},comment:{isComplete:function(bF){var bE=bF.lastCh==="*"&&bF.nextCh==="/";bF.lastCh=bF.nextCh;return bE}},method:{init:function(bE){bE.symb=(bE.symb==="m"?"{":"}");bE.reverseSymb=bE.symb==="{"?"}":"{"},isComplete:function(bE){if(bE.nextCh===bE.symb){return true}return false}},preprocess:{init:function(bE){bE.index=0},isComplete:function(bF){if(bF.nextCh==="#"){var bE=bF.lineText.match(/#(\w+)/)[1];if(bE==="endif"){if(bF.forward&&bF.depth===0){return true}bF.depth++}else{if(bE==="if"){if(!bF.forward&&bF.depth===0){return true}bF.depth--}}if(bE==="else"&&bF.depth===0){return true}}return false}}};function bv(bN,bF,bI,bG){var bQ=E(bN.getCursor());var bO=bI?1:-1;var bH=bI?bN.lineCount():-1;var bM=bQ.ch;var bS=bQ.line;var bL=bN.getLine(bS);var bE={lineText:bL,nextCh:bL.charAt(bM),lastCh:null,index:bM,symb:bG,reverseSymb:(bI?{")":"(","}":"{"}:{"(":")","{":"}"})[bG],forward:bI,depth:0,curMoveThrough:false};var bJ=U[bG];if(!bJ){return bQ}var bR=a1[bJ].init;var bP=a1[bJ].isComplete;if(bR){bR(bE)}while(bS!==bH&&bF){bE.index+=bO;bE.nextCh=bE.lineText.charAt(bE.index);if(!bE.nextCh){bS+=bO;bE.lineText=bN.getLine(bS)||"";if(bO>0){bE.index=0}else{var bK=bE.lineText.length;bE.index=(bK>0)?(bK-1):0}bE.nextCh=bE.lineText.charAt(bE.index)}if(bP(bE)){bQ.line=bS;bQ.ch=bE.index;bF--}}if(bE.nextCh||bE.curMoveThrough){return d(bS,bE.index)}return bQ}function bx(bO,bP,bH,bM,bN){var bI=bP.line;var bL=bP.ch;var bS=bO.getLine(bI);var bF=bH?1:-1;var bJ=bM?by:aq;if(bN&&bS==""){bI+=bF;bS=bO.getLine(bI);if(!g(bO,bI)){return null}bL=(bH)?0:bS.length}while(true){if(bN&&bS==""){return{from:0,to:0,line:bI}}var bK=(bF>0)?bS.length:-1;var bR=bK,bQ=bK;while(bL!=bK){var bE=false;for(var bG=0;bG<bJ.length&&!bE;++bG){if(bJ[bG](bS.charAt(bL))){bR=bL;while(bL!=bK&&bJ[bG](bS.charAt(bL))){bL+=bF}bQ=bL;bE=bR!=bQ;if(bR==bP.ch&&bI==bP.line&&bQ==bR+bF){continue}else{return{from:Math.min(bR,bQ+1),to:Math.max(bR,bQ),line:bI}}}}if(!bE){bL+=bF}}bI+=bF;if(!g(bO,bI)){return null}bS=bO.getLine(bI);bL=(bF>0)?0:bS.length}throw new Error("The impossible happened.")}function aF(bO,bQ,bF,bJ,bS,bM){var bK=E(bQ);var bL=[];if(bJ&&!bS||!bJ&&bS){bF++}var bN=!(bJ&&bS);for(var bH=0;bH<bF;bH++){var bE=bx(bO,bQ,bJ,bM,bN);if(!bE){var bG=aZ(bO,bO.lastLine());bL.push(bJ?{line:bO.lastLine(),from:bG,to:bG}:{line:0,from:0,to:0});break}bL.push(bE);bQ=d(bE.line,bJ?(bE.to-1):bE.from)}var bI=bL.length!=bF;var bP=bL[0];var bR=bL.pop();if(bJ&&!bS){if(!bI&&(bP.from!=bK.ch||bP.line!=bK.line)){bR=bL.pop()}return d(bR.line,bR.from)}else{if(bJ&&bS){return d(bR.line,bR.to-1)}else{if(!bJ&&bS){if(!bI&&(bP.to!=bK.ch||bP.line!=bK.line)){bR=bL.pop()}return d(bR.line,bR.to)}else{return d(bR.line,bR.from)}}}}function bu(bJ,bF,bH,bI){var bL=bJ.getCursor();var bE=bL.ch;var bK;for(var bG=0;bG<bF;bG++){var bM=bJ.getLine(bL.line);bK=bd(bE,bM,bI,bH,true);if(bK==-1){return null}bE=bK}return d(bJ.getCursor().line,bK)}function al(bE,bG){var bF=bE.getCursor().line;return ab(bE,d(bF,bG-1))}function aT(bE,bF,bG,bH){if(!L(bG,aI)){return}if(bF.marks[bG]){bF.marks[bG].clear()}bF.marks[bG]=bE.setBookmark(bH)}function bd(bJ,bF,bI,bG,bH){var bE;if(bG){bE=bF.indexOf(bI,bJ+1);if(bE!=-1&&!bH){bE-=1}}else{bE=bF.lastIndexOf(bI,bJ-1);if(bE!=-1&&!bH){bE+=1}}return bE}function bq(bS,bP,bF,bG,bR){var bT=bP.line;var bK=bS.firstLine();var bQ=bS.lastLine();var bE,bH,bN=bT;function bM(bU){return !bS.getLine(bU)}function bO(bV,bU,bW){if(bW){return bM(bV)!=bM(bV+bU)}return !bM(bV)&&bM(bV+bU)}if(bG){while(bK<=bN&&bN<=bQ&&bF>0){if(bO(bN,bG)){bF--}bN+=bG}return new d(bN,0)}var bJ=bS.state.vim;if(bJ.visualLine&&bO(bT,1,true)){var bL=bJ.sel.anchor;if(bO(bL.line,-1,true)){if(!bR||bL.line!=bT){bT+=1}}}var bI=bM(bT);for(bN=bT;bN<=bQ&&bF;bN++){if(bO(bN,1,true)){if(!bR||bM(bN)!=bI){bF--}}}bH=new d(bN,0);if(bN>bQ&&!bI){bI=true}else{bR=false}for(bN=bT;bN>bK;bN--){if(!bR||bM(bN)==bI||bN==bT){if(bO(bN,-1,true)){break}}}bE=new d(bN,0);return{start:bE,end:bH}}function o(bO,bM,bG,bN){var bP=bM,bF,bI;var bL=({"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/})[bG];var bH=({"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"})[bG];var bE=bO.getLine(bP.line).charAt(bP.ch);var bJ=bE===bH?1:0;bF=bO.scanForBracket(d(bP.line,bP.ch+bJ),-1,null,{bracketRegex:bL});bI=bO.scanForBracket(d(bP.line,bP.ch+bJ),1,null,{bracketRegex:bL});if(!bF||!bI){return{start:bP,end:bP}}bF=bF.pos;bI=bI.pos;if((bF.line==bI.line&&bF.ch>bI.ch)||(bF.line>bI.line)){var bK=bF;bF=bI;bI=bK}if(bN){bI.ch+=1}else{bF.ch+=1}return{start:bF,end:bI}}function aS(bN,bL,bG,bM){var bO=E(bL);var bP=bN.getLine(bO.line);var bK=bP.split("");var bF,bH,bI,bJ;var bE=bK.indexOf(bG);if(bO.ch<bE){bO.ch=bE}else{if(bE<bO.ch&&bK[bO.ch]==bG){bH=bO.ch;--bO.ch}}if(bK[bO.ch]==bG&&!bH){bF=bO.ch+1}else{for(bI=bO.ch;bI>-1&&!bF;bI--){if(bK[bI]==bG){bF=bI+1}}}if(bF&&!bH){for(bI=bF,bJ=bK.length;bI<bJ&&!bH;bI++){if(bK[bI]==bG){bH=bI}}}if(!bF||!bH){return{start:bO,end:bO}}if(bM){--bF;++bH}return{start:d(bO.line,bF),end:d(bO.line,bH)}}aN("pcre",true,"boolean");function af(){}af.prototype={getQuery:function(){return s.query},setQuery:function(bE){s.query=bE},getOverlay:function(){return this.searchOverlay},setOverlay:function(bE){this.searchOverlay=bE},isReversed:function(){return s.isReversed},setReversed:function(bE){s.isReversed=bE},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(bE){this.annotate=bE}};function aK(bE){var bF=bE.state.vim;return bF.searchState_||(bF.searchState_=new af())}function ad(bE,bH,bI,bF,bG){if(bE.openDialog){bE.openDialog(bH,bF,{bottom:true,value:bG.value,onKeyDown:bG.onKeyDown,onKeyUp:bG.onKeyUp,selectValueOnOpen:false})}else{bF(prompt(bI,""))}}function y(bG){var bF=am(bG)||[];if(!bF.length){return[]}var bH=[];if(bF[0]!==0){return}for(var bE=0;bE<bF.length;bE++){if(typeof bF[bE]=="number"){bH.push(bG.substring(bF[bE]+1,bF[bE+1]))}}return bH}function am(bH){var bF=false;var bG=[];for(var bE=0;bE<bH.length;bE++){var bI=bH.charAt(bE);if(!bF&&bI=="/"){bG.push(bE)}bF=!bF&&(bI=="\\")}return bG}function bt(bL){var bM="|(){";var bI="}";var bJ=false;var bF=[];for(var bG=-1;bG<bL.length;bG++){var bK=bL.charAt(bG)||"";var bE=bL.charAt(bG+1)||"";var bH=(bE&&bM.indexOf(bE)!=-1);if(bJ){if(bK!=="\\"||!bH){bF.push(bK)}bJ=false}else{if(bK==="\\"){bJ=true;if(bE&&bI.indexOf(bE)!=-1){bH=true}if(!bH||bE==="\\"){bF.push(bK)}}else{bF.push(bK);if(bH&&bE!=="\\"){bF.push("\\")}}}}return bF.join("")}function bw(bH){var bG=false;var bE=[];for(var bF=-1;bF<bH.length;bF++){var bJ=bH.charAt(bF)||"";var bI=bH.charAt(bF+1)||"";if(bG){bE.push(bJ);bG=false}else{if(bJ==="\\"){bG=true;if((ai(bI)||bI==="$")){bE.push("$")}else{if(bI!=="/"&&bI!=="\\"){bE.push("\\")}}}else{if(bJ==="$"){bE.push("$")}bE.push(bJ);if(bI==="/"){bE.push("\\")}}}}return bE.join("")}function ah(bG){var bF=new c.StringStream(bG);var bE=[];while(!bF.eol()){while(bF.peek()&&bF.peek()!="\\"){bE.push(bF.next())}if(bF.match("\\/",true)){bE.push("/")}else{if(bF.match("\\\\",true)){bE.push("\\")}else{bE.push(bF.next())}}}return bE.join("")}function aC(bI,bG,bL){var bK=s.registerController.getRegister("/");bK.setText(bI);if(bI instanceof RegExp){return bI}var bJ=am(bI);var bM;var bF;if(!bJ.length){bM=bI}else{bM=bI.substring(0,bJ[0]);var bE=bI.substring(bJ[0]);bF=(bE.indexOf("i")!=-1)}if(!bM){return null}if(!p("pcre")){bM=bt(bM)}if(bL){bG=(/^[^A-Z]*$/).test(bM)}var bH=new RegExp(bM,(bG||bF)?"i":undefined);return bH}function bp(bE,bF){if(bE.openNotification){bE.openNotification('<span style="color: red">'+bF+"</span>",{bottom:true,duration:5000})}else{alert(bF)}}function aJ(bF,bG){var bE="";if(bF){bE+='<span style="font-family: monospace">'+bF+"</span>"}bE+='<input type="text"/> <span style="color: #888">';if(bG){bE+='<span style="color: #888">';bE+=bG;bE+="</span>"}return bE}var R="(Javascript regexp)";function a4(bF,bG){var bH=(bG.prefix||"")+" "+(bG.desc||"");var bE=aJ(bG.prefix,bG.desc);ad(bF,bE,bH,bG.onClose,bG)}function Z(bF,bE){if(bF instanceof RegExp&&bE instanceof RegExp){var bH=["global","multiline","ignoreCase","source"];for(var bG=0;bG<bH.length;bG++){var bI=bH[bG];if(bF[bI]!==bE[bI]){return false}}return true}return false}function bA(bE,bJ,bF,bG){if(!bJ){return}var bI=aK(bE);var bH=aC(bJ,!!bF,!!bG);if(!bH){return}aM(bE,bH);if(Z(bH,bI.getQuery())){return bH}bI.setQuery(bH);return bH}function aP(bF){if(bF.source.charAt(0)=="^"){var bE=true}return{token:function(bH){if(bE&&!bH.sol()){bH.skipToEnd();return}var bG=bH.match(bF,false);if(bG){if(bG[0].length==0){bH.next();return"searching"}if(!bH.sol()){bH.backUp(1);if(!bF.exec(bH.next()+bG[0])){bH.next();return null}}bH.match(bF);return"searching"}while(!bH.eol()){bH.next();if(bH.match(bF,false)){break}}},query:bF}}function aM(bE,bH){var bG=aK(bE);var bF=bG.getOverlay();if(!bF||bH!=bF.query){if(bF){bE.removeOverlay(bF)}bF=aP(bH);bE.addOverlay(bF);if(bE.showMatchesOnScrollbar){if(bG.getScrollbarAnnotate()){bG.getScrollbarAnnotate().clear()}bG.setScrollbarAnnotate(bE.showMatchesOnScrollbar(bH))}bG.setOverlay(bF)}}function bC(bE,bF,bH,bG){if(bG===undefined){bG=1}return bE.operation(function(){var bL=bE.getCursor();var bK=bE.getSearchCursor(bH,bL);for(var bI=0;bI<bG;bI++){var bJ=bK.find(bF);if(bI==0&&bJ&&bB(bK.from(),bL)){bJ=bK.find(bF)}if(!bJ){bK=bE.getSearchCursor(bH,(bF)?d(bE.lastLine()):d(bE.firstLine(),0));if(!bK.find(bF)){return}}}return bK.from()})}function aO(bE){var bF=aK(bE);bE.removeOverlay(aK(bE).getOverlay());bF.setOverlay(null);if(bF.getScrollbarAnnotate()){bF.getScrollbarAnnotate().clear();bF.setScrollbarAnnotate(null)}}function ag(bG,bF,bE){if(typeof bG!="number"){bG=bG.line}if(bF instanceof Array){return L(bG,bF)}else{if(bE){return(bG>=bF&&bG<=bE)}else{return bG==bF}}}function bf(bE){var bH=bE.getScrollInfo();var bG=6;var bK=10;var bJ=bE.coordsChar({left:0,top:bG+bH.top},"local");var bF=bH.clientHeight-bK+bH.top;var bI=bE.coordsChar({left:0,top:bF},"local");return{top:bJ.line,bottom:bI.line}}var D=[{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"set"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:true},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:true},{name:"global",shortName:"g"}];var aa=function(){this.buildCommandMap_()};aa.prototype={processCommand:function(bE,bF,bH){var bG=this;bE.operation(function(){bE.curOp.isVimOp=true;bG._processCommand(bE,bF,bH)})},_processCommand:function(bP,bO,bF){var bJ=bP.state.vim;var bG=s.registerController.getRegister(":");var bM=bG.toString();if(bJ.visualMode){aV(bP)}var bE=new c.StringStream(bO);bG.setText(bO);var bI=bF||{};bI.input=bO;try{this.parseInput_(bP,bE,bI)}catch(bN){bp(bP,bN);throw bN}var bH;var bL;if(!bI.commandName){if(bI.line!==undefined){bL="move"}}else{bH=this.matchCommand_(bI.commandName);if(bH){bL=bH.name;if(bH.excludeFromCommandHistory){bG.setText(bM)}this.parseCommandArgs_(bE,bI,bH);if(bH.type=="exToKey"){for(var bK=0;bK<bH.toKeys.length;bK++){c.Vim.handleKey(bP,bH.toKeys[bK],"mapping")}return}else{if(bH.type=="exToEx"){this.processCommand(bP,bH.toInput);return}}}}if(!bL){bp(bP,'Not an editor command ":'+bO+'"');return}try{a8[bL](bP,bI);if((!bH||!bH.possiblyAsync)&&bI.callback){bI.callback()}}catch(bN){bp(bP,bN);throw bN}},parseInput_:function(bF,bG,bE){bG.eatWhile(":");if(bG.eat("%")){bE.line=bF.firstLine();bE.lineEnd=bF.lastLine()}else{bE.line=this.parseLineSpec_(bF,bG);if(bE.line!==undefined&&bG.eat(",")){bE.lineEnd=this.parseLineSpec_(bF,bG)}}var bH=bG.match(/^(\w+)/);if(bH){bE.commandName=bH[1]}else{bE.commandName=bG.match(/.*/)[0]}return bE},parseLineSpec_:function(bE,bF){var bG=bF.match(/^(\d+)/);if(bG){return parseInt(bG[1],10)-1}switch(bF.next()){case".":return bE.getCursor().line;case"$":return bE.lastLine();case"'":var bH=bE.state.vim.marks[bF.next()];if(bH&&bH.find()){return bH.find().line}throw new Error("Mark not set");default:bF.backUp(1);return undefined}},parseCommandArgs_:function(bF,bI,bH){if(bF.eol()){return}bI.argString=bF.match(/.*/)[0];var bG=bH.argDelimiter||/\s+/;var bE=bb(bI.argString).split(bG);if(bE.length&&bE[0]){bI.args=bE}},matchCommand_:function(bF){for(var bE=bF.length;bE>0;bE--){var bG=bF.substring(0,bE);if(this.commandMap_[bG]){var bH=this.commandMap_[bG];if(bH.name.indexOf(bF)===0){return bH}}}return null},buildCommandMap_:function(){this.commandMap_={};for(var bF=0;bF<D.length;bF++){var bG=D[bF];var bE=bG.shortName||bG.name;this.commandMap_[bE]=bG}},map:function(bF,bI,bE){if(bF!=":"&&bF.charAt(0)==":"){if(bE){throw Error("Mode not supported for ex mappings")}var bH=bF.substring(1);if(bI!=":"&&bI.charAt(0)==":"){this.commandMap_[bH]={name:bH,type:"exToEx",toInput:bI.substring(1),user:true}}else{this.commandMap_[bH]={name:bH,type:"exToKey",toKeys:bI,user:true}}}else{if(bI!=":"&&bI.charAt(0)==":"){var bG={keys:bF,type:"keyToEx",exArgs:{input:bI.substring(1)},user:true};if(bE){bG.context=bE}b.unshift(bG)}else{var bG={keys:bF,type:"keyToKey",toKeys:bI,user:true};if(bE){bG.context=bE}b.unshift(bG)}}},unmap:function(bF,bE){if(bF!=":"&&bF.charAt(0)==":"){if(bE){throw Error("Mode not supported for ex mappings")}var bH=bF.substring(1);if(this.commandMap_[bH]&&this.commandMap_[bH].user){delete this.commandMap_[bH];return}}else{var bI=bF;for(var bG=0;bG<b.length;bG++){if(bI==b[bG].keys&&b[bG].context===bE&&b[bG].user){b.splice(bG,1);return}}}throw Error("No such mapping.")}};var a8={map:function(bE,bH,bF){var bG=bH.args;if(!bG||bG.length<2){if(bE){bp(bE,"Invalid mapping: "+bH.input)}return}n.map(bG[0],bG[1],bF)},imap:function(bE,bF){this.map(bE,bF,"insert")},nmap:function(bE,bF){this.map(bE,bF,"normal")},vmap:function(bE,bF){this.map(bE,bF,"visual")},unmap:function(bE,bH,bF){var bG=bH.args;if(!bG||bG.length<1){if(bE){bp(bE,"No such mapping: "+bH.input)}return}n.unmap(bG[0],bF)},move:function(bE,bF){be.processCommand(bE,bE.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true},repeatOverride:bF.line+1})},set:function(bM,bJ){var bG=bJ.args;if(!bG||bG.length<1){if(bM){bp(bM,"Invalid mapping: "+bJ.input)}return}var bK=bG[0].split("=");var bF=bK[0];var bL=bK[1];var bI=false;if(bF.charAt(bF.length-1)=="?"){if(bL){throw Error("Trailing characters: "+bJ.argString)}bF=bF.substring(0,bF.length-1);bI=true}if(bL===undefined&&bF.substring(0,2)=="no"){bF=bF.substring(2);bL=false}var bH=aw[bF]&&aw[bF].type=="boolean";if(bH&&bL==undefined){bL=true}if(!bH&&!bL||bI){var bE=p(bF);if(bE===true||bE===false){bp(bM," "+(bE?"":"no")+bF)}else{bp(bM,"  "+bF+"="+bE)}}else{aL(bF,bL)}},registers:function(bJ,bF){var bL=bF.args;var bI=s.registerController.registers;var bG="----------Registers----------<br><br>";if(!bL){for(var bE in bI){var bM=bI[bE].toString();if(bM.length){bG+='"'+bE+"    "+bM+"<br>"}}}else{var bE;bL=bL.join("");for(var bH=0;bH<bL.length;bH++){bE=bL.charAt(bH);if(!s.registerController.isValidRegister(bE)){continue}var bK=bI[bE]||new br();bG+='"'+bE+"    "+bK.toString()+"<br>"}}bp(bJ,bG)},sort:function(bN,bX){var bO,bH,bF,bG;function bI(){if(bX.argString){var b1=new c.StringStream(bX.argString);if(b1.eat("!")){bO=true}if(b1.eol()){return}if(!b1.eatSpace()){return"Invalid arguments"}var b3=b1.match(/[a-z]+/);if(b3){b3=b3[0];bH=b3.indexOf("i")!=-1;bF=b3.indexOf("u")!=-1;var b0=b3.indexOf("d")!=-1&&1;var b2=b3.indexOf("x")!=-1&&1;var bZ=b3.indexOf("o")!=-1&&1;if(b0+b2+bZ>1){return"Invalid arguments"}bG=b0&&"decimal"||b2&&"hex"||bZ&&"octal"}if(b1.eatSpace()&&b1.match(/\/.*\//)){"patterns not supported"}}}var bJ=bI();if(bJ){bp(bN,bJ+": "+bX.argString);return}var bS=bX.line||bN.firstLine();var bW=bX.lineEnd||bX.line||bN.lastLine();if(bS==bW){return}var bM=d(bS,0);var bU=d(bW,aZ(bN,bW));var bR=bN.getRange(bM,bU).split("\n");var bK=(bG=="decimal")?/(-?)([\d]+)/:(bG=="hex")?/(-?)(?:0x)?([0-9a-f]+)/i:(bG=="octal")?/([0-7]+)/:null;var bL=(bG=="decimal")?10:(bG=="hex")?16:(bG=="octal")?8:null;var bP=[],bT=[];if(bG){for(var bV=0;bV<bR.length;bV++){if(bK.exec(bR[bV])){bP.push(bR[bV])}else{bT.push(bR[bV])}}}else{bT=bR}function bY(b0,bZ){if(bO){var b1;b1=b0;b0=bZ;bZ=b1}if(bH){b0=b0.toLowerCase();bZ=bZ.toLowerCase()}var b3=bG&&bK.exec(b0);var b2=bG&&bK.exec(bZ);if(!b3){return b0<bZ?-1:1}b3=parseInt((b3[1]+b3[2]).toLowerCase(),bL);b2=parseInt((b2[1]+b2[2]).toLowerCase(),bL);return b3-b2}bP.sort(bY);bT.sort(bY);bR=(!bO)?bT.concat(bP):bP.concat(bT);if(bF){var bQ=bR;var bE;bR=[];for(var bV=0;bV<bQ.length;bV++){if(bQ[bV]!=bE){bR.push(bQ[bV])}bE=bQ[bV]}}bN.replaceRange(bR.join("\n"),bM,bU)},global:function(bR,bI){var bF=bI.argString;if(!bF){bp(bR,"Regular Expression missing from global");return}var bL=(bI.line!==undefined)?bI.line:bR.firstLine();var bJ=bI.lineEnd||bI.line||bR.lastLine();var bQ=y(bF);var bT=bF,bH;if(bQ.length){bT=bQ[0];bH=bQ.slice(1,bQ.length).join("/")}if(bT){try{bA(bR,bT,true,true)}catch(bO){bp(bR,"Invalid regex: "+bT);return}}var bP=aK(bR).getQuery();var bE=[],bN="";for(var bK=bL;bK<=bJ;bK++){var bG=bP.test(bR.getLine(bK));if(bG){bE.push(bK+1);bN+=bR.getLine(bK)+"<br>"}}if(!bH){bp(bR,bN);return}var bM=0;var bS=function(){if(bM<bE.length){var bU=bE[bM]+bH;n.processCommand(bR,bU,{callback:bS})}bM++};bS()},substitute:function(bL,bT){if(!bL.getSearchCursor){throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.")}var bU=bT.argString;var bO=bU?y(bU):[];var bM,bN="",bE,bF,bJ;var bK=false;var bQ=false;if(bO.length){bM=bO[0];bN=bO[1];if(bN!==undefined){if(p("pcre")){bN=ah(bN)}else{bN=bw(bN)}s.lastSubstituteReplacePart=bN}bE=bO[2]?bO[2].split(" "):[]}else{if(bU&&bU.length){bp(bL,"Substitutions should be of the form :s/pattern/replace/");return}}if(bE){bF=bE[0];bJ=parseInt(bE[1]);if(bF){if(bF.indexOf("c")!=-1){bK=true;bF.replace("c","")}if(bF.indexOf("g")!=-1){bQ=true;bF.replace("g","")}bM=bM+"/"+bF}}if(bM){try{bA(bL,bM,true,true)}catch(bS){bp(bL,"Invalid regex: "+bM);return}}bN=bN||s.lastSubstituteReplacePart;if(bN===undefined){bp(bL,"No previous substitute regular expression");return}var bH=aK(bL);var bI=bH.getQuery();var bP=(bT.line!==undefined)?bT.line:bL.getCursor().line;var bR=bT.lineEnd||bP;if(bJ){bP=bR;bR=bP+bJ-1}var bV=ab(bL,d(bP,0));var bG=bL.getSearchCursor(bI,bV);ba(bL,bK,bQ,bP,bR,bG,bI,bN,bT.callback)},redo:c.commands.redo,undo:c.commands.undo,write:function(bE){if(c.commands.save){c.commands.save(bE)}else{bE.save()}},nohlsearch:function(bE){aO(bE)},delmarks:function(bO,bJ){if(!bJ.argString||!bb(bJ.argString)){bp(bO,"Argument required");return}var bE=bO.state.vim;var bP=new c.StringStream(bb(bJ.argString));while(!bP.eol()){bP.eatSpace();var bM=bP.pos;if(!bP.match(/[a-zA-Z]/,false)){bp(bO,"Invalid argument: "+bJ.argString.substring(bM));return}var bG=bP.next();if(bP.match("-",true)){if(!bP.match(/[a-zA-Z]/,false)){bp(bO,"Invalid argument: "+bJ.argString.substring(bM));return}var bH=bG;var bL=bP.next();if(G(bH)&&G(bL)||C(bH)&&C(bL)){var bF=bH.charCodeAt(0);var bN=bL.charCodeAt(0);if(bF>=bN){bp(bO,"Invalid argument: "+bJ.argString.substring(bM));return}for(var bK=0;bK<=bN-bF;bK++){var bI=String.fromCharCode(bF+bK);delete bE.marks[bI]}}else{bp(bO,"Invalid argument: "+bH+"-");return}}else{delete bE.marks[bG]}}}};var n=new aa();function ba(bS,bF,bH,bN,bL,bG,bP,bJ,bT){bS.state.vim.exMode=true;var bK=false;var bR=bG.from();function bO(){bS.operation(function(){while(!bK){bI();bM()}bQ()})}function bI(){var bV=bS.getRange(bG.from(),bG.to());var bU=bV.replace(bP,bJ);bG.replace(bU)}function bM(){var bU;while(bU=bG.findNext()&&ag(bG.from(),bN,bL)){if(!bH&&bR&&bG.from().line==bR.line){continue}bS.scrollIntoView(bG.from(),30);bS.setSelection(bG.from(),bG.to());bR=bG.from();bK=false;return}bK=true}function bQ(bV){if(bV){bV()}bS.focus();if(bR){bS.setCursor(bR);var bU=bS.state.vim;bU.exMode=false;bU.lastHPos=bU.lastHSPos=bR.ch}if(bT){bT()}}function bE(bX,bU,bY){c.e_stop(bX);var bV=c.keyName(bX);switch(bV){case"Y":bI();bM();break;case"N":bM();break;case"A":var bW=bT;bT=undefined;bS.operation(bO);bT=bW;break;case"L":bI();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":bQ(bY);break}if(bK){bQ(bY)}return true}bM();if(bK){bp(bS,"No matches for "+bP.source);return}if(!bF){bO();if(bT){bT()}return}a4(bS,{prefix:"replace with <strong>"+bJ+"</strong> (y/n/a/q/l)",onKeyDown:bE})}c.keyMap.vim={attach:u,detach:i,call:a6};function x(bM){var bF=bM.state.vim;var bH=s.macroModeState;var bK=s.registerController.getRegister(".");var bE=bH.isPlaying;var bI=bH.lastInsertModeChanges;var bN=[];if(!bE){var bJ=bI.inVisualBlock?bF.lastSelection.visualBlock.height:1;var bL=bI.changes;var bN=[];var bG=0;while(bG<bL.length){bN.push(bL[bG]);if(bL[bG] instanceof bn){bG++}else{bG+=bJ}}bI.changes=bN;bM.off("change",bk);c.off(bM.getInputField(),"keydown",Y)}if(!bE&&bF.insertModeRepeat>1){z(bM,bF,bF.insertModeRepeat-1,true);bF.lastEditInputState.repeatOverride=bF.insertModeRepeat}delete bF.insertModeRepeat;bF.insertMode=false;bM.setCursor(bM.getCursor().line,bM.getCursor().ch-1);bM.setOption("keyMap","vim");bM.setOption("disableInput",true);bM.toggleOverwrite(false);bK.setText(bI.changes.join(""));c.signal(bM,"vim-mode-change",{mode:"normal"});if(bH.isRecording){ap(bH)}}function q(bE){b.push(bE)}function aB(bJ,bI,bG,bF,bE){var bK={keys:bJ,type:bI};bK[bI]=bG;bK[bI+"Args"]=bF;for(var bH in bE){bK[bH]=bE[bH]}q(bK)}aN("insertModeEscKeysTimeout",200,"number");c.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(bE){var bF=c.commands.newlineAndIndentContinueComment||c.commands.newlineAndIndent;bF(bE)},fallthrough:["default"],attach:u,detach:i,call:a6};c.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:u,detach:i,call:a6};function J(bM,bG,bH,bE){var bO=s.registerController.getRegister(bE);var bF=bO.keyBuffer;var bK=0;bH.isPlaying=true;bH.replaySearchQueries=bO.searchQueries.slice(0);for(var bI=0;bI<bF.length;bI++){var bP=bF[bI];var bJ,bN;while(bP){bJ=(/<\w+-.+?>|<\w+>|./).exec(bP);bN=bJ[0];bP=bP.substring(bJ.index+bN.length);c.Vim.handleKey(bM,bN,"macro");if(bG.insertMode){var bL=bO.insertModeChanges[bK++].changes;s.macroModeState.lastInsertModeChanges.changes=bL;av(bM,bL,1);x(bM)}}}bH.isPlaying=false}function K(bH,bE){if(bH.isPlaying){return}var bG=bH.latestRegister;var bF=s.registerController.getRegister(bG);if(bF){bF.pushText(bE)}}function ap(bG){if(bG.isPlaying){return}var bF=bG.latestRegister;var bE=s.registerController.getRegister(bF);if(bE){bE.pushInsertModeChanges(bG.lastInsertModeChanges)}}function Q(bH,bG){if(bH.isPlaying){return}var bF=bH.latestRegister;var bE=s.registerController.getRegister(bF);if(bE){bE.pushSearchQuery(bG)}}function bk(bF,bE){var bH=s.macroModeState;var bG=bH.lastInsertModeChanges;if(!bH.isPlaying){while(bE){bG.expectCursorActivityForChange=true;if(bE.origin=="+input"||bE.origin=="paste"||bE.origin===undefined){var bI=bE.text.join("\n");bG.changes.push(bI)}bE=bE.next}}}function ac(bE){var bF=bE.state.vim;if(bF.insertMode){var bH=s.macroModeState;if(bH.isPlaying){return}var bG=bH.lastInsertModeChanges;if(bG.expectCursorActivityForChange){bG.expectCursorActivityForChange=false}else{bG.changes=[]}}else{if(!bE.curOp.isVimOp){t(bE,bF)}}if(bF.visualMode){ae(bE)}}function ae(bE){var bF=bE.state.vim;var bH=E(bF.sel.head);var bG=F(bH,0,1);if(bF.fakeCursor){bF.fakeCursor.clear()}bF.fakeCursor=bE.markText(bH,bG,{className:"cm-animate-fat-cursor"})}function t(bE,bF){var bG=bE.getCursor("anchor");var bH=bE.getCursor("head");if(bF.visualMode&&!bE.somethingSelected()){aV(bE,false)}else{if(!bF.visualMode&&!bF.insertMode&&bE.somethingSelected()){bF.visualMode=true;bF.visualLine=false;c.signal(bE,"vim-mode-change",{mode:"visual"})}}if(bF.visualMode){var bI=!aQ(bH,bG)?-1:0;var bJ=aQ(bH,bG)?-1:0;bH=F(bH,0,bI);bG=F(bG,0,bJ);bF.sel={anchor:bG,head:bH};aT(bE,bF,"<",ay(bH,bG));aT(bE,bF,">",bc(bH,bG))}else{if(!bF.insertMode){bF.lastHPos=bE.getCursor().ch}}}function bn(bE){this.keyName=bE}function Y(bI){var bH=s.macroModeState;var bG=bH.lastInsertModeChanges;var bF=c.keyName(bI);if(!bF){return}function bE(){bG.changes.push(new bn(bF));return true}if(bF.indexOf("Delete")!=-1||bF.indexOf("Backspace")!=-1){c.lookupKey(bF,"vim-insert",bE)}}function z(bM,bH,bF,bE){var bJ=s.macroModeState;bJ.isPlaying=true;var bN=!!bH.lastEditActionCommand;var bK=bH.inputState;function bG(){if(bN){be.processAction(bM,bH,bH.lastEditActionCommand)}else{be.evalInput(bM,bH)}}function bL(bP){if(bJ.lastInsertModeChanges.changes.length>0){bP=!bH.lastEditActionCommand?1:bP;var bO=bJ.lastInsertModeChanges;av(bM,bO.changes,bP)}}bH.inputState=bH.lastEditInputState;if(bN&&bH.lastEditActionCommand.interlaceInsertRepeat){for(var bI=0;bI<bF;bI++){bG();bL(1)}}else{if(!bE){bG()}bL(bF)}bH.inputState=bK;if(bH.insertMode&&!bE){x(bM)}bJ.isPlaying=false}function av(bP,bO,bF){function bL(bR){if(typeof bR=="string"){c.commands[bR](bP)}else{bR(bP)}return true}var bN=bP.getCursor("head");var bE=s.macroModeState.lastInsertModeChanges.inVisualBlock;if(bE){var bJ=bP.state.vim;var bG=bJ.lastSelection;var bI=bh(bG.anchor,bG.head);aW(bP,bN,bI.line+1);bF=bP.listSelections().length;bP.setCursor(bN)}for(var bK=0;bK<bF;bK++){if(bE){bP.setCursor(F(bN,bK,0))}for(var bH=0;bH<bO.length;bH++){var bM=bO[bH];if(bM instanceof bn){c.lookupKey(bM.keyName,"vim-insert",bL)}else{var bQ=bP.getCursor();bP.replaceRange(bM,bQ,bQ)}}}if(bE){bP.setCursor(F(bN,0,1))}}B();return aR};c.Vim=e()});(function(b,d,c){if(typeof module!="undefined"&&module.exports){module.exports=d()}else{if(typeof c.define=="function"&&c.define["amd"]){define(d)}else{c[b]=d()}}})("Firepad",function(){var d=d||{};d.utils={};d.utils.makeEventEmitter=function(g,h){g.prototype.allowedEvents_=h;g.prototype.on=function(j,l,i){this.validateEventType_(j);this.eventListeners_=this.eventListeners_||{};this.eventListeners_[j]=this.eventListeners_[j]||[];this.eventListeners_[j].push({callback:l,context:i})};g.prototype.off=function(l,n){this.validateEventType_(l);this.eventListeners_=this.eventListeners_||{};var m=this.eventListeners_[l]||[];for(var j=0;j<m.length;j++){if(m[j].callback===n){m.splice(j,1);return}}};g.prototype.trigger=function(l){this.eventListeners_=this.eventListeners_||{};var m=this.eventListeners_[l]||[];for(var j=0;j<m.length;j++){m[j].callback.apply(m[j].context,Array.prototype.slice.call(arguments,1))}};g.prototype.validateEventType_=function(l){if(this.allowedEvents_){var m=false;for(var j=0;j<this.allowedEvents_.length;j++){if(this.allowedEvents_[j]===l){m=true;break}}if(!m){throw new Error('Unknown event "'+l+'"')}}}};d.utils.elt=function(h,m,j){var n=document.createElement(h);if(typeof m==="string"){d.utils.setTextContent(n,m)}else{if(m){for(var l=0;l<m.length;++l){n.appendChild(m[l])}}}for(var g in (j||{})){n.setAttribute(g,j[g])}return n};d.utils.setTextContent=function(g,h){g.innerHTML="";g.appendChild(document.createTextNode(h))};d.utils.on=function(j,h,i,g){if(j.addEventListener){j.addEventListener(h,i,g||false)}else{if(j.attachEvent){j.attachEvent("on"+h,i)}}};d.utils.off=function(j,h,i,g){if(j.removeEventListener){j.removeEventListener(h,i,g||false)}else{if(j.detachEvent){j.detachEvent("on"+h,i)}}};d.utils.preventDefault=function(g){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}};d.utils.stopPropagation=function(g){if(g.stopPropagation){g.stopPropagation()}else{g.cancelBubble=true}};d.utils.stopEvent=function(g){d.utils.preventDefault(g);d.utils.stopPropagation(g)};d.utils.stopEventAnd=function(g){return function(h){g(h);d.utils.stopEvent(h);return false}};d.utils.trim=function(g){return g.replace(/^\s+/g,"").replace(/\s+$/g,"")};d.utils.stringEndsWith=function(l,j){var h=(typeof j=="string")?[j]:j;for(var g=0;g<h.length;g++){var j=h[g];if(l.indexOf(j,l.length-j.length)!==-1){return true}}return false};d.utils.assert=function c(g,h){if(!g){throw new Error(h||"assertion error")}};d.utils.log=function(){if(typeof console!=="undefined"&&typeof console.log!=="undefined"){var g=["Firepad:"];for(var h=0;h<arguments.length;h++){g.push(arguments[h])}console.log.apply(console,g)}};var d=d||{};d.Span=(function(){function g(i,h){this.pos=i;this.length=h}g.prototype.end=function(){return this.pos+this.length};return g}());var d=d||{};d.TextOp=(function(){var g=d.utils;function h(i){this.type=i;this.chars=null;this.text=null;this.attributes=null;if(i==="insert"){this.text=arguments[1];g.assert(typeof this.text==="string");this.attributes=arguments[2]||{};g.assert(typeof this.attributes==="object")}else{if(i==="delete"){this.chars=arguments[1];g.assert(typeof this.chars==="number")}else{if(i==="retain"){this.chars=arguments[1];g.assert(typeof this.chars==="number");this.attributes=arguments[2]||{};g.assert(typeof this.attributes==="object")}}}}h.prototype.isInsert=function(){return this.type==="insert"};h.prototype.isDelete=function(){return this.type==="delete"};h.prototype.isRetain=function(){return this.type==="retain"};h.prototype.equals=function(i){return(this.type===i.type&&this.text===i.text&&this.chars===i.chars&&this.attributesEqual(i.attributes))};h.prototype.attributesEqual=function(j){for(var i in this.attributes){if(this.attributes[i]!==j[i]){return false}}for(i in j){if(this.attributes[i]!==j[i]){return false}}return true};h.prototype.hasEmptyAttributes=function(){var j=true;for(var i in this.attributes){j=false;break}return j};return h})();var d=d||{};d.TextOperation=(function(){var j=d.TextOp;var g=d.utils;function i(){if(!this||this.constructor!==i){return new i()}this.ops=[];this.baseLength=0;this.targetLength=0}i.prototype.equals=function(m){if(this.baseLength!==m.baseLength){return false}if(this.targetLength!==m.targetLength){return false}if(this.ops.length!==m.ops.length){return false}for(var n=0;n<this.ops.length;n++){if(!this.ops[n].equals(m.ops[n])){return false}}return true};i.prototype.retain=function(p,m){if(typeof p!=="number"||p<0){throw new Error("retain expects a positive integer.")}if(p===0){return this}this.baseLength+=p;this.targetLength+=p;m=m||{};var o=(this.ops.length>0)?this.ops[this.ops.length-1]:null;if(o&&o.isRetain()&&o.attributesEqual(m)){o.chars+=p}else{this.ops.push(new j("retain",p,m))}return this};i.prototype.insert=function(p,m){if(typeof p!=="string"){throw new Error("insert expects a string")}if(p===""){return this}m=m||{};this.targetLength+=p.length;var o=(this.ops.length>0)?this.ops[this.ops.length-1]:null;var n=(this.ops.length>1)?this.ops[this.ops.length-2]:null;if(o&&o.isInsert()&&o.attributesEqual(m)){o.text+=p}else{if(o&&o.isDelete()){if(n&&n.isInsert()&&n.attributesEqual(m)){n.text+=p}else{this.ops[this.ops.length-1]=new j("insert",p,m);this.ops.push(o)}}else{this.ops.push(new j("insert",p,m))}}return this};i.prototype["delete"]=function(o){if(typeof o==="string"){o=o.length}if(typeof o!=="number"||o<0){throw new Error("delete expects a positive integer or a string")}if(o===0){return this}this.baseLength+=o;var m=(this.ops.length>0)?this.ops[this.ops.length-1]:null;if(m&&m.isDelete()){m.chars+=o}else{this.ops.push(new j("delete",o))}return this};i.prototype.isNoop=function(){return this.ops.length===0||(this.ops.length===1&&(this.ops[0].isRetain()&&this.ops[0].hasEmptyAttributes()))};i.prototype.clone=function(){var n=new i();for(var m=0;m<this.ops.length;m++){if(this.ops[m].isRetain()){n.retain(this.ops[m].chars,this.ops[m].attributes)}else{if(this.ops[m].isInsert()){n.insert(this.ops[m].text,this.ops[m].attributes)}else{n["delete"](this.ops[m].chars)}}}return n};i.prototype.toString=function(){var m=Array.prototype.map||function(r){var n=this;var q=[];for(var p=0,o=n.length;p<o;p++){q[p]=r(n[p])}return q};return m.call(this.ops,function(n){if(n.isRetain()){return"retain "+n.chars}else{if(n.isInsert()){return"insert '"+n.text+"'"}else{return"delete "+(n.chars)}}}).join(", ")};i.prototype.toJSON=function(){var n=[];for(var m=0;m<this.ops.length;m++){if(!this.ops[m].hasEmptyAttributes()){n.push(this.ops[m].attributes)}if(this.ops[m].type==="retain"){n.push(this.ops[m].chars)}else{if(this.ops[m].type==="insert"){n.push(this.ops[m].text)}else{if(this.ops[m].type==="delete"){n.push(-this.ops[m].chars)}}}}if(n.length===0){n.push(0)}return n};i.fromJSON=function(q){var r=new i();for(var p=0,m=q.length;p<m;p++){var s=q[p];var n={};if(typeof s==="object"){n=s;p++;s=q[p]}if(typeof s==="number"){if(s>0){r.retain(s,n)}else{r["delete"](-s)}}else{g.assert(typeof s==="string");r.insert(s,n)}}return r};i.prototype.apply=function(B,A,m){var r=this;A=A||[];m=m||[];if(B.length!==r.baseLength){throw new Error("The operation's base length must be equal to the string's length.")}var o=[],t=0,s,x;var C=0;var n=this.ops;for(var u=0,q=n.length;u<q;u++){var w=n[u];if(w.isRetain()){if(C+w.chars>B.length){throw new Error("Operation can't retain more characters than are left in the string.")}o[t++]=B.slice(C,C+w.chars);for(s=0;s<w.chars;s++){var v=A[C+s]||{},p={};for(x in v){p[x]=v[x];g.assert(p[x]!==false)}for(x in w.attributes){if(w.attributes[x]===false){delete p[x]}else{p[x]=w.attributes[x]}g.assert(p[x]!==false)}m.push(p)}C+=w.chars}else{if(w.isInsert()){o[t++]=w.text;for(s=0;s<w.text.length;s++){var z={};for(x in w.attributes){z[x]=w.attributes[x];g.assert(z[x]!==false)}m.push(z)}}else{C+=w.chars}}}if(C!==B.length){throw new Error("The operation didn't operate on the whole string.")}var y=o.join("");g.assert(y.length===m.length);return y};i.prototype.invert=function(r){var q=0;var n=new i();var p=this.ops;for(var o=0,m=p.length;o<m;o++){var s=p[o];if(s.isRetain()){n.retain(s.chars);q+=s.chars}else{if(s.isInsert()){n["delete"](s.text.length)}else{n.insert(r.slice(q,q+s.chars));q+=s.chars}}}return n};i.prototype.compose=function(t){var u=this;if(u.targetLength!==t.baseLength){throw new Error("The base length of the second operation has to be the target length of the first operation")}function v(B,z,A){var y={},x;for(x in B){y[x]=B[x]}for(x in z){if(A&&z[x]===false){delete y[x]}else{y[x]=z[x]}}return y}var r=new i();var o=u.clone().ops,n=t.clone().ops;var q=0,p=0;var m=o[q++],w=n[p++];var s;while(true){if(typeof m==="undefined"&&typeof w==="undefined"){break}if(m&&m.isDelete()){r["delete"](m.chars);m=o[q++];continue}if(w&&w.isInsert()){r.insert(w.text,w.attributes);w=n[p++];continue}if(typeof m==="undefined"){throw new Error("Cannot compose operations: first operation is too short.")}if(typeof w==="undefined"){throw new Error("Cannot compose operations: first operation is too long.")}if(m.isRetain()&&w.isRetain()){s=v(m.attributes,w.attributes);if(m.chars>w.chars){r.retain(w.chars,s);m.chars-=w.chars;w=n[p++]}else{if(m.chars===w.chars){r.retain(m.chars,s);m=o[q++];w=n[p++]}else{r.retain(m.chars,s);w.chars-=m.chars;m=o[q++]}}}else{if(m.isInsert()&&w.isDelete()){if(m.text.length>w.chars){m.text=m.text.slice(w.chars);w=n[p++]}else{if(m.text.length===w.chars){m=o[q++];w=n[p++]}else{w.chars-=m.text.length;m=o[q++]}}}else{if(m.isInsert()&&w.isRetain()){s=v(m.attributes,w.attributes,true);if(m.text.length>w.chars){r.insert(m.text.slice(0,w.chars),s);m.text=m.text.slice(w.chars);w=n[p++]}else{if(m.text.length===w.chars){r.insert(m.text,s);m=o[q++];w=n[p++]}else{r.insert(m.text,s);w.chars-=m.text.length;m=o[q++]}}}else{if(m.isRetain()&&w.isDelete()){if(m.chars>w.chars){r["delete"](w.chars);m.chars-=w.chars;w=n[p++]}else{if(m.chars===w.chars){r["delete"](w.chars);m=o[q++];w=n[p++]}else{r["delete"](m.chars);w.chars-=m.chars;m=o[q++]}}}else{throw new Error("This shouldn't happen: op1: "+JSON.stringify(m)+", op2: "+JSON.stringify(w))}}}}}return r};function l(m){var n=m.ops;switch(n.length){case 1:return n[0];case 2:return n[0].isRetain()?n[1]:(n[1].isRetain()?n[0]:null);case 3:if(n[0].isRetain()&&n[2].isRetain()){return n[1]}}return null}function h(m){if(m.ops[0].isRetain()){return m.ops[0].chars}return 0}i.prototype.shouldBeComposedWith=function(n){if(this.isNoop()||n.isNoop()){return true}var q=h(this),p=h(n);var o=l(this),m=l(n);if(!o||!m){return false}if(o.isInsert()&&m.isInsert()){return q+o.text.length===p}if(o.isDelete()&&m.isDelete()){return(p+m.chars===q)||q===p}return false};i.prototype.shouldBeComposedWithInverted=function(n){if(this.isNoop()||n.isNoop()){return true}var q=h(this),p=h(n);var o=l(this),m=l(n);if(!o||!m){return false}if(o.isInsert()&&m.isInsert()){return q+o.text.length===p||q===p}if(o.isDelete()&&m.isDelete()){return p+m.chars===q}return false};i.transformAttributes=function(t,s){var q={},o={};var m,r={};for(m in t){r[m]=true}for(m in s){r[m]=true}for(m in r){var p=t[m],n=s[m];g.assert(p!=null||n!=null);if(p==null){o[m]=n}else{if(n==null){q[m]=p}else{if(p===n){}else{q[m]=p}}}}return[q,o]};i.transform=function(w,u){if(w.baseLength!==u.baseLength){throw new Error("Both operations have to have the same base length")}var s=new i();var t=new i();var o=w.clone().ops,n=u.clone().ops;var q=0,p=0;var m=o[q++],x=n[p++];while(true){if(typeof m==="undefined"&&typeof x==="undefined"){break}if(m&&m.isInsert()){s.insert(m.text,m.attributes);t.retain(m.text.length);m=o[q++];continue}if(x&&x.isInsert()){s.retain(x.text.length);t.insert(x.text,x.attributes);x=n[p++];continue}if(typeof m==="undefined"){throw new Error("Cannot transform operations: first operation is too short.")}if(typeof x==="undefined"){throw new Error("Cannot transform operations: first operation is too long.")}var r;if(m.isRetain()&&x.isRetain()){var v=i.transformAttributes(m.attributes,x.attributes);if(m.chars>x.chars){r=x.chars;m.chars-=x.chars;x=n[p++]}else{if(m.chars===x.chars){r=x.chars;m=o[q++];x=n[p++]}else{r=m.chars;x.chars-=m.chars;m=o[q++]}}s.retain(r,v[0]);t.retain(r,v[1])}else{if(m.isDelete()&&x.isDelete()){if(m.chars>x.chars){m.chars-=x.chars;x=n[p++]}else{if(m.chars===x.chars){m=o[q++];x=n[p++]}else{x.chars-=m.chars;m=o[q++]}}}else{if(m.isDelete()&&x.isRetain()){if(m.chars>x.chars){r=x.chars;m.chars-=x.chars;x=n[p++]}else{if(m.chars===x.chars){r=x.chars;m=o[q++];x=n[p++]}else{r=m.chars;x.chars-=m.chars;m=o[q++]}}s["delete"](r)}else{if(m.isRetain()&&x.isDelete()){if(m.chars>x.chars){r=x.chars;m.chars-=x.chars;x=n[p++]}else{if(m.chars===x.chars){r=m.chars;m=o[q++];x=n[p++]}else{r=m.chars;x.chars-=m.chars;m=o[q++]}}t["delete"](r)}else{throw new Error("The two operations aren't compatible")}}}}}return[s,t]};return i}());var d=d||{};d.AnnotationList=(function(){var h=d.Span;function g(o,p){if(!o){throw new Error("AnnotationList assertion failed"+(p?(": "+p):""))}}function j(p,o){this.pos=p;this.length=o.length;this.annotation=o.annotation;this.attachedObject_=o.attachedObject}j.prototype.getAttachedObject=function(){return this.attachedObject_};function n(p,o){this.pos=p;this.length=o.length;this.annotation=o.annotation;this.node_=o}n.prototype.attachObject=function(o){this.node_.attachedObject=o};var m={equals:function(){return false}};function l(o){this.head_=new i(0,m);this.changeHandler_=o}l.prototype.insertAnnotatedSpan=function(p,o){this.wrapOperation_(new h(p.pos,0),function(t,r){g(!r||r.next===null);var q=new i(p.length,o);if(!r){return q}else{g(p.pos>t&&p.pos<t+r.length);var s=new i(0,m);s.next=new i(p.pos-t,r.annotation);s.next.next=q;q.next=new i(t+r.length-p.pos,r.annotation);return s.next}})};l.prototype.removeSpan=function(o){if(o.length===0){return}this.wrapOperation_(o,function(r,p){g(p!==null);var q=new i(0,m),t=q;if(o.pos>r){t.next=new i(o.pos-r,p.annotation);t=t.next}while(o.end()>r+p.length){r+=p.length;p=p.next}var s=r+p.length-o.end();if(s>0){t.next=new i(s,p.annotation)}return q.next})};l.prototype.updateSpan=function(p,o){if(p.length===0){return}this.wrapOperation_(p,function(t,r){g(r!==null);var s=new i(0,m),x=s,v=t;var u=p.pos-v;g(u<r.length);if(u>0){x.next=new i(u,r.annotation);x=x.next;v+=x.length}while(r!==null&&p.end()>=t+r.length){var w=t+r.length-v;x.next=new i(w,o(r.annotation,w));x=x.next;t+=r.length;r=r.next;v=t}var q=p.end()-v;if(q>0){g(q<r.length);x.next=new i(q,o(r.annotation,q));x=x.next;v+=x.length;x.next=new i(t+r.length-v,r.annotation)}return s.next})};l.prototype.wrapOperation_=function(x,o){if(x.pos<0){throw new Error("Span start cannot be negative.")}var p=[],r=[];var u=this.getAffectedNodes_(x);var t;if(u.start!==null){t=u.end.next;u.end.next=null}else{t=u.succ}var y=o(u.startPos,u.start);var z=false,w=false;if(y){this.mergeNodesWithSameAnnotations_(y);var v;if(u.pred&&u.pred.annotation.equals(y.annotation)){z=true;y.length+=u.pred.length;u.beforePred.next=y;v=u.predPos}else{u.beforeStart.next=y;v=u.startPos}while(y.next){r.push(new n(v,y));v+=y.length;y=y.next}if(u.succ&&u.succ.annotation.equals(y.annotation)){y.length+=u.succ.length;w=true;y.next=u.succ.next}else{y.next=t}r.push(new n(v,y))}else{if(u.pred&&u.succ&&u.pred.annotation.equals(u.succ.annotation)){z=true;w=true;y=new i(u.pred.length+u.succ.length,u.pred.annotation);u.beforePred.next=y;y.next=u.succ.next;r.push(new n(u.startPos-u.pred.length,y))}else{u.beforeStart.next=t}}if(z){p.push(new j(u.predPos,u.pred))}var q=u.startPos,s=u.start;while(s!==null){p.push(new j(q,s));q+=s.length;s=s.next}if(w){p.push(new j(q,u.succ))}this.changeHandler_(p,r)};l.prototype.getAffectedNodes_=function(r){var o={};var q=null,s=this.head_,t=s.next,p=0;while(t!==null&&r.pos>=p+t.length){p+=t.length;q=s;s=t;t=t.next}if(t===null&&!(r.length===0&&r.pos===p)){throw new Error("Span start exceeds the bounds of the AnnotationList.")}o.startPos=p;if(r.length===0&&r.pos===p){o.start=null}else{o.start=t}o.beforeStart=s;if(p===r.pos&&p>0){o.pred=s;o.predPos=p-s.length;o.beforePred=q}else{o.pred=null}while(t!==null&&r.end()>p){p+=t.length;s=t;t=t.next}if(r.end()>p){throw new Error("Span end exceeds the bounds of the AnnotationList.")}if(r.length===0&&r.end()===p){o.end=null}else{o.end=s}o.succ=(p===r.end())?t:null;return o};l.prototype.mergeNodesWithSameAnnotations_=function(p){if(!p){return}var o=null,q=p;while(q){if(o&&o.annotation.equals(q.annotation)){o.length+=q.length;o.next=q.next}else{o=q}q=q.next}};l.prototype.forEach=function(p){var o=this.head_.next;while(o!==null){p(o.length,o.annotation,o.attachedObject);o=o.next}};l.prototype.getAnnotatedSpansForPos=function(s){var p=0;var r=this.head_.next,q=null;while(r!==null&&p+r.length<=s){p+=r.length;q=r;r=r.next}if(r===null&&p!==s){throw new Error("pos exceeds the bounds of the AnnotationList")}var o=[];if(p===s&&q){o.push(new j(p-q.length,q))}if(r){o.push(new j(p,r))}return o};l.prototype.getAnnotatedSpansForSpan=function(s){if(s.length===0){return[]}var o=[];var r=this.getAffectedNodes_(s);var q=r.startPos,u=r.start;while(u!==null&&q<s.end()){var v=Math.max(q,s.pos),p=Math.min(q+u.length,s.end());var t=new h(v,p-v);t.annotation=u.annotation;o.push(t);q+=u.length;u=u.next}return o};l.prototype.count=function(){var p=0;var q=this.head_.next,o=null;while(q!==null){if(o){g(!o.annotation.equals(q.annotation))}o=q;q=q.next;p++}return p};function i(p,o){this.length=p;this.annotation=o;this.attachedObject=null;this.next=null}i.prototype.clone=function(){var o=new i(this.spanLength,this.annotation);o.next=this.next;return o};return l}());var d=d||{};d.Cursor=(function(){function g(h,i){this.position=h;this.selectionEnd=i}g.fromJSON=function(h){return new g(h.position,h.selectionEnd)};g.prototype.equals=function(h){return this.position===h.position&&this.selectionEnd===h.selectionEnd};g.prototype.compose=function(h){return h};g.prototype.transform=function(h){function i(n){var p=n;var q=h.ops;for(var o=0,m=h.ops.length;o<m;o++){if(q[o].isRetain()){n-=q[o].chars}else{if(q[o].isInsert()){p+=q[o].text.length}else{p-=Math.min(n,q[o].chars);n-=q[o].chars}}if(n<0){break}}return p}var j=i(this.position);if(this.position===this.selectionEnd){return new g(j,j)}return new g(j,i(this.selectionEnd))};return g}());var d=d||{};d.FirebaseAdapter=(function(h){if(typeof require==="function"&&typeof Firebase!=="function"){Firebase=require("firebase")}var j=d.TextOperation;var o=d.utils;var l=100;function n(t,s,r){this.ref_=t;this.ready_=false;this.firebaseCallbacks_=[];this.zombie_=false;this.document_=new j();this.revision_=0;this.pendingReceivedRevisions_={};var q=this;if(s){this.setUserId(s);this.setColor(r);this.firebaseOn_(t.root().child(".info/connected"),"value",function(u){if(u.val()===true){q.initializeUserData_()}},this);this.on("ready",function(){q.monitorCursors_()})}else{this.userId_=t.push().key()}setTimeout(function(){q.monitorHistory_()},0)}o.makeEventEmitter(n,["ready","cursor","operation","ack","retry"]);n.prototype.dispose=function(){this.removeFirebaseCallbacks_();this.userRef_.child("cursor").remove();this.userRef_.child("color").remove();this.ref_=null;this.document_=null;this.zombie_=true};n.prototype.setReadOnly=function(q){this.readOnly_=q};n.prototype.setUserId=function(q){if(this.userRef_){this.userRef_.child("cursor").remove();this.userRef_.child("cursor").onDisconnect().cancel();this.userRef_.child("color").remove();this.userRef_.child("color").onDisconnect().cancel()}this.userId_=q;this.userRef_=this.ref_.child("users").child(q);this.initializeUserData_()};n.prototype.isHistoryEmpty=function(){g(this.ready_,"Not ready yet.");return this.revision_===0};n.prototype.sendOperation=function(t,v){var s=this;if(!this.ready_){this.on("ready",function(){s.trigger("retry")});return}g(this.document_.targetLength===t.baseLength,"sendOperation() called with invalid operation.");var q=m(this.revision_);function u(x,w){s.ref_.child("history").child(x).transaction(function(y){if(y===null){return w}},function(A,y,z){if(A){if(A.message==="disconnect"){if(s.sent_&&s.sent_.id===x){setTimeout(function(){u(x,w)},0)}else{if(v){v(A,false)}}}else{o.log("Transaction failure!",A);throw A}}else{if(v){v(null,y)}}},false)}this.sent_={id:q,op:t};if(hasStartTS){var r=TSDIFF+new Date().getTime();u(q,{a:s.userId_,o:t.toJSON(),t:r})}else{u(q,{a:s.userId_,o:t.toJSON(),t:Firebase.ServerValue.TIMESTAMP})}};n.prototype.sendCursor=function(q){if(this.readOnly_){return}this.userRef_.child("cursor").set(q);this.cursor_=q};n.prototype.setColor=function(q){this.userRef_.child("color").set(q);this.color_=q};n.prototype.getDocument=function(){return this.document_};n.prototype.registerCallbacks=function(r){for(var q in r){this.on(q,r[q])}};n.prototype.initializeUserData_=function(){this.userRef_.child("cursor").onDisconnect().remove();this.userRef_.child("color").onDisconnect().remove();this.sendCursor(this.cursor_||null);this.setColor(this.color_||null)};n.prototype.monitorCursors_=function(){var r=this.ref_.child("users"),q=this;function s(v){var u=v.key();var t=v.val();q.trigger("cursor",u,t.cursor,t.color)}this.firebaseOn_(r,"child_added",s);this.firebaseOn_(r,"child_changed",s);this.firebaseOn_(r,"child_removed",function(u){var t=u.key();q.trigger("cursor",t,null)})};n.prototype.monitorHistory_=function(){var q=this;this.ref_.child("checkpoint").once("value",function(u){if(q.zombie_){return}var r=u.child("id").val(),v=u.child("o").val(),t=u.child("a").val();if(v!=null&&r!=null&&t!==null){q.pendingReceivedRevisions_[r]={o:v,a:t};q.checkpointRevision_=p(r);q.monitorHistoryStartingAt_(q.checkpointRevision_+1)}else{q.checkpointRevision_=0;q.monitorHistoryStartingAt_(q.checkpointRevision_)}})};n.prototype.monitorHistoryStartingAt_=function(r){var s=this.ref_.child("history").startAt(null,m(r));var q=this;setTimeout(function(){q.firebaseOn_(s,"child_added",function(u){var t=u.key();q.pendingReceivedRevisions_[t]=u.val();if(q.ready_){q.handlePendingReceivedRevisions_()}});s.once("value",function(){q.handleInitialRevisions_()})},0)};n.prototype.handleInitialRevisions_=function(){g(!this.ready_,"Should not be called multiple times.");this.revision_=this.checkpointRevision_;var q=m(this.revision_),t=this.pendingReceivedRevisions_;while(t[q]!=null){var s=this.parseRevision_(t[q]);if(!s){o.log("Invalid operation.",this.ref_.toString(),q,t[q])}else{this.document_=this.document_.compose(s.operation)}delete t[q];this.revision_++;q=m(this.revision_)}this.trigger("operation",this.document_);this.ready_=true;var r=this;setTimeout(function(){r.trigger("ready")},0)};n.prototype.handlePendingReceivedRevisions_=function(){var t=this.pendingReceivedRevisions_;var q=m(this.revision_);var s=false;while(t[q]!=null){this.revision_++;var r=this.parseRevision_(t[q]);if(!r){o.log("Invalid operation.",this.ref_.toString(),q,t[q])}else{this.document_=this.document_.compose(r.operation);if(this.sent_&&q===this.sent_.id){if(this.sent_.op.equals(r.operation)&&r.author===this.userId_){if(this.revision_%l===0){this.saveCheckpoint_()}this.sent_=null;this.trigger("ack")}else{s=true;this.trigger("operation",r.operation)}}else{this.trigger("operation",r.operation)}}delete t[q];q=m(this.revision_)}if(s){this.sent_=null;this.trigger("retry")}};n.prototype.parseRevision_=function(q){if(typeof q!=="object"){return null}if(typeof q.a!=="string"||typeof q.o!=="object"){return null}var s=null;try{s=j.fromJSON(q.o)}catch(r){return null}if(s.baseLength!==this.document_.targetLength){return null}return{author:q.a,operation:s}};n.prototype.saveCheckpoint_=function(){this.ref_.child("checkpoint").set({a:this.userId_,o:this.document_.toJSON(),id:m(this.revision_-1)})};n.prototype.firebaseOn_=function(s,r,t,q){this.firebaseCallbacks_.push({ref:s,eventType:r,callback:t,context:q});s.on(r,t,q);return t};n.prototype.firebaseOff_=function(u,t,v,s){u.off(t,v,s);for(var r=0;r<this.firebaseCallbacks_.length;r++){var q=this.firebaseCallbacks_[r];if(q.ref===u&&q.eventType===t&&q.callback===v&&q.context===s){this.firebaseCallbacks_.splice(r,1);break}}};n.prototype.removeFirebaseCallbacks_=function(){for(var r=0;r<this.firebaseCallbacks_.length;r++){var q=this.firebaseCallbacks_[r];q.ref.off(q.eventType,q.callback,q.context)}this.firebaseCallbacks_=[]};function g(q,r){if(!q){throw new Error(r||"assertion error")}}var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function m(q){if(q===0){return"A0"}var s="";while(q>0){var t=(q%i.length);s=i[t]+s;q-=t;q/=i.length}var r=i[s.length+9];return r+s}function p(q){g(q.length>0&&q[0]===i[q.length+8]);var r=0;for(var s=1;s<q.length;s++){r*=i.length;r+=i.indexOf(q[s])}return r}return n}());var d=d||{};d.RichTextToolbar=(function(i){var h=d.utils;function g(j){this.imageInsertionUI=j;this.element_=this.makeElement_()}h.makeEventEmitter(g,["bold","italic","underline","strike","font","font-size","color","left","center","right","unordered-list","ordered-list","todo-list","indent-increase","indent-decrease","undo","redo","insert-image"]);g.prototype.element=function(){return this.element_};g.prototype.makeButton_=function(l,n){var j=this;n=n||l;var m=h.elt("a",[h.elt("span","",{"class":"firepad-tb-"+n})],{"class":"firepad-btn"});h.on(m,"click",h.stopEventAnd(function(){j.trigger(l)}));return m};g.prototype.makeElement_=function(){var m=this;var l=this.makeFontDropdown_();var q=this.makeFontSizeDropdown_();var j=this.makeColorDropdown_();var o=[h.elt("div",[l],{"class":"firepad-btn-group"}),h.elt("div",[q],{"class":"firepad-btn-group"}),h.elt("div",[j],{"class":"firepad-btn-group"}),h.elt("div",[m.makeButton_("bold"),m.makeButton_("italic"),m.makeButton_("underline"),m.makeButton_("strike","strikethrough")],{"class":"firepad-btn-group"}),h.elt("div",[m.makeButton_("unordered-list","list-2"),m.makeButton_("ordered-list","numbered-list"),m.makeButton_("todo-list","list")],{"class":"firepad-btn-group"}),h.elt("div",[m.makeButton_("indent-decrease"),m.makeButton_("indent-increase")],{"class":"firepad-btn-group"}),h.elt("div",[m.makeButton_("left","paragraph-left"),m.makeButton_("center","paragraph-center"),m.makeButton_("right","paragraph-right")],{"class":"firepad-btn-group"}),h.elt("div",[m.makeButton_("undo"),m.makeButton_("redo")],{"class":"firepad-btn-group"})];if(m.imageInsertionUI){o.push(h.elt("div",[m.makeButton_("insert-image")],{"class":"firepad-btn-group"}))}var n=h.elt("div",o,{"class":"firepad-toolbar-wrapper"});var p=h.elt("div",null,{"class":"firepad-toolbar"});p.appendChild(n);return p};g.prototype.makeFontDropdown_=function(){var n=["Arial","Comic Sans MS","Courier New","Impact","Times New Roman","Verdana"];var j=[];for(var l=0;l<n.length;l++){var m=h.elt("span",n[l]);m.setAttribute("style","font-family:"+n[l]);j.push({content:m,value:n[l]})}return this.makeDropdown_("Font","font",j)};g.prototype.makeFontSizeDropdown_=function(){var n=[9,10,12,14,18,24,32,42];var j=[];for(var l=0;l<n.length;l++){var m=h.elt("span",n[l].toString());m.setAttribute("style","font-size:"+n[l]+"px; line-height:"+(n[l]-6)+"px;");j.push({content:m,value:n[l]})}return this.makeDropdown_("Size","font-size",j,"px")};g.prototype.makeColorDropdown_=function(){var j=["black","red","green","blue","yellow","cyan","magenta","grey"];var l=[];for(var m=0;m<j.length;m++){var n=h.elt("div");n.className="firepad-color-dropdown-item";n.setAttribute("style","background-color:"+j[m]);l.push({content:n,value:j[m]})}return this.makeDropdown_("Color","color",l)};g.prototype.makeDropdown_=function(v,p,s,m){m=m||"";var y=this;var n=h.elt("a",v+" \u25be",{"class":"firepad-btn firepad-dropdown"});var r=h.elt("ul",[],{"class":"firepad-dropdown-menu"});n.appendChild(r);var t=false;function o(){if(!t){r.style.display="block";h.on(document,"click",j,true);t=true}}var u=false;function j(){if(t){r.style.display="";h.off(document,"click",j,true);t=false}u=true;setTimeout(function(){u=false},0)}function x(A,B){if(typeof A!=="object"){A=document.createTextNode(String(A))}var z=h.elt("a",[A]);h.on(z,"click",h.stopEventAnd(function(){j();y.trigger(p,B+m)}));r.appendChild(z)}for(var l=0;l<s.length;l++){var q=s[l].content,w=s[l].value;x(q,w)}h.on(n,"click",h.stopEventAnd(function(){if(!u){o()}}));return n};return g})();var d=d||{};d.WrappedOperation=(function(i){function h(m,n){this.wrapped=m;this.meta=n}h.prototype.apply=function(){return this.wrapped.apply.apply(this.wrapped,arguments)};h.prototype.invert=function(){var m=this.meta;return new h(this.wrapped.invert.apply(this.wrapped,arguments),m&&typeof m==="object"&&typeof m.invert==="function"?m.invert.apply(m,arguments):m)};function l(n,o){for(var m in n){if(n.hasOwnProperty(m)){o[m]=n[m]}}}function g(n,m){if(n&&typeof n==="object"){if(typeof n.compose==="function"){return n.compose(m)}var o={};l(n,o);l(m,o);return o}return m}h.prototype.compose=function(m){return new h(this.wrapped.compose(m.wrapped),g(this.meta,m.meta))};function j(n,m){if(n&&typeof n==="object"){if(typeof n.transform==="function"){return n.transform(m)}}return n}h.transform=function(n,m){var o=n.wrapped.constructor.transform;var p=o(n.wrapped,m.wrapped);return[new h(p[0],j(n.meta,m.wrapped)),new h(p[1],j(m.meta,n.wrapped))]};return h}());var d=d||{};d.UndoManager=(function(){var i="normal";var h="undoing";var g="redoing";function l(m){this.maxItems=m||50;this.state=i;this.dontCompose=false;this.undoStack=[];this.redoStack=[]}l.prototype.add=function(m,o){if(this.state===h){this.redoStack.push(m);this.dontCompose=true}else{if(this.state===g){this.undoStack.push(m);this.dontCompose=true}else{var n=this.undoStack;if(!this.dontCompose&&o&&n.length>0){n.push(m.compose(n.pop()))}else{n.push(m);if(n.length>this.maxItems){n.shift()}}this.dontCompose=false;this.redoStack=[]}}};function j(m,p){var n=[];var o=p.constructor;for(var q=m.length-1;q>=0;q--){var r=o.transform(m[q],p);if(typeof r[0].isNoop!=="function"||!r[0].isNoop()){n.push(r[0])}p=r[1]}return n.reverse()}l.prototype.transform=function(m){this.undoStack=j(this.undoStack,m);this.redoStack=j(this.redoStack,m)};l.prototype.performUndo=function(m){this.state=h;if(this.undoStack.length===0){throw new Error("undo not possible")}m(this.undoStack.pop());this.state=i};l.prototype.performRedo=function(m){this.state=g;if(this.redoStack.length===0){throw new Error("redo not possible")}m(this.redoStack.pop());this.state=i};l.prototype.canUndo=function(){return this.undoStack.length!==0};l.prototype.canRedo=function(){return this.redoStack.length!==0};l.prototype.isUndoing=function(){return this.state===h};l.prototype.isRedoing=function(){return this.state===g};return l}());var d=d||{};d.Client=(function(){function j(){this.state=h}j.prototype.setState=function(m){this.state=m};j.prototype.applyClient=function(m){this.setState(this.state.applyClient(this,m))};j.prototype.applyServer=function(m){this.setState(this.state.applyServer(this,m))};j.prototype.serverAck=function(){this.setState(this.state.serverAck(this))};j.prototype.serverRetry=function(){this.setState(this.state.serverRetry(this))};j.prototype.sendOperation=function(m){throw new Error("sendOperation must be defined in child class")};j.prototype.applyOperation=function(m){throw new Error("applyOperation must be defined in child class")};function i(){}j.Synchronized=i;i.prototype.applyClient=function(m,n){m.sendOperation(n);return new l(n)};i.prototype.applyServer=function(m,n){m.applyOperation(n);return this};i.prototype.serverAck=function(m){throw new Error("There is no pending operation.")};i.prototype.serverRetry=function(m){throw new Error("There is no pending operation.")};var h=new i();function l(m){this.outstanding=m}j.AwaitingConfirm=l;l.prototype.applyClient=function(m,n){return new g(this.outstanding,n)};l.prototype.applyServer=function(m,n){var o=n.constructor.transform(this.outstanding,n);m.applyOperation(o[1]);return new l(o[0])};l.prototype.serverAck=function(m){return h};l.prototype.serverRetry=function(m){m.sendOperation(this.outstanding);return this};function g(n,m){this.outstanding=n;this.buffer=m}j.AwaitingWithBuffer=g;g.prototype.applyClient=function(m,o){var n=this.buffer.compose(o);return new g(this.outstanding,n)};g.prototype.applyServer=function(m,n){var o=n.constructor.transform;var q=o(this.outstanding,n);var p=o(this.buffer,q[1]);m.applyOperation(p[1]);return new g(q[0],p[0])};g.prototype.serverRetry=function(m){var n=this.outstanding.compose(this.buffer);m.sendOperation(n);return new l(n)};g.prototype.serverAck=function(m){m.sendOperation(this.buffer);return new l(this.buffer)};return j}());var d=d||{};d.EditorClient=(function(){var h=d.Client;var o=d.Cursor;var g=d.UndoManager;var j=d.WrappedOperation;function i(r,q){this.cursorBefore=r;this.cursorAfter=q}i.prototype.invert=function(){return new i(this.cursorAfter,this.cursorBefore)};i.prototype.compose=function(q){return new i(this.cursorBefore,q.cursorAfter)};i.prototype.transform=function(q){return new i(this.cursorBefore?this.cursorBefore.transform(q):null,this.cursorAfter?this.cursorAfter.transform(q):null)};function p(r,q){this.id=r;this.editorAdapter=q;this.li=document.createElement("li")}p.prototype.setColor=function(q){this.color=q};p.prototype.updateCursor=function(q){this.removeCursor();this.cursor=q;this.mark=this.editorAdapter.setOtherCursor(q,this.color,this.id)};p.prototype.removeCursor=function(){if(this.mark){this.mark.clear()}};function m(q,s){h.call(this);this.serverAdapter=q;this.editorAdapter=s;this.undoManager=new g();this.clients={};var r=this;this.editorAdapter.registerCallbacks({change:function(u,t){r.onChange(u,t)},cursorActivity:function(){r.onCursorActivity()},blur:function(){r.onBlur()},focus:function(){r.onFocus()}});this.editorAdapter.registerUndo(function(){r.undo()});this.editorAdapter.registerRedo(function(){r.redo()});this.serverAdapter.registerCallbacks({ack:function(){r.serverAck();if(r.focused&&r.state instanceof h.Synchronized){r.updateCursor();r.sendCursor(r.cursor)}r.emitStatus()},retry:function(){r.serverRetry()},operation:function(t){r.applyServer(t)},cursor:function(t,w,v){if(r.serverAdapter.userId_===t||!(r.state instanceof h.Synchronized)){return}var u=r.getClientObject(t);if(w){if(v){u.setColor(v)}u.updateCursor(o.fromJSON(w))}else{u.removeCursor()}}})}l(m,h);m.prototype.getClientObject=function(q){var r=this.clients[q];if(r){return r}return this.clients[q]=new p(q,this.editorAdapter)};m.prototype.applyUnredo=function(q){this.undoManager.add(this.editorAdapter.invertOperation(q));this.editorAdapter.applyOperation(q.wrapped);this.cursor=q.meta.cursorAfter;if(this.cursor){this.editorAdapter.setCursor(this.cursor)}this.applyClient(q.wrapped)};m.prototype.undo=function(){var q=this;if(!this.undoManager.canUndo()){return}this.undoManager.performUndo(function(r){q.applyUnredo(r)})};m.prototype.redo=function(){var q=this;if(!this.undoManager.canRedo()){return}this.undoManager.performRedo(function(r){q.applyUnredo(r)})};m.prototype.onChange=function(u,q){var r=this.cursor;this.updateCursor();var t=this.undoManager.undoStack.length>0&&q.shouldBeComposedWithInverted(n(this.undoManager.undoStack).wrapped);var s=new i(this.cursor,r);this.undoManager.add(new j(q,s),t);this.applyClient(u)};m.prototype.updateCursor=function(){this.cursor=this.editorAdapter.getCursor()};m.prototype.onCursorActivity=function(){var q=this.cursor;this.updateCursor();if(!this.focused||q&&this.cursor.equals(q)){return}this.sendCursor(this.cursor)};m.prototype.onBlur=function(){this.cursor=null;this.sendCursor(null);this.focused=false};m.prototype.onFocus=function(){this.focused=true;this.onCursorActivity()};m.prototype.sendCursor=function(q){if(this.state instanceof h.AwaitingWithBuffer){return}this.serverAdapter.sendCursor(q)};m.prototype.sendOperation=function(q){this.serverAdapter.sendOperation(q);this.emitStatus()};m.prototype.applyOperation=function(q){this.editorAdapter.applyOperation(q);this.updateCursor();this.undoManager.transform(new j(q,null))};m.prototype.emitStatus=function(){var q=this;setTimeout(function(){q.trigger("synced",q.state instanceof h.Synchronized)},0)};function l(s,r){function q(){}q.prototype=r.prototype;s.prototype=new q();s.prototype.constructor=s}function n(q){return q[q.length-1]}return m}());d.utils.makeEventEmitter(d.EditorClient,["synced"]);var b,d,e=function(g,h){return function(){return g.apply(h,arguments)}},f=[].slice;if(typeof d==="undefined"||d===null){d={}}d.ACEAdapter=b=(function(){g.prototype.ignoreChanges=false;function g(h){this.onCursorActivity=e(this.onCursorActivity,this);this.onFocus=e(this.onFocus,this);this.onBlur=e(this.onBlur,this);this.onChange=e(this.onChange,this);var i;this.ace=h;this.aceSession=this.ace.getSession();this.aceDoc=this.aceSession.getDocument();this.aceDoc.setNewLineMode("unix");this.grabDocumentState();this.ace.on("change",this.onChange);this.ace.on("blur",this.onBlur);this.ace.on("focus",this.onFocus);this.aceSession.selection.on("changeCursor",this.onCursorActivity);if(this.aceRange==null){this.aceRange=((i=ace.require)!=null?i:require)("ace/range").Range}}g.prototype.grabDocumentState=function(){this.lastDocLines=this.aceDoc.getAllLines();return this.lastCursorRange=this.aceSession.selection.getRange()};g.prototype.detach=function(){this.ace.removeListener("change",this.onChange);this.ace.removeListener("blur",this.onBlur);this.ace.removeListener("focus",this.onCursorActivity);return this.aceSession.selection.removeListener("changeCursor",this.onCursorActivity)};g.prototype.onChange=function(i){var h;if(!this.ignoreChanges){h=this.operationFromACEChange(i);this.trigger.apply(this,["change"].concat(f.call(h)));return this.grabDocumentState()}};g.prototype.onBlur=function(){if(this.ace.selection.isEmpty()){return this.trigger("blur")}};g.prototype.onFocus=function(){return this.trigger("focus")};g.prototype.onCursorActivity=function(){var h=this;return setTimeout((function(){return h.trigger("cursorActivity")}),0)};g.prototype.operationFromACEChange=function(p){var l,q,n,m,h,i,r,o,j;q=p.data;if((o=q.action)==="insertLines"||o==="removeLines"){r=q.lines.join("\n")+"\n";l=q.action.replace("Lines","")}else{r=q.text.replace(this.aceDoc.getNewLineCharacter(),"\n");l=q.action.replace("Text","")}i=this.indexFromPos(q.range.start);h=this.lastDocLines.join("\n").length-i;if(l==="remove"){h-=r.length}m=new d.TextOperation().retain(i).insert(r).retain(h);n=new d.TextOperation().retain(i)["delete"](r).retain(h);if(l==="remove"){j=[n,m],m=j[0],n=j[1]}return[m,n]};g.prototype.applyOperationToACE=function(h){var p,n,m,l,q,i,o,j;n=0;j=h.ops;for(i=0,o=j.length;i<o;i++){m=j[i];if(m.isRetain()){n+=m.chars}else{if(m.isInsert()){this.aceDoc.insert(this.posFromIndex(n),m.text);n+=m.text.length}else{if(m.isDelete()){p=this.posFromIndex(n);q=this.posFromIndex(n+m.chars);l=this.aceRange.fromPoints(p,q);this.aceDoc.remove(l)}}}}return this.grabDocumentState()};g.prototype.posFromIndex=function(j){var i,n,m,h,l;l=this.aceDoc.$lines;for(n=m=0,h=l.length;m<h;n=++m){i=l[n];if(j<=i.length){break}j-=i.length+1}return{row:n,column:j}};g.prototype.indexFromPos=function(o,h){var l,j,n,m;if(h==null){h=this.lastDocLines}j=0;for(l=n=0,m=o.row;0<=m?n<m:n>m;l=0<=m?++n:--n){j+=this.lastDocLines[l].length+1}return j+=o.column};g.prototype.getValue=function(){return this.aceDoc.getValue()};g.prototype.getCursor=function(){var m,l,i,o,j,h;try{o=this.indexFromPos(this.aceSession.selection.getRange().start,this.aceDoc.$lines);i=this.indexFromPos(this.aceSession.selection.getRange().end,this.aceDoc.$lines)}catch(n){m=n;try{o=this.indexFromPos(this.lastCursorRange.start);i=this.indexFromPos(this.lastCursorRange.end)}catch(n){l=n;console.log("Couldn't figure out the cursor range:",l,"-- setting it to 0:0.");j=[0,0],o=j[0],i=j[1]}}if(o>i){h=[i,o],o=h[0],i=h[1]}return new d.Cursor(o,i)};g.prototype.setCursor=function(j){var h,l,i;l=this.posFromIndex(j.position);h=this.posFromIndex(j.selectionEnd);if(j.position>j.selectionEnd){i=[h,l],l=i[0],h=i[1]}return this.aceSession.selection.setSelectionRange(new this.aceRange(l.row,l.column,h.row,h.column))};g.prototype.setOtherCursor=function(s,l,h){var q,o,j,m,r,t,i,n,p=this;if(this.otherCursors==null){this.otherCursors={}}j=this.otherCursors[h];if(j){j.start.detach();j.end.detach();this.aceSession.removeMarker(j.id)}i=this.posFromIndex(s.position);m=this.posFromIndex(s.selectionEnd);if(s.selectionEnd<s.position){n=[m,i],i=n[0],m=n[1]}q="other-client-selection-"+(l.replace("#",""));r=s.position===s.selectionEnd;if(r){q=q.replace("selection","cursor")}o="."+q+" {\n  position: absolute;\n  background-color: "+(r?"transparent":l)+";\n  border-left: 2px solid "+l+";\n}";this.addStyleRule(o);this.otherCursors[h]=j=new this.aceRange(i.row,i.column,m.row,m.column);t=this;j.clipRows=function(){var u;u=t.aceRange.prototype.clipRows.apply(this,arguments);u.isEmpty=function(){return false};return u};j.start=this.aceDoc.createAnchor(j.start);j.end=this.aceDoc.createAnchor(j.end);j.id=this.aceSession.addMarker(j,q,"text");return{clear:function(){j.start.detach();j.end.detach();return p.aceSession.removeMarker(j.id)}}};g.prototype.addStyleRule=function(i){var h;if(typeof document==="undefined"||document===null){return}if(!this.addedStyleRules){this.addedStyleRules={};h=document.createElement("style");document.documentElement.getElementsByTagName("head")[0].appendChild(h);this.addedStyleSheet=h.sheet}if(this.addedStyleRules[i]){return}this.addedStyleRules[i]=true;return this.addedStyleSheet.insertRule(i,0)};g.prototype.registerCallbacks=function(h){this.callbacks=h};g.prototype.trigger=function(){var i,j,l,h;j=arguments[0],i=2<=arguments.length?f.call(arguments,1):[];return(l=this.callbacks)!=null?(h=l[j])!=null?h.apply(this,i):void 0:void 0};g.prototype.applyOperation=function(h){if(!h.isNoop()){this.ignoreChanges=true}this.applyOperationToACE(h);return this.ignoreChanges=false};g.prototype.registerUndo=function(h){return this.ace.undo=h};g.prototype.registerRedo=function(h){return this.ace.redo=h};g.prototype.invertOperation=function(h){return h.invert(this.getValue())};return g})();var d=d||{};d.AttributeConstants={BOLD:"b",ITALIC:"i",UNDERLINE:"u",STRIKE:"s",FONT:"f",FONT_SIZE:"fs",COLOR:"c",BACKGROUND_COLOR:"bc",ENTITY_SENTINEL:"ent",LINE_SENTINEL:"l",LINE_INDENT:"li",LINE_ALIGN:"la",LIST_TYPE:"lt"};d.sentinelConstants={LINE_SENTINEL_CHARACTER:"\uE000",ENTITY_SENTINEL_CHARACTER:"\uE001"};var d=d||{};d.EntityManager=(function(){var h=d.utils;function g(){this.entities_={};var i=["src","alt","width","height","style","class"];this.register("img",{render:function(o){h.assert(o.src,"image entity should have 'src'!");var l=["src","alt","width","height","style","class"];var n="<img ";for(var m=0;m<l.length;m++){var j=l[m];if(j in o){n+=" "+j+'="'+o[j]+'"'}}n+=">";return n},fromElement:function(m){var n={};for(var l=0;l<i.length;l++){var j=i[l];if(m.hasAttribute(j)){n[j]=m.getAttribute(j)}}return n}})}g.prototype.register=function(j,i){d.utils.assert(i.render,"Entity options should include a 'render' function!");d.utils.assert(i.fromElement,"Entity options should include a 'fromElement' function!");this.entities_[j]=i};g.prototype.renderToElement=function(i,j){return this.tryRenderToElement_(i,"render",j)};g.prototype.exportToElement=function(i){var j=this.tryRenderToElement_(i,"export")||this.tryRenderToElement_(i,"getHtml")||this.tryRenderToElement_(i,"render");j.setAttribute("data-firepad-entity",i.type);return j};g.prototype.updateElement=function(i,j){var l=i.type;var m=i.info;if(this.entities_[l]&&typeof(this.entities_[l].update)!="undefined"){this.entities_[l].update(m,j)}};g.prototype.fromElement=function(i){var j=i.getAttribute("data-firepad-entity");if(!j){j=i.nodeName.toLowerCase()}if(j&&this.entities_[j]){var l=this.entities_[j].fromElement(i);return new d.Entity(j,l)}};g.prototype.tryRenderToElement_=function(i,l,p){var n=i.type,o=i.info;if(this.entities_[n]&&this.entities_[n][l]){var m=d.document||(window&&window.document);var j=this.entities_[n][l](o,p,m);if(j){if(typeof j==="string"){var q=(d.document||document).createElement("div");q.innerHTML=j;return q.childNodes[0]}else{if(typeof j==="object"){d.utils.assert(typeof j.nodeType!=="undefined","Error rendering "+n+" entity.  render() function must return an html string or a DOM element.");return j}}}}};g.prototype.entitySupportsUpdate=function(i){return this.entities_[i]&&this.entities_[i]["update"]};return g})();var d=d||{};d.Entity=(function(){var g=d.AttributeConstants;var j=g.ENTITY_SENTINEL;var h=j+"_";function i(l,m){if(!(this instanceof i)){return new i(l,m)}this.type=l;this.info=m||{}}i.prototype.toAttributes=function(){var m={};m[j]=this.type;for(var l in this.info){m[h+l]=this.info[l]}return m};i.fromAttributes=function(m){var n=m[j];var o={};for(var l in m){if(l.indexOf(h)===0){o[l.substr(h.length)]=m[l]}}return new i(n,o)};return i})();var d=d||{};d.RichTextCodeMirror=(function(){var i=d.AnnotationList;var z=d.Span;var t=d.utils;var y=d.AttributeConstants;var u="cmrt-";var o="cmrt-";var s={c:"color",bc:"background-color",fs:"font-size",li:function(A){return"padding-left: "+(A*40)+"px"}};var j={};function g(D,C,B){this.codeMirror=D;this.options_=B||{};this.entityManager_=C;this.currentAttributes_=null;var A=this;this.annotationList_=new i(function(F,E){A.onAnnotationsChanged_(F,E)});this.initAnnotationList_();x(this,"onCodeMirrorBeforeChange_");x(this,"onCodeMirrorChange_");x(this,"onCursorActivity_");if(/^5\./.test(CodeMirror.version)){this.codeMirror.on("changes",this.onCodeMirrorChange_)}else{this.codeMirror.on("change",this.onCodeMirrorChange_)}this.codeMirror.on("beforeChange",this.onCodeMirrorBeforeChange_);this.codeMirror.on("cursorActivity",this.onCursorActivity_);this.changeId_=0;this.outstandingChanges_={};this.dirtyLines_=[]}t.makeEventEmitter(g,["change","attributesChange","newLine"]);var p=d.sentinelConstants.LINE_SENTINEL_CHARACTER;var q=d.sentinelConstants.ENTITY_SENTINEL_CHARACTER;g.prototype.detach=function(){this.codeMirror.off("beforeChange",this.onCodeMirrorBeforeChange_);this.codeMirror.off("change",this.onCodeMirrorChange_);this.codeMirror.off("changes",this.onCodeMirrorChange_);this.codeMirror.off("cursorActivity",this.onCursorActivity_);this.clearAnnotations_()};g.prototype.toggleAttribute=function(D,E){var A=E||true;if(this.emptySelection_()){var C=this.getCurrentAttributes_();if(C[D]===A){delete C[D]}else{C[D]=A}this.currentAttributes_=C}else{var B=this.getCurrentAttributes_();var F=(B[D]!==A)?A:false;this.setAttribute(D,F)}};g.prototype.setAttribute=function(C,D){var A=this.codeMirror;if(this.emptySelection_()){var B=this.getCurrentAttributes_();if(D===false){delete B[C]}else{B[C]=D}this.currentAttributes_=B}else{this.updateTextAttributes(A.indexFromPos(A.getCursor("start")),A.indexFromPos(A.getCursor("end")),function(E){if(D===false){delete E[C]}else{E[C]=D}});this.updateCurrentAttributes_()}};g.prototype.updateTextAttributes=function(H,C,B,E,F){var A=[];var G=H,D=this;this.annotationList_.updateSpan(new z(H,C-H),function(J,L){var K={};for(var I in J.attributes){K[I]=J.attributes[I]}if(!K[y.LINE_SENTINEL]||F){B(K)}var N={},M={};D.computeChangedAttributes_(J.attributes,K,N,M);if(!l(N)){A.push({start:G,end:G+L,attributes:N,attributesInverse:M,origin:E})}G+=L;return new w(K)});if(A.length>0){this.trigger("attributesChange",this,A)}};g.prototype.computeChangedAttributes_=function(F,C,D,E){var B={},A;for(A in F){B[A]=true}for(A in C){B[A]=true}for(A in B){if(!(A in C)){D[A]=false;E[A]=F[A]}else{if(!(A in F)){D[A]=C[A];E[A]=false}else{if(F[A]!==C[A]){D[A]=C[A];E[A]=F[A]}}}}};g.prototype.toggleLineAttribute=function(B,C){var A=this.getCurrentLineAttributes_();var D;if(!(B in A)||A[B]!==C){D=C}else{D=false}this.setLineAttribute(B,D)};g.prototype.setLineAttribute=function(A,B){this.updateLineAttributesForSelection(function(C){if(B===false){delete C[A]}else{C[A]=B}})};g.prototype.updateLineAttributesForSelection=function(B){var A=this.codeMirror;var H=A.getCursor("start"),C=A.getCursor("end");var F=H.line,D=C.line;var E=A.getLine(D);var G=this.areLineSentinelCharacters_(E.substr(0,C.ch));if(D>F&&G){D--}this.updateLineAttributes(F,D,B)};g.prototype.updateLineAttributes=function(G,D,A){for(var B=G;B<=D;B++){var F=this.codeMirror.getLine(B);var E=this.codeMirror.indexFromPos({line:B,ch:0});if(F[0]!==p){var C={};C[y.LINE_SENTINEL]=true;A(C);this.insertText(E,p,C)}else{this.updateTextAttributes(E,E+1,A,null,true)}}};g.prototype.replaceText=function(A,B,H,C,F){this.changeId_++;var I=o+this.changeId_;this.outstandingChanges_[I]={origOrigin:F,attributes:C};var G=this.codeMirror;var E=G.posFromIndex(A);var D=typeof B==="number"?G.posFromIndex(B):null;G.replaceRange(H,E,D,I)};g.prototype.insertText=function(D,G,C,B){var A=this.codeMirror;var F=A.getCursor();var E=B=="RTCMADAPTER"&&!A.somethingSelected()&&D==A.indexFromPos(F);this.replaceText(D,null,G,C,B);if(E){A.setCursor(F)}};g.prototype.removeText=function(D,B,C){var A=this.codeMirror;A.replaceRange("",A.posFromIndex(D),A.posFromIndex(B),C)};g.prototype.insertEntityAtCursor=function(D,E,B){var A=this.codeMirror;var C=A.indexFromPos(A.getCursor("head"));this.insertEntityAt(C,D,E,B)};g.prototype.insertEntityAt=function(C,D,E,B){var A=this.codeMirror;this.insertEntity_(C,new d.Entity(D,E),B)};g.prototype.insertEntity_=function(C,B,A){this.replaceText(C,null,q,B.toAttributes(),A)};g.prototype.getAttributeSpans=function(E,A){var D=[];var C=this.annotationList_.getAnnotatedSpansForSpan(new z(E,A-E));for(var B=0;B<C.length;B++){D.push({length:C[B].length,attributes:C[B].annotation.attributes})}return D};g.prototype.end=function(){var A=this.codeMirror.lineCount()-1;return this.codeMirror.indexFromPos({line:A,ch:this.codeMirror.getLine(A).length})};g.prototype.getRange=function(D,A){var C=this.codeMirror.posFromIndex(D),B=this.codeMirror.posFromIndex(A);return this.codeMirror.getRange(C,B)};g.prototype.initAnnotationList_=function(){var A=this.end();if(A!==0){this.annotationList_.insertAnnotatedSpan(new z(0,A),new w())}};g.prototype.onAnnotationsChanged_=function(A,E){var H;var C={};this.tryToUpdateEntitiesInPlace(A,E);for(var G=0;G<A.length;G++){var F=A[G].annotation.attributes;if(y.LINE_SENTINEL in F){C[this.codeMirror.posFromIndex(A[G].pos).line]=true}H=A[G].getAttachedObject();if(H){H.clear()}}for(G=0;G<E.length;G++){var B=E[G].annotation;var J=(y.LINE_SENTINEL in B.attributes);var D=(y.ENTITY_SENTINEL in B.attributes);var L=this.codeMirror.posFromIndex(E[G].pos);if(J){C[L.line]=true}else{if(D){this.markEntity_(E[G])}else{var I=this.getClassNameForAttributes_(B.attributes);if(I!==""){var K=this.codeMirror.posFromIndex(E[G].pos+E[G].length);H=this.codeMirror.markText(L,K,{className:I});E[G].attachObject(H)}}}}for(var M in C){this.dirtyLines_.push(this.codeMirror.getLineHandle(Number(M)));this.queueLineMarking_()}};g.prototype.tryToUpdateEntitiesInPlace=function(H,B){var E=H.length;while(E--){var G=H[E];var F=B.length;while(F--){var C=B[F];if(G.pos==C.pos&&G.annotation.attributes.ent&&G.annotation.attributes.ent==C.annotation.attributes.ent){var D=C.annotation.attributes.ent;if(this.entityManager_.entitySupportsUpdate(D)){H.splice(E,1);B.splice(F,1);var A=G.getAttachedObject();A.update(C.annotation.attributes);C.attachObject(A)}}}}};g.prototype.queueLineMarking_=function(){if(this.lineMarkTimeout_!=null){return}var A=this;this.lineMarkTimeout_=setTimeout(function(){A.lineMarkTimeout_=null;var F=[];for(var D=0;D<A.dirtyLines_.length;D++){var E=A.codeMirror.getLineNumber(A.dirtyLines_[D]);F.push(Number(E))}A.dirtyLines_=[];F.sort(function(H,G){return H-G});var C=-1;for(D=0;D<F.length;D++){var B=F[D];if(B>C){C=A.markLineSentinelCharactersForChangedLines_(B,B)}}},0)};g.prototype.addStyleWithCSS_=function(B){var A=document.getElementsByTagName("head")[0],C=document.createElement("style");C.type="text/css";if(C.styleSheet){C.styleSheet.cssText=B}else{C.appendChild(document.createTextNode(B))}A.appendChild(C)};g.prototype.getClassNameForAttributes_=function(D){var E="";for(var G in D){var A=D[G];if(G===y.LINE_SENTINEL){d.utils.assert(A===true,"LINE_SENTINEL attribute should be true if it exists.")}else{var H=(this.options_.cssPrefix||u)+G;if(A!==true){if(G===y.FONT_SIZE&&typeof A!=="string"){A=A+"px"}var I=A.toString().toLowerCase().replace(/[^a-z0-9-_]/g,"-");H+="-"+I;if(s[G]){if(!j[G]){j[G]={}}if(!j[G][I]){j[G][I]=true;var B=s[G];var F=(typeof B==="function")?B(A):B+": "+A;var C=(G==y.LINE_INDENT)?"pre."+H:"."+H;this.addStyleWithCSS_(C+" { "+F+" }")}}}E=E+" "+H}}return E};g.prototype.markEntity_=function(H){var C=H.annotation.attributes;var D=d.Entity.fromAttributes(C);var K=this.codeMirror;var L=this;var B=[];for(var G=0;G<H.length;G++){var J=K.posFromIndex(H.pos+G);var I=K.posFromIndex(H.pos+G+1);var M={collapsed:true,atomic:true,inclusiveLeft:false,inclusiveRight:false};var A=this.createEntityHandle_(D,H.pos);var F=this.entityManager_.renderToElement(D,A);if(F){M.replacedWith=F}var E=K.markText(J,I,M);B.push(E);A.setMarker(E)}H.attachObject({clear:function(){for(var N=0;N<B.length;N++){B[N].clear()}},update:function(P){var N=d.Entity.fromAttributes(P);for(var O=0;O<B.length;O++){L.entityManager_.updateElement(N,B[O].replacedWith)}}});this.queueRefresh_()};g.prototype.queueRefresh_=function(){var A=this;if(!this.refreshTimer_){this.refreshTimer_=setTimeout(function(){A.codeMirror.refresh();A.refreshTimer_=null},0)}};g.prototype.createEntityHandle_=function(F,C){var B=null;var E=this;function H(){if(B){var I=B.find();return I?E.codeMirror.indexFromPos(I.from):null}else{return C}}function A(){var I=H();if(I!=null){E.codeMirror.focus();E.removeText(I,I+1)}}function G(L){var J=d.AttributeConstants;var M=J.ENTITY_SENTINEL;var K=M+"_";var I=H();E.updateTextAttributes(I,I+1,function(O){for(var P in O){delete O[P]}O[M]=F.type;for(var N in L){O[K+N]=L[N]}})}function D(I){B=I}return{find:H,remove:A,replace:G,setMarker:D}};g.prototype.lineClassRemover_=function(C){var A=this.codeMirror;var B=A.getLineHandle(C);return{clear:function(){A.removeLineClass(B,"text",".*")}}};g.prototype.emptySelection_=function(){var B=this.codeMirror.getCursor("start"),A=this.codeMirror.getCursor("end");return(B.line===A.line&&B.ch===A.ch)};g.prototype.onCodeMirrorBeforeChange_=function(A,E){if(E.origin==="+input"||E.origin==="paste"){var D=[];for(var C=0;C<E.text.length;C++){var B=E.text[C];B=B.replace(new RegExp("["+p+q+"]","g"),"");D.push(B)}E.update(E.from,E.to,D)}};function r(B,A){return(B.line-A.line)||(B.ch-A.ch)}function m(B,A){return r(B,A)===0}function v(B,A){return r(B,A)<=0}function n(A){return A[A.length-1]}function h(C){if(C.length===0){return 0}var B=0;for(var A=0;A<C.length;A++){B+=C[A].length}return B+C.length-1}g.prototype.onCodeMirrorChange_=function(O,I){if(typeof I.from==="object"){var D=[];while(I){D.push(I);I=I.next}I=D}var L=this.convertCoordinateSystemForChanges_(I);var P=[];for(var G=0;G<L.length;G++){var K=L[G];var A=K.start,C=K.end,Q=K.text,H=K.removed,N=K.origin;if(H.length>0){var J=this.annotationList_.getAnnotatedSpansForSpan(new z(A,H.length));var B=0;for(var F=0;F<J.length;F++){var M=J[F];P.push({start:A,end:A+M.length,removedAttributes:M.annotation.attributes,removed:H.substr(B,M.length),attributes:{},text:"",origin:K.origin});B+=M.length}this.annotationList_.removeSpan(new z(A,H.length))}if(Q.length>0){var E;if(K.origin==="+input"||K.origin==="paste"){E=this.currentAttributes_||{}}else{if(N in this.outstandingChanges_){E=this.outstandingChanges_[N].attributes;N=this.outstandingChanges_[N].origOrigin;delete this.outstandingChanges_[N]}else{E={}}}this.annotationList_.insertAnnotatedSpan(new z(A,Q.length),new w(E));P.push({start:A,end:A,removedAttributes:{},removed:"",text:Q,attributes:E,origin:N})}}this.markLineSentinelCharactersForChanges_(I);if(P.length>0){this.trigger("change",this,P)}};g.prototype.convertCoordinateSystemForChanges_=function(F){var J=this;var I=function(K){return J.codeMirror.indexFromPos(K)};function D(K,L){return function(M){if(v(M,L.from)){return K(M)}if(v(L.to,M)){return K({line:M.line+L.text.length-1-(L.to.line-L.from.line),ch:(L.to.line<M.line)?M.ch:(L.text.length<=1)?M.ch-(L.to.ch-L.from.ch)+h(L.text):M.ch-L.to.ch+n(L.text).length})+h(L.removed)-h(L.text)}if(L.from.line===M.line){return K(L.from)+M.ch-L.from.ch}return K(L.from)+h(L.removed.slice(0,M.line-L.from.line))+1+M.ch}}var G=[];for(var C=F.length-1;C>=0;C--){var E=F[C];I=D(I,E);var A=I(E.from);var B=E.removed.join("\n");var H=E.text.join("\n");G.unshift({start:A,end:A+B.length,removed:B,text:H,origin:E.origin})}return G};g.prototype.markLineSentinelCharactersForChanges_=function(D){var F=Number.MAX_VALUE,E=-1;for(var B=0;B<D.length;B++){var G=D[B];var A=G.from.line,C=G.from.ch;if(G.removed.length>1||G.removed[0].indexOf(p)>=0){F=Math.min(F,A);E=Math.max(E,A)}if(G.text.length>1){F=Math.min(F,A);E=Math.max(E,A+G.text.length-1)}else{if(G.text[0].indexOf(p)>=0){F=Math.min(F,A);E=Math.max(E,A)}}}E=Math.min(E,this.codeMirror.lineCount()-1);this.markLineSentinelCharactersForChangedLines_(F,E)};g.prototype.markLineSentinelCharactersForChangedLines_=function(I,B){if(I<Number.MAX_VALUE){while(I>0&&this.lineIsListItemOrIndented_(I-1)){I--}}if(B>-1){var K=this.codeMirror.lineCount();while(B+1<K&&this.lineIsListItemOrIndented_(B+1)){B++}}var E=[];var H=this.codeMirror;for(var L=I;L<=B;L++){var J=H.getLine(L);var D=H.getLineHandle(L);H.removeLineClass(D,"text",".*");if(J.length>0){var F=J.indexOf(p);while(F>=0){var A=F;while(F<J.length&&J[F]===p){var G=H.findMarksAt({line:L,ch:F});for(var C=0;C<G.length;C++){if(G[C].isForLineSentinel){G[C].clear()}}F++}this.markLineSentinelCharacters_(L,A,F,E);F=J.indexOf(p,F)}}else{E=[]}}return B};g.prototype.markLineSentinelCharacters_=function(M,L,G,I){var K=this.codeMirror;var E=null;var F=null;var C=function(){var N=F.find();return N?N.from.line:null};if(L===0){var D=this.getLineAttributes_(M);var J=D[y.LIST_TYPE];var B=D[y.LINE_INDENT]||0;if(J&&B===0){B=1}while(B>=I.length){I.push(1)}if(J==="o"){E=this.makeOrderedListElement_(I[B]);I[B]++}else{if(J==="u"){E=this.makeUnorderedListElement_();I[B]=1}else{if(J==="t"){E=this.makeTodoListElement_(false,C);I[B]=1}else{if(J==="tc"){E=this.makeTodoListElement_(true,C);I[B]=1}}}}var H=this.getClassNameForAttributes_(D);if(H!==""){this.codeMirror.addLineClass(M,"text",H)}I=I.slice(0,B+1)}var A={inclusiveLeft:true,collapsed:true};if(E){A.replacedWith=E}var F=K.markText({line:M,ch:L},{line:M,ch:G},A);F.isForLineSentinel=true};g.prototype.makeOrderedListElement_=function(A){return t.elt("div",A+".",{"class":"firepad-list-left"})};g.prototype.makeUnorderedListElement_=function(){return t.elt("div","\u2022",{"class":"firepad-list-left"})};g.prototype.toggleTodo=function(C){var B=y.LIST_TYPE;var A=this.getCurrentLineAttributes_();var D;if(!(B in A)||((A[B]!=="t")&&(A[B]!=="tc"))){D="t"}else{if(A[B]==="t"){D="tc"}else{if(A[B]==="tc"){D=C?"t":false}}}this.setLineAttribute(B,D)};g.prototype.makeTodoListElement_=function(D,B){var E={type:"checkbox","class":"firepad-todo-left"};if(D){E.checked=true}var C=t.elt("input",false,E);var A=this;t.on(C,"click",t.stopEventAnd(function(F){A.codeMirror.setCursor({line:B(),ch:1});A.toggleTodo(true)}));return C};g.prototype.lineIsListItemOrIndented_=function(B){var A=this.getLineAttributes_(B);return((A[y.LIST_TYPE]||false)!==false)||((A[y.LINE_INDENT]||0)!==0)};g.prototype.onCursorActivity_=function(){var A=this;clearTimeout(A.cursorTimeout);A.cursorTimeout=setTimeout(function(){A.updateCurrentAttributes_()},1)};g.prototype.getCurrentAttributes_=function(){if(!this.currentAttributes_){this.updateCurrentAttributes_()}return this.currentAttributes_};g.prototype.updateCurrentAttributes_=function(){var B=this.codeMirror;var D=B.indexFromPos(B.getCursor("anchor")),F=B.indexFromPos(B.getCursor("head"));var H=F;if(D>F){while(H<this.end()){var G=this.getRange(H,H+1);if(G!=="\n"&&G!==p){break}H++}if(H<this.end()){H++}}else{while(H>0){G=this.getRange(H-1,H);if(G!=="\n"&&G!==p){break}H--}}var E=this.annotationList_.getAnnotatedSpansForPos(H);this.currentAttributes_={};var C={};if(E.length>0&&(!(y.LINE_SENTINEL in E[0].annotation.attributes))){C=E[0].annotation.attributes}else{if(E.length>1){d.utils.assert(!(y.LINE_SENTINEL in E[1].annotation.attributes),"Cursor can't be between two line sentinel characters.");C=E[1].annotation.attributes}}for(var A in C){if(A!=="l"&&A!=="lt"&&A!=="li"&&A.indexOf(y.ENTITY_SENTINEL)!==0){this.currentAttributes_[A]=C[A]}}};g.prototype.getCurrentLineAttributes_=function(){var A=this.codeMirror;var C=A.getCursor("anchor"),D=A.getCursor("head");var B=D.line;if(D.ch===0&&C.line<D.line){B--}return this.getLineAttributes_(B)};g.prototype.getLineAttributes_=function(F){var C={};var B=this.codeMirror.getLine(F);if(B.length>0&&B[0]===p){var E=this.codeMirror.indexFromPos({line:F,ch:0});var D=this.annotationList_.getAnnotatedSpansForSpan(new z(E,1));d.utils.assert(D.length===1);for(var A in D[0].annotation.attributes){C[A]=D[0].annotation.attributes[A]}}return C};g.prototype.clearAnnotations_=function(){this.annotationList_.updateSpan(new z(0,this.end()),function(A,B){return new w({})})};g.prototype.newline=function(){var A=this.codeMirror;var C=this;if(!this.emptySelection_()){A.replaceSelection("\n","end","+input")}else{var E=A.getCursor("head").line;var B=this.getLineAttributes_(E);var D=B[y.LIST_TYPE];if(D&&A.getLine(E).length===1){this.updateLineAttributes(E,E,function(F){delete F[y.LIST_TYPE];delete F[y.LINE_INDENT]})}else{A.replaceSelection("\n","end","+input");this.updateLineAttributes(E+1,E+1,function(G){for(var F in B){G[F]=B[F]}if(D==="tc"){G[y.LIST_TYPE]="t"}C.trigger("newLine",{line:E+1,attr:G})})}}};g.prototype.deleteLeft=function(){var B=this.codeMirror;var F=B.getCursor("head");var C=this.getLineAttributes_(F.line);var D=C[y.LIST_TYPE];var A=C[y.LINE_INDENT];var E=this.emptySelection_()&&F.ch===1;if(E&&D){this.updateLineAttributes(F.line,F.line,function(G){delete G[y.LIST_TYPE];delete G[y.LINE_INDENT]})}else{if(E&&A&&A>0){this.updateLineAttributes(F.line,F.line,function(G){G[y.LINE_INDENT]--})}else{B.deleteH(-1,"char")}}};g.prototype.deleteRight=function(){var A=this.codeMirror;var E=A.getCursor("head");var D=A.getLine(E.line);var B=this.areLineSentinelCharacters_(D);var C=(E.line+1<A.lineCount())?A.getLine(E.line+1):"";if(this.emptySelection_()&&B&&C[0]===p){A.replaceRange("",{line:E.line,ch:0},{line:E.line+1,ch:0},"+input")}else{A.deleteH(1,"char")}};g.prototype.indent=function(){this.updateLineAttributesForSelection(function(B){var A=B[y.LINE_INDENT];var C=B[y.LIST_TYPE];if(A){B[y.LINE_INDENT]++}else{if(C){B[y.LINE_INDENT]=2}else{B[y.LINE_INDENT]=1}}})};g.prototype.unindent=function(){this.updateLineAttributesForSelection(function(B){var A=B[y.LINE_INDENT];if(A&&A>1){B[y.LINE_INDENT]=A-1}else{delete B[y.LIST_TYPE];delete B[y.LINE_INDENT]}})};g.prototype.getText=function(){return this.codeMirror.getValue().replace(new RegExp(p,"g"),"")};g.prototype.areLineSentinelCharacters_=function(B){for(var A=0;A<B.length;A++){if(B[A]!==p){return false}}return true};function w(A){this.attributes=A||{}}w.prototype.equals=function(B){if(!(B instanceof w)){return false}var A;for(A in this.attributes){if(B.attributes[A]!==this.attributes[A]){return false}}for(A in B.attributes){if(B.attributes[A]!==this.attributes[A]){return false}}return true};function l(B){for(var A in B){return false}return true}function x(B,C){var A=B[C];B[C]=function(){A.apply(B,arguments)}}return g})();var d=d||{};d.RichTextCodeMirrorAdapter=(function(){var o=d.TextOperation;var l=d.WrappedOperation;var r=d.Cursor;function h(s){this.rtcm=s;this.cm=s.codeMirror;q(this,"onChange");q(this,"onAttributesChange");q(this,"onCursorActivity");q(this,"onFocus");q(this,"onBlur");this.rtcm.on("change",this.onChange);this.rtcm.on("attributesChange",this.onAttributesChange);this.cm.on("cursorActivity",this.onCursorActivity);this.cm.on("focus",this.onFocus);this.cm.on("blur",this.onBlur)}h.prototype.detach=function(){this.rtcm.off("change",this.onChange);this.rtcm.off("attributesChange",this.onAttributesChange);this.cm.off("cursorActivity",this.onCursorActivity);this.cm.off("focus",this.onFocus);this.cm.off("blur",this.onBlur)};function m(t,s){if(t.line<s.line){return -1}if(t.line>s.line){return 1}if(t.ch<s.ch){return -1}if(t.ch>s.ch){return 1}return 0}function j(t,s){return m(t,s)===0}function n(t,s){return m(t,s)<=0}function p(s){var t=s.lineCount()-1;return s.indexFromPos({line:t,ch:s.getLine(t).length})}h.operationFromCodeMirrorChanges=function(x,A){var z=p(A);var t=new o().retain(z);var u=new o().retain(z);for(var v=x.length-1;v>=0;v--){var w=x[v];var y=w.start;var s=z-y-w.text.length;t=new o().retain(y)["delete"](w.removed.length).insert(w.text,w.attributes).retain(s).compose(t);u=u.compose(new o().retain(y)["delete"](w.text.length).insert(w.removed,w.removedAttributes).retain(s));z+=w.removed.length-w.text.length}return[t,u]};h.operationFromAttributesChanges=function(z,B){var A=p(B);var u=new o(),v=new o();var x=0;for(var w=0;w<z.length;w++){var y=z[w];var t=y.start-x;g(t>=0);u.retain(t);v.retain(t);var s=y.end-y.start;u.retain(s,y.attributes);v.retain(s,y.attributesInverse);x=y.start+s}u.retain(A-x);v.retain(A-x);return[u,v]};h.applyOperationToCodeMirror=function(t,x){if(t.ops.length>10){x.codeMirror.getWrapperElement().setAttribute("style","display: none")}var w=t.ops;var u=0;for(var v=0,s=w.length;v<s;v++){var y=w[v];if(y.isRetain()){if(!i(y.attributes)){x.updateTextAttributes(u,u+y.chars,function(A){for(var z in y.attributes){if(y.attributes[z]===false){delete A[z]}else{A[z]=y.attributes[z]}}},"RTCMADAPTER",true)}u+=y.chars}else{if(y.isInsert()){x.insertText(u,y.text,y.attributes,"RTCMADAPTER");u+=y.text.length}else{if(y.isDelete()){x.removeText(u,u+y.chars,"RTCMADAPTER")}}}}if(t.ops.length>10){x.codeMirror.getWrapperElement().setAttribute("style","");x.codeMirror.refresh()}};h.prototype.registerCallbacks=function(s){this.callbacks=s};h.prototype.onChange=function(s,t){if(t[0].origin!=="RTCMADAPTER"){var u=h.operationFromCodeMirrorChanges(t,this.cm);this.trigger("change",u[0],u[1])}};h.prototype.onAttributesChange=function(s,t){if(t[0].origin!=="RTCMADAPTER"){var u=h.operationFromAttributesChanges(t,this.cm);this.trigger("change",u[0],u[1])}};h.prototype.onCursorActivity=function(){this.trigger("cursorActivity")};h.prototype.onFocus=function(){this.trigger("focus")};h.prototype.onBlur=function(){if(!this.cm.somethingSelected()){this.trigger("blur")}};h.prototype.getValue=function(){return this.cm.getValue()};h.prototype.getCursor=function(){var t=this.cm;var x=t.getCursor();var s=t.indexFromPos(x);var w;if(t.somethingSelected()){var u=t.getCursor(true);var v=j(x,u)?t.getCursor(false):u;w=t.indexFromPos(v)}else{w=s}return new r(s,w)};h.prototype.setCursor=function(s){this.cm.setSelection(this.cm.posFromIndex(s.position),this.cm.posFromIndex(s.selectionEnd))};h.prototype.addStyleRule=function(t){if(typeof document==="undefined"||document===null){return}if(!this.addedStyleRules){this.addedStyleRules={};var s=document.createElement("style");document.documentElement.getElementsByTagName("head")[0].appendChild(s);this.addedStyleSheet=s.sheet}if(this.addedStyleRules[t]){return}this.addedStyleRules[t]=true;return this.addedStyleSheet.insertRule(t,0)};h.prototype.setOtherCursor=function(B,u,s){var w=this.cm.posFromIndex(B.position);if(typeof u!=="string"||!u.match(/^#[a-fA-F0-9]{3,6}$/)){return}var v=this.rtcm.end();if(typeof B!=="object"||typeof B.position!=="number"||typeof B.selectionEnd!=="number"){return}if(B.position<0||B.position>v||B.selectionEnd<0||B.selectionEnd>v){return}if(B.position===B.selectionEnd){var t=this.cm.cursorCoords(w);var A=document.createElement("span");A.className="other-client";A.style.borderLeftWidth="2px";A.style.borderLeftStyle="solid";A.style.borderLeftColor=u;A.style.marginLeft=A.style.marginRight="-1px";A.style.height=(t.bottom-t.top)*0.9+"px";A.setAttribute("data-clientid",s);A.style.zIndex=0;return this.cm.setBookmark(w,{widget:A,insertLeft:true})}else{var x="selection-"+u.replace("#","");var z="."+x+" { background: "+u+"; }";this.addStyleRule(z);var C,y;if(B.selectionEnd>B.position){C=w;y=this.cm.posFromIndex(B.selectionEnd)}else{C=this.cm.posFromIndex(B.selectionEnd);y=w}return this.cm.markText(C,y,{className:x})}};h.prototype.trigger=function(t){var s=Array.prototype.slice.call(arguments,1);var u=this.callbacks&&this.callbacks[t];if(u){u.apply(this,s)}};h.prototype.applyOperation=function(s){h.applyOperationToCodeMirror(s,this.rtcm)};h.prototype.registerUndo=function(s){this.cm.undo=s};h.prototype.registerRedo=function(s){this.cm.redo=s};h.prototype.invertOperation=function(v){var B=0,C=this.rtcm.codeMirror,A,x;var w=new o();for(var E=0;E<v.wrapped.ops.length;E++){var y=v.wrapped.ops[E];if(y.isRetain()){if(i(y.attributes)){w.retain(y.chars);B+=y.chars}else{A=this.rtcm.getAttributeSpans(B,B+y.chars);for(x=0;x<A.length;x++){var t={};for(var z in y.attributes){var s=y.attributes[z];var u=A[x].attributes[z];if(s===false){if(u){t[z]=u}}else{if(s!==u){t[z]=u||false}}}w.retain(A[x].length,t);B+=A[x].length}}}else{if(y.isInsert()){w["delete"](y.text.length)}else{if(y.isDelete()){var D=C.getRange(C.posFromIndex(B),C.posFromIndex(B+y.chars));A=this.rtcm.getAttributeSpans(B,B+y.chars);var F=0;for(x=0;x<A.length;x++){w.insert(D.substr(F,A[x].length),A[x].attributes);F+=A[x].length}B+=y.chars}}}}return new l(w,v.meta.invert())};function g(s,t){if(!s){throw new Error(t||"assertion error")}}function q(t,u){var s=t[u];t[u]=function(){s.apply(t,arguments)}}function i(t){for(var s in t){return false}return true}return h}());var d=d||{};d.Formatting=(function(){var g=d.AttributeConstants;function h(i){if(!(this instanceof h)){return new h(i)}this.attributes=i||{}}h.prototype.cloneWithNewAttribute_=function(l,m){var j={};for(var i in this.attributes){j[i]=this.attributes[i]}if(m===false){delete j[l]}else{j[l]=m}return new h(j)};h.prototype.bold=function(i){return this.cloneWithNewAttribute_(g.BOLD,i)};h.prototype.italic=function(i){return this.cloneWithNewAttribute_(g.ITALIC,i)};h.prototype.underline=function(i){return this.cloneWithNewAttribute_(g.UNDERLINE,i)};h.prototype.strike=function(i){return this.cloneWithNewAttribute_(g.STRIKE,i)};h.prototype.font=function(i){return this.cloneWithNewAttribute_(g.FONT,i)};h.prototype.fontSize=function(i){return this.cloneWithNewAttribute_(g.FONT_SIZE,i)};h.prototype.color=function(i){return this.cloneWithNewAttribute_(g.COLOR,i)};h.prototype.backgroundColor=function(i){return this.cloneWithNewAttribute_(g.BACKGROUND_COLOR,i)};return h})();var d=d||{};d.Text=(function(){function g(i,h){if(!(this instanceof g)){return new g(i,h)}this.text=i;this.formatting=h||d.Formatting()}return g})();var d=d||{};d.LineFormatting=(function(){var h=d.AttributeConstants;function g(i){if(!(this instanceof g)){return new g(i)}this.attributes=i||{};this.attributes[h.LINE_SENTINEL]=true}g.LIST_TYPE={NONE:false,ORDERED:"o",UNORDERED:"u",TODO:"t",TODOCHECKED:"tc"};g.prototype.cloneWithNewAttribute_=function(l,m){var j={};for(var i in this.attributes){j[i]=this.attributes[i]}if(m===false){delete j[l]}else{j[l]=m}return new g(j)};g.prototype.indent=function(i){return this.cloneWithNewAttribute_(h.LINE_INDENT,i)};g.prototype.align=function(i){return this.cloneWithNewAttribute_(h.LINE_ALIGN,i)};g.prototype.listItem=function(i){d.utils.assert(i===false||i==="u"||i==="o"||i==="t"||i==="tc");return this.cloneWithNewAttribute_(h.LIST_TYPE,i)};g.prototype.getIndent=function(){return this.attributes[h.LINE_INDENT]||0};g.prototype.getAlign=function(){return this.attributes[h.LINE_ALIGN]||0};g.prototype.getListItem=function(){return this.attributes[h.LIST_TYPE]||false};return g})();var d=d||{};d.Line=(function(){function g(i,h){if(!(this instanceof g)){return new g(i,h)}if(Object.prototype.toString.call(i)!=="[object Array]"){if(typeof i==="undefined"){i=[]}else{i=[i]}}this.textPieces=i;this.formatting=h||d.LineFormatting()}return g})();var d=d||{};d.ParseHtml=(function(){var q=d.LineFormatting.LIST_TYPE;function m(t,s,r){this.listType=t||q.UNORDERED;this.lineFormatting=s||d.LineFormatting();this.textFormatting=r||d.Formatting()}m.prototype.withTextFormatting=function(r){return new m(this.listType,this.lineFormatting,r)};m.prototype.withLineFormatting=function(r){return new m(this.listType,r,this.textFormatting)};m.prototype.withListType=function(r){return new m(r,this.lineFormatting,this.textFormatting)};m.prototype.withIncreasedIndent=function(){var r=this.lineFormatting.indent(this.lineFormatting.getIndent()+1);return new m(this.listType,r,this.textFormatting)};m.prototype.withAlign=function(s){var r=this.lineFormatting.align(s);return new m(this.listType,r,this.textFormatting)};function p(){this.lines=[];this.currentLine=[];this.currentLineListItemType=null}p.prototype.newlineIfNonEmpty=function(r){this.cleanLine_();if(this.currentLine.length>0){this.newline(r)}};p.prototype.newlineIfNonEmptyOrListItem=function(r){this.cleanLine_();if(this.currentLine.length>0||this.currentLineListItemType!==null){this.newline(r)}};p.prototype.newline=function(s){this.cleanLine_();var r=s.lineFormatting;if(this.currentLineListItemType!==null){r=r.listItem(this.currentLineListItemType);this.currentLineListItemType=null}this.lines.push(d.Line(this.currentLine,r));this.currentLine=[]};p.prototype.makeListItem=function(r){this.currentLineListItemType=r};p.prototype.cleanLine_=function(){if(this.currentLine.length>0){var s=this.currentLine.length-1;this.currentLine[0].text=this.currentLine[0].text.replace(/^ +/,"");this.currentLine[s].text=this.currentLine[s].text.replace(/ +$/g,"");for(var r=0;r<this.currentLine.length;r++){this.currentLine[r].text=this.currentLine[r].text.replace(/\u00a0/g," ")}}if(this.currentLine.length===1&&this.currentLine[0].text===""){this.currentLine=[]}};var g;function i(s,t){var v=(d.document||document).createElement("div");v.innerHTML=s;g=t;var r=new p();var u=new m();h(v,u,r);return r.lines}var n=n||{ELEMENT_NODE:1,TEXT_NODE:3};function h(u,r,t){if(u.nodeType===n.ELEMENT_NODE){var w=g.fromElement(u);if(w){t.currentLine.push(new d.Text(d.sentinelConstants.ENTITY_SENTINEL_CHARACTER,new d.Formatting(w.toAttributes())));return}}switch(u.nodeType){case n.TEXT_NODE:var z=u.nodeValue.replace(/[ \n\t]+/g," ");t.currentLine.push(d.Text(z,r.textFormatting));break;case n.ELEMENT_NODE:var s=u.getAttribute("style")||"";r=o(r,s);switch(u.nodeName.toLowerCase()){case"div":case"h1":case"h2":case"h3":case"p":t.newlineIfNonEmpty(r);l(u,r,t);t.newlineIfNonEmpty(r);break;case"center":r=r.withAlign("center");t.newlineIfNonEmpty(r);l(u,r.withAlign("center"),t);t.newlineIfNonEmpty(r);break;case"b":case"strong":l(u,r.withTextFormatting(r.textFormatting.bold(true)),t);break;case"u":l(u,r.withTextFormatting(r.textFormatting.underline(true)),t);break;case"i":case"em":l(u,r.withTextFormatting(r.textFormatting.italic(true)),t);break;case"s":l(u,r.withTextFormatting(r.textFormatting.strike(true)),t);break;case"font":var x=u.getAttribute("face");var v=u.getAttribute("color");var A=parseInt(u.getAttribute("size"));if(x){r=r.withTextFormatting(r.textFormatting.font(x))}if(v){r=r.withTextFormatting(r.textFormatting.color(v))}if(A){r=r.withTextFormatting(r.textFormatting.fontSize(A))}l(u,r,t);break;case"br":t.newline(r);break;case"ul":t.newlineIfNonEmptyOrListItem(r);var y=u.getAttribute("class")==="firepad-todo"?q.TODO:q.UNORDERED;l(u,r.withListType(y).withIncreasedIndent(),t);t.newlineIfNonEmpty(r);break;case"ol":t.newlineIfNonEmptyOrListItem(r);l(u,r.withListType(q.ORDERED).withIncreasedIndent(),t);t.newlineIfNonEmpty(r);break;case"li":j(u,r,t);break;case"style":break;default:l(u,r,t);break}break;default:break}}function l(t,u,r){if(t.hasChildNodes()){for(var s=0;s<t.childNodes.length;s++){h(t.childNodes[s],u,r)}}}function j(u,v,r){r.newlineIfNonEmptyOrListItem(v);var t=(u.getAttribute("class")==="firepad-checked")?q.TODOCHECKED:v.listType;r.makeListItem(t);var s=r.currentLine;l(u,v,r);if(s===r.currentLine||r.currentLine.length>0){r.newline(v)}}function o(s,E){var w=s.textFormatting;var x=s.lineFormatting;var F=E.split(";");for(var y=0;y<F.length;y++){var D=F[y].split(":");if(D.length!==2){continue}var r=d.utils.trim(D[0]).toLowerCase();var v=d.utils.trim(D[1]).toLowerCase();switch(r){case"text-decoration":var t=v.indexOf("underline")>=0;var C=v.indexOf("line-through")>=0;w=w.underline(t).strike(C);break;case"font-weight":var B=(v==="bold")||parseInt(v)>=600;w=w.bold(B);break;case"font-style":var z=(v==="italic"||v==="oblique");w=w.italic(z);break;case"color":w=w.color(v);break;case"background-color":w=w.backgroundColor(v);break;case"text-align":x=x.align(v);break;case"font-size":var G=null;var A=["px","pt","%","em","xx-small","x-small","small","medium","large","x-large","xx-large","smaller","larger"];if(d.utils.stringEndsWith(v,A)){G=v}else{if(parseInt(v)){G=parseInt(v)+"px"}}if(G){w=w.fontSize(G)}break;case"font-family":var u=d.utils.trim(v.split(",")[0]);u=u.replace(/['"]/g,"");u=u.replace(/\w\S*/g,function(H){return H.charAt(0).toUpperCase()+H.substr(1).toLowerCase()});w=w.font(u);break}}return s.withLineFormatting(x).withTextFormatting(w)}return i})();var d=d||{};d.SerializeHtml=(function(){var o=d.utils;var j=d.AttributeConstants;var n=d.LineFormatting.LIST_TYPE;var g='<style>ul.firepad-todo { list-style: none; margin-left: 0; padding-left: 0; } ul.firepad-todo > li { padding-left: 1em; text-indent: -1em; } ul.firepad-todo > li:before { content: "\\2610"; padding-right: 5px; } ul.firepad-todo > li.firepad-checked:before { content: "\\2611"; padding-right: 5px; }</style>\n';function i(q){return(q===n.ORDERED)?"<ol>":(q===n.UNORDERED)?"<ul>":'<ul class="firepad-todo">'}function p(q){return(q===n.ORDERED)?"</ol>":"</ul>"}function h(r,q){return(r===q)||(r===n.TODO&&q===n.TODOCHECKED)||(r===n.TODOCHECKED&&q===n.TODO)}function l(q){return q.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;")}function m(S,w){var B="";var R=true;var K=[];var x=false;var E=true;var y=true;var O=0,z=S.ops[O];var A=false;while(z){o.assert(z.isInsert());var H=z.attributes;if(R){R=false;var C=0,P=null,r="left";if(j.LINE_SENTINEL in H){C=H[j.LINE_INDENT]||0;P=H[j.LIST_TYPE]||null;r=H[j.LINE_ALIGN]||"left"}if(P){C=C||1}if(x){B+="</li>";x=false}else{if(!E){if(y){B+="<br/>"}B+="</div>"}}E=false;o.assert(C>=0,"Indent must not be negative.");while(K.length>C||(C===K.length&&P!==null&&!h(P,K[K.length-1]))){B+=p(K.pop())}while(K.length<C){var F=P||n.UNORDERED;A=P==n.TODO||P==n.TODOCHECKED||A;B+=i(F);K.push(F)}var Q=(r!=="left")?' style="text-align:'+r+'"':"";if(P){var N="";switch(P){case n.TODOCHECKED:N=' class="firepad-checked"';break;case n.TODO:N=' class="firepad-unchecked"';break}B+="<li"+N+Q+">";x=true}else{B+="<div"+Q+">"}y=true}if(j.LINE_SENTINEL in H){z=S.ops[++O];continue}if(j.ENTITY_SENTINEL in H){for(var M=0;M<z.text.length;M++){var D=d.Entity.fromAttributes(H);var q=w.exportToElement(D);B+=q.outerHTML}z=S.ops[++O];continue}var L="",s="";for(var J in H){var I=H[J];var u,t;if(J===j.BOLD||J===j.ITALIC||J===j.UNDERLINE||J===j.STRIKE){o.assert(I===true);u=t=J}else{if(J===j.FONT_SIZE){u='span style="font-size: '+I;u+=(typeof I!=="string"||I.indexOf("px",I.length-2)===-1)?'px"':'"';t="span"}else{if(J===j.FONT){u='span style="font-family: '+I+'"';t="span"}else{if(J===j.COLOR){u='span style="color: '+I+'"';t="span"}else{if(J===j.BACKGROUND_COLOR){u='span style="background-color: '+I+'"';t="span"}else{o.log(false,"Encountered unknown attribute while rendering html: "+J)}}}}}if(u){L+="<"+u+">"}if(t){s="</"+t+">"+s}}var G=z.text;var v=G.indexOf("\n");if(v>=0){R=true;if(v<G.length-1){z=new d.TextOp("insert",G.substr(v+1),H)}else{z=S.ops[++O]}G=G.substr(0,v)}else{z=S.ops[++O]}G=G.replace(/  +/g,function(T){return new Array(T.length+1).join("\u00a0")}).replace(/^ /,"\u00a0").replace(/ $/,"\u00a0");if(G.length>0){y=false}B+=L+l(G)+s}if(x){B+="</li>"}else{if(!E){if(y){B+="&nbsp;"}B+="</div>"}}while(K.length>0){B+=p(K.pop())}if(A){B=g+B}return B}return m})();var d=d||{};d.textPiecesToInserts=function(m,j){var h=[];function l(o,i){if(o instanceof d.Text){i=o.formatting.attributes;o=o.text}h.push({string:o,attributes:i});m=o[o.length-1]==="\n"}function n(o){if(m){l(d.sentinelConstants.LINE_SENTINEL_CHARACTER,o.formatting.attributes)}for(var p=0;p<o.textPieces.length;p++){l(o.textPieces[p])}l("\n")}for(var g=0;g<j.length;g++){if(j[g] instanceof d.Line){n(j[g])}else{l(j[g])}}return h};var d=d||{};d.Headless=(function(){var j=d.TextOperation;var i=d.FirebaseAdapter;var h=d.EntityManager;var g=d.ParseHtml;function l(m){if(!(this instanceof l)){return new l(m)}this.adapter=new i(m);this.ready=false;this.entityManager=new h()}l.prototype.getDocument=function(n){var m=this;if(m.ready){return n(m.adapter.getDocument())}m.adapter.on("ready",function(){m.ready=true;n(m.adapter.getDocument())})};l.prototype.getText=function(m){this.getDocument(function(n){var o=n.apply("");for(key in d.sentinelConstants){o=o.replace(new RegExp(d.sentinelConstants[key],"g"),"")}m(o)})};l.prototype.setText=function(m,o){var n=j().insert(m);this.sendOperationWithRetry(n,o)};l.prototype.initializeFakeDom=function(m){if(typeof document==="object"||typeof d.document==="object"){m()}else{require("jsdom").env("<head></head><body></body>",function(o,n){if(d.document){n.close();return m()}d.document=n.document;m()})}};l.prototype.getHtml=function(n){var m=this;m.initializeFakeDom(function(){m.getDocument(function(o){n(d.SerializeHtml(o,this.entityManager))})})};l.prototype.setHtml=function(n,o){var m=this;m.initializeFakeDom(function(){var r=g(n,m.entityManager);var q=d.textPiecesToInserts(true,r);var s=new j();for(var p=0;p<q.length;p++){s.insert(q[p].string,q[p].attributes)}m.sendOperationWithRetry(s,o)})};l.prototype.sendOperationWithRetry=function(n,o){var m=this;m.getDocument(function(p){var q=n.clone()["delete"](p.targetLength);m.adapter.sendOperation(q,function(s,r){if(r){if(typeof o!=="undefined"){o(null,r)}}else{m.sendOperationWithRetry(n,o)}})})};return l})();var d=d||{};d.Firepad=(function(h){if(!d.RichTextCodeMirrorAdapter){throw new Error("Oops! It looks like you're trying to include lib/firepad.js directly.  This is actually one of many source files that make up firepad.  You want dist/firepad.js instead.")}var l=d.RichTextCodeMirrorAdapter;var o=d.RichTextCodeMirror;var x=d.RichTextToolbar;var t=d.ACEAdapter;var w=d.FirebaseAdapter;var s=d.EditorClient;var i=d.EntityManager;var q=d.AttributeConstants;var v=d.utils;var u=d.LineFormatting.LIST_TYPE;var n=h.CodeMirror;var m=h.ace;function j(E,y,A){if(!(this instanceof j)){return new j(E,y,A)}if(!n&&!m){throw new Error("Couldn't find CodeMirror or ACE.  Did you forget to include codemirror.js or ace.js?")}if(n&&y instanceof n){this.codeMirror_=this.editor_=y;var F=this.codeMirror_.getValue();if(F!==""){throw new Error("Can't initialize Firepad with a CodeMirror instance that already contains text.")}}else{if(m&&y&&y.session instanceof m.EditSession){this.ace_=this.editor_=y;F=this.ace_.getValue();if(F!==""){throw new Error("Can't initialize Firepad with an ACE instance that already contains text.")}}else{this.codeMirror_=this.editor_=new n(y)}}var D=this.codeMirror_?this.codeMirror_.getWrapperElement():this.ace_.container;this.firepadWrapper_=v.elt("div",null,{"class":"firepad"});D.parentNode.replaceChild(this.firepadWrapper_,D);this.firepadWrapper_.appendChild(D);v.on(D,"dragstart",v.stopEvent);this.editor_.firepad=this;this.options_=A||{};if(this.getOption("richTextShortcuts",false)){if(!n.keyMap.richtext){this.initializeKeyMap_()}this.codeMirror_.setOption("keyMap","richtext");this.firepadWrapper_.className+=" firepad-richtext"}this.imageInsertionUI=this.getOption("imageInsertionUI",true);if(this.getOption("richTextToolbar",false)){this.addToolbar_();this.firepadWrapper_.className+=" firepad-richtext firepad-with-toolbar"}this.addPoweredByLogo_();if(this.codeMirror_){this.codeMirror_.refresh()}var C=this.getOption("userId",E.push().key());var B=this.getOption("userColor",r(C));this.entityManager_=new i();this.firebaseAdapter_=new w(E,C,B);if(this.codeMirror_){this.richTextCodeMirror_=new o(this.codeMirror_,this.entityManager_,{cssPrefix:"firepad-"});this.editorAdapter_=new l(this.richTextCodeMirror_)}else{this.editorAdapter_=new t(this.ace_)}this.client_=new s(this.firebaseAdapter_,this.editorAdapter_);var z=this;this.firebaseAdapter_.on("cursor",function(){z.trigger.apply(z,["cursor"].concat([].slice.call(arguments)))});if(this.codeMirror_){this.richTextCodeMirror_.on("newLine",function(){z.trigger.apply(z,["newLine"].concat([].slice.call(arguments)))})}this.firebaseAdapter_.on("ready",function(){z.ready_=true;if(this.ace_){this.editorAdapter_.grabDocumentState()}var G=z.getOption("defaultText",null);if(G&&z.isHistoryEmpty()){z.setText(G)}z.trigger("ready")});this.client_.on("synced",function(G){z.trigger("synced",G)});if(navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.match(/MSIE 8\./)){window.onload=function(){var G=document.getElementsByTagName("head")[0],H=document.createElement("style");H.type="text/css";H.styleSheet.cssText=":before,:after{content:none !important;}";G.appendChild(H);setTimeout(function(){G.removeChild(H)},0)}}}v.makeEventEmitter(j);j.fromCodeMirror=j;j.fromACE=j;j.prototype.dispose=function(){this.zombie_=true;var y=this.codeMirror_?this.codeMirror_.getWrapperElement():this.ace_.container;this.firepadWrapper_.removeChild(y);this.firepadWrapper_.parentNode.replaceChild(y,this.firepadWrapper_);this.editor_.firepad=null;if(this.codeMirror_&&this.codeMirror_.getOption("keyMap")==="richtext"){this.codeMirror_.setOption("keyMap","default")}this.firebaseAdapter_.dispose();this.editorAdapter_.detach();if(this.richTextCodeMirror_){this.richTextCodeMirror_.detach()}};j.prototype.setReadOnly=function(y){this.firebaseAdapter_.setReadOnly(y)};j.prototype.setUserId=function(y){this.firebaseAdapter_.setUserId(y)};j.prototype.setUserColor=function(y){this.firebaseAdapter_.setColor(y)};j.prototype.getText=function(){this.assertReady_("getText");if(this.codeMirror_){return this.richTextCodeMirror_.getText()}else{return this.ace_.getSession().getDocument().getValue()}};j.prototype.setText=function(y){if(this.ace_){return this.ace_.getSession().getDocument().setValue(y)}else{this.codeMirror_.getWrapperElement().setAttribute("style","display: none");this.codeMirror_.setValue("");this.insertText(0,y);this.codeMirror_.getWrapperElement().setAttribute("style","");this.codeMirror_.refresh()}};j.prototype.insertTextAtCursor=function(y){this.insertText(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),y)};j.prototype.insertText=function(A,D){v.assert(!this.ace_,"Not supported for ace yet.");this.assertReady_("insertText");if(Object.prototype.toString.call(D)!=="[object Array]"){D=[D]}var E=A===0;var C=d.textPiecesToInserts(E,D);for(var B=0;B<C.length;B++){var z=C[B].string;var y=C[B].attributes;this.richTextCodeMirror_.insertText(A,z,y);A+=z.length}};j.prototype.getOperationForSpan=function(E,y){var B=this.richTextCodeMirror_.getRange(E,y);var A=this.richTextCodeMirror_.getAttributeSpans(E,y);var D=0;var C=new d.TextOperation();for(var z=0;z<A.length;z++){C.insert(B.substr(D,A[z].length),A[z].attributes);D+=A[z].length}return C};j.prototype.getHtml=function(){return this.getHtmlFromRange(null,null)};j.prototype.getHtmlFromSelection=function(){var z=this.codeMirror_.getCursor("start"),y=this.codeMirror_.getCursor("end");var B=this.codeMirror_.indexFromPos(z),A=this.codeMirror_.indexFromPos(y);return this.getHtmlFromRange(B,A)};j.prototype.getHtmlFromRange=function(A,y){var z=(A!=null&&y!=null)?this.getOperationForSpan(A,y):this.getOperationForSpan(0,this.codeMirror_.getValue().length);return d.SerializeHtml(z,this.entityManager_)};j.prototype.insertHtml=function(z,A){var y=d.ParseHtml(A,this.entityManager_);this.insertText(z,y)};j.prototype.insertHtmlAtCursor=function(y){this.insertHtml(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),y)};j.prototype.setHtml=function(z){var y=d.ParseHtml(z,this.entityManager_);this.setText(y)};j.prototype.isHistoryEmpty=function(){this.assertReady_("isHistoryEmpty");return this.firebaseAdapter_.isHistoryEmpty()};j.prototype.bold=function(){this.richTextCodeMirror_.toggleAttribute(q.BOLD);this.codeMirror_.focus()};j.prototype.italic=function(){this.richTextCodeMirror_.toggleAttribute(q.ITALIC);this.codeMirror_.focus()};j.prototype.underline=function(){this.richTextCodeMirror_.toggleAttribute(q.UNDERLINE);this.codeMirror_.focus()};j.prototype.strike=function(){this.richTextCodeMirror_.toggleAttribute(q.STRIKE);this.codeMirror_.focus()};j.prototype.fontSize=function(y){this.richTextCodeMirror_.setAttribute(q.FONT_SIZE,y);this.codeMirror_.focus()};j.prototype.font=function(y){this.richTextCodeMirror_.setAttribute(q.FONT,y);this.codeMirror_.focus()};j.prototype.color=function(y){this.richTextCodeMirror_.setAttribute(q.COLOR,y);this.codeMirror_.focus()};j.prototype.highlight=function(){this.richTextCodeMirror_.toggleAttribute(q.BACKGROUND_COLOR,"rgba(255,255,0,.65)");this.codeMirror_.focus()};j.prototype.align=function(y){if(y!=="left"&&y!=="center"&&y!=="right"){throw new Error('align() must be passed "left", "center", or "right".')}this.richTextCodeMirror_.setLineAttribute(q.LINE_ALIGN,y);this.codeMirror_.focus()};j.prototype.orderedList=function(){this.richTextCodeMirror_.toggleLineAttribute(q.LIST_TYPE,"o");this.codeMirror_.focus()};j.prototype.unorderedList=function(){this.richTextCodeMirror_.toggleLineAttribute(q.LIST_TYPE,"u");this.codeMirror_.focus()};j.prototype.todo=function(){this.richTextCodeMirror_.toggleTodo();this.codeMirror_.focus()};j.prototype.newline=function(){this.richTextCodeMirror_.newline()};j.prototype.deleteLeft=function(){this.richTextCodeMirror_.deleteLeft()};j.prototype.deleteRight=function(){this.richTextCodeMirror_.deleteRight()};j.prototype.indent=function(){this.richTextCodeMirror_.indent();this.codeMirror_.focus()};j.prototype.unindent=function(){this.richTextCodeMirror_.unindent();this.codeMirror_.focus()};j.prototype.undo=function(){this.codeMirror_.undo()};j.prototype.redo=function(){this.codeMirror_.redo()};j.prototype.insertEntity=function(z,A,y){this.richTextCodeMirror_.insertEntityAtCursor(z,A,y)};j.prototype.insertEntityAt=function(z,A,B,y){this.richTextCodeMirror_.insertEntityAt(z,A,B,y)};j.prototype.registerEntity=function(z,y){this.entityManager_.register(z,y)};j.prototype.getOption=function(y,z){return(y in this.options_)?this.options_[y]:z};j.prototype.assertReady_=function(y){if(!this.ready_){throw new Error('You must wait for the "ready" event before calling '+y+".")}if(this.zombie_){throw new Error("You can't use a Firepad after calling dispose()!")}};j.prototype.makeImageDialog_=function(){this.makeDialog_("img","Insert image url")};j.prototype.makeDialog_=function(z,G){var I=this;var D=function(){var J=document.getElementById("overlay");J.style.visibility="hidden";I.firepadWrapper_.removeChild(J)};var A=function(){var J=document.getElementById("overlay");J.style.visibility="hidden";var K=document.getElementById(z).value;if(K!==null){I.insertEntity(z,{src:K})}I.firepadWrapper_.removeChild(J)};var F=v.elt("input",null,{"class":"firepad-dialog-input",id:z,type:"text",placeholder:G,autofocus:"autofocus"});var E=v.elt("a","Submit",{"class":"firepad-btn",id:"submitbtn"});v.on(E,"click",v.stopEventAnd(A));var H=v.elt("a","Cancel",{"class":"firepad-btn"});v.on(H,"click",v.stopEventAnd(D));var C=v.elt("div",[E,H],{"class":"firepad-btn-group"});var y=v.elt("div",[F,C],{"class":"firepad-dialog-div"});var B=v.elt("div",[y],{"class":"firepad-dialog",id:"overlay"});this.firepadWrapper_.appendChild(B)};j.prototype.addToolbar_=function(){this.toolbar=new x(this.imageInsertionUI);this.toolbar.on("undo",this.undo,this);this.toolbar.on("redo",this.redo,this);this.toolbar.on("bold",this.bold,this);this.toolbar.on("italic",this.italic,this);this.toolbar.on("underline",this.underline,this);this.toolbar.on("strike",this.strike,this);this.toolbar.on("font-size",this.fontSize,this);this.toolbar.on("font",this.font,this);this.toolbar.on("color",this.color,this);this.toolbar.on("left",function(){this.align("left")},this);this.toolbar.on("center",function(){this.align("center")},this);this.toolbar.on("right",function(){this.align("right")},this);this.toolbar.on("ordered-list",this.orderedList,this);this.toolbar.on("unordered-list",this.unorderedList,this);this.toolbar.on("todo-list",this.todo,this);this.toolbar.on("indent-increase",this.indent,this);this.toolbar.on("indent-decrease",this.unindent,this);this.toolbar.on("insert-image",this.makeImageDialog_,this);this.firepadWrapper_.insertBefore(this.toolbar.element(),this.firepadWrapper_.firstChild)};j.prototype.addPoweredByLogo_=function(){var y=v.elt("span",null,{"class":"partner-logo"});this.firepadWrapper_.appendChild(y)};j.prototype.initializeKeyMap_=function(){function y(z){return function(A){setTimeout(function(){z.call(A.firepad)},0)}}n.keyMap.richtext={"Ctrl-B":y(this.bold),"Cmd-B":y(this.bold),"Ctrl-I":y(this.italic),"Cmd-I":y(this.italic),"Ctrl-U":y(this.underline),"Cmd-U":y(this.underline),"Ctrl-H":y(this.highlight),"Cmd-H":y(this.highlight),Enter:y(this.newline),Delete:y(this.deleteRight),Backspace:y(this.deleteLeft),Tab:y(this.indent),"Shift-Tab":y(this.unindent),fallthrough:["default"]}};function r(B){var y=1;for(var A=0;A<B.length;A++){y=17*(y+B.charCodeAt(A))%360}var z=y/360;return p(z,1,0.85)}function g(A,z,y){function B(D){var C=Math.round(255*D).toString(16);return C.length===1?"0"+C:C}return"#"+B(A)+B(z)+B(y)}function p(B,A,z){if(A===0){return g(z,z,z)}var C=z<0.5?z*(1+A):(z+A)-(A*z);var D=2*z-C;var y=function(E){if(E<0){E+=1}if(E>1){E-=1}if(6*E<1){return D+(C-D)*6*E}if(2*E<1){return C}if(3*E<2){return D+(C-D)*6*(2/3-E)}return D};return g(y(B+1/3),y(B),y(B-1/3))}return j})(this);d.Firepad.Formatting=d.Formatting;d.Firepad.Text=d.Text;d.Firepad.Entity=d.Entity;d.Firepad.LineFormatting=d.LineFormatting;d.Firepad.Line=d.Line;d.Firepad.TextOperation=d.TextOperation;d.Firepad.Headless=d.Headless;d.Firepad.RichTextCodeMirrorAdapter=d.RichTextCodeMirrorAdapter;d.Firepad.ACEAdapter=d.ACEAdapter;firepad_=d;return d.Firepad},this);(function(c,f,n){n.documentElement.className=n.documentElement.className+" dk_fouc";var r={},t=[],p={left:37,up:38,right:39,down:40,enter:13},e=['<div class="dk_container {{ classname }}" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">','<a class="dk_toggle">','<span class="dk_label">{{ label }}</span>','<span class="select-icon"></span>',"</a>",'<div class="dk_options">','<ul class="dk_options_inner">',"</ul>","</div>","</div>"].join(""),h='<li class="{{ current }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',i={startSpeed:100,theme:false,change:false},m=false;r.init=function(u){u=c.extend({},i,u);return this.each(function(){var y=c(this),E=y.find(":selected").first(),D=y.find("option"),C=y.data("dropkick")||{},v=y.attr("id")||y.attr("name"),w=u.width||y.outerWidth(),A=y.attr("tabindex")?y.attr("tabindex"):"",x=y.attr("class")?y.attr("class"):"",z=false,B;if(C.id){return y}else{C.settings=u;C.tabindex=A;C.classname=x;C.id=v;C.$original=E;C.$select=y;C.value=d(y.val())||d(E.attr("value"));C.label=E.text();C.options=D}z=b(e,C);z.find(".dk_toggle").css({});y.before(z);z=c("#dk_container_"+v).addClass("dk_shown");B=u.theme?u.theme:"default";z.addClass("dk_theme_"+B);C.theme=B;C.$dk=z;y.data("dropkick",C);z.data("dropkick",C);t[t.length]=y;z.bind("focus.dropkick",function(F){z.addClass("dk_focus")}).bind("blur.dropkick",function(F){z.removeClass("dk_open dk_focus")});setTimeout(function(){y.hide()},0)})};r.theme=function(y){var v=c(this),w=v.data("dropkick"),u=w.$dk,x="dk_theme_"+w.theme;u.removeClass(x).addClass("dk_theme_"+y);w.theme=y};r.reset=function(){for(var w=0,u=t.length;w<u;w++){var y=t[w].data("dropkick"),v=y.$dk,x=v.find("li").first();v.find(".dk_label").text(y.label);v.find(".dk_options_inner").animate({scrollTop:0},0);o(x,v);g(x,v,true)}};c.fn.dropkick=function(u){if(r[u]){return r[u].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof u==="object"||!u){return r.init.apply(this,arguments)}}};function q(B,w){var u=B.keyCode,x=w.data("dropkick"),E=w.find(".dk_options"),A=w.hasClass("dk_open"),C=w.find(".dk_option_current"),z=E.find("li").first(),D=E.find("li").last(),y,v;switch(u){case p.enter:if(A){g(C.find("a"),w);l(w)}else{s(w)}B.preventDefault();break;case p.up:v=C.prev("li");if(A){if(v.length){o(v,w)}else{o(D,w)}}else{s(w)}B.preventDefault();break;case p.down:if(A){y=C.next("li").first();if(y.length){o(y,w)}else{o(z,w)}}else{s(w)}B.preventDefault();break;default:break}}function g(w,v,x){var z,u,y;z=w.attr("data-dk-dropdown-value");u=w.text();y=v.data("dropkick");$select=y.$select;$select.val(z);v.find(".dk_label").text(u);x=x||false;if(y.settings.change&&!x){y.settings.change.call($select,z,u)}}function o(v,u){u.find(".dk_option_current").removeClass("dk_option_current");v.addClass("dk_option_current");j(u,v)}function j(w,v){var u=v.prevAll("li").outerHeight()*v.prevAll("li").length;w.find(".dk_options_inner").animate({scrollTop:u+"px"},0)}function l(u){u.removeClass("dk_open")}function s(u){var v=u.data("dropkick");u.find(".dk_options").css({top:u.find(".dk_toggle").outerHeight()-1});u.toggleClass("dk_open")}function b(z,B){var C=z,D=[],w;C=C.replace("{{ id }}",B.id);C=C.replace("{{ label }}",B.label);C=C.replace("{{ tabindex }}",B.tabindex);C=C.replace("{{ classname }}",B.classname);if(B.options&&B.options.length){for(var x=0,v=B.options.length;x<v;x++){var u=c(B.options[x]),A="dk_option_current",y=h;y=y.replace("{{ value }}",u.val());y=y.replace("{{ current }}",(d(u.val())===B.value)?A:"");y=y.replace("{{ text }}",u.text());D[D.length]=y}}w=c(C);w.find(".dk_options_inner").html(D.join(""));return w}function d(u){return(c.trim(u).length>0)?u:false}c(function(){c(n).on("click",".dk_toggle",function(v){var u=c(this).parents(".dk_container").first();s(u);if("ontouchstart" in f){u.addClass("dk_touch");u.find(".dk_options_inner").addClass("scrollable vertical")}v.preventDefault();return false});c(n).on("click",".dk_options a",function(x){var w=c(this),u=w.parents(".dk_container").first(),v=u.data("dropkick");l(u);g(w,u);o(w.parent(),u);x.preventDefault();return false});c(n).bind("keydown.dk_nav",function(w){var x=c(".dk_container.dk_open"),v=c(".dk_container.dk_focus"),u=null;if(x.length){u=x}else{if(v.length&&!x.length){u=v}}if(u){q(w,u)}})})})(jQuery,window,document);(function(){function H(h,g,l){h.addEventListener?h.addEventListener(g,l,!1):h.attachEvent("on"+g,l)}function c(h){if("keypress"==h.type){var g=String.fromCharCode(h.which);h.shiftKey||(g=g.toLowerCase());return g}return R[h.which]?R[h.which]:b[h.which]?b[h.which]:String.fromCharCode(h.which).toLowerCase()}function o(h,g){h=h||{};var m=!1,l;for(l in O){h[l]&&O[l]>g?m=!0:O[l]=0}m||(M=!1)}function N(v,u,t,s,p){var q,r,m=[],l=t.type;if(!P[v]){return[]}"keyup"==l&&j(v)&&(u=[v]);for(q=0;q<P[v].length;++q){if(r=P[v][q],!(r.seq&&O[r.seq]!=r.level)&&l==r.action&&("keypress"==l&&!t.metaKey&&!t.ctrlKey||u.sort().join(",")===r.modifiers.sort().join(","))){s&&r.combo==p&&P[v].splice(q,1),m.push(r)}}return m}function f(h,g,l){if(!Q.stopCallback(g,g.target||g.srcElement,l)&&!1===h(g,l)){g.preventDefault&&g.preventDefault(),g.stopPropagation&&g.stopPropagation(),g.returnValue=!1,g.cancelBubble=!0}}function e(l){"number"!==typeof l.which&&(l.which=l.keyCode);var h=c(l);if(h){if("keyup"==l.type&&d==h){d=!1}else{var s=[];l.shiftKey&&s.push("shift");l.altKey&&s.push("alt");l.ctrlKey&&s.push("ctrl");l.metaKey&&s.push("meta");var s=N(h,s,l),r,m={},p=0,q=!1;for(r=0;r<s.length;++r){s[r].seq?(q=!0,p=Math.max(p,s[r].level),m[s[r].seq]=1,f(s[r].callback,l,s[r].combo)):!q&&!M&&f(s[r].callback,l,s[r].combo)}l.type==M&&!j(h)&&o(m,p)}}}function j(g){return"shift"==g||"ctrl"==g||"alt"==g||"meta"==g}function K(h,g,m){if(!m){if(!L){L={};for(var l in R){95<l&&112>l||R.hasOwnProperty(l)&&(L[R[l]]=l)}}m=L[h]?"keydown":"keypress"}"keypress"==m&&g.length&&(m="keydown");return m}function I(x,w,v,u,r){J[x+":"+v]=w;x=x.replace(/\s+/g," ");var s=x.split(" "),t,q,p=[];if(1<s.length){var m=x,l=v;O[m]=0;l||(l=K(s[0],[]));x=function(){M=l;++O[m];clearTimeout(G);G=setTimeout(o,1000)};v=function(g){f(w,g,m);"keyup"!==l&&(d=c(g));setTimeout(o,10)};for(u=0;u<s.length;++u){I(s[u],u<s.length-1?x:v,l,m,u)}}else{q="+"===x?["+"]:x.split("+");for(s=0;s<q.length;++s){t=q[s],n[t]&&(t=n[t]),v&&("keypress"!=v&&i[t])&&(t=i[t],p.push("shift")),j(t)&&p.push(t)}v=K(t,p,v);P[t]||(P[t]=[]);N(t,p,{type:v},!u,x);P[t][u?"unshift":"push"]({callback:w,modifiers:p,action:v,seq:u,level:r,combo:x})}}for(var R={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},b={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},n={option:"alt",command:"meta","return":"enter",escape:"esc"},L,P={},J={},O={},G,d=!1,M=!1,S=1;20>S;++S){R[111+S]="f"+S}for(S=0;9>=S;++S){R[S+96]=S}H(document,"keypress",e);H(document,"keydown",e);H(document,"keyup",e);var Q={bind:function(h,g,m){h=h instanceof Array?h:[h];for(var l=0;l<h.length;++l){I(h[l],g,m)}return this},unbind:function(h,g){return Q.bind(h,function(){},g)},trigger:function(h,g){if(J[h+":"+g]){J[h+":"+g]({},h)}return this},reset:function(){P={};J={};return this},stopCallback:function(h,g){return -1<(" "+g.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==g.tagName||"SELECT"==g.tagName||g.contentEditable&&"true"==g.contentEditable}};window.Mousetrap=Q;"function"===typeof define&&define.amd&&define(Q)})();(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(h){function g(c){c=e.json?JSON.stringify(c):String(c);return e.raw?c:encodeURIComponent(c)}function b(c,j){var f;if(e.raw){f=c}else{f:{var l=c;0===l.indexOf('"')&&(l=l.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{l=decodeURIComponent(l.replace(d," "));f=e.json?JSON.parse(l):l;break f}catch(i){}f=void 0}}return h.isFunction(j)?j(f):f}var d=/\+/g,e=h.cookie=function(c,o,i){if(void 0!==o&&!h.isFunction(o)){i=h.extend({},e.defaults,i);if("number"===typeof i.expires){var p=i.expires,n=i.expires=new Date;n.setTime(+n+86400000*p)}return document.cookie=[e.raw?c:encodeURIComponent(c),"=",g(o),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}i=c?void 0:{};for(var p=document.cookie?document.cookie.split("; "):[],n=0,f=p.length;n<f;n++){var m=p[n].split("="),j;j=m.shift();j=e.raw?j:decodeURIComponent(j);m=m.join("=");if(c&&c===j){i=b(m,o);break}c||void 0===(m=b(m))||(i[j]=m)}return i};e.defaults={};h.removeCookie=function(c,f){if(void 0===h.cookie(c)){return !1}h.cookie(c,"",h.extend({},f,{expires:-1}));return !h.cookie(c)}});typeof JSON!="object"&&(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a){return"null"}gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1){u[n]=str(n,a)||"null"}return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1){typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}}else{for(r in a){Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}}return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number"){for(r=0;r<n;r+=1){indent+=" "}}else{typeof n=="string"&&(indent=n)}rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number"){return str("",{"":e})}throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object"){for(n in i){Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n])}}return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}(),function(d,b){var f=d.History=d.History||{},c=d.jQuery;if(typeof f.Adapter!="undefined"){throw new Error("History.js Adapter has already been loaded...")}f.Adapter={bind:function(h,g,i){c(h).bind(g,i)},trigger:function(h,g,i){c(h).trigger(g,i)},extractEventData:function(j,l,h){var g=l&&l.originalEvent&&l.originalEvent[j]||h&&h[j]||b;return g},onDomLoad:function(g){c(g)}},typeof f.init!="undefined"&&f.init()}(window),function(g,c){var j=g.document,f=g.setTimeout||f,b=g.clearTimeout||b,d=g.setInterval||d,h=g.History=g.History||{};if(typeof h.initHtml4!="undefined"){throw new Error("History.js HTML4 Support has already been loaded...")}h.initHtml4=function(){if(typeof h.initHtml4.initialized!="undefined"){return !1}h.initHtml4.initialized=!0,h.enabled=!0,h.savedHashes=[],h.isLastHash=function(l){var i=h.getHashByIndex(),m;return m=l===i,m},h.isHashEqual=function(l,i){return l=encodeURIComponent(l).replace(/%25/g,"%"),i=encodeURIComponent(i).replace(/%25/g,"%"),l===i},h.saveHash=function(i){return h.isLastHash(i)?!1:(h.savedHashes.push(i),!0)},h.getHashByIndex=function(l){var i=null;return typeof l=="undefined"?i=h.savedHashes[h.savedHashes.length-1]:l<0?i=h.savedHashes[h.savedHashes.length+l]:i=h.savedHashes[l],i},h.discardedHashes={},h.discardedStates={},h.discardState=function(p,m,q){var o=h.getHashByState(p),l;return l={discardedState:p,backState:q,forwardState:m},h.discardedStates[o]=l,!0},h.discardHash=function(m,i,o){var l={discardedHash:m,backState:o,forwardState:i};return h.discardedHashes[m]=l,!0},h.discardedState=function(l){var i=h.getHashByState(l),m;return m=h.discardedStates[i]||!1,m},h.discardedHash=function(l){var i=h.discardedHashes[l]||!1;return i},h.recycleState=function(l){var i=h.getHashByState(l);return h.discardedState(l)&&delete h.discardedStates[i],!0},h.emulated.hashChange&&(h.hashChangeInit=function(){h.checkerFunction=null;var n="",o,m,l,e,p=Boolean(h.getHash());return h.isInternetExplorer()?(o="historyjs-iframe",m=j.createElement("iframe"),m.setAttribute("id",o),m.setAttribute("src","#"),m.style.display="none",j.body.appendChild(m),m.contentWindow.document.open(),m.contentWindow.document.close(),l="",e=!1,h.checkerFunction=function(){if(e){return !1}e=!0;var q=h.getHash(),i=h.getHash(m.contentWindow.document);return q!==n?(n=q,i!==q&&(l=i=q,m.contentWindow.document.open(),m.contentWindow.document.close(),m.contentWindow.document.location.hash=h.escapeHash(q)),h.Adapter.trigger(g,"hashchange")):i!==l&&(l=i,p&&i===""?h.back():h.setHash(i,!1)),e=!1,!0}):h.checkerFunction=function(){var i=h.getHash()||"";return i!==n&&(n=i,h.Adapter.trigger(g,"hashchange")),!0},h.intervalList.push(d(h.checkerFunction,h.options.hashChangeInterval)),!0},h.Adapter.onDomLoad(h.hashChangeInit)),h.emulated.pushState&&(h.onHashChange=function(o){var v=o&&o.newURL||h.getLocationHref(),q=h.getHashByUrl(v),m=null,p=null,l=null,e;return h.isLastHash(q)?(h.busy(!1),!1):(h.doubleCheckComplete(),h.saveHash(q),q&&h.isTraditionalAnchor(q)?(h.Adapter.trigger(g,"anchorchange"),h.busy(!1),!1):(m=h.extractState(h.getFullUrl(q||h.getLocationHref()),!0),h.isLastSavedState(m)?(h.busy(!1),!1):(p=h.getHashByState(m),e=h.discardedState(m),e?(h.getHashByIndex(-2)===h.getHashByState(e.forwardState)?h.back(!1):h.forward(!1),!1):(h.pushState(m.data,m.title,encodeURI(m.url),!1),!0))))},h.Adapter.bind(g,"hashchange",h.onHashChange),h.pushState=function(y,m,e,p){e=encodeURI(e).replace(/%25/g,"%");if(h.getHashByUrl(e)){throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).")}if(p!==!1&&h.busy()){return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:p}),!1}h.busy(!0);var z=h.createStateObject(y,m,e),x=h.getHashByState(z),w=h.getState(!1),q=h.getHashByState(w),o=h.getHash(),v=h.expectedStateId==z.id;return h.storeState(z),h.expectedStateId=z.id,h.recycleState(z),h.setTitle(z),x===q?(h.busy(!1),!1):(h.saveState(z),v||h.Adapter.trigger(g,"statechange"),!h.isHashEqual(x,o)&&!h.isHashEqual(x,h.getShortUrl(h.getLocationHref()))&&h.setHash(x,!1),h.busy(!1),!0)},h.replaceState=function(x,m,e,p){e=encodeURI(e).replace(/%25/g,"%");if(h.getHashByUrl(e)){throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).")}if(p!==!1&&h.busy()){return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:p}),!1}h.busy(!0);var y=h.createStateObject(x,m,e),w=h.getHashByState(y),v=h.getState(!1),q=h.getHashByState(v),o=h.getStateByIndex(-2);return h.discardState(v,y,o),w===q?(h.storeState(y),h.expectedStateId=y.id,h.recycleState(y),h.setTitle(y),h.saveState(y),h.Adapter.trigger(g,"statechange"),h.busy(!1)):h.pushState(y.data,y.title,y.url,!1),!0}),h.emulated.pushState&&h.getHash()&&!h.emulated.hashChange&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(g,"hashchange")})},typeof h.init!="undefined"&&h.init()}(window),function(y,D){var m=y.console||D,b=y.document,v=y.navigator,E=!1,j=y.setTimeout,C=y.clearTimeout,B=y.setInterval,x=y.clearInterval,q=y.JSON,A=y.alert,w=y.History=y.History||{},g=y.history;try{E=y.sessionStorage,E.setItem("TEST","1"),E.removeItem("TEST")}catch(z){E=!1}q.stringify=q.stringify||q.encode,q.parse=q.parse||q.decode;if(typeof w.init!="undefined"){throw new Error("History.js Core has already been loaded...")}w.init=function(c){return typeof w.Adapter=="undefined"?!1:(typeof w.initCore!="undefined"&&w.initCore(),typeof w.initHtml4!="undefined"&&w.initHtml4(),!0)},w.initCore=function(f){if(typeof w.initCore.initialized!="undefined"){return !1}w.initCore.initialized=!0,w.options=w.options||{},w.options.hashChangeInterval=w.options.hashChangeInterval||100,w.options.safariPollInterval=w.options.safariPollInterval||500,w.options.doubleCheckInterval=w.options.doubleCheckInterval||500,w.options.disableSuid=w.options.disableSuid||!1,w.options.storeInterval=w.options.storeInterval||1000,w.options.busyDelay=w.options.busyDelay||250,w.options.debug=w.options.debug||!1,w.options.initialTitle=w.options.initialTitle||b.title,w.options.html4Mode=w.options.html4Mode||!1,w.options.delayInit=w.options.delayInit||!1,w.intervalList=[],w.clearAllIntervals=function(){var h,d=w.intervalList;if(typeof d!="undefined"&&d!==null){for(h=0;h<d.length;h++){x(d[h])}w.intervalList=null}},w.debug=function(){(w.options.debug||!1)&&w.log.apply(w,arguments)},w.log=function(){var F=typeof m!="undefined"&&typeof m.log!="undefined"&&typeof m.log.apply!="undefined",n=b.getElementById("log"),l,p,G,h,d;F?(h=Array.prototype.slice.call(arguments),l=h.shift(),typeof m.debug!="undefined"?m.debug.apply(m,[l,h]):m.log.apply(m,[l,h])):l="\n"+arguments[0]+"\n";for(p=1,G=arguments.length;p<G;++p){d=arguments[p];if(typeof d=="object"&&typeof q!="undefined"){try{d=q.stringify(d)}catch(r){}}l+="\n"+d+"\n"}return n?(n.value+=l+"\n-----\n",n.scrollTop=n.scrollHeight-n.clientHeight):F||A(l),!0},w.getInternetExplorerMajorVersion=function(){var d=w.getInternetExplorerMajorVersion.cached=typeof w.getInternetExplorerMajorVersion.cached!="undefined"?w.getInternetExplorerMajorVersion.cached:function(){var i=3,h=b.createElement("div"),l=h.getElementsByTagName("i");while((h.innerHTML="<!--[if gt IE "+ ++i+"]><i></i><![endif]-->")&&l[0]){}return i>4?i:!1}();return d},w.isInternetExplorer=function(){var d=w.isInternetExplorer.cached=typeof w.isInternetExplorer.cached!="undefined"?w.isInternetExplorer.cached:Boolean(w.getInternetExplorerMajorVersion());return d},w.options.html4Mode?w.emulated={pushState:!0,hashChange:!0}:w.emulated={pushState:!Boolean(y.history&&y.history.pushState&&y.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(v.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(v.userAgent)),hashChange:Boolean(!("onhashchange" in y||"onhashchange" in b)||w.isInternetExplorer()&&w.getInternetExplorerMajorVersion()<8)},w.enabled=!w.emulated.pushState,w.bugs={setHash:Boolean(!w.emulated.pushState&&v.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(v.userAgent)),safariPoll:Boolean(!w.emulated.pushState&&v.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(v.userAgent)),ieDoubleCheck:Boolean(w.isInternetExplorer()&&w.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(w.isInternetExplorer()&&w.getInternetExplorerMajorVersion()<7)},w.isEmptyObject=function(h){for(var d in h){if(h.hasOwnProperty(d)){return !1}}return !0},w.cloneObject=function(h){var d,i;return h?(d=q.stringify(h),i=q.parse(d)):i={},i},w.getRootUrl=function(){var d=b.location.protocol+"//"+(b.location.hostname||b.location.host);if(b.location.port||!1){d+=":"+b.location.port}return d+="/",d},w.getBaseHref=function(){var h=b.getElementsByTagName("base"),d=null,i="";return h.length===1&&(d=h[0],i=d.href.replace(/[^\/]+$/,"")),i=i.replace(/\/+$/,""),i&&(i+="/"),i},w.getBaseUrl=function(){var d=w.getBaseHref()||w.getBasePageUrl()||w.getRootUrl();return d},w.getPageUrl=function(){var h=w.getState(!1,!1),d=(h||{}).url||w.getLocationHref(),i;return i=d.replace(/\/+$/,"").replace(/[^\/]+$/,function(o,l,p){return/\./.test(o)?o:o+"/"}),i},w.getBasePageUrl=function(){var d=w.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(i,h,l){return/[^\/]$/.test(i)?"":i}).replace(/\/+$/,"")+"/";return d},w.getFullUrl=function(i,d){var l=i,h=i.substring(0,1);return d=typeof d=="undefined"?!0:d,/[a-z]+\:\/\//.test(i)||(h==="/"?l=w.getRootUrl()+i.replace(/^\/+/,""):h==="#"?l=w.getPageUrl().replace(/#.*/,"")+i:h==="?"?l=w.getPageUrl().replace(/[\?#].*/,"")+i:d?l=w.getBaseUrl()+i.replace(/^(\.\/)+/,""):l=w.getBasePageUrl()+i.replace(/^(\.\/)+/,"")),l.replace(/\#$/,"")},w.getShortUrl=function(i){var d=i,l=w.getBaseUrl(),h=w.getRootUrl();return w.emulated.pushState&&(d=d.replace(l,"")),d=d.replace(h,"/"),w.isTraditionalAnchor(d)&&(d="./"+d),d=d.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),d},w.getLocationHref=function(d){return d=d||b,d.URL===d.location.href?d.location.href:d.location.href===decodeURIComponent(d.URL)?d.URL:d.location.hash&&decodeURIComponent(d.location.href.replace(/^[^#]+/,""))===d.location.hash?d.location.href:d.URL.indexOf("#")==-1&&d.location.href.indexOf("#")!=-1?d.location.href:d.URL||d.location.href},w.store={},w.idToState=w.idToState||{},w.stateToId=w.stateToId||{},w.urlToId=w.urlToId||{},w.storedStates=w.storedStates||[],w.savedStates=w.savedStates||[],w.normalizeStore=function(){w.store.idToState=w.store.idToState||{},w.store.urlToId=w.store.urlToId||{},w.store.stateToId=w.store.stateToId||{}},w.getState=function(h,d){typeof h=="undefined"&&(h=!0),typeof d=="undefined"&&(d=!0);var i=w.getLastSavedState();return !i&&d&&(i=w.createStateObject()),h&&(i=w.cloneObject(i),i.url=i.cleanUrl||i.url),i},w.getIdByState=function(h){var d=w.extractId(h.url),i;if(!d){i=w.getStateString(h);if(typeof w.stateToId[i]!="undefined"){d=w.stateToId[i]}else{if(typeof w.store.stateToId[i]!="undefined"){d=w.store.stateToId[i]}else{for(;;){d=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof w.idToState[d]=="undefined"&&typeof w.store.idToState[d]=="undefined"){break}}w.stateToId[i]=d,w.idToState[d]=h}}}return d},w.normalizeState=function(h){var d,i;if(!h||typeof h!="object"){h={}}if(typeof h.normalized!="undefined"){return h}if(!h.data||typeof h.data!="object"){h.data={}}return d={},d.normalized=!0,d.title=h.title||"",d.url=w.getFullUrl(h.url?h.url:w.getLocationHref()),d.hash=w.getShortUrl(d.url),d.data=w.cloneObject(h.data),d.id=w.getIdByState(d),d.cleanUrl=d.url.replace(/\??\&_suid.*/,""),d.url=d.cleanUrl,i=!w.isEmptyObject(d.data),(d.title||i)&&w.options.disableSuid!==!0&&(d.hash=w.getShortUrl(d.url).replace(/\??\&_suid.*/,""),/\?/.test(d.hash)||(d.hash+="?"),d.hash+="&_suid="+d.id),d.hashedUrl=w.getFullUrl(d.hash),(w.emulated.pushState||w.bugs.safariPoll)&&w.hasUrlDuplicate(d)&&(d.url=d.hashedUrl),d},w.createStateObject=function(i,d,l){var h={data:i,title:d,url:l};return h=w.normalizeState(h),h},w.getStateById=function(d){d=String(d);var h=w.idToState[d]||w.store.idToState[d]||D;return h},w.getStateString=function(i){var d,l,h;return d=w.normalizeState(i),l={data:d.data,title:i.title,url:i.url},h=q.stringify(l),h},w.getStateId=function(h){var d,i;return d=w.normalizeState(h),i=d.id,i},w.getHashByState=function(h){var d,i;return d=w.normalizeState(h),i=d.hash,i},w.extractId=function(o){var h,p,l,d;return o.indexOf("#")!=-1?d=o.split("#")[0]:d=o,p=/(.*)\&_suid=([0-9]+)$/.exec(d),l=p?p[1]||o:o,h=p?String(p[2]||""):"",h||!1},w.isTraditionalAnchor=function(h){var d=!/[\/\?\.]/.test(h);return d},w.extractState=function(o,h){var p=null,l,d;return h=h||!1,l=w.extractId(o),l&&(p=w.getStateById(l)),p||(d=w.getFullUrl(o),l=w.getIdByUrl(d)||!1,l&&(p=w.getStateById(l)),!p&&h&&!w.isTraditionalAnchor(o)&&(p=w.createStateObject(null,null,d))),p},w.getIdByUrl=function(d){var h=w.urlToId[d]||w.store.urlToId[d]||D;return h},w.getLastSavedState=function(){return w.savedStates[w.savedStates.length-1]||D},w.getLastStoredState=function(){return w.storedStates[w.storedStates.length-1]||D},w.hasUrlDuplicate=function(h){var d=!1,i;return i=w.extractState(h.url),d=i&&i.id!==h.id,d},w.storeState=function(d){return w.urlToId[d.url]=d.id,w.storedStates.push(w.cloneObject(d)),d},w.isLastSavedState=function(o){var h=!1,p,l,d;return w.savedStates.length&&(p=o.id,l=w.getLastSavedState(),d=l.id,h=p===d),h},w.saveState=function(d){return w.isLastSavedState(d)?!1:(w.savedStates.push(w.cloneObject(d)),!0)},w.getStateByIndex=function(h){var d=null;return typeof h=="undefined"?d=w.savedStates[w.savedStates.length-1]:h<0?d=w.savedStates[w.savedStates.length+h]:d=w.savedStates[h],d},w.getCurrentIndex=function(){var d=null;return w.savedStates.length<1?d=0:d=w.savedStates.length-1,d},w.getHash=function(h){var d=w.getLocationHref(h),i;return i=w.getHashByUrl(d),i},w.unescapeHash=function(h){var d=w.normalizeHash(h);return d=decodeURIComponent(d),d},w.normalizeHash=function(h){var d=h.replace(/[^#]*#/,"").replace(/#.*/,"");return d},w.setHash=function(l,h){var o,d;return h!==!1&&w.busy()?(w.pushQueue({scope:w,callback:w.setHash,args:arguments,queue:h}),!1):(w.busy(!0),o=w.extractState(l,!0),o&&!w.emulated.pushState?w.pushState(o.data,o.title,o.url,!1):w.getHash()!==l&&(w.bugs.setHash?(d=w.getPageUrl(),w.pushState(null,null,d+"#"+l,!1)):b.location.hash=l),w)},w.escapeHash=function(d){var h=w.normalizeHash(d);return h=y.encodeURIComponent(h),w.bugs.hashEscape||(h=h.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),h},w.getHashByUrl=function(h){var d=String(h).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return d=w.unescapeHash(d),d},w.setTitle=function(l){var h=l.title,o;h||(o=w.getStateByIndex(0),o&&o.url===l.url&&(h=o.title||w.options.initialTitle));try{b.getElementsByTagName("title")[0].innerHTML=h.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(d){}return b.title=h,w},w.queues=[],w.busy=function(h){typeof h!="undefined"?w.busy.flag=h:typeof w.busy.flag=="undefined"&&(w.busy.flag=!1);if(!w.busy.flag){C(w.busy.timeout);var d=function(){var l,o,i;if(w.busy.flag){return}for(l=w.queues.length-1;l>=0;--l){o=w.queues[l];if(o.length===0){continue}i=o.shift(),w.fireQueueItem(i),w.busy.timeout=j(d,w.options.busyDelay)}};w.busy.timeout=j(d,w.options.busyDelay)}return w.busy.flag},w.busy.flag=!1,w.fireQueueItem=function(d){return d.callback.apply(d.scope||w,d.args||[])},w.pushQueue=function(d){return w.queues[d.queue||0]=w.queues[d.queue||0]||[],w.queues[d.queue||0].push(d),w},w.queue=function(h,d){return typeof h=="function"&&(h={callback:h}),typeof d!="undefined"&&(h.queue=d),w.busy()?w.pushQueue(h):w.fireQueueItem(h),w},w.clearQueue=function(){return w.busy.flag=!1,w.queues=[],w},w.stateChanged=!1,w.doubleChecker=!1,w.doubleCheckComplete=function(){return w.stateChanged=!0,w.doubleCheckClear(),w},w.doubleCheckClear=function(){return w.doubleChecker&&(C(w.doubleChecker),w.doubleChecker=!1),w},w.doubleCheck=function(d){return w.stateChanged=!1,w.doubleCheckClear(),w.bugs.ieDoubleCheck&&(w.doubleChecker=j(function(){return w.doubleCheckClear(),w.stateChanged||d(),!0},w.options.doubleCheckInterval)),w},w.safariStatePoll=function(){var d=w.extractState(w.getLocationHref()),h;if(!w.isLastSavedState(d)){return h=d,h||(h=w.createStateObject()),w.Adapter.trigger(y,"popstate"),w}return},w.back=function(d){return d!==!1&&w.busy()?(w.pushQueue({scope:w,callback:w.back,args:arguments,queue:d}),!1):(w.busy(!0),w.doubleCheck(function(){w.back(!1)}),g.go(-1),!0)},w.forward=function(d){return d!==!1&&w.busy()?(w.pushQueue({scope:w,callback:w.forward,args:arguments,queue:d}),!1):(w.busy(!0),w.doubleCheck(function(){w.forward(!1)}),g.go(1),!0)},w.go=function(h,d){var i;if(h>0){for(i=1;i<=h;++i){w.forward(d)}}else{if(!(h<0)){throw new Error("History.go: History.go requires a positive or negative integer passed.")}for(i=-1;i>=h;--i){w.back(d)}}return w};if(w.emulated.pushState){var e=function(){};w.pushState=w.pushState||e,w.replaceState=w.replaceState||e}else{w.onPopState=function(h,F){var p=!1,d=!1,l,u;return w.doubleCheckComplete(),l=w.getHash(),l?(u=w.extractState(l||w.getLocationHref(),!0),u?w.replaceState(u.data,u.title,u.url,!1):(w.Adapter.trigger(y,"anchorchange"),w.busy(!1)),w.expectedStateId=!1,!1):(p=w.Adapter.extractEventData("state",h,F)||!1,p?d=w.getStateById(p):w.expectedStateId?d=w.getStateById(w.expectedStateId):d=w.extractState(w.getLocationHref()),d||(d=w.createStateObject(null,null,w.getLocationHref())),w.expectedStateId=!1,w.isLastSavedState(d)?(w.busy(!1),!1):(w.storeState(d),w.saveState(d),w.setTitle(d),w.Adapter.trigger(y,"statechange"),w.busy(!1),!0))},w.Adapter.bind(y,"popstate",w.onPopState),w.pushState=function(h,p,o,d){if(w.getHashByUrl(o)&&w.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(d!==!1&&w.busy()){return w.pushQueue({scope:w,callback:w.pushState,args:arguments,queue:d}),!1}w.busy(!0);var l=w.createStateObject(h,p,o);return w.isLastSavedState(l)?w.busy(!1):(w.storeState(l),w.expectedStateId=l.id,g.pushState(l.id,l.title,l.url),w.Adapter.trigger(y,"popstate")),!0},w.replaceState=function(h,p,o,d){if(w.getHashByUrl(o)&&w.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(d!==!1&&w.busy()){return w.pushQueue({scope:w,callback:w.replaceState,args:arguments,queue:d}),!1}w.busy(!0);var l=w.createStateObject(h,p,o);return w.isLastSavedState(l)?w.busy(!1):(w.storeState(l),w.expectedStateId=l.id,g.replaceState(l.id,l.title,l.url),w.Adapter.trigger(y,"popstate")),!0}}if(E){try{w.store=q.parse(E.getItem("History.store"))||{}}catch(c){w.store={}}w.normalizeStore()}else{w.store={},w.normalizeStore()}w.Adapter.bind(y,"unload",w.clearAllIntervals),w.saveState(w.storeState(w.extractState(w.getLocationHref(),!0))),E&&(w.onUnload=function(){var o,h,p;try{o=q.parse(E.getItem("History.store"))||{}}catch(l){o={}}o.idToState=o.idToState||{},o.urlToId=o.urlToId||{},o.stateToId=o.stateToId||{};for(h in w.idToState){if(!w.idToState.hasOwnProperty(h)){continue}o.idToState[h]=w.idToState[h]}for(h in w.urlToId){if(!w.urlToId.hasOwnProperty(h)){continue}o.urlToId[h]=w.urlToId[h]}for(h in w.stateToId){if(!w.stateToId.hasOwnProperty(h)){continue}o.stateToId[h]=w.stateToId[h]}w.store=o,w.normalizeStore(),p=q.stringify(o);try{E.setItem("History.store",p)}catch(d){if(d.code!==DOMException.QUOTA_EXCEEDED_ERR){throw d}E.length&&(E.removeItem("History.store"),E.setItem("History.store",p))}},w.intervalList.push(B(w.onUnload,w.options.storeInterval)),w.Adapter.bind(y,"beforeunload",w.onUnload),w.Adapter.bind(y,"unload",w.onUnload));if(!w.emulated.pushState){w.bugs.safariPoll&&w.intervalList.push(B(w.safariStatePoll,w.options.safariPollInterval));if(v.vendor==="Apple Computer, Inc."||(v.appCodeName||"")==="Mozilla"){w.Adapter.bind(y,"hashchange",function(){w.Adapter.trigger(y,"popstate")}),w.getHash()&&w.Adapter.onDomLoad(function(){w.Adapter.trigger(y,"hashchange")})}}},(!w.options||!w.options.delayInit)&&w.init()}(window);(function(b){b.fn.splitter=function(c){c=c||{};return this.each(function(){var p;function j(u){if(d.outline){p=p||o.clone(false).insertAfter(h)}q.css("-webkit-user-select","none");o.addClass(d.activeClass);h._posSplit=h[0][d.pxSplit]-u[d.eventPos];b(document).bind("mousemove",m).bind("mouseup",s)}function m(u){var v=h._posSplit+u[d.eventPos];if(d.outline){v=Math.max(0,Math.min(v,e._DA-o._DA));o.css(d.origin,v)}else{n(v)}}function s(u){o.removeClass(d.activeClass);var v=h._posSplit+u[d.eventPos];if(d.outline){p.remove();p=null;n(v)}q.css("-webkit-user-select","text");b(document).unbind("mousemove",m).unbind("mouseup",s)}function n(u){u=Math.max(h._min,e._DA-g._max,Math.min(u,h._max,e._DA-o._DA-g._min));o._DA=o[0][d.pxSplit];o.css(d.origin,u).css(d.fixed,e._DF);h.css(d.origin,0).css(d.split,u).css(d.fixed,e._DF);g.css(d.origin,u+o._DA).css(d.split,e._DA-o._DA-u).css(d.fixed,e._DF);if(!b.browser.msie){q.trigger("resize")}}function r(x,w){var v=0;for(var u=1;u<arguments.length;u++){v+=Math.max(parseInt(x.css(arguments[u]))||0,0)}return v}var l=(c.splitHorizontal?"h":c.splitVertical?"v":c.type)||"v";var d=b.extend({activeClass:"active",pxPerKey:8,tabIndex:0,accessKey:""},{v:{keyLeft:39,keyRight:37,cursor:"col-resize",splitbarClass:"vsplitbar",outlineClass:"voutline",type:"v",eventPos:"pageX",origin:"left",split:"width",pxSplit:"offsetWidth",side1:"Left",side2:"Right",fixed:"height",pxFixed:"offsetHeight",side3:"Top",side4:"Bottom"},h:{keyTop:40,keyBottom:38,cursor:"n-resize",splitbarClass:"hsplitbar",outlineClass:"houtline",type:"h",eventPos:"pageY",origin:"top",split:"height",pxSplit:"offsetHeight",side1:"Top",side2:"Bottom",fixed:"width",pxFixed:"offsetWidth",side3:"Left",side4:"Right"}}[l],c);var e=b(this).css({position:"relative"});var q=b(">*",e[0]).css({position:"absolute","z-index":"1","-moz-outline-style":"none"});var h=b(q[0]);var g=b(q[1]);var f=b('<a href="javascript:void(0)"></a>').attr({accessKey:d.accessKey,tabIndex:d.tabIndex,title:d.splitbarClass}).bind(b.browser.opera?"click":"focus",function(){this.focus();o.addClass(d.activeClass)}).bind("keydown",function(w){var v=w.which||w.keyCode;var u=v==d["key"+d.side1]?1:v==d["key"+d.side2]?-1:0;if(u){n(h[0][d.pxSplit]+u*d.pxPerKey,false)}}).bind("blur",function(){o.removeClass(d.activeClass)});var o=b(q[2]||"<div></div>").insertAfter(h).css("z-index","100").append(f).attr({"class":d.splitbarClass,unselectable:"on"}).css({position:"absolute","user-select":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none"}).bind("mousedown",j);if(/^(auto|default|)$/.test(o.css("cursor"))){o.css("cursor",d.cursor)}o._DA=o[0][d.pxSplit];e._PBF=b.boxModel?r(e,"border"+d.side3+"Width","border"+d.side4+"Width"):0;e._PBA=b.boxModel?r(e,"border"+d.side1+"Width","border"+d.side2+"Width"):0;h._pane=d.side1;g._pane=d.side2;b.each([h,g],function(){this._min=d["min"+this._pane]||r(this,"min-"+d.split);this._max=d["max"+this._pane]||r(this,"max-"+d.split)||9999;this._init=d["size"+this._pane]===true?parseInt(b.curCSS(this[0],d.split)):d["size"+this._pane]});var t=h._init;if(!isNaN(g._init)){t=e[0][d.pxSplit]-e._PBA-g._init-o._DA}if(d.cookie){if(!b.cookie){alert("jQuery.splitter(): jQuery cookie plugin required")}var i=parseInt(b.cookie(d.cookie));if(!isNaN(i)){t=i}b(window).bind("unload",function(){var u=String(o.css(d.origin));b.cookie(d.cookie,u,{expires:d.cookieExpires||365,path:d.cookiePath||document.location.pathname})})}if(isNaN(t)){t=Math.round((e[0][d.pxSplit]-e._PBA-o._DA)/2)}if(d.anchorToWindow){e._hadjust=r(e,"borderTopWidth","borderBottomWidth","marginBottom");e._hmin=Math.max(r(e,"minHeight"),20);b(window).bind("resize",function(){var v=e.offset().top;var u=b(window).height();e.css("height",Math.max(u-v-e._hadjust,e._hmin)+"px");if(!b.browser.msie){e.trigger("resize")}}).trigger("resize")}else{if(d.resizeToWidth&&!b.browser.msie){b(window).bind("resize",function(){e.trigger("resize")})}}e.bind("resize",function(v,u){if(v.target!=this){return}e._DF=e[0][d.pxFixed]-e._PBF;e._DA=e[0][d.pxSplit]-e._PBA;if(e._DF<=0||e._DA<=0){return}n(!isNaN(u)?u:(!(d.sizeRight||d.sizeBottom)?h[0][d.pxSplit]:e._DA-g[0][d.pxSplit]-o._DA))}).trigger("resize",[t])})}})(jQuery);
/*!
	Autosize v1.18.7 - 2014-04-13
	Automatically adjust textarea height based on user input.
	(c) 2014 Jack Moore - http://www.jacklmoore.com/autosize
	license: http://www.opensource.org/licenses/mit-license.php
*/
(function(c){var f={className:"autosizejs",id:"autosizejs",append:"\n",callback:false,resizeDelay:10,placeholder:true},g='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',b=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],e,d=c(g).data("autosize",true)[0];d.style.lineHeight="99px";if(c(d).css("lineHeight")==="99px"){b.push("lineHeight")}d.style.lineHeight="";c.fn.autosize=function(h){if(!this.length){return this}h=c.extend({},f,h||{});if(d.parentNode!==document.body){c(document.body).append(d)}return this.each(function(){var n=this,m=c(n),t,v,l=0,u=c.isFunction(h.callback),o={height:n.style.height,overflow:n.style.overflow,overflowY:n.style.overflowY,wordWrap:n.style.wordWrap,resize:n.style.resize},q,i=m.width();if(m.data("autosize")){return}m.data("autosize",true);if(m.css("box-sizing")==="border-box"||m.css("-moz-box-sizing")==="border-box"||m.css("-webkit-box-sizing")==="border-box"){l=m.outerHeight()-m.height()}v=Math.max(parseInt(m.css("minHeight"),10)-l||0,m.height());m.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:(m.css("resize")==="none"||m.css("resize")==="vertical")?"none":"horizontal"});function p(){var x;var w=window.getComputedStyle?window.getComputedStyle(n,null):false;if(w){x=n.getBoundingClientRect().width;if(x===0||typeof x!=="number"){x=parseInt(w.width,10)}c.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(y,z){x-=parseInt(w[z],10)})}else{x=Math.max(m.width(),0)}d.style.width=x+"px"}function s(){var x={};e=n;d.className=h.className;d.id=h.id;t=parseInt(m.css("maxHeight"),10);c.each(b,function(z,A){x[A]=m.css(A)});c(d).css(x).attr("wrap",m.attr("wrap"));p();if(window.chrome){var w=n.style.width;n.style.width="0px";var y=n.offsetWidth;n.style.width=w}}function r(){var w,x;if(e!==n){s()}else{p()}if(!n.value&&h.placeholder){d.value=(m.attr("placeholder")||"")+h.append}else{d.value=n.value+h.append}d.style.overflowY=n.style.overflowY;x=parseInt(n.style.height,10);d.scrollTop=0;d.scrollTop=90000;w=d.scrollTop;if(t&&w>t){n.style.overflowY="scroll";w=t}else{n.style.overflowY="hidden";if(w<v){w=v}}w+=l;if(x!==w){n.style.height=w+"px";if(u){h.callback.call(n,n)}}}function j(){clearTimeout(q);q=setTimeout(function(){var w=m.width();if(w!==i){i=w;r()}},parseInt(h.resizeDelay,10))}if("onpropertychange" in n){if("oninput" in n){m.on("input.autosize keyup.autosize",r)}else{m.on("propertychange.autosize",function(){if(event.propertyName==="value"){r()}})}}else{m.on("input.autosize",r)}if(h.resizeDelay!==false){c(window).on("resize.autosize",j)}m.on("autosize.resize",r);m.on("autosize.resizeIncludeStyle",function(){e=null;r()});m.on("autosize.destroy",function(){e=null;clearTimeout(q);c(window).off("resize",j);m.off("autosize").off(".autosize").css(o).removeData("autosize")});r()})}}(window.jQuery||window.$));(function(){var j=this,r=this.document;function i(){this._events=this._events||{}}i.prototype.addListener=function(A,B){this._events[A]=this._events[A]||[];this._events[A].push(B)};i.prototype.on=i.prototype.addListener;i.prototype.removeListener=function(B,C){if(!this._events[B]){return}var D=this._events[B],A=D.length;while(A--){if(D[A]===C||D[A].listener===C){D.splice(A,1);return}}};i.prototype.off=i.prototype.removeListener;i.prototype.removeAllListeners=function(A){if(this._events[A]){delete this._events[A]}};i.prototype.once=function(B,C){function A(){var D=Array.prototype.slice.call(arguments);this.removeListener(B,A);return C.apply(this,D)}A.listener=C;return this.on(B,A)};i.prototype.emit=function(D){if(!this._events[D]){return}var B=Array.prototype.slice.call(arguments,1),E=this._events[D],A=E.length,C=0;for(;C<A;C++){E[C].apply(this,B)}};i.prototype.listeners=function(A){return this._events[A]=this._events[A]||[]};var z=0,h=1,s=2,l=3,g=4,q=5,u=6;function v(B){var A=this;if(!(this instanceof v)){return new v(arguments[0],arguments[1],arguments[2])}i.call(this);if(typeof B==="number"){B={cols:arguments[0],rows:arguments[1],handler:arguments[2]}}B=B||{};f(p(v.defaults),function(D){if(B[D]==null){B[D]=v.options[D];if(v[D]!==v.defaults[D]){B[D]=v[D]}}A[D]=B[D]});if(B.colors.length===8){B.colors=B.colors.concat(v._colors.slice(8))}else{if(B.colors.length===16){B.colors=B.colors.concat(v._colors.slice(16))}else{if(B.colors.length===10){B.colors=B.colors.slice(0,-2).concat(v._colors.slice(8,-2),B.colors.slice(-2))}else{if(B.colors.length===18){B.colors=B.colors.slice(0,-2).concat(v._colors.slice(16,-2),B.colors.slice(-2))}}}}this.colors=B.colors;this.options=B;this.parent=B.body||B.parent||(r?r.getElementsByTagName("body")[0]:null);this.cols=B.cols||B.geometry[0];this.rows=B.rows||B.geometry[1];if(B.handler){this.on("data",B.handler)}this.ybase=0;this.ydisp=0;this.x=0;this.y=0;this.cursorState=0;this.cursorHidden=false;this.convertEol;this.state=0;this.queue="";this.scrollTop=0;this.scrollBottom=this.rows-1;this.applicationKeypad=false;this.applicationCursor=false;this.originMode=false;this.insertMode=false;this.wraparoundMode=false;this.normal=null;this.prefixMode=false;this.selectMode=false;this.visualMode=false;this.searchMode=false;this.searchDown;this.entry="";this.entryPrefix="Search: ";this._real;this._selected;this._textarea;this.charset=null;this.gcharset=null;this.glevel=0;this.charsets=[null];this.decLocator;this.x10Mouse;this.vt200Mouse;this.vt300Mouse;this.normalMouse;this.mouseEvents;this.sendFocus;this.utfMouse;this.sgrMouse;this.urxvtMouse;this.element;this.children;this.refreshStart;this.refreshEnd;this.savedX;this.savedY;this.savedCols;this.readable=true;this.writable=true;this.defAttr=(0<<18)|(257<<9)|(256<<0);this.curAttr=this.defAttr;this.params=[];this.currentParam=0;this.prefix="";this.postfix="";this.lines=[];var C=this.rows;while(C--){this.lines.push(this.blankLine())}this.tabs;this.setupStops()}n(v,i);v.prototype.eraseAttr=function(){return(this.defAttr&~511)|(this.curAttr&511)};v.tangoColors=["#2e3436","#cc0000","#4e9a06","#c4a000","#3465a4","#75507b","#06989a","#d3d7cf","#555753","#ef2929","#8ae234","#fce94f","#729fcf","#ad7fa8","#34e2e2","#eeeeec"];v.xtermColors=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"];v.colors=(function(){var A=v.tangoColors.slice(),E=[0,95,135,175,215,255],C;C=0;for(;C<216;C++){B(E[(C/36)%6|0],E[(C/6)%6|0],E[C%6])}C=0;for(;C<24;C++){E=8+C*10;B(E,E,E)}function B(H,G,F){A.push("#"+D(H)+D(G)+D(F))}function D(F){F=F.toString(16);return F.length<2?"0"+F:F}return A})();v.colors[256]="#000000";v.colors[257]="#f0f0f0";v._colors=v.colors.slice();v.vcolors=(function(){var C=[],A=v.colors,D=0,B;for(;D<256;D++){B=parseInt(A[D].substring(1),16);C.push([(B>>16)&255,(B>>8)&255,B&255])}return C})();v.defaults={colors:v.colors,convertEol:false,termName:"xterm",geometry:[80,24],cursorBlink:true,visualBell:false,popOnBell:false,scrollback:1000,screenKeys:false,debug:false,useStyle:false};v.options={};f(p(v.defaults),function(A){v[A]=v.defaults[A];v.options[A]=v.defaults[A]});v.focus=null;v.prototype.focus=function(){if(v.focus===this){return}if(v.focus){v.focus.blur()}if(this.sendFocus){this.send("\x1b[I")}this.showCursor();v.focus=this};v.prototype.blur=function(){if(v.focus!==this){return}this.cursorState=0;this.refresh(this.y,this.y);if(this.sendFocus){this.send("\x1b[O")}v.focus=null};v.prototype.initGlobal=function(){var A=this.document;v._boundDocs=v._boundDocs||[];if(~d(v._boundDocs,A)){return}v._boundDocs.push(A);v.bindPaste(A);v.bindKeys(A);v.bindCopy(A);if(this.isMobile){this.fixMobile(A)}if(this.useStyle){v.insertStyle(A,this.colors[256],this.colors[257])}};v.bindPaste=function(A){var B=A.defaultView;m(B,"paste",function(D){var C=v.focus;if(!C){return}if(D.clipboardData){C.send(D.clipboardData.getData("text/plain"))}else{if(C.context.clipboardData){C.send(C.context.clipboardData.getData("Text"))}}C.element.contentEditable="inherit";return e(D)})};v.bindKeys=function(A){m(A,"keydown",function(B){if(!v.focus){return}var C=B.target||B.srcElement;if(!C){return}if(C===v.focus.element||C===v.focus.context||C===v.focus.document||C===v.focus.body||C===v._textarea||C===v.focus.parent){return v.focus.keyDown(B)}},true);m(A,"keypress",function(B){if(!v.focus){return}var C=B.target||B.srcElement;if(!C){return}if(C===v.focus.element||C===v.focus.context||C===v.focus.document||C===v.focus.body||C===v._textarea||C===v.focus.parent){return v.focus.keyPress(B)}},true);m(A,"mousedown",function(C){if(!v.focus){return}var B=C.target||C.srcElement;if(!B){return}do{if(B===v.focus.element){return}}while(B=B.parentNode);v.focus.blur()})};v.bindCopy=function(A){var B=A.defaultView;m(B,"copy",function(E){var D=v.focus;if(!D){return}if(!D._selected){return}var C=D.getCopyTextarea();var F=D.grabText(D._selected.x1,D._selected.x2,D._selected.y1,D._selected.y2);D.emit("copy",F);C.focus();C.textContent=F;C.value=F;C.setSelectionRange(0,F.length);c(function(){D.element.focus();D.focus()},1)})};v.prototype.fixMobile=function(A){var C=this;var B=A.createElement("textarea");B.style.position="absolute";B.style.left="-32000px";B.style.top="-32000px";B.style.width="0px";B.style.height="0px";B.style.opacity="0";B.style.backgroundColor="transparent";B.style.borderStyle="none";B.style.outlineStyle="none";B.autocapitalize="none";B.autocorrect="off";A.getElementsByTagName("body")[0].appendChild(B);v._textarea=B;c(function(){B.focus()},1000);if(this.isAndroid){m(B,"change",function(){var D=B.textContent||B.value;B.value="";B.textContent="";C.send(D+"\r")})}};v.insertStyle=function(A,D,B){var E=A.getElementById("term-style");if(E){return}var C=A.getElementsByTagName("head")[0];if(!C){return}var E=A.createElement("style");E.id="term-style";E.innerHTML=".terminal {\n  float: left;\n  border: "+D+' solid 5px;\n  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;\n  font-size: 11px;\n  color: '+B+";\n  background: "+D+";\n}\n\n.terminal-cursor {\n  color: "+D+";\n  background: "+B+";\n}\n";C.insertBefore(E,C.firstChild)};v.prototype.open=function(C){var A=this,B=0,D;this.parent=C||this.parent;if(!this.parent){throw new Error("Terminal requires a parent element.")}this.context=this.parent.ownerDocument.defaultView;this.document=this.parent.ownerDocument;this.body=this.document.getElementsByTagName("body")[0];if(this.context.navigator&&this.context.navigator.userAgent){this.isMac=!!~this.context.navigator.userAgent.indexOf("Mac");this.isIpad=!!~this.context.navigator.userAgent.indexOf("iPad");this.isIphone=!!~this.context.navigator.userAgent.indexOf("iPhone");this.isAndroid=!!~this.context.navigator.userAgent.indexOf("Android");this.isMobile=this.isIpad||this.isIphone||this.isAndroid;this.isMSIE=!!~this.context.navigator.userAgent.indexOf("MSIE")}this.element=this.document.createElement("div");this.element.className="terminal";this.element.style.outline="none";this.element.setAttribute("tabindex",0);this.element.setAttribute("spellcheck","false");this.element.style.backgroundColor=this.colors[256];this.element.style.color=this.colors[257];this.children=[];for(;B<this.rows;B++){D=this.document.createElement("div");this.element.appendChild(D);this.children.push(D)}this.parent.appendChild(this.element);this.refresh(0,this.rows-1);this.initGlobal();this.focus();this.startBlink();m(this.element,"focus",function(){A.focus();if(A.isMobile){v._textarea.focus()}});m(this.element,"mousedown",function(){A.focus()});m(this.element,"mousedown",function(F){var E=F.button!=null?+F.button:F.which!=null?F.which-1:null;if(A.isMSIE){E=E===1?0:E===4?1:E}if(E!==2){return}A.element.contentEditable="true";c(function(){A.element.contentEditable="inherit"},1)},true);this.bindMouse();if(v.brokenBold==null){v.brokenBold=x(this.document)}c(function(){A.element.focus()},100)};v.prototype.bindMouse=function(){var B=this.element,J=this,D=32;var E="onmousewheel" in this.context?"mousewheel":"DOMMouseScroll";function H(L){var K,M;K=A(L);M=C(L);if(!M){return}I(K,M);switch(L.type){case"mousedown":D=K;break;case"mouseup":D=32;break;case E:break}}function G(L){var K=D,M;M=C(L);if(!M){return}K+=32;I(K,M)}function F(L,K){if(!J.utfMouse){if(K===255){return L.push(0)}if(K>127){K=127}L.push(K)}else{if(K===2047){return L.push(0)}if(K<127){L.push(K)}else{if(K>2047){K=2047}L.push(192|(K>>6));L.push(128|(K&63))}}}function I(K,M){if(J.vt300Mouse){K&=3;M.x-=32;M.y-=32;var L="\x1b[24";if(K===0){L+="1"}else{if(K===1){L+="3"}else{if(K===2){L+="5"}else{if(K===3){return}else{L+="0"}}}}L+="~["+M.x+","+M.y+"]\r";J.send(L);return}if(J.decLocator){K&=3;M.x-=32;M.y-=32;if(K===0){K=2}else{if(K===1){K=4}else{if(K===2){K=6}else{if(K===3){K=3}}}}J.send("\x1b["+K+";"+(K===3?4:0)+";"+M.y+";"+M.x+";"+(M.page||0)+"&w");return}if(J.urxvtMouse){M.x-=32;M.y-=32;M.x++;M.y++;J.send("\x1b["+K+";"+M.x+";"+M.y+"M");return}if(J.sgrMouse){M.x-=32;M.y-=32;J.send("\x1b[<"+((K&3)===3?K&~3:K)+";"+M.x+";"+M.y+((K&3)===3?"m":"M"));return}var L=[];F(L,K);F(L,M.x);F(L,M.y);J.send("\x1b[M"+w.fromCharCode.apply(w,L))}function A(N){var M,K,P,O,L;switch(N.type){case"mousedown":M=N.button!=null?+N.button:N.which!=null?N.which-1:null;if(J.isMSIE){M=M===1?0:M===4?1:M}break;case"mouseup":M=3;break;case"DOMMouseScroll":M=N.detail<0?64:65;break;case"mousewheel":M=N.wheelDeltaY>0?64:65;break}K=N.shiftKey?4:0;P=N.metaKey?8:0;O=N.ctrlKey?16:0;L=K|P|O;if(J.vt200Mouse){L&=O}else{if(!J.normalMouse){L=0}}M=(32+(L<<2))+M;return M}function C(O){var K,P,L,N,M;if(O.pageX==null){return}K=O.pageX;P=O.pageY;M=J.element;while(M&&M!==J.document.documentElement){K-=M.offsetLeft;P-=M.offsetTop;M="offsetParent" in M?M.offsetParent:M.parentNode}L=J.element.clientWidth;N=J.element.clientHeight;K=Math.round((K/L)*J.cols);P=Math.round((P/N)*J.rows);if(K<0){K=0}if(K>J.cols){K=J.cols}if(P<0){P=0}if(P>J.rows){P=J.rows}K+=32;P+=32;return{x:K,y:P,type:O.type===E?"mousewheel":O.type}}m(B,"mousedown",function(L){if(!J.mouseEvents){return}H(L);J.focus();if(J.vt200Mouse){H({__proto__:L,type:"mouseup"});return e(L)}if(J.normalMouse){m(J.document,"mousemove",G)}if(!J.x10Mouse){m(J.document,"mouseup",function K(M){H(M);if(J.normalMouse){y(J.document,"mousemove",G)}y(J.document,"mouseup",K);return e(M)})}return e(L)});m(B,E,function(K){if(!J.mouseEvents){return}if(J.x10Mouse||J.vt300Mouse||J.decLocator){return}H(K);return e(K)});m(B,E,function(K){if(J.mouseEvents){return}if(J.applicationKeypad){return}if(K.type==="DOMMouseScroll"){J.scrollDisp(K.detail<0?-5:5)}else{J.scrollDisp(K.wheelDeltaY>0?-5:5)}return e(K)})};v.prototype.destroy=function(){this.readable=false;this.writable=false;this._events={};this.handler=function(){};this.write=function(){};if(this.element.parentNode){this.element.parentNode.removeChild(this.element)}};v.prototype.refresh=function(D,F){var M,L,J,P,G,B,C,I,K,H,A,E,O,N;if(F-D>=this.rows/2){N=this.element.parentNode;if(N){N.removeChild(this.element)}}C=this.cols;L=D;if(F>=this.lines.length){this.log("`end` is too large. Most likely a bad CSR.");F=this.lines.length-1}for(;L<=F;L++){O=L+this.ydisp;P=this.lines[O];G="";if(L===this.y&&this.cursorState&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden){M=this.x}else{M=-1}K=this.defAttr;J=0;for(;J<C;J++){I=P[J][0];B=P[J][1];if(J===M){I=-1}if(I!==K){if(K!==this.defAttr){G+="</span>"}if(I!==this.defAttr){if(I===-1){G+='<span class="reverse-video terminal-cursor">'}else{G+='<span style="';H=I&511;A=(I>>9)&511;E=I>>18;if(E&1){if(!v.brokenBold){G+="font-weight:bold;"}if(A<8){A+=8}}if(E&2){G+="text-decoration:underline;"}if(E&4){if(E&2){G=G.slice(0,-1);G+=" blink;"}else{G+="text-decoration:blink;"}}if(E&8){H=(I>>9)&511;A=I&511;if((E&1)&&A<8){A+=8}}if(E&16){G+="visibility:hidden;"}if(H!==256){G+="background-color:"+this.colors[H]+";"}if(A!==257){G+="color:"+this.colors[A]+";"}G+='">'}}}switch(B){case"&":G+="&amp;";break;case"<":G+="&lt;";break;case">":G+="&gt;";break;default:if(B<=" "){G+="&nbsp;"}else{if(t(B)){J++}G+=B}break}K=I}if(K!==this.defAttr){G+="</span>"}this.children[L].innerHTML=G}if(N){N.appendChild(this.element)}};v.prototype._cursorBlink=function(){if(v.focus!==this){return}this.cursorState^=1;this.refresh(this.y,this.y)};v.prototype.showCursor=function(){if(!this.cursorState){this.cursorState=1;this.refresh(this.y,this.y)}else{}};v.prototype.startBlink=function(){if(!this.cursorBlink){return}var A=this;this._blinker=function(){A._cursorBlink()};this._blink=b(this._blinker,500)};v.prototype.refreshBlink=function(){if(!this.cursorBlink){return}clearInterval(this._blink);this._blink=b(this._blinker,500)};v.prototype.scroll=function(){var A;if(++this.ybase===this.scrollback){this.ybase=this.ybase/2|0;this.lines=this.lines.slice(-(this.ybase+this.rows)+1)}this.ydisp=this.ybase;A=this.ybase+this.rows-1;A-=this.rows-1-this.scrollBottom;if(A===this.lines.length){this.lines.push(this.blankLine())}else{this.lines.splice(A,0,this.blankLine())}if(this.scrollTop!==0){if(this.ybase!==0){this.ybase--;this.ydisp=this.ybase}this.lines.splice(this.ybase+this.scrollTop,1)}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};v.prototype.scrollDisp=function(A){this.ydisp+=A;if(this.ydisp>this.ybase){this.ydisp=this.ybase}else{if(this.ydisp<0){this.ydisp=0}}this.refresh(0,this.rows-1)};v.prototype.write=function(G){var A=G.length,C=0,B,E,D;this.refreshStart=this.y;this.refreshEnd=this.y;if(this.ybase!==this.ydisp){this.ydisp=this.ybase;this.maxRange()}for(;C<A;C++){D=G[C];switch(this.state){case z:switch(D){case"\x07":this.bell();break;case"\n":case"\x0b":case"\x0c":if(this.convertEol){this.x=0}this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}break;case"\r":this.x=0;break;case"\b":if(this.x>0){this.x--}break;case"\t":this.x=this.nextStop();break;case"\x0e":this.setgLevel(1);break;case"\x0f":this.setgLevel(0);break;case"\x1b":this.state=h;break;default:if(D>=" "){if(this.charset&&this.charset[D]){D=this.charset[D]}if(this.x>=this.cols){this.x=0;this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}}this.lines[this.y+this.ybase][this.x]=[this.curAttr,D];this.x++;this.updateRange(this.y);if(t(D)){B=this.y+this.ybase;if(this.cols<2||this.x>=this.cols){this.lines[B][this.x-1]=[this.curAttr," "];break}this.lines[B][this.x]=[this.curAttr," "];this.x++}}break}break;case h:switch(D){case"[":this.params=[];this.currentParam=0;this.state=s;break;case"]":this.params=[];this.currentParam=0;this.state=l;break;case"P":this.params=[];this.currentParam=0;this.state=q;break;case"_":this.state=u;break;case"^":this.state=u;break;case"c":this.reset();break;case"E":this.x=0;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0);this.setgCharset(0,v.charsets.US);this.state=z;C++;break;case"(":case")":case"*":case"+":case"-":case".":switch(D){case"(":this.gcharset=0;break;case")":this.gcharset=1;break;case"*":this.gcharset=2;break;case"+":this.gcharset=3;break;case"-":this.gcharset=1;break;case".":this.gcharset=2;break}this.state=g;break;case"/":this.gcharset=3;this.state=g;C--;break;case"N":break;case"O":break;case"n":this.setgLevel(2);break;case"o":this.setgLevel(3);break;case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor();this.state=z;break;case"8":this.restoreCursor();this.state=z;break;case"#":this.state=z;C++;break;case"H":this.tabSet();break;case"=":this.log("Serial port requested application keypad.");this.applicationKeypad=true;this.state=z;break;case">":this.log("Switching back to normal keypad.");this.applicationKeypad=false;this.state=z;break;default:this.state=z;this.error("Unknown ESC control: %s.",D);break}break;case g:switch(D){case"0":E=v.charsets.SCLD;break;case"A":E=v.charsets.UK;break;case"B":E=v.charsets.US;break;case"4":E=v.charsets.Dutch;break;case"C":case"5":E=v.charsets.Finnish;break;case"R":E=v.charsets.French;break;case"Q":E=v.charsets.FrenchCanadian;break;case"K":E=v.charsets.German;break;case"Y":E=v.charsets.Italian;break;case"E":case"6":E=v.charsets.NorwegianDanish;break;case"Z":E=v.charsets.Spanish;break;case"H":case"7":E=v.charsets.Swedish;break;case"=":E=v.charsets.Swiss;break;case"/":E=v.charsets.ISOLatin;C++;break;default:E=v.charsets.US;break}this.setgCharset(this.gcharset,E);this.gcharset=null;this.state=z;break;case l:if(D==="\x1b"||D==="\x07"){if(D==="\x1b"){C++}this.params.push(this.currentParam);switch(this.params[0]){case 0:case 1:case 2:if(this.params[1]){this.title=this.params[1];this.handleTitle(this.title)}break;case 3:break;case 4:case 5:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 46:break;case 50:break;case 51:break;case 52:break;case 104:case 105:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:break}this.params=[];this.currentParam=0;this.state=z}else{if(!this.params.length){if(D>="0"&&D<="9"){this.currentParam=this.currentParam*10+D.charCodeAt(0)-48}else{if(D===";"){this.params.push(this.currentParam);this.currentParam=""}}}else{this.currentParam+=D}}break;case s:if(D==="?"||D===">"||D==="!"){this.prefix=D;break}if(D>="0"&&D<="9"){this.currentParam=this.currentParam*10+D.charCodeAt(0)-48;break}if(D==="$"||D==='"'||D===" "||D==="'"){this.postfix=D;break}this.params.push(this.currentParam);this.currentParam=0;if(D===";"){break}this.state=z;switch(D){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":if(!this.prefix){this.charAttributes(this.params)}break;case"n":if(!this.prefix){this.deviceStatus(this.params)}break;case"@":this.insertChars(this.params);break;case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":if(this.params.length<2&&!this.prefix){this.scrollDown(this.params)}break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":switch(this.prefix){case"!":this.softReset(this.params);break}break;default:this.error("Unknown CSI code: %s.",D);break}this.prefix="";this.postfix="";break;case q:if(D==="\x1b"||D==="\x07"){if(D==="\x1b"){C++}switch(this.prefix){case"":break;case"$q":var H=this.currentParam,F=false;switch(H){case'"q':H='0"q';break;case'"p':H='61"p';break;case"r":H=""+(this.scrollTop+1)+";"+(this.scrollBottom+1)+"r";break;case"m":H="0m";break;default:this.error("Unknown DCS Pt: %s.",H);H="";break}this.send("\x1bP"+ +F+"$r"+H+"\x1b\\");break;case"+p":break;case"+q":var H=this.currentParam,F=false;this.send("\x1bP"+ +F+"+r"+H+"\x1b\\");break;default:this.error("Unknown DCS prefix: %s.",this.prefix);break}this.currentParam=0;this.prefix="";this.state=z}else{if(!this.currentParam){if(!this.prefix&&D!=="$"&&D!=="+"){this.currentParam=D}else{if(this.prefix.length===2){this.currentParam=D}else{this.prefix+=D}}}else{this.currentParam+=D}}break;case u:if(D==="\x1b"||D==="\x07"){if(D==="\x1b"){C++}this.state=z}break}}this.updateRange(this.y);this.refresh(this.refreshStart,this.refreshEnd)};v.prototype.writeln=function(A){this.write(A+"\r\n")};v.prototype.keyDown=function(C){var A=this,B;switch(C.keyCode){case 8:if(C.shiftKey){B="\x08";break}B="\x7f";break;case 9:if(C.shiftKey){B="\x1b[Z";break}B="\t";break;case 13:B="\r";break;case 27:B="\x1b";break;case 37:if(this.applicationCursor){B="\x1bOD";break}B="\x1b[D";break;case 39:if(this.applicationCursor){B="\x1bOC";break}B="\x1b[C";break;case 38:if(this.applicationCursor){B="\x1bOA";break}if(C.ctrlKey){this.scrollDisp(-1);return e(C)}else{B="\x1b[A"}break;case 40:if(this.applicationCursor){B="\x1bOB";break}if(C.ctrlKey){this.scrollDisp(1);return e(C)}else{B="\x1b[B"}break;case 46:B="\x1b[3~";break;case 45:B="\x1b[2~";break;case 36:if(this.applicationKeypad){B="\x1bOH";break}B="\x1bOH";break;case 35:if(this.applicationKeypad){B="\x1bOF";break}B="\x1bOF";break;case 33:if(C.shiftKey){this.scrollDisp(-(this.rows-1));return e(C)}else{B="\x1b[5~"}break;case 34:if(C.shiftKey){this.scrollDisp(this.rows-1);return e(C)}else{B="\x1b[6~"}break;case 112:B="\x1bOP";break;case 113:B="\x1bOQ";break;case 114:B="\x1bOR";break;case 115:B="\x1bOS";break;case 116:B="\x1b[15~";break;case 117:B="\x1b[17~";break;case 118:B="\x1b[18~";break;case 119:B="\x1b[19~";break;case 120:B="\x1b[20~";break;case 121:B="\x1b[21~";break;case 122:B="\x1b[23~";break;case 123:B="\x1b[24~";break;default:if(C.ctrlKey){if(C.keyCode>=65&&C.keyCode<=90){if(this.screenKeys){if(!this.prefixMode&&!this.selectMode&&C.keyCode===65){this.enterPrefix();return e(C)}}if(this.prefixMode&&C.keyCode===86){this.leavePrefix();return}if((this.prefixMode||this.selectMode)&&C.keyCode===67){if(this.visualMode){c(function(){A.leaveVisual()},1)}return}B=w.fromCharCode(C.keyCode-64)}else{if(C.keyCode===32){B=w.fromCharCode(0)}else{if(C.keyCode>=51&&C.keyCode<=55){B=w.fromCharCode(C.keyCode-51+27)}else{if(C.keyCode===56){B=w.fromCharCode(127)}else{if(C.keyCode===219){B=w.fromCharCode(27)}else{if(C.keyCode===221){B=w.fromCharCode(29)}}}}}}}else{if((!this.isMac&&C.altKey)||(this.isMac&&C.metaKey)){if(C.keyCode>=65&&C.keyCode<=90){B="\x1b"+w.fromCharCode(C.keyCode+32)}else{if(C.keyCode===192){B="\x1b`"}else{if(C.keyCode>=48&&C.keyCode<=57){B="\x1b"+(C.keyCode-48)}}}}}break}if(!B){return true}if(this.prefixMode){this.leavePrefix();return e(C)}if(this.selectMode){this.keySelect(C,B);return e(C)}this.emit("keydown",C);this.emit("key",B,C);this.showCursor();this.handler(B);return e(C)};v.prototype.setgLevel=function(A){this.glevel=A;this.charset=this.charsets[A]};v.prototype.setgCharset=function(A,B){this.charsets[A]=B;if(this.glevel===A){this.charset=B}};v.prototype.keyPress=function(B){var A;e(B);if(B.charCode){A=B.charCode}else{if(B.which==null){A=B.keyCode}else{if(B.which!==0&&B.charCode!==0){A=B.which}else{return false}}}if(!A||B.ctrlKey||B.altKey||B.metaKey){return false}A=w.fromCharCode(A);if(this.prefixMode){this.leavePrefix();this.keyPrefix(B,A);return false}if(this.selectMode){this.keySelect(B,A);return false}this.emit("keypress",A,B);this.emit("key",A,B);this.showCursor();this.handler(A);return false};v.prototype.send=function(B){var A=this;if(!this.queue){c(function(){A.handler(A.queue);A.queue=""},1)}this.queue+=B};v.prototype.bell=function(){this.emit("bell");if(!this.visualBell){return}var A=this;this.element.style.borderColor="white";c(function(){A.element.style.borderColor=""},10);if(this.popOnBell){this.focus()}};v.prototype.log=function(){if(!this.debug){return}if(!this.context.console||!this.context.console.log){return}var A=Array.prototype.slice.call(arguments);this.context.console.log.apply(this.context.console,A)};v.prototype.error=function(){if(!this.debug){return}if(!this.context.console||!this.context.console.error){return}var A=Array.prototype.slice.call(arguments);this.context.console.error.apply(this.context.console,A)};v.prototype.resize=function(A,G){var B,F,D,C,E;if(A<1){A=1}if(G<1){G=1}C=this.cols;if(C<A){E=[this.defAttr," "];D=this.lines.length;while(D--){while(this.lines[D].length<A){this.lines[D].push(E)}}}else{if(C>A){D=this.lines.length;while(D--){while(this.lines[D].length>A){this.lines[D].pop()}}}}this.setupStops(C);this.cols=A;C=this.rows;if(C<G){F=this.element;while(C++<G){if(this.lines.length<G+this.ybase){this.lines.push(this.blankLine())}if(this.children.length<G){B=this.document.createElement("div");F.appendChild(B);this.children.push(B)}}}else{if(C>G){while(C-->G){if(this.lines.length>G+this.ybase){this.lines.pop()}if(this.children.length>G){F=this.children.pop();if(!F){continue}F.parentNode.removeChild(F)}}}}this.rows=G;if(this.y>=G){this.y=G-1}if(this.x>=A){this.x=A-1}this.scrollTop=0;this.scrollBottom=G-1;this.refresh(0,this.rows-1);this.normal=null};v.prototype.updateRange=function(A){if(A<this.refreshStart){this.refreshStart=A}if(A>this.refreshEnd){this.refreshEnd=A}};v.prototype.maxRange=function(){this.refreshStart=0;this.refreshEnd=this.rows-1};v.prototype.setupStops=function(A){if(A!=null){if(!this.tabs[A]){A=this.prevStop(A)}}else{this.tabs={};A=0}for(;A<this.cols;A+=8){this.tabs[A]=true}};v.prototype.prevStop=function(A){if(A==null){A=this.x}while(!this.tabs[--A]&&A>0){}return A>=this.cols?this.cols-1:A<0?0:A};v.prototype.nextStop=function(A){if(A==null){A=this.x}while(!this.tabs[++A]&&A<this.cols){}return A>=this.cols?this.cols-1:A<0?0:A};v.prototype.eraseRight=function(A,D){var B=this.lines[this.ybase+D],C=[this.eraseAttr()," "];for(;A<this.cols;A++){B[A]=C}this.updateRange(D)};v.prototype.eraseLeft=function(A,D){var B=this.lines[this.ybase+D],C=[this.eraseAttr()," "];A++;while(A--){B[A]=C}this.updateRange(D)};v.prototype.eraseLine=function(A){this.eraseRight(0,A)};v.prototype.blankLine=function(E){var A=E?this.eraseAttr():this.defAttr;var D=[A," "],B=[],C=0;for(;C<this.cols;C++){B[C]=D}return B};v.prototype.ch=function(A){return A?[this.eraseAttr()," "]:[this.defAttr," "]};v.prototype.is=function(B){var A=this.termName;return(A+"").indexOf(B)===0};v.prototype.handler=function(A){this.emit("data",A)};v.prototype.handleTitle=function(A){this.emit("title",A)};v.prototype.index=function(){this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}this.state=z};v.prototype.reverseIndex=function(){var A;this.y--;if(this.y<this.scrollTop){this.y++;this.lines.splice(this.y+this.ybase,0,this.blankLine(true));A=this.rows-1-this.scrollBottom;this.lines.splice(this.rows-1+this.ybase-A+1,1);this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)}this.state=z};v.prototype.reset=function(){this.options.rows=this.rows;this.options.cols=this.cols;v.call(this,this.options);this.refresh(0,this.rows-1)};v.prototype.tabSet=function(){this.tabs[this.x]=true;this.state=z};v.prototype.cursorUp=function(B){var A=B[0];if(A<1){A=1}this.y-=A;if(this.y<0){this.y=0}};v.prototype.cursorDown=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}};v.prototype.cursorForward=function(B){var A=B[0];if(A<1){A=1}this.x+=A;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.cursorBackward=function(B){var A=B[0];if(A<1){A=1}this.x-=A;if(this.x<0){this.x=0}};v.prototype.cursorPos=function(C){var B,A;B=C[0]-1;if(C.length>=2){A=C[1]-1}else{A=0}if(B<0){B=0}else{if(B>=this.rows){B=this.rows-1}}if(A<0){A=0}else{if(A>=this.cols){A=this.cols-1}}this.x=A;this.y=B};v.prototype.eraseInDisplay=function(B){var A;switch(B[0]){case 0:this.eraseRight(this.x,this.y);A=this.y+1;for(;A<this.rows;A++){this.eraseLine(A)}break;case 1:this.eraseLeft(this.x,this.y);A=this.y;while(A--){this.eraseLine(A)}break;case 2:A=this.rows;while(A--){this.eraseLine(A)}break;case 3:break}};v.prototype.eraseInLine=function(A){switch(A[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y);break}};v.prototype.charAttributes=function(G){if(G.length===1&&G[0]===0){this.curAttr=this.defAttr;return}var C=G.length,E=0,B=this.curAttr>>18,A=(this.curAttr>>9)&511,D=this.curAttr&511,F;for(;E<C;E++){F=G[E];if(F>=30&&F<=37){A=F-30}else{if(F>=40&&F<=47){D=F-40}else{if(F>=90&&F<=97){F+=8;A=F-90}else{if(F>=100&&F<=107){F+=8;D=F-100}else{if(F===0){B=this.defAttr>>18;A=(this.defAttr>>9)&511;D=this.defAttr&511}else{if(F===1){B|=1}else{if(F===4){B|=2}else{if(F===5){B|=4}else{if(F===7){B|=8}else{if(F===8){B|=16}else{if(F===22){B&=~1}else{if(F===24){B&=~2}else{if(F===25){B&=~4}else{if(F===27){B&=~8}else{if(F===28){B&=~16}else{if(F===39){A=(this.defAttr>>9)&511}else{if(F===49){D=this.defAttr&511}else{if(F===38){if(G[E+1]===2){E+=2;A=o(G[E]&255,G[E+1]&255,G[E+2]&255);if(A===-1){A=511}E+=2}else{if(G[E+1]===5){E+=2;F=G[E]&255;A=F}}}else{if(F===48){if(G[E+1]===2){E+=2;D=o(G[E]&255,G[E+1]&255,G[E+2]&255);if(D===-1){D=511}E+=2}else{if(G[E+1]===5){E+=2;F=G[E]&255;D=F}}}else{if(F===100){A=(this.defAttr>>9)&511;D=this.defAttr&511}else{this.error("Unknown SGR attribute: %d.",F)}}}}}}}}}}}}}}}}}}}}}this.curAttr=(B<<18)|(A<<9)|D};v.prototype.deviceStatus=function(A){if(!this.prefix){switch(A[0]){case 5:this.send("\x1b[0n");break;case 6:this.send("\x1b["+(this.y+1)+";"+(this.x+1)+"R");break}}else{if(this.prefix==="?"){switch(A[0]){case 6:this.send("\x1b[?"+(this.y+1)+";"+(this.x+1)+"R");break;case 15:break;case 25:break;case 26:break;case 53:break}}}};v.prototype.insertChars=function(E){var D,C,A,B;D=E[0];if(D<1){D=1}C=this.y+this.ybase;A=this.x;B=[this.eraseAttr()," "];while(D--&&A<this.cols){this.lines[C].splice(A++,0,B);this.lines[C].pop()}};v.prototype.cursorNextLine=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}this.x=0};v.prototype.cursorPrecedingLine=function(B){var A=B[0];if(A<1){A=1}this.y-=A;if(this.y<0){this.y=0}this.x=0};v.prototype.cursorCharAbsolute=function(B){var A=B[0];if(A<1){A=1}this.x=A-1};v.prototype.insertLines=function(D){var C,B,A;C=D[0];if(C<1){C=1}B=this.y+this.ybase;A=this.rows-1-this.scrollBottom;A=this.rows-1+this.ybase-A+1;while(C--){this.lines.splice(B,0,this.blankLine(true));this.lines.splice(A,1)}this.updateRange(this.y);this.updateRange(this.scrollBottom)};v.prototype.deleteLines=function(D){var C,B,A;C=D[0];if(C<1){C=1}B=this.y+this.ybase;A=this.rows-1-this.scrollBottom;A=this.rows-1+this.ybase-A;while(C--){this.lines.splice(A+1,0,this.blankLine(true));this.lines.splice(B,1)}this.updateRange(this.y);this.updateRange(this.scrollBottom)};v.prototype.deleteChars=function(D){var C,B,A;C=D[0];if(C<1){C=1}B=this.y+this.ybase;A=[this.eraseAttr()," "];while(C--){this.lines[B].splice(this.x,1);this.lines[B].push(A)}};v.prototype.eraseChars=function(E){var D,C,A,B;D=E[0];if(D<1){D=1}C=this.y+this.ybase;A=this.x;B=[this.eraseAttr()," "];while(D--&&A<this.cols){this.lines[C][A++]=B}};v.prototype.charPosAbsolute=function(B){var A=B[0];if(A<1){A=1}this.x=A-1;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.HPositionRelative=function(B){var A=B[0];if(A<1){A=1}this.x+=A;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.sendDeviceAttributes=function(A){if(A[0]>0){return}if(!this.prefix){if(this.is("xterm")||this.is("rxvt-unicode")||this.is("screen")){this.send("\x1b[?1;2c")}else{if(this.is("linux")){this.send("\x1b[?6c")}}}else{if(this.prefix===">"){if(this.is("xterm")){this.send("\x1b[>0;276;0c")}else{if(this.is("rxvt-unicode")){this.send("\x1b[>85;95;0c")}else{if(this.is("linux")){this.send(A[0]+"c")}else{if(this.is("screen")){this.send("\x1b[>83;40003;0c")}}}}}}};v.prototype.linePosAbsolute=function(B){var A=B[0];if(A<1){A=1}this.y=A-1;if(this.y>=this.rows){this.y=this.rows-1}};v.prototype.VPositionRelative=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}};v.prototype.HVPosition=function(A){if(A[0]<1){A[0]=1}if(A[1]<1){A[1]=1}this.y=A[0]-1;if(this.y>=this.rows){this.y=this.rows-1}this.x=A[1]-1;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.setMode=function(D){if(typeof D==="object"){var A=D.length,B=0;for(;B<A;B++){this.setMode(D[B])}return}if(!this.prefix){switch(D){case 4:this.insertMode=true;break;case 20:break}}else{if(this.prefix==="?"){switch(D){case 1:this.applicationCursor=true;break;case 2:this.setgCharset(0,v.charsets.US);this.setgCharset(1,v.charsets.US);this.setgCharset(2,v.charsets.US);this.setgCharset(3,v.charsets.US);break;case 3:this.savedCols=this.cols;this.resize(132,this.rows);break;case 6:this.originMode=true;break;case 7:this.wraparoundMode=true;break;case 12:break;case 66:this.log("Serial port requested application keypad.");this.applicationKeypad=true;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=D===9;this.vt200Mouse=D===1000;this.normalMouse=D>1000;this.mouseEvents=true;this.element.style.cursor="default";this.log("Binding to mouse events.");break;case 1004:this.sendFocus=true;break;case 1005:this.utfMouse=true;break;case 1006:this.sgrMouse=true;break;case 1015:this.urxvtMouse=true;break;case 25:this.cursorHidden=false;break;case 1049:case 47:case 1047:if(!this.normal){var C={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset();this.normal=C;this.showCursor()}break}}}};v.prototype.resetMode=function(C){if(typeof C==="object"){var A=C.length,B=0;for(;B<A;B++){this.resetMode(C[B])}return}if(!this.prefix){switch(C){case 4:this.insertMode=false;break;case 20:break}}else{if(this.prefix==="?"){switch(C){case 1:this.applicationCursor=false;break;case 3:if(this.cols===132&&this.savedCols){this.resize(this.savedCols,this.rows)}delete this.savedCols;break;case 6:this.originMode=false;break;case 7:this.wraparoundMode=false;break;case 12:break;case 66:this.log("Switching back to normal keypad.");this.applicationKeypad=false;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=false;this.vt200Mouse=false;this.normalMouse=false;this.mouseEvents=false;this.element.style.cursor="";break;case 1004:this.sendFocus=false;break;case 1005:this.utfMouse=false;break;case 1006:this.sgrMouse=false;break;case 1015:this.urxvtMouse=false;break;case 25:this.cursorHidden=true;break;case 1049:case 47:case 1047:if(this.normal){this.lines=this.normal.lines;this.ybase=this.normal.ybase;this.ydisp=this.normal.ydisp;this.x=this.normal.x;this.y=this.normal.y;this.scrollTop=this.normal.scrollTop;this.scrollBottom=this.normal.scrollBottom;this.tabs=this.normal.tabs;this.normal=null;this.refresh(0,this.rows-1);this.showCursor()}break}}}};v.prototype.setScrollRegion=function(A){if(this.prefix){return}this.scrollTop=(A[0]||1)-1;this.scrollBottom=(A[1]||this.rows)-1;this.x=0;this.y=0};v.prototype.saveCursor=function(A){this.savedX=this.x;this.savedY=this.y};v.prototype.restoreCursor=function(A){this.x=this.savedX||0;this.y=this.savedY||0};v.prototype.cursorForwardTab=function(B){var A=B[0]||1;while(A--){this.x=this.nextStop()}};v.prototype.scrollUp=function(B){var A=B[0]||1;while(A--){this.lines.splice(this.ybase+this.scrollTop,1);this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine())}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};v.prototype.scrollDown=function(B){var A=B[0]||1;while(A--){this.lines.splice(this.ybase+this.scrollBottom,1);this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine())}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};v.prototype.initMouseTracking=function(A){};v.prototype.resetTitleModes=function(A){};v.prototype.cursorBackwardTab=function(B){var A=B[0]||1;while(A--){this.x=this.prevStop()}};v.prototype.repeatPrecedingCharacter=function(D){var C=D[0]||1,A=this.lines[this.ybase+this.y],B=A[this.x-1]||[this.defAttr," "];while(C--){A[this.x++]=B}};v.prototype.tabClear=function(B){var A=B[0];if(A<=0){delete this.tabs[this.x]}else{if(A===3){this.tabs={}}}};v.prototype.mediaCopy=function(A){};v.prototype.setResources=function(A){};v.prototype.disableModifiers=function(A){};v.prototype.setPointerMode=function(A){};v.prototype.softReset=function(A){this.cursorHidden=false;this.insertMode=false;this.originMode=false;this.wraparoundMode=false;this.applicationKeypad=false;this.applicationCursor=false;this.scrollTop=0;this.scrollBottom=this.rows-1;this.curAttr=this.defAttr;this.x=this.y=0;this.charset=null;this.glevel=0;this.charsets=[null]};v.prototype.requestAnsiMode=function(A){};v.prototype.requestPrivateMode=function(A){};v.prototype.setConformanceLevel=function(A){};v.prototype.loadLEDs=function(A){};v.prototype.setCursorStyle=function(A){};v.prototype.setCharProtectionAttr=function(A){};v.prototype.restorePrivateValues=function(A){};v.prototype.setAttrInRectangle=function(H){var F=H[0],D=H[1],B=H[2],G=H[3],A=H[4];var C,E;for(;F<B+1;F++){C=this.lines[this.ybase+F];for(E=D;E<G;E++){C[E]=[A,C[E][1]]}}this.updateRange(H[0]);this.updateRange(H[2])};v.prototype.savePrivateValues=function(A){};v.prototype.manipulateWindow=function(A){};v.prototype.reverseAttrInRectangle=function(A){};v.prototype.setTitleModeFeature=function(A){};v.prototype.setWarningBellVolume=function(A){};v.prototype.setMarginBellVolume=function(A){};v.prototype.copyRectangle=function(A){};v.prototype.enableFilterRectangle=function(A){};v.prototype.requestParameters=function(A){};v.prototype.selectChangeExtent=function(A){};v.prototype.fillRectangle=function(H){var F=H[0],E=H[1],C=H[2],A=H[3],G=H[4];var B,D;for(;E<A+1;E++){B=this.lines[this.ybase+E];for(D=C;D<G;D++){B[D]=[B[D][0],w.fromCharCode(F)]}}this.updateRange(H[1]);this.updateRange(H[3])};v.prototype.enableLocatorReporting=function(B){var A=B[0]>0};v.prototype.eraseRectangle=function(H){var E=H[0],C=H[1],A=H[2],G=H[3];var B,D,F;F=[this.eraseAttr()," "];for(;E<A+1;E++){B=this.lines[this.ybase+E];for(D=C;D<G;D++){B[D]=F}}this.updateRange(H[0]);this.updateRange(H[2])};v.prototype.setLocatorEvents=function(A){};v.prototype.selectiveEraseRectangle=function(A){};v.prototype.requestLocatorPosition=function(A){};v.prototype.insertColumns=function(){var D=params[0],A=this.ybase+this.rows,C=[this.eraseAttr()," "],B;while(D--){for(B=this.ybase;B<A;B++){this.lines[B].splice(this.x+1,0,C);this.lines[B].pop()}}this.maxRange()};v.prototype.deleteColumns=function(){var D=params[0],A=this.ybase+this.rows,C=[this.eraseAttr()," "],B;while(D--){for(B=this.ybase;B<A;B++){this.lines[B].splice(this.x,1);this.lines[B].push(C)}}this.maxRange()};v.prototype.enterPrefix=function(){this.prefixMode=true};v.prototype.leavePrefix=function(){this.prefixMode=false};v.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write};this.write=function(){};this.selectMode=true;this.visualMode=false;this.cursorHidden=false;this.refresh(this.y,this.y)};v.prototype.leaveSelect=function(){this.x=this._real.x;this.y=this._real.y;this.ydisp=this._real.ydisp;this.ybase=this._real.ybase;this.cursorHidden=this._real.cursorHidden;this.lines=this._real.lines;this.write=this._real.write;delete this._real;this.selectMode=false;this.visualMode=false;this.refresh(0,this.rows-1)};v.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines);this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y);this.visualMode=true};v.prototype.leaveVisual=function(){this.lines=this._real.preVisual;delete this._real.preVisual;delete this._selected;this.visualMode=false;this.refresh(0,this.rows-1)};v.prototype.enterSearch=function(C){this.entry="";this.searchMode=true;this.searchDown=C;this._real.preSearch=this.copyBuffer(this.lines);this._real.preSearchX=this.x;this._real.preSearchY=this.y;var A=this.ydisp+this.rows-1;for(var B=0;B<this.entryPrefix.length;B++){this.lines[A][B]=[(this.defAttr&~511)|4,this.entryPrefix[B]]}this.y=this.rows-1;this.x=this.entryPrefix.length;this.refresh(this.rows-1,this.rows-1)};v.prototype.leaveSearch=function(){this.searchMode=false;if(this._real.preSearch){this.lines=this._real.preSearch;this.x=this._real.preSearchX;this.y=this._real.preSearchY;delete this._real.preSearch;delete this._real.preSearchX;delete this._real.preSearchY}this.refresh(this.rows-1,this.rows-1)};v.prototype.copyBuffer=function(B){var B=B||this.lines,C=[];for(var D=0;D<B.length;D++){C[D]=[];for(var A=0;A<B[D].length;A++){C[D][A]=[B[D][A][0],B[D][A][1]]}}return C};v.prototype.getCopyTextarea=function(C){var B=this._copyTextarea,A=this.document;if(!B){B=A.createElement("textarea");B.style.position="absolute";B.style.left="-32000px";B.style.top="-32000px";B.style.width="0px";B.style.height="0px";B.style.opacity="0";B.style.backgroundColor="transparent";B.style.borderStyle="none";B.style.outlineStyle="none";A.getElementsByTagName("body")[0].appendChild(B);this._copyTextarea=B}return B};v.prototype.copyText=function(C){var B=this,A=this.getCopyTextarea();this.emit("copy",C);A.focus();A.textContent=C;A.value=C;A.setSelectionRange(0,C.length);c(function(){B.element.focus();B.focus()},1)};v.prototype.selectText=function(B,A,K,I){var D,C,M,L,E,J,H,F,G;if(this._selected){D=this._selected.x1;C=this._selected.x2;M=this._selected.y1;L=this._selected.y2;if(L<M){E=C;C=D;D=E;E=L;L=M;M=E}if(C<D&&M===L){E=C;C=D;D=E}for(H=M;H<=L;H++){J=0;F=this.cols-1;if(H===M){J=D}if(H===L){F=C}for(;J<=F;J++){if(this.lines[H][J].old!=null){G=this.lines[H][J].old;delete this.lines[H][J].old;this.lines[H][J]=[G,this.lines[H][J][1]]}}}K=this._selected.y1;B=this._selected.x1}K=Math.max(K,0);K=Math.min(K,this.ydisp+this.rows-1);I=Math.max(I,0);I=Math.min(I,this.ydisp+this.rows-1);this._selected={x1:B,x2:A,y1:K,y2:I};if(I<K){E=A;A=B;B=E;E=I;I=K;K=E}if(A<B&&K===I){E=A;A=B;B=E}for(H=K;H<=I;H++){J=0;F=this.cols-1;if(H===K){J=B}if(H===I){F=A}for(;J<=F;J++){G=this.lines[H][J][0];this.lines[H][J]=[(G&~511)|((511<<9)|4),this.lines[H][J][1]];this.lines[H][J].old=G}}K=K-this.ydisp;I=I-this.ydisp;K=Math.max(K,0);K=Math.min(K,this.rows-1);I=Math.max(I,0);I=Math.min(I,this.rows-1);this.refresh(0,this.rows-1)};v.prototype.grabText=function(C,B,J,I){var E="",D="",A,K,H,G,F;if(I<J){F=B;B=C;C=F;F=I;I=J;J=F}if(B<C&&J===I){F=B;B=C;C=F}for(H=J;H<=I;H++){K=0;G=this.cols-1;if(H===J){K=C}if(H===I){G=B}for(;K<=G;K++){A=this.lines[H][K][1];if(A===" "){D+=A;continue}if(D){E+=D;D=""}E+=A;if(t(A)){K++}}D="";E+="\n"}for(K=B,H=I;K<this.cols;K++){if(this.lines[H][K][1]!==" "){E=E.slice(0,-1);break}}return E};v.prototype.keyPrefix=function(B,A){if(A==="k"||A==="&"){this.destroy()}else{if(A==="p"||A==="]"){this.emit("request paste")}else{if(A==="c"){this.emit("request create")}else{if(A>="0"&&A<="9"){A=+A-1;if(!~A){A=9}this.emit("request term",A)}else{if(A==="n"){this.emit("request term next")}else{if(A==="P"){this.emit("request term previous")}else{if(A===":"){this.emit("request command mode")}else{if(A==="["){this.enterSelect()}}}}}}}}};v.prototype.keySelect=function(I,K){this.showCursor();if(this.searchMode||K==="n"||K==="N"){return this.keySearch(I,K)}if(K==="\x04"){var H=this.ydisp+this.y;if(this.ydisp===this.ybase){this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1);this.refresh(0,this.rows-1)}else{this.scrollDisp((this.rows-1)/2|0)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="\x15"){var H=this.ydisp+this.y;if(this.ydisp===0){this.y=Math.max(this.y-(this.rows-1)/2|0,0);this.refresh(0,this.rows-1)}else{this.scrollDisp(-(this.rows-1)/2|0)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="\x06"){var H=this.ydisp+this.y;this.scrollDisp(this.rows-1);if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="\x02"){var H=this.ydisp+this.y;this.scrollDisp(-(this.rows-1));if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="k"||K==="\x1b[A"){var H=this.ydisp+this.y;this.y--;if(this.y<0){this.y=0;this.scrollDisp(-1)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}else{this.refresh(this.y,this.y+1)}return}if(K==="j"||K==="\x1b[B"){var H=this.ydisp+this.y;this.y++;if(this.y>=this.rows){this.y=this.rows-1;this.scrollDisp(1)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}else{this.refresh(this.y-1,this.y)}return}if(K==="h"||K==="\x1b[D"){var J=this.x;this.x--;if(this.x<0){this.x=0}if(this.visualMode){this.selectText(J,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="l"||K==="\x1b[C"){var J=this.x;this.x++;if(this.x>=this.cols){this.x=this.cols-1}if(this.visualMode){this.selectText(J,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="v"||K===" "){if(!this.visualMode){this.enterVisual()}else{this.leaveVisual()}return}if(K==="y"){if(this.visualMode){var M=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2);this.copyText(M);this.leaveVisual()}return}if(K==="q"||K==="\x1b"){if(this.visualMode){this.leaveVisual()}else{this.leaveSelect()}return}if(K==="w"||K==="W"){var C=this.x;var B=this.y;var G=this.ydisp;var J=this.x;var H=this.y;var F=this.ydisp;var A=false;for(;;){var O=this.lines[F+H];while(J<this.cols){if(O[J][1]<=" "){A=true}else{if(A){break}}J++}if(J>=this.cols){J=this.cols-1}if(J===this.cols-1&&O[J][1]<=" "){J=0;if(++H>=this.rows){H--;if(++F>this.ybase){F=this.ybase;J=this.x;break}}continue}break}this.x=J,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="b"||K==="B"){var C=this.x;var B=this.y;var G=this.ydisp;var J=this.x;var H=this.y;var F=this.ydisp;for(;;){var O=this.lines[F+H];var A=J>0&&O[J][1]>" "&&O[J-1][1]>" ";while(J>=0){if(O[J][1]<=" "){if(A&&(J+1<this.cols&&O[J+1][1]>" ")){J++;break}else{A=true}}J--}if(J<0){J=0}if(J===0&&(O[J][1]<=" "||!A)){J=this.cols-1;if(--H<0){H++;if(--F<0){F++;J=0;break}}continue}break}this.x=J,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="e"||K==="E"){var J=this.x+1;var H=this.y;var F=this.ydisp;if(J>=this.cols){J--}for(;;){var O=this.lines[F+H];while(J<this.cols){if(O[J][1]<=" "){J++}else{break}}while(J<this.cols){if(O[J][1]<=" "){if(J-1>=0&&O[J-1][1]>" "){J--;break}}J++}if(J>=this.cols){J=this.cols-1}if(J===this.cols-1&&O[J][1]<=" "){J=0;if(++H>=this.rows){H--;if(++F>this.ybase){F=this.ybase;break}}continue}break}this.x=J,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="^"||K==="0"){var C=this.x;if(K==="0"){this.x=0}else{if(K==="^"){var O=this.lines[this.ydisp+this.y];var J=0;while(J<this.cols){if(O[J][1]>" "){break}J++}if(J>=this.cols){J=this.cols-1}this.x=J}}if(this.visualMode){this.selectText(C,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="$"){var C=this.x;var O=this.lines[this.ydisp+this.y];var J=this.cols-1;while(J>=0){if(O[J][1]>" "){if(this.visualMode&&J<this.cols-1){J++}break}J--}if(J<0){J=0}this.x=J;if(this.visualMode){this.selectText(C,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="g"||K==="G"){var C=this.x;var B=this.y;var G=this.ydisp;if(K==="g"){this.x=0,this.y=0;this.scrollDisp(-this.ydisp)}else{if(K==="G"){this.x=0,this.y=this.rows-1;this.scrollDisp(this.ybase)}}if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="H"||K==="M"||K==="L"){var C=this.x;var B=this.y;if(K==="H"){this.x=0,this.y=0}else{if(K==="M"){this.x=0,this.y=this.rows/2|0}else{if(K==="L"){this.x=0,this.y=this.rows-1}}}if(this.visualMode){this.selectText(C,this.x,this.ydisp+B,this.ydisp+this.y)}else{this.refresh(B,B);this.refresh(this.y,this.y)}return}if(K==="{"||K==="}"){var C=this.x;var B=this.y;var G=this.ydisp;var O;var L=false;var N=false;var D=-1;var H=this.y+(K==="{"?-1:1);var F=this.ydisp;var E;if(K==="{"){if(H<0){H++;if(F>0){F--}}}else{if(K==="}"){if(H>=this.rows){H--;if(F<this.ybase){F++}}}}for(;;){O=this.lines[F+H];for(E=0;E<this.cols;E++){if(O[E][1]>" "){if(D===-1){D=0}L=true;break}else{if(E===this.cols-1){if(D===-1){D=1}else{if(D===0){N=true}else{if(D===1){if(L){N=true}}}}break}}}if(N){break}if(K==="{"){H--;if(H<0){H++;if(F>0){F--}else{break}}}else{if(K==="}"){H++;if(H>=this.rows){H--;if(F<this.ybase){F++}else{break}}}}}if(!N){if(K==="{"){H=0;F=0}else{if(K==="}"){H=this.rows-1;F=this.ybase}}}this.x=0,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="/"||K==="?"){if(!this.visualMode){this.enterSearch(K==="/")}return}return false};v.prototype.keySearch=function(J,M){if(M==="\x1b"){this.leaveSearch();return}if(M==="\r"||(!this.searchMode&&(M==="n"||M==="N"))){this.leaveSearch();var L=this.entry;if(!L){this.refresh(0,this.rows-1);return}var C=this.x;var B=this.y;var H=this.ydisp;var O;var N=false;var G=false;var K=this.x+1;var I=this.ydisp+this.y;var F,E;var D=M==="N"?this.searchDown:!this.searchDown;for(;;){O=this.lines[I];while(K<this.cols){for(E=0;E<L.length;E++){if(K+E>=this.cols){break}if(O[K+E][1]!==L[E]){break}else{if(O[K+E][1]===L[E]&&E===L.length-1){N=true;break}}}if(N){break}K+=E+1}if(N){break}K=0;if(!D){I++;if(I>this.ybase+this.rows-1){if(G){break}G=true;I=0}}else{I--;if(I<0){if(G){break}G=true;I=this.ybase+this.rows-1}}}if(N){if(I-this.ybase<0){F=I;I=0;if(F>this.ybase){I=F-this.ybase;F=this.ybase}}else{F=this.ybase;I-=this.ybase}this.x=K,this.y=I;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+H,this.ydisp+this.y)}return}this.refresh(0,this.rows-1);return}if(M==="\b"||M==="\x7f"){if(this.entry.length===0){return}var A=this.ydisp+this.rows-1;this.entry=this.entry.slice(0,-1);var E=this.entryPrefix.length+this.entry.length;this.lines[A][E]=[this.lines[A][E][0]," "];this.x--;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return}if(M.length===1&&M>=" "&&M<="~"){var A=this.ydisp+this.rows-1;this.entry+=M;var E=this.entryPrefix.length+this.entry.length-1;this.lines[A][E]=[(this.defAttr&~511)|4,M];this.x++;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return}return false};v.charsets={};v.charsets.SCLD={"`":"\u25c6",a:"\u2592",b:"\u0009",c:"\u000c",d:"\u000d",e:"\u000a",f:"\u00b0",g:"\u00b1",h:"\u2424",i:"\u000b",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\u00a3","~":"\u00b7"};v.charsets.UK=null;v.charsets.US=null;v.charsets.Dutch=null;v.charsets.Finnish=null;v.charsets.French=null;v.charsets.FrenchCanadian=null;v.charsets.German=null;v.charsets.Italian=null;v.charsets.NorwegianDanish=null;v.charsets.Spanish=null;v.charsets.Swedish=null;v.charsets.Swiss=null;v.charsets.ISOLatin=null;function m(D,C,B,A){D.addEventListener(C,B,A||false)}function y(D,C,B,A){D.removeEventListener(C,B,A||false)}function e(A){if(A.preventDefault){A.preventDefault()}A.returnValue=false;if(A.stopPropagation){A.stopPropagation()}A.cancelBubble=true;return false}function n(C,A){function B(){this.constructor=C}B.prototype=A.prototype;C.prototype=new B}function x(C){var B=C.getElementsByTagName("body")[0];var E=C.createElement("span");E.innerHTML="hello world";B.appendChild(E);var D=E.scrollWidth;E.style.fontWeight="bold";var A=E.scrollWidth;B.removeChild(E);return D!==A}var w=this.String;var c=this.setTimeout;var b=this.setInterval;function d(C,B){var A=C.length;while(A--){if(C[A]===B){return A}}return -1}function t(A){if(A<="\uff00"){return false}return(A>="\uff01"&&A<="\uffbe")||(A>="\uffc2"&&A<="\uffc7")||(A>="\uffca"&&A<="\uffcf")||(A>="\uffd2"&&A<="\uffd7")||(A>="\uffda"&&A<="\uffdc")||(A>="\uffe0"&&A<="\uffe6")||(A>="\uffe8"&&A<="\uffee")}function o(C,A,I){var D=(C<<16)|(A<<8)|I;if(o._cache[D]!=null){return o._cache[D]}var E=Infinity,K=-1,F=0,G,B,L,H,J;for(;F<v.vcolors.length;F++){G=v.vcolors[F];B=G[0];L=G[1];H=G[2];J=o.distance(C,A,I,B,L,H);if(J===0){K=F;break}if(J<E){E=J;K=F}}return o._cache[D]=K}o._cache={};o.distance=function(E,D,F,B,A,C){return Math.pow(30*(E-B),2)+Math.pow(59*(D-A),2)+Math.pow(11*(F-C),2)};function f(D,B,A){if(D.forEach){return D.forEach(B,A)}for(var C=0;C<D.length;C++){B.call(A,D[C],C,D)}}function p(C){if(Object.keys){return Object.keys(C)}var A,B=[];for(A in C){if(Object.prototype.hasOwnProperty.call(C,A)){B.push(A)}}return B}v.EventEmitter=i;v.inherits=n;v.on=m;v.off=y;v.cancel=e;if(typeof module!=="undefined"){module.exports=v}else{this.Terminal=v}}).call(function(){return this||(typeof window!=="undefined"?window:global)}());(function(){var b;Terminal.prototype.oldScrollDisp=Terminal.prototype.scrollDisp;Terminal.prototype.scrollDisp=function(d){var f,c;this.termWrap||(this.termWrap=$(this.element).parent());void 0===this.lineBottom&&(this.lineBottom=0);f=this.termWrap.scrollTop();c=this.termWrap.height();return 0>d&&f>0?this.termWrap.scrollTop(Math.max(f-2*b,0)):d>0&&f<this.lineBottom-c?this.termWrap.scrollTop(Math.min(f+2*b,this.lineBottom-c)):this.oldScrollDisp(d>0?2:-2)};Terminal.prototype.oldKeyDown=Terminal.prototype.keyDown;Terminal.prototype.keyDown=function(c){return this.isMac&&c.metaKey&&(67===c.keyCode||86===c.keyCode)?!0:this.oldKeyDown(c)};b=null;Terminal.prototype.rescroll=function(){var d,f,c;void 0===this.lineBottom&&(this.lineBottom=0);this.divs||(this.divs=$(this.element).children());this.termWrap||(this.termWrap=$(this.element).parent());f=this.divs.filter(function(){return $(this).text().trim().length>0});if(0!==f.length){d=$(f[f.length-1]);b=b||d.height();this.lineBottom=Math.max(d.position().top+b+this.termWrap.scrollTop(),this.lineBottom);c=this.termWrap.height();return this.lineBottom>c?this.termWrap.scrollTop(this.lineBottom-c):void 0}}})();function Paginator(c,b){this.ref=c;this.pageNumber=0;this.limit=b;this.lastPageNumber=null;this.currentSet={};this.snap=null;this.lastKey=null;this.allData=[]}Paginator.prototype={nextPage:function(d){if(this.isLastPage()){d(this.allData[this.pageNumber-1])}else{if(this.pageNumber<this.allData.length){if(this.pageNumber==0){return}this.pageNumber+=1;d(this.allData[this.pageNumber-1]);return}var b=getLastPriority(this.snap);this.lastKey=getLastKey(this.snap);var c=this;this.ref.startAt(b,this.lastKey).limit(this.limit+(this.lastKey?1:0)).once("value",function(e){c.snap=e;var f=c.sorted(c.snap.exportVal(),c.lastKey);if(f.length==0){c.lastPageNumber=c.pageNumber;d(undefined);return}c.allData.push(f);c.pageNumber+=1;if(f.length<c.limit){c.lastPageNumber=c.pageNumber}d(c.allData[c.pageNumber-1])})}},sorted:function(f,b){var c=[];for(key in f){if(key==b){continue}var e=f[key];e.key=key;c.push(e)}return c.sort(function(g,d){return g[".priority"]>d[".priority"]})},prevPage:function(b){if(this.isFirstPage()){return}this.pageNumber-=1;b(this.allData[this.pageNumber-1])},isFirstPage:function(){return this.pageNumber===1},isLastPage:function(){return this.pageNumber===this.lastPageNumber}};function getLastPriority(b){var c=undefined;if(b==null){return c}b.forEach(function(d){if(c==undefined){c=d.getPriority()}if(d.getPriority()>c){c=d.getPriority()}});return c}function getLastKey(b){var d=undefined;var c=undefined;if(b==null){return d}b.forEach(function(e){if(d==undefined){d=e.getPriority();c=e.name()}if(e.getPriority()>d){c=e.name()}});return c}function each(d,b){if(d){for(k in d){if(d.hasOwnProperty(k)){var c=b(d[k],k);if(c===true){break}}}}}var LANG_MAP={vb:{name:"Visual Basic",tab_size:4,value:"vb",sample:'Imports System\n\nPublic Module mymodule\n   Sub Main()\n     Console.WriteLine ("Hello World!")\n   End Sub\nEnd Module\n',repl:false,mode:"vb"},csharp:{name:"C#",tab_size:4,value:"clike",sample:'// Entry point name must be "Solution"\nusing System;\n\npublic static class Solution\n{\n    private static void Main()\n    {\n        Console.WriteLine("Hello, world!");\n    }\n}\n',repl:false,mode:"text/x-csharp"},julia:{name:"Julia",tab_size:4,value:"julia",sample:'println("Hello, world!")\n',repl:true,mode:"julia"},haskell:{name:"Haskell",tab_size:4,value:"haskell",sample:'-- Included libs:\n-- bytestring hashtables parsec split text unordered-containers vector vector-algorithms hunit hspec\n--\n-- Code is run with runghc\n\nmain = putStrLn "Hello, world!"\n',repl:true,mode:"haskell"},mysql:{name:"MySQL",tab_size:4,value:"sql",sample:"/*\nView the Database Scheme here: https://s3-us-west-2.amazonaws.com/cbunkstatic/Schema.png\n*/\n\nSELECT 'Hello, world!';\n",repl:true,mode:"text/x-mysql"},go:{name:"Go",tab_size:4,value:"go",sample:'package main\n\nimport "fmt"\n\nfunc main() {\n    fmt.Println("Hello, world!")\n}\n',repl:false,mode:"go"},"ruby1.9":{name:"Ruby",tab_size:4,value:"ruby",sample:"# Include libs: Rspec\n\nputs 'Hello, world!'\n",repl:true,mode:"ruby"},java:{autocomplete:true,name:"Java",tab_size:4,value:"clike",sample:'// Class name must be "Main"\n// Libraries included:\n// json simple, guava, apache commons lang3, junit, jmock\n\nclass Main {\n    public static void main(String[] args) {\n        System.out.println("Hello, world!");\n    }\n}\n',repl:false,mode:"text/x-java"},coffeescript:{name:"Coffeescript",tab_size:4,value:"coffeescript",sample:"# Libs included:\n#     underscore lodash chai sinon sinon-chai mocha async request q bluebird jsdom\n\nconsole.log 'Hello, world!'\n",repl:true,mode:"coffeescript"},swift:{name:"Swift",tab_size:4,value:"swift",sample:'print("Hello, world!")\n',repl:true,mode:"text/x-swift"},perl:{name:"Perl",tab_size:4,value:"perl",sample:'print "Hello, world!\\n";\n',repl:false,mode:"perl"},"ruby1.8":{name:"Ruby",tab_size:4,value:"ruby",sample:"# Include libs: Rspec\n\nputs 'Hello, world!'\n",repl:true,mode:"ruby"},lua:{name:"Lua",tab_size:4,value:"lua",sample:'print("Hello, world")\n',repl:true,mode:"lua"},erlang:{name:"Erlang",tab_size:4,value:"erlang",sample:"%% Name your module 'prog' and export 'start/0'\n\n-module(prog).\n\n-export([start/0]).\n\nstart() ->\n     io:format(\"Hello, world!~n\").\n",repl:true,mode:"erlang"},shell:{name:"Shell",tab_size:4,value:"shell",sample:'#!/bin/sh\n\necho "Hello World!"\n',repl:true,mode:"text/x-sh"},python:{name:"Python 2",tab_size:4,value:"python",sample:'# Libraries Included:\n# Numpy, Scipy, Scikit, Pandas\n\nprint "Hello, world!"\n',repl:true,mode:"python"},javascript:{name:"Javascript",tab_size:4,value:"javascript",sample:"/*\nLibs included:\n    underscore lodash chai sinon sinon-chai mocha async request q bluebird jsdom\n*/\n\nconsole.log('Hello, world!');\n",repl:true,mode:"javascript"},php:{name:"PHP",tab_size:4,value:"php",sample:"<?php\n    echo 'Hello, world!';\n?>\n",repl:false,mode:"php"},ruby:{name:"Ruby",tab_size:4,value:"ruby",sample:"# Include libs: Rspec\n\nputs 'Hello, world!'\n",repl:true,mode:"ruby"},python3:{name:"Python 3",tab_size:4,value:"python",sample:'# Libraries Included:\n# Numpy, Scipy, Scikit, Pandas\n\nprint("Hello, world!")\n',repl:true,mode:"python"},c:{name:"C",tab_size:4,value:"clike",sample:'// Compiled with: gcc -std=c11 -Wall -pthread -lm\n\n#include <stdio.h>\n\n int main(void)\n {\n    printf("Hello, world!\\n");\n    return 0;\n }\n',repl:false,mode:"text/x-csrc"},plain:{name:"Plain Text",tab_size:4,value:"null",sample:"",repl:false,mode:"text/plain"},scala:{name:"Scala",tab_size:4,value:"clike",sample:'object HelloWorld {\n    def main(args: Array[String]): Unit = {\n        println("Hello, world!")\n    }\n}\n',repl:true,mode:"text/x-scala"},ocaml:{name:"OCaml",tab_size:4,value:"text/x-ocaml",sample:'print_endline "Hello, world!" ;;\n',repl:true,mode:"mllike"},"c++":{name:"C++",tab_size:4,value:"clike",sample:'// Compiled with: g++ -Wall -std=c++14 -pthread\n\n#include <iostream>\n\nusing namespace std;\n\nint main(){\n    cout << "Hello, World!" << endl;\n    return 0;\n}\n',repl:false,mode:"text/x-c++src"},r:{name:"R",tab_size:4,value:"r",sample:'print("Hello, world!")\n',repl:true,mode:"r"},clojure:{name:"Cloure",tab_size:4,value:"clojure",sample:'(println "Hello, world!")\n',repl:true,mode:"clojure"},rust:{name:"Rust",tab_size:4,value:"rust",sample:'fn main() {\n    println!("Hello World!");\n}\n',repl:false,mode:"rust"}};(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.overlayMode=function(d,c,e){return{startState:function(){return{base:b.startState(d),overlay:b.startState(c),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,lineSeen:null}},copyState:function(f){return{base:b.copyState(d,f.base),overlay:b.copyState(c,f.overlay),basePos:f.basePos,baseCur:null,overlayPos:f.overlayPos,overlayCur:null}},token:function(g,f){if(g.sol()||g.string!=f.lineSeen||Math.min(f.basePos,f.overlayPos)<g.start){f.lineSeen=g.string;f.basePos=f.overlayPos=g.start}if(g.start==f.basePos){f.baseCur=d.token(g,f.base);f.basePos=g.pos}if(g.start==f.overlayPos){g.pos=g.start;f.overlayCur=c.token(g,f.overlay);f.overlayPos=g.pos}g.pos=Math.min(f.basePos,f.overlayPos);if(f.overlayCur==null){return f.baseCur}else{if(f.baseCur!=null&&f.overlay.combineTokens||e&&f.overlay.combineTokens==null){return f.baseCur+" "+f.overlayCur}else{return f.overlayCur}}},indent:d.indent&&function(g,f){return d.indent(g.base,f)},electricChars:d.electricChars,innerMode:function(f){return{state:f.base,mode:d}},blankLine:function(f){if(d.blankLine){d.blankLine(f.base)}if(c.blankLine){c.blankLine(f.overlay)}}}}});$(function(){var i=navigator.userAgent.toLowerCase();jQuery.browser={version:(i.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(i),opera:/opera/.test(i),msie:/msie/.test(i)&&!/opera/.test(i),mozilla:/mozilla/.test(i)&&!/(compatible|webkit)/.test(i)};var A="https://spica.firebaseIO.com";var bn=new Firebase(A);var j=bn;var ao;var bE=undefined;var bh={};var au;var ae;var bd;var bA;var aU=0;var aG=false;var e=false;var a7=false;var G;var aO=undefined;var by;var aj=7200*1000;var ap=false;var ai=["#1abc9c","#e74c3c","#8e44ad","#c0392b","#f39c12","#27ae60","#f1c40f","#03A678","#1E8BC3","#1E824C"];var bc;var p;var n=null;var y=["clojure","coffeescript","erlang","haskell","javascript","julia","lua","mysql","ocaml","python","python3","r","ruby","scala","shell","swift"];var a9="";var F;var aE=false;var B=false;var ag="python";var z=false;var C={20:30,50:68,100:120,250:260};hasStartTS=false;CodeMirror.defineMode("chat",function(bG,bH){var bI={token:function(bL,bK){if(bL.pos==0){for(k in bc){var bJ=bc[k];if(bL.match(bJ.name+" said:")){return""+ai.indexOf(bJ.color)}}}while(bL.next()!=null){}return null}};return CodeMirror.overlayMode(CodeMirror.getMode(bG,bH.backdrop||"text/plain"),bI)});function aB(bM,bQ,bI){var bG,bK,bH,bR,bO,bJ,bN,bP,bL;bH="";bJ=null;bP=bI.text;for(bR=bO=0,bN=bP.length;bO<bN;bR=++bO){bG=bP[bR];bK=!!(bI.matchMask&1<<bR);if(bJ!==bK){bH+=bK?'<span class="highlight">':"</span>";bJ=bK}bH+=_.escape(bG)}bJ&&(bH+="</span>");if(bI.data){bL=bI.data.substr(0,50);if(bL!=bI.text){bH+='<span class="info">'+_.escape(bL);bL.length<bI.data.length&&(bH+="&hellip;");bH+="</span>"}}return bM.innerHTML=bH}function bt(bP,bU){var bJ=[],bG=bU.toUpperCase(),bM=bU.toLowerCase();bP:for(var bI,bV=0;bI=bP[bV];bV++){var bS=bI.text;if(bS){for(var bL,bR,bT=-1,bN=0,bO=0,bQ=0;bQ<bU.length;bQ++){var bH=bS.indexOf(bM[bQ],bT+1),bK=bS.indexOf(bG[bQ],bT+1);bL=bH>=0&&(bK<0||bH<bK)?bH:bK;if(bL<0){continue bP}bR=bL-bT-1;if(bR>0){bT===-1&&(bO+=10);bO+=bR}bN|=1<<bL;bT=bL}bI.matchMask=bN;bI.exactMatch=bO?0:1;bI.score=-bO;bJ.push(bI)}}return bJ.sort(function(bX,bW){aSym=bX.text.charAt(0).toLowerCase()==bX.text.charAt(0).toUpperCase()?1:0;bSym=bW.text.charAt(0).toLowerCase()==bW.text.charAt(0).toUpperCase()?1:0;return bW.exactMatch-bX.exactMatch||bW.score-bX.score||aSym-bSym||bX.text.localeCompare(bW.text)})}function aI(bH,bJ,bG){var bI=bt(bJ.list,bH);return bG({list:bI,from:bJ.from,to:bJ.to})}CodeMirror.registerHelper("hint","magic",function(bI,bK){var bM=bI.getCursor();var bJ=bI.getValue();var bH=bI.getTokenAt(bM);var bL=bI.state.completionActive;if(bL.list){var bG=bI.getRange(bL.from,bM);bL.to.ch=Math.max(bL.to.ch,bM.ch);return aI(bG,bL,bK)}if(!bL.inflight){bL.inflight=$.post("https://complete.codebunk.com/complete/",{line:bM.line,"char":bM.ch,lang:window.lang,bunk:HASH,code:bJ})}return bL.inflight.done(function(bO){bO=JSON.parse(bO);var bS,bN,bP,bQ,bR;if(!bO.error&&bO.completions.length>0){bP=parseInt(bO.offset);bP||(bP=null===bH.type||"."===bH.string?bH.end:bH.start);bN=bO.completions;for(bQ=0,bR=bN.length;bQ<bR;bQ++){bS=bN[bQ];bS.render=aB}bL.from=CodeMirror.Pos(bM.line,bP);bL.to=CodeMirror.Pos(bM.line,Math.max(bH.end,bO.startCol||0));bL.list=bN;a=bI.getRange(bL.from,bM);return aI(a,bL,bK)}})});CodeMirror.commands.autocomplete=function(bG){if(LANG_MAP[window.lang].autocomplete&&z){return CodeMirror.showHint(bG,CodeMirror.hint.magic,{async:true,completeSingle:false,closeOnUnfocus:false})}};function a5(bG){return A+"/namespace-questions/"+bG+"/"}function aA(bG){return A+"/user-questions/"+bG+"/"}function bo(){$("#menu-home").click(function(){window.location="/db"});$("#menu-avchat").click(function(){if($(this).hasClass("selected")){x();$(this).removeClass("selected")}else{aJ();$(this).addClass("selected")}});$("#menu-playback").click(function(){window.location="/pb/"+HASH});$("#menu-private").click(function(){o()});$("#menu-newbunk").click(function(){window.location="/b"});$("#menu-fork").click(function(){r()});$("#menu-keymap").click(function(){E()});$("#menu-logout").click(function(){aF()});$("#menu-playback").hide();if(X()){$("#menu-logout").hide();$("#menu-private").hide()}if(!B){$("#menu-private").hide()}if(ap){$("#menu-private").addClass("selected")}$("#fork").click(r)}function aR(){$("#save-title").click(h);$("#title-modal").on("show",function(){$("#title-inp").val($("#bunktitle span").text())});$(".panes").height(window.innerHeight-40).width(window.innerWidth-30);$("select").dropkick({change:az});$("#questions").click(aV);$("#vidvis").bind("click",function(){if(aG){$("#stream").hide();$("#editor").height(window.innerHeight-63);$("#result").height(window.innerHeight-86);$(this).css("bottom",0);$(".vidtext").html("Show Chat");aG=false}else{$("#stream").show();$("#editor").height(window.innerHeight-250);$("#result").height(window.innerHeight-298);$(this).css("bottom",205);$(".vidtext").html("Hide Chat");aG=true}});bF();ac();br();aC()}function bF(){CodeMirror.modeURL="/static/codemirror/mode/%N/%N.js";ae=CodeMirror.fromTextArea(document.getElementById("playback"));au=CodeMirror(document.getElementById("editor"),{lineNumbers:true,mode:"python",tabSize:4,indentUnit:4,lineWrapping:true,extraKeys:{Tab:function(bG){if(bG.getSelection().length){CodeMirror.commands.indentMore(bG)}else{bG.replaceSelection("    ","end")}},"Ctrl-Space":"autocomplete"}});au.on("keyup",function(bH,bG){var bI;bI=bG.keyCode||bG.which;if(190===bI){return au.execCommand("autocomplete")}});bd=CodeMirror(document.getElementById("logeditor"),{lineNumbers:false,mode:"null",tabSize:4,indentUnit:4,lineWrapping:true,mode:"chat"});bd.setOption("readOnly",true)}function az(bJ,bH){if(au.options.readOnly){bf("You cannot change the Language of this Bunk");return}var bI=new Firebase(A+"/"+HASH+"/output");bI.remove();var bJ=$("#lang_select").val();var bG=ag;ad(bJ);bz(bJ,false);U(bJ,bG)}function U(bG,bH){var bI=LANG_MAP[bG];if(au.getValue()===""||au.getValue()===LANG_MAP[bH].sample){return au.setValue(bI.sample)}au.setValue("\nOld Content below("+LANG_MAP[bH].name+"):\n\n"+au.getValue()+"\n");au.blockComment(CodeMirror.Pos(0,0),CodeMirror.Pos(au.lastLine(),0),{commentBlankLines:true,indent:false});return au.setValue(bI.sample+"\n\n"+au.getValue())}function E(){$("#save-dn").unbind();$("#dn-modal .close").show();$("#dn-modal h3").text("Select Editor");var bH=bh.keymap||"default";var bG='<ul class="nav nav-list">';bG+='<li data-id="default" '+(bH=="default"?'class="selected"':"")+"><a>Default</a></li>";bG+='<li data-id="emacs" '+(bH=="emacs"?'class="selected"':"")+"><a>Emacs</a></li>";bG+='<li data-id="sublime" '+(bH=="sublime"?'class="selected"':"")+"><a>Sublime</a></li>";bG+='<li data-id="vim" '+(bH=="vim"?'class="selected"':"")+"><a>Vim</a></li>";bG+="</ul>";$("#dn-modal .modal-body").html(bG);$("#dn-modal .modal-footer").hide();$("#dn-modal li").click(function(){var bI=$(this).attr("data-id");$("#dn-modal").modal("hide");ah(bI);_gaq.push(["_trackEvent","User","SetKeyMap",bI])});$("#dn-modal").modal()}function ah(bH){if(["emacs","vim","sublime","default"].indexOf(bH)==-1){return}au.setOption("keyMap",bH);bh.keymap=bH;if(X()){return}var bG=new Firebase(A+"/userdata/"+bD());bG.update({keymap:bH})}function aq(){ah(bh.keymap||"default")}function T(){if(B&&X()){bf("This Bunk is editable by you alone. Please login if you want to create Collaborative Bunks.")}else{if(B){bf("This Bunk is editable by others.")}}au.setOption("readOnly",false);F.setReadOnly(false);$("#clear-repl").css("visibility","visible")}function aD(){au.setOption("readOnly",true);$("#clear-repl").css("visibility","hidden");F.setReadOnly(true);bf("This Bunk is Read only. Only owner of the Bunk can make changes to it.")}function aC(){bA=new FirebaseSimpleLogin(bn,function(bH,bG){if(bH){$("#page-loader").hide();alert("Uh Oh!","Unable to authenticate. Try again.");return}if(bE!=undefined){window.location.reload()}if(bG){bE=bG;aW();V(bD(),function(bI){L(bI);l()})}else{bE={provider:"anon",id:"anon",username:"anon"};bp("",function(bI){val={name:bI};bh=val;l()});$("#questions").hide()}})}window.init=aR;function X(){return bE.provider=="anon"}function aW(){$("#logout, #home").show();$("#logout").unbind().click(aF)}function ac(){$("#authbtn, #dbparent").hide()}function aF(){bA.logout();window.location="/"}function a0(bG){bA.login(bG,{rememberMe:true});show_logout()}function bD(){if(bE.provider=="password"){return"persona-"+bE.email.replace(/\./g,",")}return bE.provider+"-"+bE.id}function aP(){return G}function V(bH,bG){var bI=new Firebase(A+"/userdata/"+bH);bI.once("value",function(bJ){var bK=bJ.val();if(bK==null){bh={};bp("",function(bL){bK={name:bL};if(bG){bG(bK)}});return}if(bG){bG(bK)}})}function L(bG){bh=bG}function bp(bH,bG){var bI=function(){var bK=$("#dn-inp").val();if(bK==""||bK==undefined){return}$("#dn-modal").modal("hide");var bJ=new Firebase(A+"/userdata/"+bD());bJ.update({name:bK});bh.name=bK.replace(/#|\]|\[|\$|\.|\//g,"-");bG(bK.replace(/#|\]|\[|\$|\.|\//g,"-"))};$("#save-dn").click(bI);$("#dn-inp").val(bH);$("#dn-inp").on("keyup",function(bK){if(!bK){bK=window.event}var bJ=bK.keyCode||bK.which;if(bJ=="13"){bI();return false}});$("#dn-modal .modal-header button").hide();$("#dn-modal").on("shown",function(){$("#dn-inp").focus();$("#dn-modal").off("shown")});$("#dn-modal").modal({backdrop:"static"})}function be(bG){if(bh.namespaces==undefined){bG(bD(),"Personal");return}$("#save-dn").unbind();$("#dn-modal h3").text("Select Team");var bH=bD();var bI='<ul class="nav nav-list">';bI+='<li data-id="'+bH+'"><a>Personal</a></li>';for(key in bh.namespaces){if(bh.namespaces.hasOwnProperty(key)){if(key==bH){continue}bI+='<li data-id="'+key+'"><a>'+bh.namespaces[key].name+"</a></li>"}}bI+="</ul>";$("#dn-modal .modal-body").html(bI);$("#dn-modal .modal-footer").hide();$("#dn-modal .modal-header button").hide();$("#dn-modal li").click(function(){var bJ=$(this).attr("data-id");var bK=$(this).find("a").text();if(bJ==bH){bG(bJ,bK);$("#dn-modal").modal("hide");return}var bL=this;aM(bJ,function(bM){if(bM.numbunks>0){bG(bJ,bK);$("#dn-modal").modal("hide")}else{$(bL).unbind().find("a").text($(bL).unbind().find("a").text()+" (No Bunks Left. Choose other.)")}})});$("#dn-modal").modal({backdrop:"static"})}function s(bI){aS();setTimeout(function(){$("#result").splitter({splitHorizontal:true,outline:true,sizeTop:$(".terminal").height()+20});$(".panes").splitter({sizeRight:$(".terminal").width()+10});var bL=bI.lang;if(bL=="ruby"){bL="ruby1.9"}if(X()&&B){bf("This Bunk is editable by you alone. Please login if you want to create Collaborative Bunks.")}var bK=bD();var bJ=bI.nsid;if(bJ==bK||bJ==bI.owner){al()}else{al(bJ)}setTimeout(function(){aw(HASH,bL);ar();$("#page-loader").hide()},100)},100);$("#chatbox").width($("#result").width()+30);$("#editor").bind("resize",function(bJ){au.setSize($(this).width(),$(this).height())});$("#logwrap").bind("resize",function(bJ){$("#logeditor").height($(this).height()-42);bd.setSize($(this).width(),$("#logeditor").height());$("#chatbox").width($(this).width()+30);bd.scrollIntoView(bd.lastLine())});if(a7){History.pushState(null,null,""+HASH+"/")}$("#runbtn").click(bl);$("#clear-repl").click(a8);$("#rate-candidate").click(bs);$("#end-interview").click(a2);Mousetrap.bind(["command+r","ctrl+r"],bl);var bH=bD();if(X()){bH=Math.floor(Math.random()*9999999999).toString();p=bH}bc=bw(bI.users||{});var bG=ax(bH);F=Firepad.fromCodeMirror(bn,au,{userId:bH+"||"+bh.name,userColor:bG});aZ();bo();if(hasStartTS){$("#menu-playback").show()}bm();a4();F.on("ready",function(){if(bI.qid&&bI.qid.length>0){aK(bI.nsid,bI.qid);bn.update({qid:"",origqid:bI.qid})}})}function l(){aq();var bG=window.location.hash.replace(/#/g,"");if(bG){HASH=bG;bi(bG)}else{if(HASH){bi(HASH)}else{be(function(bH,bI){af(D,bH,bI)})}}}function bi(bG){bn=bn.child(bG);bn.once("value",function(bH){var bI=bH.val();if(bI==null){alert("Uh Oh!","Unable to fetch bunk data.");return}u(bI)})}function ba(bH,bG){return Math.floor(Math.random()*(bG-bH+1)+bH)}function af(bG,bH,bI){G=bH;BUNKOWNER=bD();var bJ=new Firebase(A+"/maxid/");bJ.transaction(function(bL){var bK=bL||0;return bK+1},function(bN,bL,bM){if(bL){var bK=ba(100,999);bG(bK+""+bM.val(),bH,bI)}})}function D(bL,bG,bK){HASH=bL;_gaq.push(["_trackEvent","Bunk","New"]);bn=bn.child(bL);e=true;B=true;var bJ=bD();var bI=new Date().getTime();by=bI+TSDIFF;var bH=false;if(bG==bJ||X()){bH=true}var bM={owner:bJ,owner_name:bh.name||"No Name",nsid:bG||bJ,nsname:bK||"Personal",lang:"python",readonly:bH,created:bI,api_key:apiKey,sessId:sessId,token:token,validTill:-1,sessUpdate:0,paid:false,withPlayback:true,version:1,"private":false};aO=1;bn.update(bM,function(bN){at(bN,bG,bK,bM)})}function at(bI,bG,bH,bJ){if(bI!=null){alert("Uh Oh!","Unable to create bunk. Please try again.");return}hasStartTS=true;a7=true;s(bJ);bv(bG,bH,bJ);W();bB();if(!X()){a1();if(!ap){K()}}U("python","plain")}function bv(bH,bJ,bM){if(!X()){var bI=bD();var bL={created:new Date().getTime(),lang:"python",username:bh.name,userid:bI,nsid:bH,nsname:bJ};var bG=new Firebase(A+"/user-bunks/"+bI);bG=bG.child(bn.name()).setWithPriority(bL,-by);if(bH!=bI){c(bn.name(),bH,bI,bL);an(bM)}else{ay()}}else{bj();ab(bM);var bK='<div id="markreadonly" class="alert"><button type="button" class="close" data-dismiss="alert">&times;</button>This is a readonly Bunk! You need to <b><a style="cursor:pointer;text-decoration: none;" href="/">Login</a></b> to create collaborative bunks.</div>'}}function ay(){a6();$("#usesession-yes").click(N);$("#buysession span").click(function(){var bG=parseInt($(this).attr("data-id"));a3(C[bG]*100,bG)});bb()}function c(bL,bK,bI,bO,bN,bG){if(bN==undefined){bN=by}var bJ=new Date().getTime();var bH=new Firebase(A+"/userdata-bunks/"+bI+"/"+bK);bH.child(bL).setWithPriority(bO,-bN);var bM=new Firebase(A+"/namespace-bunks/"+bK);bM.child("bymember/"+bI).child(bL).setWithPriority(bO,-bN);bM.child("all").child(bL).setWithPriority(bO,-bN);aM(bK,function(bQ){var bP=new Firebase(A+"/namespace/"+bK);bP.update({numbunks:bQ.numbunks-1},function(bR){if(bG){bG()}})})}function S(bG){return e||(bh.namespaces&&bh.namespaces[bG]!=undefined)}function u(bH){ap=bH["private"];e=bk(bH.owner);aO=bH.version;by=bH.created+TSDIFF;BUNKOWNER=bH.owner;G=bH.nsid;B=e||S(G);if(ap&&!B){alert("Private Bunk","You do not have access to this Bunk",function(){window.location="/db"});return}apiKey=bH.api_key||apiKey;sessId=bH.sessId||sessId;token=bH.token||token;if(bH.withPlayback==true){hasStartTS=true}bB(bH.title);var bG=bH.lang;if(bG=="ruby"){bG="ruby1.9";bn.update({lang:bG})}if(bG!=$("#lang_select").val()){bz(bG)}s(bH);if(bH.nsid==bH.owner&&bH.readonly==false){var bI=bH.validTill-(new Date().getTime()+TSDIFF);if(bI<0){bn.update({readonly:true});bH.readonly=true}}if(B){if(X()){if(b()){T();e=true}else{aD()}W();return}T();a1();if(!ap){K()}if(bH.nsid==undefined){G=bH.owner}else{G=bH.nsid}if(bH.nsid==bH.owner||bH.nsid==undefined){ab(bH)}else{an(bH)}}else{Z();q();br();$("#questions").hide()}W()}function ab(bG){if(bG.version==undefined){return}if(!X()&&e){bb()}Z();if(X()||!e){return}J();ay();O(bG.validTill)}function an(bG){_gaq.push(["_trackEvent","Bunk","Team",bG.nsid]);br();bC();q();bq()}function r(){_gaq.push(["_trackEvent","fork","click"]);$("#page-loader").show();bn.once("value",function(bG){var bH=bG.val();if(bH==null){$("#page-loader").hide();alert("Error in Forking the Bunk. Try again.");return}if(!bH.history){_gaq.push(["_trackEvent","fork","nohistory"]);$("#page-loader").hide();alert("Sorry","No data to Fork.");return}_gaq.push(["_trackEvent","fork","success"]);if(S(bH.nsid)&&bD()!=bH.nsid){t(bH.nsid,function(){af(H,bH)})}else{af(H,bH)}})}function t(bH,bG){aM(bH,function(bI){if(bI.numbunks>0){bG()}else{$("#page-loader").hide();_gaq.push(["_trackEvent","fork","nosessions"]);alert("Sorry","Unable to Fork. No more Interview Sessions left.")}})}function H(bL,bM){NREF=new Firebase(A+"/"+bL);var bK=new Date().getTime();var bJ=bD();var bG=bM.nsid||bJ;var bI=bM.nsname||"Personal";var bH=bM.readonly;if(!S(bM.nsid)){bG=bJ;bI="Personal"}if(bG==bJ){bH=true}NREF.update({owner:bJ,owner_name:bh.name,created:bK,history:bM.history,lang:bM.lang,nsid:bG,nsname:bI,sessStart:0,sessUpdate:0,readonly:bH,charged:false,withPlayback:bM.withPlayback,paid:false,title:$("#bunktitle span").html(),"private":false,validTill:-1,version:1,api_key:apiKey2,sessId:sessId2,token:token2},function(bP){if(X()){bj(bL);window.location="https://"+window.location.hostname+"/b/"+bL;return}var bO={created:bK,lang:bM.lang,username:bh.name,userid:bJ,nsid:bG,nsname:bI,title:$("#bunktitle span").html()};var bN=new Firebase(A+"/user-bunks/"+bD());bN=bN.child(bL).setWithPriority(bO,-bK,function(){if(bG!=bJ){c(bL,bG,bJ,bO,bK,function(){window.location="https://"+window.location.hostname+"/b/"+bL})}else{window.location="https://"+window.location.hostname+"/b/"+bL}})})}function aM(bH,bG){var bI=new Firebase(A+"/namespace/"+bH);bI.once("value",function(bJ){var bK=bJ.val();if(bK==null){return}if(bG){bG(bK)}})}function ax(bH){var bI=bc;if(X()){bH=p}if(bI==undefined){return ai[parseInt(Math.random()*10)]}var bG=[];$.each(bI,function(bL,bK){var bJ=bL.split("||");var bM=bJ[0];if(bM==bH){return bK.color}bG.push(bK.color)});bG=$(ai).not(bG).get();if(bG.length==0){return ai[parseInt(Math.random()*10)]}return bG[Math.floor(Math.random()*bG.length)]}function bm(){bn.child("users").on("value",function(bG){bc=bw(bG.val());aL()})}function bw(bH){if(bH==undefined){return{}}var bG={};$.each(bH,function(bK,bJ){var bI=bK.split("||");bG[bI[0]]={color:bJ.color,name:bI[1]}});return bG}var am=false;function aL(){var bG='<div id="menu-roster">';var bH=0;for(k in bc){bG+='<div class="menu-roster-item menu-item"><i class="icon icon-user" style="color:'+bc[k].color+'"></i><span>'+bc[k].name+"</span></div>";bH=bH+1}bG+="</div>";$("#menu-roster").remove();$("#menu").append(bG);if(bH>1&&am==false){_gaq.push(["_trackEvent","Session","UserCount",HASH,bH]);am=true}}function o(){bn.once("value",function(bG){var bI=bG.val();if(bI==null){alert("Uh Oh!","Unable to complete the request");return}var bH=bI["private"];ap=!bH;$("#menu-private").toggleClass("selected");bn.update({"private":!bH})})}function W(){bn.child("readonly").on("value",function(bG){var bH=bG.val();if(bH==null){setTimeout(W,1*1000);return}if(bH==true){bg();if(!B){aD()}}else{R();if(!B){T()}}})}function K(){$("#end-interview").show()}function w(){$("#end-interview").hide()}function a2(){$("#end-interview-modal").modal();$("#end-interview-yes").unbind().bind("click",o)}function a1(){$("#rate-candidate").show()}function bs(){$("#rate-candidate-modal .error").text("");$("#rate-candidate-modal #save-rating").unbind().bind("click",P);$("#rate-candidate-modal").modal()}function P(){var bH=$('#rate-candidate-modal form input[name="rating"]:checked').val();if(bH==undefined){$("#rate-candidate-modal .error").text("Please choose a rating!");return}var bG=$("#rate-candidate-modal form textarea").val();bn.once("value",function(bI){var bK=bI.val();if(bK==null){$("#rate-candidate-modal .error").text("Unable to save rating!");return}var bJ=bK.ratings||{};bJ[bD()]=[bh.name,bH,bG];$("#rate-candidate-modal").modal("hide");bn.update({ratings:bJ})})}function a6(bG){if(bE.provider=="anon"){return}var bH=new Firebase(A+"/sessions/"+bD());bH.once("value",function(bI){var bJ=bI.val();if(bJ==null){aU=5}else{aU=bJ.remaining}if(bG){bG()}$("#use-session").html("Use Session ("+aU+")")})}function bb(){$("#use-session").show().css("display","inline-block").removeClass("disabled").unbind().click(function(){$("#usesession-modal").modal()})}function q(){$("#use-session").addClass("disabled").unbind()}function br(){$("#buysession").parents(".span2").hide()}function J(){$("#buysession").parents(".span2").show()}function N(){a6(function(){if(!aU){alert("No Sessions!","No more sessions left. Please buy some sessions.");_gaq.push(["_trackEvent","usesession","fail"]);return}var bH=new Date().getTime()+aj+TSDIFF;O(bH);bn.update({validTill:bH,readonly:false});var bG=new Firebase(A+"/sessions/"+bD());bG.update({remaining:aU-1});aU=aU-1;isCharged=true;_gaq.push(["_trackEvent","usesession","success"])})}function O(bI){var bH=bI-(new Date().getTime()+TSDIFF);if(bH<0){bn.update({readonly:true});return}var bG=bD();q();bq();setTimeout(function(){bn.update({readonly:true});$("#readonly").addClass("disabled").unbind();$("#readonly i").removeClass("icon-check-empty").addClass("icon-check");bb()},bH);$(".timer").show();aX(bH)}function bq(){$("#readonly i").removeClass("icon-check").addClass("icon-check-empty");$("#readonly").removeClass("disabled").unbind().click(function(){if($("#readonly i").hasClass("icon-check-empty")){bn.update({readonly:true})}else{bn.update({readonly:false})}})}function aX(bG){function bH(bJ){var bI=bJ+"";if(bI.length<2){return"0"+bI}else{return bI}}totalSeconds=parseInt(bG/1000);interval=setInterval(function(){$("#seconds").text(bH(parseInt(totalSeconds%60)));$("#minutes").text(bH(parseInt(totalSeconds/60)));if(totalSeconds==0){alert("Session's over!","Current session is over. Your bunk is no more collaborative.");clearInterval(interval);return}totalSeconds--},1000)}function M(bG){a6(function(){var bJ=new Firebase(A+"/sessions/"+bD());bJ.update({remaining:aU+bG});aU+=bG;var bH=new Date();var bI=bJ.child("buy-"+bH.getTime());bI.set({created:bH.toUTCString(),num:bG})})}function a3(bH,bI){$("#page-loader").addClass("trans");$("#page-loader").show();var bG=function(bK){$("#page-loader").addClass("trans");$("#page-loader").show();var bJ=bD();$.post("/charge",{token:bK.id,amount:bH,user:bJ},function(bL){$("#page-loader").removeClass("trans");$("#page-loader").hide();if(bL.success){M(bI);_gaq.push(["_trackEvent","charged","success",bI]);alert("Congratulations!",bI+" Collaborative Sessions added to your account")}else{_gaq.push(["_trackEvent","charged","failure",bL.reason]);alert("Failure!",bL.reason)}})};StripeCheckout.open({key:STRIPE_KEY,amount:bH,currency:"usd",name:"CodeBunk",description:"Buy "+bI+" Sessions",panelLabel:"Buy",token:bG,closed:function(){$("#page-loader").removeClass("trans");$("#page-loader").hide()}})}function bg(){$("#readonly i").removeClass("icon-check-empty").addClass("icon-check")}function R(){$("#readonly i").removeClass("icon-check").addClass("icon-check-empty")}function bC(){$("#readonly").removeClass("disabled").unbind().click(function(){if($("#readonly i").hasClass("icon-check-empty")){$("#readonly i").removeClass("icon-check-empty").addClass("icon-check")}else{$("#readonly i").removeClass("icon-check").addClass("icon-check-empty")}})}function Z(){$("#readonly").addClass("disabled").unbind()}function bk(bG){if(bD()==bG){return true}var bH=bE.provider;var bI=bE.id;if(bH+"-"+bI==bG||bH+"/"+bI==bG){return true}return false}function a4(){bn.child("lang").on("value",function(bG){var bH=bG.val();if(bH==null){return}aw(HASH,bH);bz(bH)});bn.child("title").on("value",function(bG){var bH=bG.val();if(bH==null){return}bB(bH)});bn.child("private").on("value",function(bG){var bH=bG.val();if(bH==null){return}if(B){if(bH){$("#menu-private").addClass("selected");w()}else{$("#menu-private").removeClass("selected");if(!X()){K()}}ap=bH;return}if(bH==true){alert("End of Interview","Thank You for interviewing with us. We will get back to you soon.",function(){window.location="https://"+window.location.hostname+"/db/"})}})}function av(bG){return bG.match(/cbapiv\d+/)!=null}function bB(bG){$("#title-inp").val(bG||"Untitled Bunk");$("#bunktitle span").text(bG||"Untitled Bunk");if(bG){$("title").text("CodeBunk: "+bG)}else{$("title").text("CodeBunk: Untitle Bunk")}}function h(){_gaq.push(["_trackEvent","Title","Set"]);var bL=$("#title-inp").val();var bI=aP();if(bL.length>0){if(au.options.readOnly&&!B){return}$("#bunktitle span").text(bL);$("title").text("CodeBunk: "+bL);var bH=HASH;var bJ=BUNKOWNER;var bK=new Firebase(A+"/"+bH);bK.update({title:bL});if(!av(bJ)){if(aO==undefined){bK=new Firebase(A+"/users/"+bJ+"/"+bH)}else{bK=new Firebase(A+"/user-bunks/"+bJ+"/"+bH)}bK.update({title:bL});bK.setPriority(-by)}if(bJ!=bI){if(!av(bJ)){bK=new Firebase(A+"/userdata-bunks/"+bJ+"/"+bI+"/"+bH);bK.update({title:bL});bK.setPriority(-by)}bK=new Firebase(A+"/namespace-bunks/"+bI);if(!av(bJ)){var bG=bK.child("bymember/"+bJ+"/"+bH);bG.update({title:bL});bG.setPriority(-by)}var bG=bK.child("all/"+bH);bG.update({title:bL});bG.setPriority(-by)}}}function a8(){if(n){n.reset();n.send("\n")}}function bz(bK,bJ){window.lang=bK;ag=bK;$("#lang_select").val(bK);var bG=LANG_MAP[bK]["repl"];if(!bG||au.options.readOnly){$("#clear-repl").css("visibility","hidden")}else{$("#clear-repl").css("visibility","visible")}if(bJ!=false){ak("#lang_select",bK)}if(bK=="java"){bf("Class name must be <b>Main</b>")}if(bK=="csharp"){bf('Entry point class must be named <b>Solution</b> ("static void Main" should be defined in class Solution) ')}if(bK=="vb"){bf('Define "Sub Main" on the top level module')}if(bK=="erlang"){bf("Name your module 'prog' and export 'start/0'. <br/><b> -module(prog).<br/>-export([start/0]).</b>")}if(bK=="mysql"){bf("View the <a target='_blank' href='https://s3-us-west-2.amazonaws.com/cbunkstatic/Schema.png'>Database Schema</a>")}var bH=LANG_MAP[bK].value;var bI=LANG_MAP[bK].mode;au.setOption("mode",bI);CodeMirror.autoLoadMode(au,bH);ae.setOption("mode",bI);CodeMirror.autoLoadMode(ae,bH)}function ad(bL){if(au.options.readOnly){bf("You cannot change the Language of this Bunk");return}var bI=HASH;var bJ=BUNKOWNER;var bH=aP();var bK=new Firebase(A+"/"+bI);bK.update({lang:bL});if(!av(bJ)){if(aO==undefined){bK=new Firebase(A+"/users/"+bJ+"/"+bI)}else{bK=new Firebase(A+"/user-bunks/"+bJ+"/"+bI)}bK.update({lang:bL});bK.setPriority(-by)}if(bJ!=bH){if(!av(bJ)){bK=new Firebase(A+"/userdata-bunks/"+bJ+"/"+bH+"/"+bI);bK.update({lang:bL});bK.setPriority(-by)}bK=new Firebase(A+"/namespace-bunks/"+bH);if(!av(bJ)){var bG=bK.child("bymember/"+bJ+"/"+bI);bG.update({lang:bL});bG.setPriority(-by)}var bG=bK.child("all/"+bI);bG.update({lang:bL});bG.setPriority(-by)}}function b(bI){bI=bI||HASH;$.cookie.json=true;var bH=$.cookie()||{};bH=bH.__CB_SESS_H||[];for(var bG=0;bG<bH.length;bG++){if(bH[bG]==bI){return true}}return false}function bj(bH){$.cookie.defaults={path:"/"};bH=bH||HASH;if(b(bH)){return}$.cookie.json=true;var bG=$.cookie()||{};bG=bG.__CB_SESS_H||[];bG.push(bH);if(bG.length>50){bG.shift()}$.cookie("__CB_SESS_H",bG)}function aK(bG,bI){var bH=new Firebase(a5(bG));bH=bH.child(bI);bH.once("value",function(bJ){F.setText(bJ.val().text)})}function I(bG,bL){bL.html("");var bI=function(bM){aH(bM,bL)};var bK;var bH=bD();if(bG==bH){bK=new Firebase(aA(bH))}else{bK=new Firebase(a5(bG))}paginator=new Paginator(bK,25);paginator.nextPage(bI);bL.append('<div class="paginator"><div class="btn btn-mini btn-default next">Next<i class="icon icon-chevron-right"></i></div><div class="btn btn-mini btn-default prev"><i class="icon icon-chevron-left"></i>Prev</div></div>');bL.find(".prev").click(function(){paginator.prevPage(bI)});bL.find(".next").click(function(){paginator.nextPage(bI)});bL.append('<div class="qlist"></div>');var bJ=bL.find(".qlist");bJ.parent().append('<div id="qspinner"><i class="icon-spinner icon-spin icon-2x"></i></div>')}function Q(bH,bG){bG.once("value",function(bI){var bP=bI.val();var bO=bP.title;var bN=bG.name();var bL=bP.userid;var bK=bP.username||"Me";if(bL==bD()){bK="Me"}var bM=bP.nsid||bD();var bQ=bP.nsname||"Personal";var bR=bP.text;var bJ=bP.created;aT(bH,bN,bO,bR,bL,bK,bM,bQ,bJ-TSDIFF)})}function aT(bM,bN,bO,bQ,bJ,bI,bK,bP,bH){var bL='<div class="qitem">';bL+='<div class="heading"></div>';bL+='<div class="sub-heading"></div>';bL+="</div>";bM.prepend(bL);var bG=bM.find(".qitem:first-child");bG.find(".heading").text(bO);bG.find(".sub-heading").text(bQ)}function aH(bI,bH){$("#qspinner").remove();if(bI==undefined){return}var bG=bH.find(".qlist");bG.html("");var bJ=bI.slice().reverse();$.each(bJ,function(bR,bP){var bO=bP.title;var bN=bP.key;var bL=bP.userid;var bK=bP.username||"Me";if(bL==bD()){bK="Me"}var bM=bP.nsid||bD();var bQ=bP.nsname||"Personal";var bS=bP.text;aT(bG,bN,bO,bS,bL,bK,bM,bQ,bJ[bR].created-TSDIFF)});bH.show()}function aV(){var bG='<li><span data-id="'+bD()+'">Personal</span></li>';if(bh.namespaces!=undefined){for(key in bh.namespaces){if(bh.namespaces.hasOwnProperty(key)){if(key==bD()){continue}bG+='<li><span data-id="'+key+'">'+bh.namespaces[key].name+"</span></li>"}}}$("#question-ns").html(bG);var bH=bD();$("#question-ns span").click(function(){bH=$(this).attr("data-id");$("#question-modal .dropdown-toggle").html($(this).text()+'&nbsp;<span class="caret"></span>');I(bH,$("#question-list"))});I(bD(),$("#question-list"));$("#question-modal").modal();_gaq.push(["_trackEvent","Question","Display",HASH])}function aZ(){var bI=$("#logwrap").height();var bG=$("#chatbox").height();$("#logeditor").height(bI-bG+1);bd.setSize($("#logeditor").width(),$("#logeditor").height());var bH=new Firebase(A+"/"+bn.name()+"-log");Firepad.fromCodeMirror(bH,bd,{userId:bD()});aQ()}function aQ(){$("#chatbox textarea").autosize({callback:function(){var bG=$("#chatbox").height();var bI=$("#logwrap").height();var bH=$("#chatbox").height();$("#logeditor").height(bI-bH+1);bd.setSize($("#logeditor").width(),$("#logeditor").height())}}).keydown(function(bG){if(bG.which==13){return false}return true}).keyup(function(bG){if(bG.which==13){if(au.options.readOnly){return}var bH=bh.name+" said: "+$("#chatbox textarea").val();bu(bH);$("#chatbox textarea").val("")}});bd.on("change",function(){bd.scrollIntoView(bd.lastLine())})}function bu(bH,bG){if(bG==undefined){bH=bH+"\n"}bd.replaceRange(bH,CodeMirror.Pos(bd.lastLine()))}var g=false;function aY(bH){var bG=new Firebase(A+"/.info/connected");var bI=new Firebase(A+"/"+bH+"/"+HASH);bG.on("value",function(bK){if(bK.val()){var bJ=bI.push(true);bJ.onDisconnect().remove();g=true}else{g=false}})}function al(bG){if(bG!=undefined){aM(bG,function(bH){if(bH.sid==-1){aY("presence")}else{z=true;aY("presence_paid")}})}else{aY("presence")}}function ar(){var bH=new Firebase(A+"/"+HASH+"/output");bH.limit(100).on("child_added",function(bJ){var bK=bJ.val();n.write(bK)});var bG=new Firebase(A+"/"+HASH+"/execute");var bI=function(bK,bJ){bu(bK,true);bJ()};new d(bG,bI)}function aS(){n=new Terminal({cols:80,rows:24});n.open($("#terminal").empty()[0])}function aw(bG,bI){if(n){n.destroy();aS()}if(bI.indexOf("ruby")!=-1){bI="ruby"}if(LANG_MAP[bI].repl===false){$("#result").trigger("resize",[0])}else{$("#result").trigger("resize",[$(".terminal").height()+20])}if(true){if(n){}setTimeout(function(){return $("#terminal").scrollTop(0)},1);var bH=new Firebase(A+"/"+HASH+"/input");bH.push({control:"start",lang:bI,bunkid:HASH});n.off("data");n.on("data",function(bJ){if(au.options.readOnly){return}if(g){bH.push({code:bJ,lang:bI,bunkid:HASH})}})}}function v(bH,bG){al();$.get("/bunk_loaded/"+bH,function(){bG()})}function m(bG,bH,bI){$.get("/repl_run/"+bG,{code:bH,lang:bI,bunkid:HASH})}var f=undefined;var Y=undefined;function aJ(){_gaq.push(["_trackEvent","Video","Start",HASH]);aa();$("body>object").css("display","block");$("#stream").show();var bH=$("#stream").height();$(".panes").height($(".panes").height()-bH);var bI=$(au.getWrapperElement());au.setSize(bI.width(),bI.height()-bH);var bG=$(bd.getWrapperElement());$("#logeditor").height($("#logeditor").height()-bH);bd.setSize(bG.width(),bG.height()-bH);$("#result").height($("#result").height()-bH);$("#editor").height($("#editor").height()-bH)}function x(){_gaq.push(["_trackEvent","Video","Stop",HASH]);try{if(Y){session.unpublish(Y)}if(f){session.unsubscribe(f)}session.disconnect()}catch(bI){console.log(bI);_gaq.push(["_trackEvent","Video","Stop-Failure",HASH])}var bH=$("#stream").height();$("#stream").hide();$(".panes").height($(".panes").height()+bH);var bJ=$(au.getWrapperElement());au.setSize(bJ.width(),bJ.height()+bH);var bG=$(bd.getWrapperElement());$("#logeditor").height($("#logeditor").height()+bH);bd.setSize(bG.width(),bG.height()+bH);$("#result").height($("#result").height()+bH);$("#editor").height($("#editor").height()+bH);$("body>object").css("display","none")}function aa(){try{if(!aE){session=OT.initSession(apiKey,sessId)}session.connect(token,function(bH){if(!bH){$("#mystream-parent").html('<div  id="mystream"></div>');Y=OT.initPublisher("mystream",{height:200,width:"100%"});session.publish(Y)}});session.on("streamCreated",function(bH){var bJ=document.createElement("div");bJ.setAttribute("id","stream"+bH.stream.streamId);document.getElementById("otherstream").appendChild(bJ);var bI={height:200};f=bH.stream;session.subscribe(bH.stream,bJ.id,bI)});aE=true}catch(bG){console.log(bG);_gaq.push(["_trackEvent","Video","Init-Failure",HASH])}}function bx(bG){if(bG.code==1013){alert("Problem!","This page is trying to connect a third client to an peer-to-peer session. Only two clients can connect to peer-to-peer sessions.")}}window.exceptionHandler=bx;function ak(bJ,bI){var bG=$(bJ);var bH=bG.prev(".dk_container");bG.val(bI);bH.find(".dk_options_inner").children("li").each(function(){var bK=$(this);var bL=bK.children("a");bK.removeClass("dk_option_current");if(bL.data("dk-dropdown-value")==bI){bK.addClass("dk_option_current");bH.find(".dk_label").text(bL.text())}})}function bf(bH,bG){$("#notification .msg").html(bH);$("#notification").miniNotification({position:"bottom",hideOnClick:true,autoHide:false,closeButton:true});$("#notification").width($("#editor").width())}function bl(){var bJ=$("#lang_select").val();if(bJ=="plain"){return}if(au.options.readOnly){bf("You do not have the permission to execute code on this Bunk.");return}var bH=au.doc.getValue();if(bH.length==0){return}bu("\n------------------------------------------");bu(bh.name+" is running the code");bu("------------------------------------------\n");var bI=window.location.hash.replace(/#/g,"")||HASH;if(bJ.indexOf("ruby")!=-1){bJ="ruby"}var bG=new Firebase(A+"/"+HASH+"/input");bG.push({control:"execute",lang:bJ,bunkid:HASH,code:bH});_gaq.push(["_trackEvent","run",bJ]);return false}window._originalAlert=window.alert;var aN=function(){};window.alert=function(bJ,bI,bG){var bH=function(){if(!$.fn.modal.Constructor){return false}if($("#windowAlertModal").length==1){return true}};if(bH()){aN=function(){if(bG){bG()}aN=function(){}};$("#windowAlertModal .modal-header h3").text(bJ);$("#windowAlertModal .modal-body p").html(bI);$("#windowAlertModal").modal();$("#windowAlertModal").off("hidden").on("hidden",aN)}else{window._originalAlert(bI)}};function d(bH,bG){this.processingCallback=bG;this.busy=false;bH.startAt().limit(1).on("child_added",function(bI){this.currentItem=bI.ref();this.tryToProcess()},this)}d.prototype.readyToProcess=function(){this.busy=false;this.tryToProcess()};d.prototype.tryToProcess=function(){if(!this.busy&&this.currentItem){this.busy=true;var bH=null;var bG=this;var bI=this.currentItem;this.currentItem=null;bI.transaction(function(bJ){bH=bJ;if(bJ){return null}else{return}},function(bL,bJ,bK,bM){if(bL){throw bL}if(bJ){bG.processingCallback(bH,function(){bG.readyToProcess()})}else{bG.readyToProcess()}})}}});$(function(){$.miniNotification=function(d,j){var i,h,c,f,b,g,e=this;this.defaults={autoHide:true,position:"top",show:true,effect:"slide",opacity:0.95,time:4000,showSpeed:600,hideSpeed:450,showEasing:"",hideEasing:"",innerDivClass:"inner",closeButton:false,closeButtonText:"&times",closeButtonClass:"close",hideOnClick:true,onLoad:function(){},onVisible:function(){var m=$("#notification .inner").height();var l=$("#notification i").height();$("#notification i").css("margin-top",(m-l)/2)},onHide:function(){},onHidden:function(){}};b="";this.settings={};this.$element=$(d);f=function(l){return b=l};h=function(){var m,l;l=(e.getSetting("effect"))==="slide"?0-e.$element.outerHeight():0;m={};if((e.getSetting("position"))==="bottom"){m.bottom=l}else{m.top=l}if((e.getSetting("effect"))==="fade"){m.opacity=0}return m};c=function(){var l;l={opacity:e.getSetting("opacity")};if((e.getSetting("position"))==="bottom"){l.bottom=0}else{l.top="40px"}l["font-size"]="16px";return l};g=function(){e.$elementInner=$("<div />",{"class":e.getSetting("innerDivClass")});return e.$element.wrapInner(e.$elementInner)};i=function(){var l;l=$("<a />",{"class":e.getSetting("closeButtonClass"),html:e.getSetting("closeButtonText")});e.$element.children().append(l);return l.bind("click",function(){return e.hide()})};this.getState=function(){return b};this.getSetting=function(l){return this.settings[l]};this.callSettingFunction=function(l){return this.settings[l](d)};this.init=function(){var l=this;f("hidden");this.settings=$.extend({},this.defaults,j);if(this.$element.length){g();if(this.getSetting("closeButton")){i()}this.$element.css(h()).css({display:"inline"});if(this.getSetting("show")){this.show()}if(this.getSetting("hideOnClick")){return this.$element.bind("click",function(){if(l.getState()!=="hiding"){return l.hide()}})}}};this.show=function(){var l=this;if(this.getState()!=="showing"&&this.getState()!=="visible"){f("showing");this.callSettingFunction("onLoad");return this.$element.animate(c(),this.getSetting("showSpeed"),this.getSetting("showEasing"),function(){f("visible");l.callSettingFunction("onVisible");if(l.getSetting("autoHide")){return setTimeout((function(){return l.hide()}),l.settings.time)}})}};this.hide=function(){var l=this;if(this.getState()!=="hiding"&&this.getState()!=="hidden"){f("hiding");this.callSettingFunction("onHide");return this.$element.animate(h(),this.getSetting("hideSpeed"),this.getSetting("hideEasing"),function(){f("hidden");return l.callSettingFunction("onHidden")})}};this.init();return this};return $.fn.miniNotification=function(b){return this.each(function(){var c;c=($(this)).data("miniNotification");if(c===void 0){c=new $.miniNotification(this,b);return($(this)).data("miniNotification",c)}else{return c.show()}})}});